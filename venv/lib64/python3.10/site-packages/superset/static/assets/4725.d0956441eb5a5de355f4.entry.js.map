{"version":3,"file":"4725.d0956441eb5a5de355f4.entry.js","mappings":"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","sources":["webpack://superset/./plugins/legacy-preset-chart-nvd3/src/utils.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/utils/isTruthy.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/vendor/superset/AnnotationTypes.js","webpack://superset/./packages/superset-ui-chart-controls/src/sections/sections.tsx","webpack://superset/./packages/superset-ui-chart-controls/src/sections/advancedAnalytics.tsx","webpack://superset/./packages/superset-ui-chart-controls/src/sections/annotationsAndLayers.tsx","webpack://superset/./packages/superset-ui-chart-controls/src/sections/forecastInterval.tsx","webpack://superset/./packages/superset-ui-chart-controls/src/sections/chartTitle.tsx","webpack://superset/./packages/superset-ui-chart-controls/src/utils/checkColumnType.ts","webpack://superset/./packages/superset-ui-chart-controls/src/shared-controls/customControls.tsx","webpack://superset/./packages/superset-ui-chart-controls/src/sections/echartsTimeSeriesQuery.tsx","webpack://superset/./packages/superset-ui-chart-controls/src/utils/mainMetric.ts","webpack://superset/./packages/superset-ui-chart-controls/src/fixtures.ts","webpack://superset/./packages/superset-ui-chart-controls/src/index.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/boxplotOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/contributionOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/flattenOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/pivotOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/prophetOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/renameOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/resampleOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/rollingWindowOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/sortOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/timeCompareOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/timeComparePivotOperator.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/utils/constants.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/utils/extractExtraMetrics.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/utils/getMetricOffsetsMap.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/utils/isDerivedSeries.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/utils/isTimeComparison.ts","webpack://superset/./packages/superset-ui-chart-controls/src/operators/utils/timeOffset.ts","webpack://superset/./packages/superset-ui-chart-controls/src/utils/columnChoices.ts","webpack://superset/./packages/superset-ui-chart-controls/src/utils/getColorFormatters.ts","webpack://superset/./packages/superset-ui-core/src/chart/models/ChartMetadata.ts","webpack://superset/./packages/superset-ui-core/src/chart/models/ChartPlugin.ts","webpack://superset/./packages/superset-ui-core/src/chart/registries/ChartComponentRegistrySingleton.ts","webpack://superset/./packages/superset-ui-core/src/chart/registries/ChartTransformPropsRegistrySingleton.ts","webpack://superset/./packages/superset-ui-core/src/components/constants.ts","webpack://superset/./packages/superset-ui-core/src/currency-format/CurrencyFormatter.ts","webpack://superset/./packages/superset-ui-core/src/currency-format/utils.ts","webpack://superset/./packages/superset-ui-core/src/dynamic-plugins/shared-modules.ts","webpack://superset/./packages/superset-ui-core/src/hooks/useComponentDidMount/useComponentDidMount.ts","webpack://superset/./packages/superset-ui-core/src/math-expression/index.ts","webpack://superset/./packages/superset-ui-core/src/models/Plugin.ts","webpack://superset/./packages/superset-ui-core/src/models/Preset.ts","webpack://superset/./packages/superset-ui-core/src/query/extractTimegrain.ts","webpack://superset/./packages/superset-ui-core/src/query/normalizeOrderBy.ts","webpack://superset/./packages/superset-ui-core/src/query/types/AnnotationLayer.ts","webpack://superset/./packages/superset-ui-core/src/time-format/formatters/smartDateDetailed.ts","webpack://superset/./packages/superset-ui-core/src/utils/ensureIsInt.ts","webpack://superset/./packages/superset-ui-core/src/utils/isEqualArray.ts","webpack://superset/./packages/superset-ui-core/src/validator/legacyValidateNumber.ts","webpack://superset/./packages/superset-ui-core/src/validator/validateMapboxStylesUrl.ts","webpack://superset/./packages/superset-ui-core/src/validator/validateNumber.ts","webpack://superset/./plugins/legacy-plugin-chart-country-map/src/countries.ts","webpack://superset/./plugins/legacy-plugin-chart-sankey/src/utils.ts","webpack://superset/./plugins/legacy-plugin-chart-world-map/src/utils.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Treemap/constants.ts","webpack://superset/./plugins/plugin-chart-echarts/src/constants.ts","webpack://superset/./plugins/plugin-chart-echarts/src/defaults.ts","webpack://superset/./plugins/plugin-chart-echarts/src/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/utils/series.ts","webpack://superset/./plugins/plugin-chart-pivot-table/src/types.ts","webpack://superset/./plugins/plugin-chart-table/src/DataTable/utils/externalAPIs.ts","webpack://superset/./plugins/plugin-chart-table/src/consts.ts","webpack://superset/./plugins/plugin-chart-table/src/i18n.ts","webpack://superset/./plugins/plugin-chart-table/src/utils/DateWithFormatter.ts","webpack://superset/./src/components/DynamicPlugins/index.tsx","webpack://superset/./src/components/ErrorBoundary/index.tsx","webpack://superset/./src/components/MessageToasts/Toast.tsx","webpack://superset/./src/components/MessageToasts/ToastPresenter.tsx","webpack://superset/./src/components/MessageToasts/ToastContainer.tsx","webpack://superset/./src/filters/components/Range/SingleValueType.ts","webpack://superset/./plugins/legacy-plugin-chart-calendar/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-calendar/src/utils.ts","webpack://superset/./plugins/legacy-plugin-chart-calendar/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-calendar/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-chord/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-chord/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-chord/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-country-map/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-country-map/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-country-map/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-event-flow/src/controlPanel.tsx","webpack://superset/./plugins/legacy-plugin-chart-event-flow/src/index.ts","webpack://superset/./plugins/legacy-plugin-chart-heatmap/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-heatmap/src/controlPanel.tsx","webpack://superset/./plugins/legacy-plugin-chart-heatmap/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-histogram/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-histogram/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-histogram/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-horizon/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-horizon/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-horizon/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-map-box/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-map-box/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-paired-t-test/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-paired-t-test/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-paired-t-test/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-parallel-coordinates/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-parallel-coordinates/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-parallel-coordinates/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-partition/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-partition/src/OptionDescription.tsx","webpack://superset/./plugins/legacy-plugin-chart-partition/src/controlPanel.tsx","webpack://superset/./plugins/legacy-plugin-chart-partition/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-rose/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-rose/src/controlPanel.tsx","webpack://superset/./plugins/legacy-plugin-chart-rose/src/index.js","webpack://superset/./plugins/legacy-plugin-chart-sankey/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-sankey/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-sankey/src/index.js","webpack://superset/./plugins/plugin-chart-table/src/transformProps.ts","webpack://superset/./plugins/plugin-chart-table/src/utils/isEqualColumns.ts","webpack://superset/./plugins/plugin-chart-table/src/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-table/src/buildQuery.ts","webpack://superset/./plugins/plugin-chart-table/src/index.ts","webpack://superset/./plugins/plugin-chart-word-cloud/src/legacyPlugin/transformProps.ts","webpack://superset/./plugins/plugin-chart-word-cloud/src/plugin/buildQuery.ts","webpack://superset/./plugins/plugin-chart-word-cloud/src/plugin/controlPanel.ts","webpack://superset/./plugins/plugin-chart-word-cloud/src/configureEncodable.ts","webpack://superset/./plugins/plugin-chart-word-cloud/src/plugin/index.ts","webpack://superset/./plugins/legacy-plugin-chart-world-map/src/transformProps.js","webpack://superset/./plugins/legacy-plugin-chart-world-map/src/controlPanel.ts","webpack://superset/./plugins/legacy-plugin-chart-world-map/src/index.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/utils/tokenize.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/transformProps.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/NVD3Controls.tsx","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Area/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Area/index.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Bar/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Bar/index.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Bubble/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Bubble/index.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Bullet/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Bullet/index.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Compare/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Compare/index.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/DistBar/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/DistBar/index.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Line/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/Line/index.js","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/TimePivot/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-nvd3/src/TimePivot/index.js","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/transformProps.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/utilities/controls.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/utilities/utils.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/utilities/Shared_DeckGL.jsx","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Arc/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Arc/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/utilities/sharedDndControls.tsx","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Geojson/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Geojson/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Grid/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Grid/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Hex/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Hex/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Heatmap/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Heatmap/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/Multi/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/Multi/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Path/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Path/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Polygon/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Polygon/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Scatter/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Scatter/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Screengrid/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Screengrid/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Contour/controlPanel.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/layers/Contour/index.ts","webpack://superset/./plugins/legacy-preset-chart-deckgl/src/preset.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/sharedControls.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberWithTrendline/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/utils.ts","webpack://superset/./plugins/plugin-chart-echarts/src/utils/tooltip.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberWithTrendline/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberWithTrendline/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberWithTrendline/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberTotal/controlPanel.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberTotal/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberTotal/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BigNumber/BigNumberTotal/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BoxPlot/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BoxPlot/controlPanel.ts","webpack://superset/./plugins/plugin-chart-echarts/src/utils/convertInteger.ts","webpack://superset/./plugins/plugin-chart-echarts/src/utils/forecast.ts","webpack://superset/./plugins/plugin-chart-echarts/src/utils/annotation.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/transformers.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BoxPlot/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Funnel/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/BoxPlot/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Funnel/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/constants.ts","webpack://superset/./plugins/plugin-chart-echarts/src/controls.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Funnel/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Funnel/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Funnel/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Treemap/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Treemap/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Treemap/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/utils/treeBuilder.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Treemap/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Treemap/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Gauge/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Gauge/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/utils/controls.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Gauge/constants.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Gauge/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Gauge/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Gauge/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Graph/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Graph/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Graph/constants.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Graph/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Graph/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Graph/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Radar/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Radar/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Radar/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Radar/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Radar/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/MixedTimeseries/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/utils/formDataSuffix.ts","webpack://superset/./plugins/plugin-chart-echarts/src/MixedTimeseries/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/MixedTimeseries/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/utils/formatters.ts","webpack://superset/./plugins/plugin-chart-echarts/src/MixedTimeseries/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/MixedTimeseries/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Pie/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Pie/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Pie/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Pie/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Pie/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Area/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Area/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Regular/Line/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Regular/Bar/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Regular/Bar/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Regular/Line/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Regular/SmoothLine/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Regular/SmoothLine/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Regular/Scatter/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Regular/Scatter/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Step/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Timeseries/Step/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Waterfall/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Waterfall/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Waterfall/constants.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Waterfall/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Waterfall/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Tree/constants.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Tree/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Tree/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Tree/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Tree/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Sunburst/types.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Sunburst/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Sunburst/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Sunburst/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Sunburst/index.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Bubble/constants.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Bubble/transformProps.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Bubble/buildQuery.ts","webpack://superset/./plugins/plugin-chart-echarts/src/Bubble/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-echarts/src/Bubble/index.ts","webpack://superset/./src/filters/components/Select/types.ts","webpack://superset/./src/filters/components/Select/buildQuery.ts","webpack://superset/./src/filters/components/Select/controlPanel.ts","webpack://superset/./src/filters/components/Select/transformProps.ts","webpack://superset/./src/filters/components/Select/index.ts","webpack://superset/./src/filters/components/Range/buildQuery.ts","webpack://superset/./src/filters/components/Range/controlPanel.ts","webpack://superset/./src/filters/components/Range/transformProps.ts","webpack://superset/./src/filters/components/Range/index.ts","webpack://superset/./src/filters/components/Time/controlPanel.ts","webpack://superset/./src/filters/components/Time/types.ts","webpack://superset/./src/filters/components/Time/transformProps.ts","webpack://superset/./src/filters/components/Time/index.ts","webpack://superset/./src/filters/components/TimeColumn/buildQuery.ts","webpack://superset/./src/filters/components/TimeColumn/controlPanel.ts","webpack://superset/./src/filters/components/TimeColumn/types.ts","webpack://superset/./src/filters/components/TimeColumn/transformProps.ts","webpack://superset/./src/filters/components/TimeColumn/index.ts","webpack://superset/./src/filters/components/TimeGrain/buildQuery.ts","webpack://superset/./src/filters/components/TimeGrain/controlPanel.ts","webpack://superset/./src/filters/components/TimeGrain/types.ts","webpack://superset/./src/filters/components/TimeGrain/transformProps.ts","webpack://superset/./src/filters/components/TimeGrain/index.ts","webpack://superset/./plugins/plugin-chart-pivot-table/src/plugin/buildQuery.ts","webpack://superset/./plugins/plugin-chart-pivot-table/src/plugin/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-pivot-table/src/plugin/transformProps.ts","webpack://superset/./plugins/plugin-chart-pivot-table/src/plugin/index.ts","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/buildQuery.ts","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/shared.ts","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/columns.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/groupBy.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/components/CodeEditor/CodeEditor.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/components/ControlHeader/controlHeader.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/consts.ts","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/handlebarTemplate.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/includeTime.ts","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/limits.ts","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/metrics.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/orderBy.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/pagination.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/queryMode.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controls/style.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/controlPanel.tsx","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/transformProps.ts","webpack://superset/./plugins/plugin-chart-handlebars/src/plugin/index.ts","webpack://superset/./plugins/plugin-chart-period-over-period-kpi/src/utils.ts","webpack://superset/./plugins/plugin-chart-period-over-period-kpi/src/plugin/buildQuery.ts","webpack://superset/./plugins/plugin-chart-period-over-period-kpi/src/plugin/controlPanel.ts","webpack://superset/./plugins/plugin-chart-period-over-period-kpi/src/plugin/transformProps.ts","webpack://superset/./plugins/plugin-chart-period-over-period-kpi/src/plugin/index.ts","webpack://superset/./src/visualizations/TimeTable/transformProps.ts","webpack://superset/./src/visualizations/TimeTable/controlPanel.js","webpack://superset/./src/visualizations/TimeTable/index.ts","webpack://superset/./src/visualizations/presets/MainPreset.js","webpack://superset/./src/explore/controlPanels/Separator.js","webpack://superset/./src/setup/setupPlugins.ts","webpack://superset/./src/components/FlashProvider/index.tsx","webpack://superset/./src/views/RootContextProviders.tsx"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport d3 from 'd3';\nimport d3tip from 'd3-tip';\nimport dompurify from 'dompurify';\nimport { smartDateFormatter, getNumberFormatter } from '@superset-ui/core';\n// Regexp for the label added to time shifted series\n// (1 hour offset, 2 days offset, etc.)\nconst TIME_SHIFT_PATTERN = /\\d+ \\w+ offset/;\n\nconst ANIMATION_TIME = 1000;\n\nexport function cleanColorInput(value) {\n  // for superset series that should have the same color\n  return String(value)\n    .trim()\n    .replace(' (right axis)', '')\n    .split(', ')\n    .filter(k => !TIME_SHIFT_PATTERN.test(k))\n    .join(', ');\n}\n\n/**\n * If format is smart_date, format date\n * Otherwise, format number with the given format name\n * @param {*} format\n */\nexport function getTimeOrNumberFormatter(format) {\n  return format === 'smart_date'\n    ? smartDateFormatter\n    : getNumberFormatter(format);\n}\n\nexport function drawBarValues(svg, data, stacked, axisFormat) {\n  const format = getNumberFormatter(axisFormat);\n  const countSeriesDisplayed = data.filter(d => !d.disabled).length;\n  const totalStackedValues =\n    stacked && data.length !== 0\n      ? data[0].values.map((bar, iBar) => {\n          const bars = data\n            .filter(series => !series.disabled)\n            .map(series => series.values[iBar]);\n\n          return d3.sum(bars, d => d.y);\n        })\n      : [];\n  svg.selectAll('.bar-chart-label-group').remove();\n  setTimeout(() => {\n    svg.selectAll('.bar-chart-label-group').remove();\n    const groupLabels = svg\n      .select('g.nv-barsWrap')\n      .append('g')\n      .attr('class', 'bar-chart-label-group');\n    svg\n      .selectAll('g.nv-group')\n      .filter((d, i) => !stacked || i === countSeriesDisplayed - 1)\n      .selectAll('rect')\n      .each(function each(d, index) {\n        const rectObj = d3.select(this);\n        const transformAttr = rectObj.attr('transform');\n        const xPos = parseFloat(rectObj.attr('x'));\n        const yPos = parseFloat(rectObj.attr('y'));\n        const rectWidth = parseFloat(rectObj.attr('width'));\n        const rectHeight = parseFloat(rectObj.attr('height'));\n        const textEls = groupLabels\n          .append('text')\n          .text(format(stacked ? totalStackedValues[index] : d.y))\n          .attr('transform', transformAttr)\n          .attr('class', 'bar-chart-label');\n\n        // fine tune text position\n        const bbox = textEls.node().getBBox();\n        const labelWidth = bbox.width;\n        const labelHeight = bbox.height;\n        textEls.attr('x', xPos + rectWidth / 2 - labelWidth / 2);\n        if (rectObj.attr('class').includes('positive')) {\n          textEls.attr('y', yPos - 5);\n        } else {\n          textEls.attr('y', yPos + rectHeight + labelHeight);\n        }\n      });\n  }, ANIMATION_TIME);\n}\n\n// Formats the series key to account for a possible NULL value\nfunction getFormattedKey(seriesKey, shouldDompurify) {\n  if (seriesKey === '<NULL>') {\n    return `&lt;${seriesKey.slice(1, -1)}&gt;`;\n  }\n\n  return shouldDompurify ? dompurify.sanitize(seriesKey) : seriesKey;\n}\n\n// Custom sorted tooltip\n// use a verbose formatter for times\nexport function generateRichLineTooltipContent(\n  d,\n  timeFormatter,\n  valueFormatter,\n) {\n  let tooltip = '';\n  tooltip +=\n    \"<table><thead><tr><td colspan='3'>\" +\n    `<strong class='x-value'>${timeFormatter(d.value)}</strong>` +\n    '</td></tr></thead><tbody>';\n  d.series.sort((a, b) => (a.value >= b.value ? -1 : 1));\n  d.series.forEach(series => {\n    const key = getFormattedKey(series.key, true);\n    tooltip +=\n      `<tr class=\"${series.highlight ? 'emph' : ''}\">` +\n      `<td class='legend-color-guide' style=\"opacity: ${\n        series.highlight ? '1' : '0.75'\n      };\"\">` +\n      '<div ' +\n      `style=\"border: 2px solid ${\n        series.highlight ? 'black' : 'transparent'\n      }; background-color: ${series.color};\"` +\n      '></div>' +\n      '</td>' +\n      `<td>${key}</td>` +\n      `<td>${valueFormatter(series.value)}</td>` +\n      '</tr>';\n  });\n  tooltip += '</tbody></table>';\n\n  return dompurify.sanitize(tooltip);\n}\n\nexport function generateCompareTooltipContent(d, valueFormatter) {\n  let tooltip = '';\n  tooltip +=\n    \"<table><thead><tr><td colspan='3'>\" +\n    `<strong class='x-value'>${d.value}</strong>` +\n    '</td></tr></thead><tbody>';\n  d.series.sort((a, b) => (a.value >= b.value ? -1 : 1));\n  d.series.forEach(series => {\n    const key = getFormattedKey(series.key, true);\n    tooltip +=\n      `<tr class=\"${series.highlight ? 'emph' : ''}\">` +\n      `<td class='legend-color-guide' style=\"opacity: ${\n        series.highlight ? '1' : '0.75'\n      };\"\">` +\n      '<div ' +\n      `style=\"border: 2px solid ${\n        series.highlight ? 'black' : 'transparent'\n      }; background-color: ${series.color};\"` +\n      '></div>' +\n      '</td>' +\n      `<td>${key}</td>` +\n      `<td>${valueFormatter(series.value)}</td>` +\n      '</tr>';\n  });\n  tooltip += '</tbody></table>';\n\n  return dompurify.sanitize(tooltip);\n}\n\nexport function generateAreaChartTooltipContent(\n  d,\n  timeFormatter,\n  valueFormatter,\n  chart,\n) {\n  const total =\n    chart.style() === 'expand'\n      ? // expand mode does not include total row\n        d3.sum(d.series, s => s.value)\n      : // other modes include total row at the end\n        d.series[d.series.length - 1].value;\n  let tooltip = '';\n  tooltip +=\n    \"<table><thead><tr><td colspan='4'>\" +\n    `<strong class='x-value'>${timeFormatter(d.value)}</strong>` +\n    '</td></tr></thead><tbody>' +\n    '<tr class=\"tooltip-header\"><td></td><td>Category</td><td>Value</td><td>% to total</td></tr>';\n  d.series.forEach(series => {\n    const key = getFormattedKey(series.key, true);\n    const isTotal = series.key === 'TOTAL';\n    let trClass = '';\n    if (series.highlight) {\n      trClass = 'superset-legacy-chart-nvd3-tr-highlight';\n    } else if (isTotal) {\n      trClass = 'superset-legacy-chart-nvd3-tr-total';\n    }\n    tooltip +=\n      `<tr class=\"${trClass}\" style=\"border-color: ${series.color}\">` +\n      `<td style=\"color: ${series.color}\">${isTotal ? '' : '&#9724;'}</td>` +\n      `<td>${key}</td>` +\n      `<td>${valueFormatter(isTotal ? total : series?.point?.y)}</td>` +\n      `<td>${((100 * series.value) / total).toFixed(2)}%</td>` +\n      '</tr>';\n  });\n  tooltip += '</tbody></table>';\n\n  return dompurify.sanitize(tooltip);\n}\n\nexport function generateMultiLineTooltipContent(d, xFormatter, yFormatters) {\n  const tooltipTitle = xFormatter(d.value);\n  let tooltip = '';\n\n  tooltip +=\n    \"<table><thead><tr><td colspan='3'>\" +\n    `<strong class='x-value'>${tooltipTitle}</strong>` +\n    '</td></tr></thead><tbody>';\n\n  d.series.forEach((series, i) => {\n    const yFormatter = yFormatters[i];\n    const key = getFormattedKey(series.key, false);\n    tooltip +=\n      \"<tr><td class='legend-color-guide'>\" +\n      `<div style=\"background-color: ${series.color};\"></div></td>` +\n      `<td class='key'>${key}</td>` +\n      `<td class='value'>${yFormatter(series.value)}</td></tr>`;\n  });\n\n  tooltip += '</tbody></table>';\n\n  return tooltip;\n}\n\nexport function generateTimePivotTooltip(d, xFormatter, yFormatter) {\n  const tooltipTitle = xFormatter(d.value);\n  let tooltip = '';\n\n  tooltip +=\n    \"<table><thead><tr><td colspan='3'>\" +\n    `<strong class='x-value'>${tooltipTitle}</strong>` +\n    '</td></tr></thead><tbody>';\n\n  d.series.forEach(series => {\n    if (series.highlight) {\n      let label = '';\n      if (series.key === 'current') {\n        label = series.key;\n      } else {\n        label = `${series.key} of the selected frequency:`;\n      }\n      tooltip +=\n        \"<tr><td class='legend-color-guide'>\" +\n        `<div style=\"background-color: ${series.color};\"></div></td>` +\n        `<td class='key'>${label}</td>` +\n        `<td class='value'>${yFormatter(series.value)}</td></tr>`;\n    }\n  });\n\n  tooltip += '</tbody></table>';\n\n  return dompurify.sanitize(tooltip);\n}\n\nfunction getLabel(stringOrObjectWithLabel) {\n  return stringOrObjectWithLabel.label || stringOrObjectWithLabel;\n}\n\nfunction createHTMLRow(col1, col2) {\n  return `<tr><td>${col1}</td><td>${col2}</td></tr>`;\n}\n\nexport function generateBubbleTooltipContent({\n  point,\n  entity,\n  xField,\n  yField,\n  sizeField,\n  xFormatter,\n  yFormatter,\n  sizeFormatter,\n}) {\n  let s = '<table>';\n  s +=\n    `<tr><td style=\"color: ${point.color};\">` +\n    `<strong>${point[entity]}</strong> (${point.group})` +\n    '</td></tr>';\n  s += createHTMLRow(getLabel(xField), xFormatter(point.x));\n  s += createHTMLRow(getLabel(yField), yFormatter(point.y));\n  s += createHTMLRow(getLabel(sizeField), sizeFormatter(point.size));\n  s += '</table>';\n\n  return s;\n}\n\n// shouldRemove indicates whether the nvtooltips should be removed from the DOM\nexport function hideTooltips(shouldRemove) {\n  const targets = document.querySelectorAll('.nvtooltip');\n  if (targets.length > 0) {\n    // Only set opacity to 0 when hiding tooltips so they would reappear\n    // on hover, which sets the opacity to 1\n    targets.forEach(t => {\n      if (shouldRemove) {\n        t.remove();\n      } else {\n        // eslint-disable-next-line no-param-reassign\n        t.style.opacity = 0;\n      }\n    });\n  }\n}\n\nexport function generateTooltipClassName(uuid) {\n  return `tooltip-${uuid}`;\n}\n\nexport function removeTooltip(uuid) {\n  const classSelector = `.${generateTooltipClassName(uuid)}`;\n  const target = document.querySelector(classSelector);\n  if (target) {\n    target.remove();\n  }\n}\n\nexport function wrapTooltip(chart) {\n  const tooltipLayer =\n    chart.useInteractiveGuideline && chart.useInteractiveGuideline()\n      ? chart.interactiveLayer\n      : chart;\n  const tooltipGeneratorFunc = tooltipLayer.tooltip.contentGenerator();\n  tooltipLayer.tooltip.contentGenerator(d => {\n    let tooltip = `<div>`;\n    tooltip += tooltipGeneratorFunc(d);\n    tooltip += '</div>';\n\n    return tooltip;\n  });\n}\n\nexport function tipFactory(layer) {\n  return d3tip()\n    .attr('class', `d3-tip ${layer.annotationTipClass || ''}`)\n    .direction('n')\n    .offset([-5, 0])\n    .html(d => {\n      if (!d) {\n        return '';\n      }\n      const title =\n        d[layer.titleColumn] && d[layer.titleColumn].length > 0\n          ? `${d[layer.titleColumn]} - ${layer.name}`\n          : layer.name;\n      const body = Array.isArray(layer.descriptionColumns)\n        ? layer.descriptionColumns.map(c => d[c])\n        : Object.values(d);\n\n      return `<div><strong>${title}</strong></div><br/><div>${body.join(\n        ', ',\n      )}</div>`;\n    });\n}\n\nexport function getMaxLabelSize(svg, axisClass) {\n  // axis class = .nv-y2  // second y axis on dual line chart\n  // axis class = .nv-x  // x axis on time series line chart\n  const tickTexts = svg.selectAll(`.${axisClass} g.tick text`);\n  if (tickTexts.length > 0) {\n    const lengths = tickTexts[0].map(text => text.getComputedTextLength());\n\n    return Math.ceil(Math.max(0, ...lengths));\n  }\n\n  return 0;\n}\n\nexport function formatLabel(input, verboseMap = {}) {\n  // The input for label may be a string or an array of string\n  // When using the time shift feature, the label contains a '---' in the array\n  const verboseLookup = s => verboseMap[s] || s;\n\n  return Array.isArray(input) && input.length > 0\n    ? input\n        .map(l => (TIME_SHIFT_PATTERN.test(l) ? l : verboseLookup(l)))\n        .join(', ')\n    : verboseLookup(input);\n}\n\nconst MIN_BAR_WIDTH = 18;\n\nexport function computeBarChartWidth(data, stacked, maxWidth) {\n  const barCount = stacked\n    ? d3.max(data, d => d.values.length)\n    : d3.sum(data, d => d.values.length);\n\n  const barWidth = barCount * MIN_BAR_WIDTH;\n\n  return Math.max(barWidth, maxWidth);\n}\n\nexport function tryNumify(s) {\n  // Attempts casting to Number, returns string when failing\n  const n = Number(s);\n\n  return Number.isNaN(n) ? s : n;\n}\n\nexport function stringifyTimeRange(extent) {\n  if (extent.some(d => d.toISOString === undefined)) {\n    return null;\n  }\n\n  return extent.map(d => d.toISOString().slice(0, -1)).join(' : ');\n}\n\nexport function setAxisShowMaxMin(axis, showminmax) {\n  if (axis && axis.showMaxMin && showminmax !== undefined) {\n    axis.showMaxMin(showminmax);\n  }\n}\n\nexport function computeYDomain(data) {\n  if (Array.isArray(data) && data.length > 0 && Array.isArray(data[0].values)) {\n    const extents = data\n      .filter(d => !d.disabled)\n      .map(row => d3.extent(row.values, v => v.y));\n    const minOfMin = d3.min(extents, ([min]) => min);\n    const maxOfMax = d3.max(extents, ([, max]) => max);\n\n    return [minOfMin, maxOfMax];\n  }\n\n  return [0, 1];\n}\n\nexport function computeStackedYDomain(data) {\n  if (Array.isArray(data) && data.length > 0 && Array.isArray(data[0].values)) {\n    const series = data\n      .filter(d => !d.disabled)\n      .map(d => d.values.map(v => v.y));\n    const stackedValues = series[0].map((_, i) =>\n      series.reduce((acc, cur) => acc + cur[i], 0),\n    );\n\n    return [Math.min(0, ...stackedValues), Math.max(0, ...stackedValues)];\n  }\n\n  return [0, 1];\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function isTruthy(obj) {\n  if (typeof obj === 'boolean') {\n    return obj;\n  }\n  if (typeof obj === 'string') {\n    return ['yes', 'y', 'true', 't', '1'].includes(obj.toLowerCase());\n  }\n\n  return !!obj;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\n\nfunction extractTypes(metadata) {\n  return Object.keys(metadata).reduce((prev, key) => {\n    const result = prev;\n    result[key] = key;\n\n    return result;\n  }, {});\n}\n\nexport const ANNOTATION_TYPES_METADATA = {\n  FORMULA: {\n    value: 'FORMULA',\n    label: t('Formula'),\n  },\n  EVENT: {\n    value: 'EVENT',\n    label: t('Event'),\n    supportNativeSource: true,\n  },\n  INTERVAL: {\n    value: 'INTERVAL',\n    label: t('Interval'),\n    supportNativeSource: true,\n  },\n  TIME_SERIES: {\n    value: 'TIME_SERIES',\n    label: t('Time Series'),\n  },\n};\n\nexport const ANNOTATION_TYPES = extractTypes(ANNOTATION_TYPES_METADATA);\n\nexport const DEFAULT_ANNOTATION_TYPE = ANNOTATION_TYPES.FORMULA;\n\nexport const ANNOTATION_SOURCE_TYPES_METADATA = {\n  NATIVE: {\n    value: 'NATIVE',\n    label: 'Superset annotation',\n  },\n};\n\nexport const ANNOTATION_SOURCE_TYPES = extractTypes(\n  ANNOTATION_SOURCE_TYPES_METADATA,\n);\n\nexport function requiresQuery(annotationSourceType) {\n  return !!annotationSourceType;\n}\n\nconst NATIVE_COLUMN_NAMES = {\n  descriptionColumns: ['long_descr'],\n  intervalEndColumn: 'end_dttm',\n  timeColumn: 'start_dttm',\n  titleColumn: 'short_descr',\n};\n\nexport function applyNativeColumns(annotation) {\n  if (annotation.sourceType === ANNOTATION_SOURCE_TYPES.NATIVE) {\n    return { ...annotation, ...NATIVE_COLUMN_NAMES };\n  }\n\n  return annotation;\n}\n\nexport default ANNOTATION_TYPES;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport { ControlPanelSectionConfig } from '../types';\n\n// A few standard controls sections that are used internally.\n// Not recommended for use in third-party plugins.\n\nconst baseTimeSection = {\n  label: t('Time'),\n  expanded: true,\n  description: t('Time related form attributes'),\n};\n\nexport const legacyTimeseriesTime: ControlPanelSectionConfig = {\n  ...baseTimeSection,\n  controlSetRows: [\n    ['granularity'],\n    ['granularity_sqla'],\n    ['time_grain_sqla'],\n    ['time_range'],\n  ],\n};\n\nexport const datasourceAndVizType: ControlPanelSectionConfig = {\n  label: t('Datasource & Chart Type'),\n  expanded: true,\n  controlSetRows: [\n    ['datasource'],\n    ['viz_type'],\n    [\n      {\n        name: 'slice_id',\n        config: {\n          type: 'HiddenControl',\n          label: t('Chart ID'),\n          hidden: true,\n          description: t('The id of the active chart'),\n        },\n      },\n      {\n        name: 'cache_timeout',\n        config: {\n          type: 'HiddenControl',\n          label: t('Cache Timeout (seconds)'),\n          hidden: true,\n          description: t('The number of seconds before expiring the cache'),\n        },\n      },\n      {\n        name: 'url_params',\n        config: {\n          type: 'HiddenControl',\n          label: t('URL Parameters'),\n          hidden: true,\n          description: t(\n            'Extra url parameters for use in Jinja templated queries',\n          ),\n        },\n      },\n      {\n        name: 'custom_params',\n        config: {\n          type: 'HiddenControl',\n          label: t('Extra Parameters'),\n          hidden: true,\n          description: t(\n            'Extra parameters that any plugins can choose to set for use in Jinja templated queries',\n          ),\n        },\n      },\n    ],\n  ],\n};\n\nexport const colorScheme: ControlPanelSectionConfig = {\n  label: t('Color Scheme'),\n  controlSetRows: [['color_scheme']],\n};\n\nexport const annotations: ControlPanelSectionConfig = {\n  label: t('Annotations and Layers'),\n  tabOverride: 'data',\n  expanded: true,\n  controlSetRows: [\n    [\n      {\n        name: 'annotation_layers',\n        config: {\n          type: 'AnnotationLayerControl',\n          label: '',\n          default: [],\n          description: t('Annotation Layers'),\n          renderTrigger: true,\n        },\n      },\n    ],\n  ],\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t, RollingType, ComparisonType } from '@superset-ui/core';\n\nimport { ControlSubSectionHeader } from '../components/ControlSubSectionHeader';\nimport { ControlPanelSectionConfig } from '../types';\nimport { formatSelectOptions, displayTimeRelatedControls } from '../utils';\n\nexport const advancedAnalyticsControls: ControlPanelSectionConfig = {\n  label: t('Advanced analytics'),\n  tabOverride: 'data',\n  description: t(\n    'This section contains options ' +\n      'that allow for advanced analytical post processing ' +\n      'of query results',\n  ),\n  visibility: displayTimeRelatedControls,\n  controlSetRows: [\n    [<ControlSubSectionHeader>{t('Rolling window')}</ControlSubSectionHeader>],\n    [\n      {\n        name: 'rolling_type',\n        config: {\n          type: 'SelectControl',\n          label: t('Rolling function'),\n          default: null,\n          choices: [[null, t('None')]].concat(\n            formatSelectOptions(Object.values(RollingType)),\n          ),\n          description: t(\n            'Defines a rolling window function to apply, works along ' +\n              'with the [Periods] text box',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: 'rolling_periods',\n        config: {\n          type: 'TextControl',\n          label: t('Periods'),\n          isInt: true,\n          description: t(\n            'Defines the size of the rolling window function, ' +\n              'relative to the time granularity selected',\n          ),\n          visibility: ({ controls }, { name }) => {\n            // `rolling_type_b` refer to rolling_type in mixed timeseries Query B\n            const rollingTypeControlName = name.endsWith('_b')\n              ? 'rolling_type_b'\n              : 'rolling_type';\n            return (\n              Boolean(controls[rollingTypeControlName]?.value) &&\n              controls[rollingTypeControlName]?.value !== RollingType.Cumsum\n            );\n          },\n        },\n      },\n    ],\n    [\n      {\n        name: 'min_periods',\n        config: {\n          type: 'TextControl',\n          label: t('Min periods'),\n          isInt: true,\n          description: t(\n            'The minimum number of rolling periods required to show ' +\n              'a value. For instance if you do a cumulative sum on 7 days ' +\n              'you may want your \"Min Period\" to be 7, so that all data points ' +\n              'shown are the total of 7 periods. This will hide the \"ramp up\" ' +\n              'taking place over the first 7 periods',\n          ),\n          visibility: ({ controls }, { name }) => {\n            // `rolling_type_b` refer to rolling_type in mixed timeseries Query B\n            const rollingTypeControlName = name.endsWith('_b')\n              ? 'rolling_type_b'\n              : 'rolling_type';\n            return (\n              Boolean(controls[rollingTypeControlName]?.value) &&\n              controls[rollingTypeControlName]?.value !== RollingType.Cumsum\n            );\n          },\n        },\n      },\n    ],\n    [<ControlSubSectionHeader>{t('Time comparison')}</ControlSubSectionHeader>],\n    [\n      {\n        name: 'time_compare',\n        config: {\n          type: 'SelectControl',\n          multi: true,\n          freeForm: true,\n          label: t('Time shift'),\n          choices: [\n            ['1 day ago', t('1 day ago')],\n            ['1 week ago', t('1 week ago')],\n            ['28 days ago', t('28 days ago')],\n            ['30 days ago', t('30 days ago')],\n            ['52 weeks ago', t('52 weeks ago')],\n            ['1 year ago', t('1 year ago')],\n            ['104 weeks ago', t('104 weeks ago')],\n            ['2 years ago', t('2 years ago')],\n            ['156 weeks ago', t('156 weeks ago')],\n            ['3 years ago', t('3 years ago')],\n          ],\n          description: t(\n            'Overlay one or more timeseries from a ' +\n              'relative time period. Expects relative time deltas ' +\n              'in natural language (example:  24 hours, 7 days, ' +\n              '52 weeks, 365 days). Free text is supported.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: 'comparison_type',\n        config: {\n          type: 'SelectControl',\n          label: t('Calculation type'),\n          default: 'values',\n          choices: [\n            [ComparisonType.Values, t('Actual values')],\n            [ComparisonType.Difference, t('Difference')],\n            [ComparisonType.Percentage, t('Percentage change')],\n            [ComparisonType.Ratio, t('Ratio')],\n          ],\n          description: t(\n            'How to display time shifts: as individual lines; as the ' +\n              'difference between the main time series and each time shift; ' +\n              'as the percentage change; or as the ratio between series and time shifts.',\n          ),\n        },\n      },\n    ],\n    [<ControlSubSectionHeader>{t('Resample')}</ControlSubSectionHeader>],\n    [\n      {\n        name: 'resample_rule',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          label: t('Rule'),\n          default: null,\n          choices: [\n            ['1T', t('1 minutely frequency')],\n            ['1H', t('1 hourly frequency')],\n            ['1D', t('1 calendar day frequency')],\n            ['7D', t('7 calendar day frequency')],\n            ['1MS', t('1 month start frequency')],\n            ['1M', t('1 month end frequency')],\n            ['1AS', t('1 year start frequency')],\n            ['1A', t('1 year end frequency')],\n          ],\n          description: t('Pandas resample rule'),\n        },\n      },\n    ],\n    [\n      {\n        name: 'resample_method',\n        config: {\n          type: 'SelectControl',\n          label: t('Fill method'),\n          default: null,\n          choices: [\n            ['asfreq', t('Null imputation')],\n            ['zerofill', t('Zero imputation')],\n            ['linear', t('Linear interpolation')],\n            ['ffill', t('Forward values')],\n            ['bfill', t('Backward values')],\n            ['median', t('Median values')],\n            ['mean', t('Mean values')],\n            ['sum', t('Sum values')],\n          ],\n          description: t('Pandas resample method'),\n        },\n      },\n    ],\n  ],\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport { ControlPanelSectionConfig } from '../types';\n\nexport const annotationLayers = [];\n\nexport const annotationsAndLayersControls: ControlPanelSectionConfig = {\n  label: t('Annotations and Layers'),\n  expanded: false,\n  tabOverride: 'data',\n  controlSetRows: [\n    [\n      {\n        name: 'annotation_layers',\n        config: {\n          type: 'AnnotationLayerControl',\n          label: '',\n          default: annotationLayers,\n          description: t('Annotation Layers'),\n          renderTrigger: false,\n        },\n      },\n    ],\n  ],\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  legacyValidateInteger,\n  legacyValidateNumber,\n  t,\n} from '@superset-ui/core';\nimport { ControlPanelSectionConfig } from '../types';\nimport { displayTimeRelatedControls } from '../utils';\n\nexport const FORECAST_DEFAULT_DATA = {\n  forecastEnabled: false,\n  forecastInterval: 0.8,\n  forecastPeriods: 10,\n  forecastSeasonalityDaily: null,\n  forecastSeasonalityWeekly: null,\n  forecastSeasonalityYearly: null,\n};\n\nexport const forecastIntervalControls: ControlPanelSectionConfig = {\n  label: t('Predictive Analytics'),\n  expanded: false,\n  visibility: displayTimeRelatedControls,\n  controlSetRows: [\n    [\n      {\n        name: 'forecastEnabled',\n        config: {\n          type: 'CheckboxControl',\n          label: t('Enable forecast'),\n          renderTrigger: false,\n          default: FORECAST_DEFAULT_DATA.forecastEnabled,\n          description: t('Enable forecasting'),\n        },\n      },\n    ],\n    [\n      {\n        name: 'forecastPeriods',\n        config: {\n          type: 'TextControl',\n          label: t('Forecast periods'),\n          validators: [legacyValidateInteger],\n          default: FORECAST_DEFAULT_DATA.forecastPeriods,\n          description: t(\n            'How many periods into the future do we want to predict',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: 'forecastInterval',\n        config: {\n          type: 'TextControl',\n          label: t('Confidence interval'),\n          validators: [legacyValidateNumber],\n          default: FORECAST_DEFAULT_DATA.forecastInterval,\n          description: t(\n            'Width of the confidence interval. Should be between 0 and 1',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: 'forecastSeasonalityYearly',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          label: t('Yearly seasonality'),\n          choices: [\n            [null, t('default')],\n            [true, t('Yes')],\n            [false, t('No')],\n          ],\n          default: FORECAST_DEFAULT_DATA.forecastSeasonalityYearly,\n          description: t(\n            'Should yearly seasonality be applied. An integer value will specify Fourier order of seasonality.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: 'forecastSeasonalityWeekly',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          label: t('Weekly seasonality'),\n          choices: [\n            [null, t('default')],\n            [true, t('Yes')],\n            [false, t('No')],\n          ],\n          default: FORECAST_DEFAULT_DATA.forecastSeasonalityWeekly,\n          description: t(\n            'Should weekly seasonality be applied. An integer value will specify Fourier order of seasonality.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: 'forecastSeasonalityDaily',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          label: t('Daily seasonality'),\n          choices: [\n            [null, t('default')],\n            [true, t('Yes')],\n            [false, t('No')],\n          ],\n          default: FORECAST_DEFAULT_DATA.forecastSeasonalityDaily,\n          description: t(\n            'Should daily seasonality be applied. An integer value will specify Fourier order of seasonality.',\n          ),\n        },\n      },\n    ],\n  ],\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\n\nimport { ControlSubSectionHeader } from '../components/ControlSubSectionHeader';\nimport { ControlPanelSectionConfig } from '../types';\nimport { formatSelectOptions } from '../utils';\n\nexport const TITLE_MARGIN_OPTIONS: number[] = [\n  15, 30, 50, 75, 100, 125, 150, 200,\n];\nexport const TITLE_POSITION_OPTIONS: [string, string][] = [\n  ['Left', t('Left')],\n  ['Top', t('Top')],\n];\nexport const titleControls: ControlPanelSectionConfig = {\n  label: t('Chart Title'),\n  tabOverride: 'customize',\n  expanded: true,\n  controlSetRows: [\n    [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n    [\n      {\n        name: 'x_axis_title',\n        config: {\n          type: 'TextControl',\n          label: t('X Axis Title'),\n          renderTrigger: true,\n          default: '',\n          description: t('Changing this control takes effect instantly'),\n        },\n      },\n    ],\n    [\n      {\n        name: 'x_axis_title_margin',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          clearable: true,\n          label: t('X AXIS TITLE BOTTOM MARGIN'),\n          renderTrigger: true,\n          default: TITLE_MARGIN_OPTIONS[0],\n          choices: formatSelectOptions(TITLE_MARGIN_OPTIONS),\n          description: t('Changing this control takes effect instantly'),\n        },\n      },\n    ],\n    [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n    [\n      {\n        name: 'y_axis_title',\n        config: {\n          type: 'TextControl',\n          label: t('Y Axis Title'),\n          renderTrigger: true,\n          default: '',\n          description: t('Changing this control takes effect instantly'),\n        },\n      },\n    ],\n    [\n      {\n        name: 'y_axis_title_margin',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          clearable: true,\n          label: t('Y Axis Title Margin'),\n          renderTrigger: true,\n          default: TITLE_MARGIN_OPTIONS[0],\n          choices: formatSelectOptions(TITLE_MARGIN_OPTIONS),\n          description: t('Changing this control takes effect instantly'),\n        },\n      },\n    ],\n    [\n      {\n        name: 'y_axis_title_position',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          clearable: false,\n          label: t('Y Axis Title Position'),\n          renderTrigger: true,\n          default: TITLE_POSITION_OPTIONS[0][0],\n          choices: TITLE_POSITION_OPTIONS,\n          description: t('Changing this control takes effect instantly'),\n        },\n      },\n    ],\n  ],\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ensureIsArray, GenericDataType, ValueOf } from '@superset-ui/core';\nimport {\n  ControlPanelState,\n  isDataset,\n  isQueryResponse,\n} from '@superset-ui/chart-controls';\n\nexport function checkColumnType(\n  columnName: string,\n  datasource: ValueOf<Pick<ControlPanelState, 'datasource'>>,\n  columnTypes: GenericDataType[],\n): boolean {\n  if (isDataset(datasource)) {\n    return ensureIsArray(datasource.columns).some(\n      c =>\n        c.type_generic !== undefined &&\n        columnTypes.includes(c.type_generic) &&\n        columnName === c.column_name,\n    );\n  }\n  if (isQueryResponse(datasource)) {\n    return ensureIsArray(datasource.columns)\n      .filter(\n        c =>\n          c.type_generic !== undefined && columnTypes.includes(c.type_generic),\n      )\n      .map(c => c.column_name)\n      .some(c => columnName === c);\n  }\n  return false;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport {\n  ContributionType,\n  ensureIsArray,\n  GenericDataType,\n  getColumnLabel,\n  getMetricLabel,\n  QueryFormColumn,\n  QueryFormMetric,\n  t,\n} from '@superset-ui/core';\nimport {\n  ControlPanelState,\n  ControlState,\n  ControlStateMapping,\n  isDataset,\n} from '../types';\nimport { isTemporalColumn } from '../utils';\nimport {\n  DEFAULT_XAXIS_SORT_SERIES_DATA,\n  SORT_SERIES_CHOICES,\n} from '../constants';\nimport { checkColumnType } from '../utils/checkColumnType';\n\nexport const contributionModeControl = {\n  name: 'contributionMode',\n  config: {\n    type: 'SelectControl',\n    label: t('Contribution Mode'),\n    default: null,\n    choices: [\n      [null, t('None')],\n      [ContributionType.Row, t('Row')],\n      [ContributionType.Column, t('Series')],\n    ],\n    description: t('Calculate contribution per series or row'),\n  },\n};\n\nfunction isForcedCategorical(controls: ControlStateMapping): boolean {\n  return (\n    checkColumnType(\n      getColumnLabel(controls?.x_axis?.value as QueryFormColumn),\n      controls?.datasource?.datasource,\n      [GenericDataType.Numeric],\n    ) && !!controls?.xAxisForceCategorical?.value\n  );\n}\n\nfunction isSortable(controls: ControlStateMapping): boolean {\n  return (\n    isForcedCategorical(controls) ||\n    checkColumnType(\n      getColumnLabel(controls?.x_axis?.value as QueryFormColumn),\n      controls?.datasource?.datasource,\n      [GenericDataType.String, GenericDataType.Boolean],\n    )\n  );\n}\n\nconst xAxisSortVisibility = ({ controls }: { controls: ControlStateMapping }) =>\n  isSortable(controls) &&\n  ensureIsArray(controls?.groupby?.value).length === 0 &&\n  ensureIsArray(controls?.metrics?.value).length === 1;\n\nconst xAxisMultiSortVisibility = ({\n  controls,\n}: {\n  controls: ControlStateMapping;\n}) =>\n  isSortable(controls) &&\n  (!!ensureIsArray(controls?.groupby?.value).length ||\n    ensureIsArray(controls?.metrics?.value).length > 1);\n\nexport const xAxisSortControl = {\n  name: 'x_axis_sort',\n  config: {\n    type: 'XAxisSortControl',\n    label: (state: ControlPanelState) =>\n      state.form_data?.orientation === 'horizontal'\n        ? t('Y-Axis Sort By')\n        : t('X-Axis Sort By'),\n    description: t('Decides which column to sort the base axis by.'),\n    shouldMapStateToProps: () => true,\n    mapStateToProps: (state: ControlPanelState, controlState: ControlState) => {\n      const { controls, datasource } = state;\n      const dataset = isDataset(datasource) ? datasource : undefined;\n      const columns = [controls?.x_axis?.value as QueryFormColumn].filter(\n        Boolean,\n      );\n      const metrics = [\n        ...ensureIsArray(controls?.metrics?.value as QueryFormMetric),\n        controls?.timeseries_limit_metric?.value as QueryFormMetric,\n      ].filter(Boolean);\n      const metricLabels = [...new Set(metrics.map(getMetricLabel))];\n      const options = [\n        ...columns.map(column => {\n          const value = getColumnLabel(column);\n          return {\n            value,\n            label: dataset?.verbose_map?.[value] || value,\n          };\n        }),\n        ...metricLabels.map(value => ({\n          value,\n          label: dataset?.verbose_map?.[value] || value,\n        })),\n      ];\n\n      const shouldReset = !(\n        typeof controlState.value === 'string' &&\n        options.map(option => option.value).includes(controlState.value) &&\n        !isTemporalColumn(\n          getColumnLabel(controls?.x_axis?.value as QueryFormColumn),\n          controls?.datasource?.datasource,\n        )\n      );\n\n      return {\n        shouldReset,\n        options,\n      };\n    },\n    visibility: xAxisSortVisibility,\n  },\n};\n\nexport const xAxisSortAscControl = {\n  name: 'x_axis_sort_asc',\n  config: {\n    type: 'CheckboxControl',\n    label: (state: ControlPanelState) =>\n      state.form_data?.orientation === 'horizontal'\n        ? t('Y-Axis Sort Ascending')\n        : t('X-Axis Sort Ascending'),\n    default: true,\n    description: t('Whether to sort ascending or descending on the base Axis.'),\n    visibility: ({ controls }: { controls: ControlStateMapping }) =>\n      controls?.x_axis_sort?.value !== undefined &&\n      xAxisSortVisibility({ controls }),\n  },\n};\n\nexport const xAxisForceCategoricalControl = {\n  name: 'xAxisForceCategorical',\n  config: {\n    type: 'CheckboxControl',\n    label: () => t('Force categorical'),\n    default: false,\n    description: t('Treat values as categorical.'),\n    initialValue: (control: ControlState, state: ControlPanelState | null) =>\n      state?.form_data?.x_axis_sort !== undefined || control.value,\n    renderTrigger: true,\n    visibility: ({ controls }: { controls: ControlStateMapping }) =>\n      checkColumnType(\n        getColumnLabel(controls?.x_axis?.value as QueryFormColumn),\n        controls?.datasource?.datasource,\n        [GenericDataType.Numeric],\n      ),\n    shouldMapStateToProps: () => true,\n  },\n};\n\nexport const xAxisSortSeriesControl = {\n  name: 'x_axis_sort_series',\n  config: {\n    type: 'SelectControl',\n    freeForm: false,\n    label: (state: ControlPanelState) =>\n      state.form_data?.orientation === 'horizontal'\n        ? t('Y-Axis Sort By')\n        : t('X-Axis Sort By'),\n    choices: SORT_SERIES_CHOICES,\n    default: DEFAULT_XAXIS_SORT_SERIES_DATA.sort_series_type,\n    renderTrigger: true,\n    description: t('Decides which measure to sort the base axis by.'),\n    visibility: xAxisMultiSortVisibility,\n  },\n};\n\nexport const xAxisSortSeriesAscendingControl = {\n  name: 'x_axis_sort_series_ascending',\n  config: {\n    type: 'CheckboxControl',\n    label: (state: ControlPanelState) =>\n      state.form_data?.orientation === 'horizontal'\n        ? t('Y-Axis Sort Ascending')\n        : t('X-Axis Sort Ascending'),\n    default: DEFAULT_XAXIS_SORT_SERIES_DATA.sort_series_ascending,\n    description: t('Whether to sort ascending or descending on the base Axis.'),\n    renderTrigger: true,\n    visibility: ({ controls }: { controls: ControlStateMapping }) =>\n      controls?.x_axis_sort_series?.value !== undefined &&\n      xAxisMultiSortVisibility({ controls }),\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport { ControlPanelSectionConfig, ControlSetRow } from '../types';\nimport {\n  contributionModeControl,\n  xAxisForceCategoricalControl,\n  xAxisSortAscControl,\n  xAxisSortControl,\n  xAxisSortSeriesAscendingControl,\n  xAxisSortSeriesControl,\n} from '../shared-controls';\n\nconst controlsWithoutXAxis: ControlSetRow[] = [\n  ['metrics'],\n  ['groupby'],\n  [contributionModeControl],\n  ['adhoc_filters'],\n  ['limit'],\n  ['timeseries_limit_metric'],\n  ['order_desc'],\n  ['row_limit'],\n  ['truncate_metric'],\n  ['show_empty_columns'],\n];\n\nexport const echartsTimeSeriesQuery: ControlPanelSectionConfig = {\n  label: t('Query'),\n  expanded: true,\n  controlSetRows: [['x_axis'], ['time_grain_sqla'], ...controlsWithoutXAxis],\n};\n\nexport const echartsTimeSeriesQueryWithXAxisSort: ControlPanelSectionConfig = {\n  label: t('Query'),\n  expanded: true,\n  controlSetRows: [\n    ['x_axis'],\n    ['time_grain_sqla'],\n    [xAxisForceCategoricalControl],\n    [xAxisSortControl],\n    [xAxisSortAscControl],\n    [xAxisSortSeriesControl],\n    [xAxisSortSeriesAscendingControl],\n    ...controlsWithoutXAxis,\n  ],\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Metric } from '../types';\n\nexport default function mainMetric(savedMetrics?: Metric[] | null) {\n  // Using 'count' as default metric if it exists, otherwise using whatever one shows up first\n  let metric;\n  if (savedMetrics && savedMetrics.length > 0) {\n    savedMetrics.forEach(m => {\n      if (m.metric_name === 'count') {\n        metric = 'count';\n      }\n    });\n    if (!metric) {\n      metric = savedMetrics[0].metric_name;\n    }\n  }\n  return metric;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { DatasourceType, GenericDataType } from '@superset-ui/core';\nimport { Dataset } from './types';\n\nexport const TestDataset: Dataset = {\n  column_formats: {},\n  currency_formats: {},\n  columns: [\n    {\n      advanced_data_type: undefined,\n      certification_details: null,\n      certified_by: null,\n      column_name: 'num',\n      description: null,\n      expression: '',\n      filterable: true,\n      groupby: true,\n      id: 332,\n      is_certified: false,\n      is_dttm: false,\n      python_date_format: null,\n      type: 'BIGINT',\n      type_generic: GenericDataType.Numeric,\n      verbose_name: null,\n      warning_markdown: null,\n    },\n    {\n      advanced_data_type: undefined,\n      certification_details: null,\n      certified_by: null,\n      column_name: 'gender',\n      description: null,\n      expression: '',\n      filterable: true,\n      groupby: true,\n      id: 330,\n      is_certified: false,\n      is_dttm: false,\n      python_date_format: null,\n      type: 'VARCHAR(16)',\n      type_generic: GenericDataType.String,\n      verbose_name: '',\n      warning_markdown: null,\n    },\n    {\n      advanced_data_type: undefined,\n      certification_details: null,\n      certified_by: null,\n      column_name: 'state',\n      description: null,\n      expression: '',\n      filterable: true,\n      groupby: true,\n      id: 333,\n      is_certified: false,\n      is_dttm: false,\n      python_date_format: null,\n      type: 'VARCHAR(10)',\n      type_generic: GenericDataType.String,\n      verbose_name: null,\n      warning_markdown: null,\n    },\n    {\n      advanced_data_type: undefined,\n      certification_details: null,\n      certified_by: null,\n      column_name: 'ds',\n      description: null,\n      expression: '',\n      filterable: true,\n      groupby: true,\n      id: 329,\n      is_certified: false,\n      is_dttm: true,\n      python_date_format: null,\n      type: 'TIMESTAMP WITHOUT TIME ZONE',\n      type_generic: GenericDataType.Temporal,\n      verbose_name: null,\n      warning_markdown: null,\n    },\n    {\n      advanced_data_type: undefined,\n      certification_details: null,\n      certified_by: null,\n      column_name: 'name',\n      description: null,\n      expression: '',\n      filterable: true,\n      groupby: true,\n      id: 331,\n      is_certified: false,\n      is_dttm: false,\n      python_date_format: null,\n      type: 'VARCHAR(255)',\n      type_generic: GenericDataType.String,\n      verbose_name: null,\n      warning_markdown: null,\n    },\n  ],\n  datasource_name: 'birth_names',\n  description: null,\n  granularity_sqla: 'ds',\n  id: 2,\n  main_dttm_col: 'ds',\n  metrics: [\n    {\n      certification_details: null,\n      certified_by: null,\n      d3format: null,\n      currency: null,\n      description: null,\n      expression: 'COUNT(*)',\n      id: 7,\n      is_certified: false,\n      metric_name: 'count',\n      verbose_name: 'COUNT(*)',\n      warning_markdown: '',\n      warning_text: null,\n    },\n  ],\n  name: 'public.birth_names',\n  order_by_choices: [],\n  owners: [\n    {\n      first_name: 'admin',\n      id: 1,\n      last_name: 'user',\n      username: 'admin',\n    },\n  ],\n  type: DatasourceType.Dataset,\n  uid: '2__table',\n  verbose_map: {},\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport * as sectionsModule from './sections';\n\nexport * from './utils';\nexport * from './constants';\nexport * from './operators';\n\n// can't do `export * as sections from './sections'`, babel-transformer will fail\nexport const sections = sectionsModule;\n\nexport * from './components/InfoTooltipWithTrigger';\nexport * from './components/ColumnOption';\nexport * from './components/ColumnTypeLabel/ColumnTypeLabel';\nexport * from './components/MetricOption';\nexport * from './components/ControlSubSectionHeader';\nexport * from './components/Tooltip';\n\nexport * from './shared-controls';\nexport * from './types';\nexport * from './fixtures';\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport {\n  ensureIsArray,\n  getColumnLabel,\n  getMetricLabel,\n  PostProcessingBoxplot,\n  BoxPlotQueryObjectWhiskerType,\n} from '@superset-ui/core';\nimport { PostProcessingFactory } from './types';\n\nconst PERCENTILE_REGEX = /(\\d+)\\/(\\d+) percentiles/;\n\nexport const boxplotOperator: PostProcessingFactory<PostProcessingBoxplot> = (\n  formData,\n  queryObject,\n) => {\n  const { groupby, whiskerOptions } = formData;\n\n  if (whiskerOptions) {\n    let whiskerType: BoxPlotQueryObjectWhiskerType;\n    let percentiles: [number, number] | undefined;\n    const percentileMatch = PERCENTILE_REGEX.exec(whiskerOptions as string);\n\n    if (whiskerOptions === 'Tukey' || !whiskerOptions) {\n      whiskerType = 'tukey';\n    } else if (whiskerOptions === 'Min/max (no outliers)') {\n      whiskerType = 'min/max';\n    } else if (percentileMatch) {\n      whiskerType = 'percentile';\n      percentiles = [\n        parseInt(percentileMatch[1], 10),\n        parseInt(percentileMatch[2], 10),\n      ];\n    } else {\n      throw new Error(`Unsupported whisker type: ${whiskerOptions}`);\n    }\n\n    return {\n      operation: 'boxplot',\n      options: {\n        whisker_type: whiskerType,\n        percentiles,\n        groupby: ensureIsArray(groupby).map(getColumnLabel),\n        metrics: ensureIsArray(queryObject.metrics).map(getMetricLabel),\n      },\n    };\n  }\n  return undefined;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { PostProcessingContribution } from '@superset-ui/core';\nimport { PostProcessingFactory } from './types';\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nexport const contributionOperator: PostProcessingFactory<\n  PostProcessingContribution\n> = (formData, queryObject, time_shifts) => {\n  if (formData.contributionMode) {\n    return {\n      operation: 'contribution',\n      options: {\n        orientation: formData.contributionMode,\n        time_shifts,\n      },\n    };\n  }\n  return undefined;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { PostProcessingFlatten } from '@superset-ui/core';\nimport { PostProcessingFactory } from './types';\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nexport const flattenOperator: PostProcessingFactory<PostProcessingFlatten> = (\n  formData,\n  queryObject,\n) => ({\n  operation: 'flatten',\n});\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport {\n  ensureIsArray,\n  getColumnLabel,\n  getMetricLabel,\n  PostProcessingPivot,\n  getXAxisLabel,\n} from '@superset-ui/core';\nimport { PostProcessingFactory } from './types';\nimport { extractExtraMetrics } from './utils';\n\nexport const pivotOperator: PostProcessingFactory<PostProcessingPivot> = (\n  formData,\n  queryObject,\n) => {\n  const metricLabels = [\n    ...ensureIsArray(queryObject.metrics),\n    ...extractExtraMetrics(formData),\n  ].map(getMetricLabel);\n  const xAxisLabel = getXAxisLabel(formData);\n  const columns = queryObject.series_columns || queryObject.columns;\n\n  if (xAxisLabel && metricLabels.length) {\n    return {\n      operation: 'pivot',\n      options: {\n        index: [xAxisLabel],\n        columns: ensureIsArray(columns).map(getColumnLabel),\n        // Create 'dummy' mean aggregates to assign cell values in pivot table\n        // use the 'mean' aggregates to avoid drop NaN. PR: https://github.com/apache-superset/superset-ui/pull/1231\n        aggregates: Object.fromEntries(\n          metricLabels.map(metric => [metric, { operator: 'mean' }]),\n        ),\n        drop_missing_columns: !formData?.show_empty_columns,\n      },\n    };\n  }\n\n  return undefined;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { PostProcessingProphet, getXAxisLabel } from '@superset-ui/core';\nimport { PostProcessingFactory } from './types';\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nexport const prophetOperator: PostProcessingFactory<PostProcessingProphet> = (\n  formData,\n  queryObject,\n) => {\n  const xAxisLabel = getXAxisLabel(formData);\n  if (formData.forecastEnabled && xAxisLabel) {\n    return {\n      operation: 'prophet',\n      options: {\n        time_grain: formData.time_grain_sqla,\n        periods: parseInt(formData.forecastPeriods, 10),\n        confidence_interval: parseFloat(formData.forecastInterval),\n        yearly_seasonality: formData.forecastSeasonalityYearly,\n        weekly_seasonality: formData.forecastSeasonalityWeekly,\n        daily_seasonality: formData.forecastSeasonalityDaily,\n        index: xAxisLabel,\n      },\n    };\n  }\n  return undefined;\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport {\n  PostProcessingRename,\n  ensureIsArray,\n  getMetricLabel,\n  ComparisonType,\n  getXAxisLabel,\n} from '@superset-ui/core';\nimport { PostProcessingFactory } from './types';\nimport { getMetricOffsetsMap, isTimeComparison } from './utils';\n\nexport const renameOperator: PostProcessingFactory<PostProcessingRename> = (\n  formData,\n  queryObject,\n) => {\n  const metrics = ensureIsArray(queryObject.metrics);\n  const columns = ensureIsArray(\n    queryObject.series_columns || queryObject.columns,\n  );\n  const { truncate_metric } = formData;\n  const xAxisLabel = getXAxisLabel(formData);\n  // remove or rename top level of column name(metric name) in the MultiIndex when\n  // 1) only 1 metric\n  // 2) dimension exist\n  // 3) xAxis exist\n  // 4) time comparison exist, and comparison type is \"actual values\"\n  // 5) truncate_metric in form_data and truncate_metric is true\n  if (\n    metrics.length === 1 &&\n    columns.length > 0 &&\n    xAxisLabel &&\n    !(\n      // todo: we should provide an approach to handle derived metrics\n      (\n        isTimeComparison(formData, queryObject) &&\n        [\n          ComparisonType.Difference,\n          ComparisonType.Ratio,\n          ComparisonType.Percentage,\n        ].includes(formData.comparison_type)\n      )\n    ) &&\n    truncate_metric !== undefined &&\n    !!truncate_metric\n  ) {\n    const renamePairs: [string, string | null][] = [];\n\n    if (\n      // \"actual values\" will add derived metric.\n      // we will rename the \"metric\" from the metricWithOffset label\n      // for example: \"count__1 year ago\" =>\t\"1 year ago\"\n      isTimeComparison(formData, queryObject) &&\n      formData.comparison_type === ComparisonType.Values\n    ) {\n      const metricOffsetMap = getMetricOffsetsMap(formData, queryObject);\n      const timeOffsets = ensureIsArray(formData.time_compare);\n      [...metricOffsetMap.keys()].forEach(metricWithOffset => {\n        const offsetLabel = timeOffsets.find(offset =>\n          metricWithOffset.includes(offset),\n        );\n        renamePairs.push([metricWithOffset, offsetLabel]);\n      });\n    }\n\n    renamePairs.push([getMetricLabel(metrics[0]), null]);\n\n    return {\n      operation: 'rename',\n      options: {\n        columns: Object.fromEntries(renamePairs),\n        level: 0,\n        inplace: true,\n      },\n    };\n  }\n\n  return undefined;\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { PostProcessingResample } from '@superset-ui/core';\nimport { PostProcessingFactory } from './types';\n\n/* eslint-disable @typescript-eslint/no-unused-vars */\nexport const resampleOperator: PostProcessingFactory<PostProcessingResample> = (\n  formData,\n  queryObject,\n) => {\n  const resampleZeroFill = formData.resample_method === 'zerofill';\n  const resampleMethod = resampleZeroFill ? 'asfreq' : formData.resample_method;\n  const resampleRule = formData.resample_rule;\n  if (resampleMethod && resampleRule) {\n    return {\n      operation: 'resample',\n      options: {\n        method: resampleMethod,\n        rule: resampleRule,\n        fill_value: resampleZeroFill ? 0 : null,\n      },\n    };\n  }\n  return undefined;\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport {\n  ensureIsArray,\n  ensureIsInt,\n  PostProcessingCum,\n  PostProcessingRolling,\n  RollingType,\n} from '@superset-ui/core';\nimport { getMetricOffsetsMap, isTimeComparison } from './utils';\nimport { PostProcessingFactory } from './types';\n\nexport const rollingWindowOperator: PostProcessingFactory<\n  PostProcessingRolling | PostProcessingCum\n> = (formData, queryObject) => {\n  let columns: (string | undefined)[];\n  if (isTimeComparison(formData, queryObject)) {\n    const metricsMap = getMetricOffsetsMap(formData, queryObject);\n    columns = [\n      ...Array.from(metricsMap.values()),\n      ...Array.from(metricsMap.keys()),\n    ];\n  } else {\n    columns = ensureIsArray(queryObject.metrics).map(metric => {\n      if (typeof metric === 'string') {\n        return metric;\n      }\n      return metric.label;\n    });\n  }\n  const columnsMap = Object.fromEntries(columns.map(col => [col, col]));\n\n  if (formData.rolling_type === RollingType.Cumsum) {\n    return {\n      operation: 'cum',\n      options: {\n        operator: 'sum',\n        columns: columnsMap,\n      },\n    };\n  }\n\n  if (\n    [RollingType.Sum, RollingType.Mean, RollingType.Std].includes(\n      formData.rolling_type,\n    )\n  ) {\n    return {\n      operation: 'rolling',\n      options: {\n        rolling_type: formData.rolling_type,\n        window: ensureIsInt(formData.rolling_periods, 1),\n        min_periods: ensureIsInt(formData.min_periods, 0),\n        columns: columnsMap,\n      },\n    };\n  }\n\n  return undefined;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { isEmpty } from 'lodash';\nimport {\n  ensureIsArray,\n  getMetricLabel,\n  getXAxisLabel,\n  isDefined,\n  PostProcessingSort,\n} from '@superset-ui/core';\nimport { PostProcessingFactory } from './types';\nimport { extractExtraMetrics } from './utils';\n\nexport const sortOperator: PostProcessingFactory<PostProcessingSort> = (\n  formData,\n  queryObject,\n) => {\n  // the sortOperator only used in the barchart v2\n  const sortableLabels = [\n    getXAxisLabel(formData),\n    ...ensureIsArray(formData.metrics).map(getMetricLabel),\n    ...extractExtraMetrics(formData).map(getMetricLabel),\n  ].filter(Boolean);\n\n  if (\n    isDefined(formData?.x_axis_sort) &&\n    isDefined(formData?.x_axis_sort_asc) &&\n    sortableLabels.includes(formData.x_axis_sort) &&\n    // the sort operator doesn't support sort-by multiple series.\n    isEmpty(formData.groupby)\n  ) {\n    if (formData.x_axis_sort === getXAxisLabel(formData)) {\n      return {\n        operation: 'sort',\n        options: {\n          is_sort_index: true,\n          ascending: formData.x_axis_sort_asc,\n        },\n      };\n    }\n\n    return {\n      operation: 'sort',\n      options: {\n        by: formData.x_axis_sort,\n        ascending: formData.x_axis_sort_asc,\n      },\n    };\n  }\n  return undefined;\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { ComparisonType, PostProcessingCompare } from '@superset-ui/core';\nimport { getMetricOffsetsMap, isTimeComparison } from './utils';\nimport { PostProcessingFactory } from './types';\n\nexport const timeCompareOperator: PostProcessingFactory<\n  PostProcessingCompare\n> = (formData, queryObject) => {\n  const comparisonType = formData.comparison_type;\n  const metricOffsetMap = getMetricOffsetsMap(formData, queryObject);\n\n  if (\n    isTimeComparison(formData, queryObject) &&\n    comparisonType !== ComparisonType.Values\n  ) {\n    return {\n      operation: 'compare',\n      options: {\n        source_columns: Array.from(metricOffsetMap.values()),\n        compare_columns: Array.from(metricOffsetMap.keys()),\n        compare_type: comparisonType,\n        drop_original_columns: true,\n      },\n    };\n  }\n\n  return undefined;\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport {\n  ensureIsArray,\n  getColumnLabel,\n  NumpyFunction,\n  PostProcessingPivot,\n  getXAxisLabel,\n} from '@superset-ui/core';\nimport { getMetricOffsetsMap, isTimeComparison } from './utils';\nimport { PostProcessingFactory } from './types';\n\nexport const timeComparePivotOperator: PostProcessingFactory<\n  PostProcessingPivot\n> = (formData, queryObject) => {\n  const metricOffsetMap = getMetricOffsetsMap(formData, queryObject);\n  const xAxisLabel = getXAxisLabel(formData);\n  const columns = queryObject.series_columns || queryObject.columns;\n\n  if (isTimeComparison(formData, queryObject) && xAxisLabel) {\n    const aggregates = Object.fromEntries(\n      [...metricOffsetMap.values(), ...metricOffsetMap.keys()].map(metric => [\n        metric,\n        // use the 'mean' aggregates to avoid drop NaN\n        { operator: 'mean' as NumpyFunction },\n      ]),\n    );\n\n    return {\n      operation: 'pivot',\n      options: {\n        index: [xAxisLabel],\n        columns: ensureIsArray(columns).map(getColumnLabel),\n        drop_missing_columns: !formData?.show_empty_columns,\n        aggregates,\n      },\n    };\n  }\n\n  return undefined;\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nexport const TIME_COMPARISON_SEPARATOR = '__';\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ensureIsArray,\n  getMetricLabel,\n  QueryFormData,\n  QueryFormMetric,\n} from '@superset-ui/core';\n\nexport function extractExtraMetrics(\n  formData: QueryFormData,\n): QueryFormMetric[] {\n  const { groupby, timeseries_limit_metric, x_axis_sort, metrics } = formData;\n  const extra_metrics: QueryFormMetric[] = [];\n  const limitMetric = ensureIsArray(timeseries_limit_metric)[0];\n  if (\n    !(groupby || []).length &&\n    limitMetric &&\n    getMetricLabel(limitMetric) === x_axis_sort &&\n    !metrics?.some(metric => getMetricLabel(metric) === x_axis_sort)\n  ) {\n    extra_metrics.push(limitMetric);\n  }\n  return extra_metrics;\n}\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { getMetricLabel, ensureIsArray } from '@superset-ui/core';\nimport { PostProcessingFactory } from '../types';\nimport { TIME_COMPARISON_SEPARATOR } from './constants';\n\nexport const getMetricOffsetsMap: PostProcessingFactory<Map<string, string>> = (\n  formData,\n  queryObject,\n) => {\n  /*\n    return metric offset-label and metric-label hashmap, for instance:\n    {\n      \"SUM(value)__1 year ago\": \"SUM(value)\",\n      \"SUM(value)__2 year ago\": \"SUM(value)\"\n    }\n  */\n  const queryMetrics = ensureIsArray(queryObject.metrics);\n  const timeOffsets = ensureIsArray(formData.time_compare);\n\n  const metricLabels = queryMetrics.map(getMetricLabel);\n  const metricOffsetMap = new Map<string, string>();\n  metricLabels.forEach((metric: string) => {\n    timeOffsets.forEach((offset: string) => {\n      metricOffsetMap.set(\n        [metric, offset].join(TIME_COMPARISON_SEPARATOR),\n        metric,\n      );\n    });\n  });\n\n  return metricOffsetMap;\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport {\n  ensureIsArray,\n  JsonObject,\n  QueryFormData,\n  ComparisonType,\n} from '@superset-ui/core';\nimport { hasTimeOffset } from './timeOffset';\n\nexport const isDerivedSeries = (\n  series: JsonObject,\n  formData: QueryFormData,\n): boolean => {\n  const comparisonType = formData.comparison_type;\n  if (comparisonType !== ComparisonType.Values) {\n    return false;\n  }\n  const timeCompare: string[] = ensureIsArray(formData?.time_compare);\n  return hasTimeOffset(series, timeCompare);\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { ComparisonType } from '@superset-ui/core';\nimport { getMetricOffsetsMap } from './getMetricOffsetsMap';\nimport { PostProcessingFactory } from '../types';\n\nexport const isTimeComparison: PostProcessingFactory<boolean> = (\n  formData,\n  queryObject,\n) => {\n  const comparisonType = formData.comparison_type;\n  const metricOffsetMap = getMetricOffsetsMap(formData, queryObject);\n\n  return (\n    Object.values(ComparisonType).includes(comparisonType) &&\n    metricOffsetMap.size > 0\n  );\n};\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitationsxw\n * under the License.\n */\nimport { JsonObject } from '@superset-ui/core';\nimport { isString } from 'lodash';\n\nexport const getTimeOffset = (\n  series: JsonObject,\n  timeCompare: string[],\n): string | undefined =>\n  timeCompare.find(\n    timeOffset =>\n      // offset is represented as <offset>, group by list\n      series.name.includes(`${timeOffset},`) ||\n      // offset is represented as <metric>__<offset>\n      series.name.includes(`__${timeOffset}`),\n  );\n\nexport const hasTimeOffset = (\n  series: JsonObject,\n  timeCompare: string[],\n): boolean =>\n  isString(series.name) ? !!getTimeOffset(series, timeCompare) : false;\n\nexport const getOriginalSeries = (\n  seriesName: string,\n  timeCompare: string[],\n): string => {\n  let result = seriesName;\n  timeCompare.forEach(compare => {\n    // offset is represented as <offset>, group by list\n    result = result.replace(`${compare},`, '');\n    // offset is represented as <metric>__<offset>\n    result = result.replace(`__${compare}`, '');\n  });\n  return result.trim();\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { QueryResponse } from '@superset-ui/core';\nimport { Dataset, isDataset, isQueryResponse } from '../types';\n\n/**\n * Convert Datasource columns to column choices\n */\nexport default function columnChoices(\n  datasource?: Dataset | QueryResponse | null,\n): [string, string][] {\n  if (isDataset(datasource) || isQueryResponse(datasource)) {\n    return datasource.columns\n      .map((col): [string, string] => [\n        col.column_name,\n        'verbose_name' in col\n          ? col.verbose_name || col.column_name\n          : col.column_name,\n      ])\n      .sort((opt1, opt2) =>\n        opt1[1].toLowerCase() > opt2[1].toLowerCase() ? 1 : -1,\n      );\n  }\n  return [];\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport memoizeOne from 'memoize-one';\nimport { addAlpha, DataRecord } from '@superset-ui/core';\nimport {\n  ColorFormatters,\n  Comparator,\n  ConditionalFormattingConfig,\n  MultipleValueComparators,\n} from '../types';\n\nexport const round = (num: number, precision = 0) =>\n  Number(`${Math.round(Number(`${num}e+${precision}`))}e-${precision}`);\n\nconst MIN_OPACITY_BOUNDED = 0.05;\nconst MIN_OPACITY_UNBOUNDED = 0;\nconst MAX_OPACITY = 1;\nexport const getOpacity = (\n  value: number,\n  cutoffPoint: number,\n  extremeValue: number,\n  minOpacity = MIN_OPACITY_BOUNDED,\n  maxOpacity = MAX_OPACITY,\n) => {\n  if (extremeValue === cutoffPoint) {\n    return maxOpacity;\n  }\n  return Math.min(\n    maxOpacity,\n    round(\n      Math.abs(\n        ((maxOpacity - minOpacity) / (extremeValue - cutoffPoint)) *\n          (value - cutoffPoint),\n      ) + minOpacity,\n      2,\n    ),\n  );\n};\n\nexport const getColorFunction = (\n  {\n    operator,\n    targetValue,\n    targetValueLeft,\n    targetValueRight,\n    colorScheme,\n  }: ConditionalFormattingConfig,\n  columnValues: number[],\n  alpha?: boolean,\n) => {\n  let minOpacity = MIN_OPACITY_BOUNDED;\n  const maxOpacity = MAX_OPACITY;\n\n  let comparatorFunction: (\n    value: number,\n    allValues: number[],\n  ) => false | { cutoffValue: number; extremeValue: number };\n  if (operator === undefined || colorScheme === undefined) {\n    return () => undefined;\n  }\n  if (\n    MultipleValueComparators.includes(operator) &&\n    (targetValueLeft === undefined || targetValueRight === undefined)\n  ) {\n    return () => undefined;\n  }\n  if (\n    operator !== Comparator.None &&\n    !MultipleValueComparators.includes(operator) &&\n    targetValue === undefined\n  ) {\n    return () => undefined;\n  }\n  switch (operator) {\n    case Comparator.None:\n      minOpacity = MIN_OPACITY_UNBOUNDED;\n      comparatorFunction = (value: number, allValues: number[]) => {\n        const cutoffValue = Math.min(...allValues);\n        const extremeValue = Math.max(...allValues);\n        return value >= cutoffValue && value <= extremeValue\n          ? { cutoffValue, extremeValue }\n          : false;\n      };\n      break;\n    case Comparator.GreaterThan:\n      comparatorFunction = (value: number, allValues: number[]) =>\n        value > targetValue!\n          ? { cutoffValue: targetValue!, extremeValue: Math.max(...allValues) }\n          : false;\n      break;\n    case Comparator.LessThan:\n      comparatorFunction = (value: number, allValues: number[]) =>\n        value < targetValue!\n          ? { cutoffValue: targetValue!, extremeValue: Math.min(...allValues) }\n          : false;\n      break;\n    case Comparator.GreaterOrEqual:\n      comparatorFunction = (value: number, allValues: number[]) =>\n        value >= targetValue!\n          ? { cutoffValue: targetValue!, extremeValue: Math.max(...allValues) }\n          : false;\n      break;\n    case Comparator.LessOrEqual:\n      comparatorFunction = (value: number, allValues: number[]) =>\n        value <= targetValue!\n          ? { cutoffValue: targetValue!, extremeValue: Math.min(...allValues) }\n          : false;\n      break;\n    case Comparator.Equal:\n      comparatorFunction = (value: number) =>\n        value === targetValue!\n          ? { cutoffValue: targetValue!, extremeValue: targetValue! }\n          : false;\n      break;\n    case Comparator.NotEqual:\n      comparatorFunction = (value: number, allValues: number[]) => {\n        if (value === targetValue!) {\n          return false;\n        }\n        const max = Math.max(...allValues);\n        const min = Math.min(...allValues);\n        return {\n          cutoffValue: targetValue!,\n          extremeValue:\n            Math.abs(targetValue! - min) > Math.abs(max - targetValue!)\n              ? min\n              : max,\n        };\n      };\n      break;\n    case Comparator.Between:\n      comparatorFunction = (value: number) =>\n        value > targetValueLeft! && value < targetValueRight!\n          ? { cutoffValue: targetValueLeft!, extremeValue: targetValueRight! }\n          : false;\n      break;\n    case Comparator.BetweenOrEqual:\n      comparatorFunction = (value: number) =>\n        value >= targetValueLeft! && value <= targetValueRight!\n          ? { cutoffValue: targetValueLeft!, extremeValue: targetValueRight! }\n          : false;\n      break;\n    case Comparator.BetweenOrLeftEqual:\n      comparatorFunction = (value: number) =>\n        value >= targetValueLeft! && value < targetValueRight!\n          ? { cutoffValue: targetValueLeft!, extremeValue: targetValueRight! }\n          : false;\n      break;\n    case Comparator.BetweenOrRightEqual:\n      comparatorFunction = (value: number) =>\n        value > targetValueLeft! && value <= targetValueRight!\n          ? { cutoffValue: targetValueLeft!, extremeValue: targetValueRight! }\n          : false;\n      break;\n    default:\n      comparatorFunction = () => false;\n      break;\n  }\n\n  return (value: number) => {\n    const compareResult = comparatorFunction(value, columnValues);\n    if (compareResult === false) return undefined;\n    const { cutoffValue, extremeValue } = compareResult;\n    if (alpha === undefined || alpha) {\n      return addAlpha(\n        colorScheme,\n        getOpacity(value, cutoffValue, extremeValue, minOpacity, maxOpacity),\n      );\n    }\n    return colorScheme;\n  };\n};\n\nexport const getColorFormatters = memoizeOne(\n  (\n    columnConfig: ConditionalFormattingConfig[] | undefined,\n    data: DataRecord[],\n    alpha?: boolean,\n  ) =>\n    columnConfig?.reduce(\n      (acc: ColorFormatters, config: ConditionalFormattingConfig) => {\n        if (\n          config?.column !== undefined &&\n          (config?.operator === Comparator.None ||\n            (config?.operator !== undefined &&\n              (MultipleValueComparators.includes(config?.operator)\n                ? config?.targetValueLeft !== undefined &&\n                  config?.targetValueRight !== undefined\n                : config?.targetValue !== undefined)))\n        ) {\n          acc.push({\n            column: config?.column,\n            getColorFromValue: getColorFunction(\n              config,\n              data.map(row => row[config.column!] as number),\n              alpha,\n            ),\n          });\n        }\n        return acc;\n      },\n      [],\n    ) ?? [],\n);\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Behavior, ChartLabel } from '../types/Base';\nimport { ParseMethod } from '../../connection';\n\ninterface LookupTable {\n  [key: string]: boolean;\n}\n\nexport interface ExampleImage {\n  url: string;\n  caption?: string;\n}\n\nexport interface ChartMetadataConfig {\n  name: string;\n  canBeAnnotationTypes?: string[];\n  credits?: string[];\n  description?: string;\n  datasourceCount?: number;\n  enableNoResults?: boolean;\n  supportedAnnotationTypes?: string[];\n  thumbnail: string;\n  useLegacyApi?: boolean;\n  behaviors?: Behavior[];\n  exampleGallery?: ExampleImage[];\n  tags?: string[];\n  category?: string | null;\n  // deprecated: true hides a chart from all viz picker interactions.\n  deprecated?: boolean;\n  // label: ChartLabel.DEPRECATED which will display a \"deprecated\" label on the chart.\n  label?: ChartLabel | null;\n  labelExplanation?: string | null;\n  queryObjectCount?: number;\n  parseMethod?: ParseMethod;\n}\n\nexport default class ChartMetadata {\n  name: string;\n\n  canBeAnnotationTypes?: string[];\n\n  canBeAnnotationTypesLookup: LookupTable;\n\n  credits: string[];\n\n  description: string;\n\n  supportedAnnotationTypes: string[];\n\n  thumbnail: string;\n\n  useLegacyApi: boolean;\n\n  behaviors: Behavior[];\n\n  datasourceCount: number;\n\n  enableNoResults: boolean;\n\n  exampleGallery: ExampleImage[];\n\n  tags: string[];\n\n  category: string | null;\n\n  deprecated?: boolean;\n\n  label?: ChartLabel | null;\n\n  labelExplanation?: string | null;\n\n  queryObjectCount: number;\n\n  parseMethod: ParseMethod;\n\n  constructor(config: ChartMetadataConfig) {\n    const {\n      name,\n      canBeAnnotationTypes = [],\n      credits = [],\n      description = '',\n      supportedAnnotationTypes = [],\n      thumbnail,\n      useLegacyApi = false,\n      behaviors = [],\n      datasourceCount = 1,\n      enableNoResults = true,\n      exampleGallery = [],\n      tags = [],\n      category = null,\n      deprecated = false,\n      label = null,\n      labelExplanation = null,\n      queryObjectCount = 1,\n      parseMethod = 'json-bigint',\n    } = config;\n\n    this.name = name;\n    this.credits = credits;\n    this.description = description;\n    this.canBeAnnotationTypes = canBeAnnotationTypes;\n    this.canBeAnnotationTypesLookup = canBeAnnotationTypes.reduce(\n      (prev: LookupTable, type: string) => {\n        const lookup = prev;\n        lookup[type] = true;\n\n        return lookup;\n      },\n      {},\n    );\n    this.supportedAnnotationTypes = supportedAnnotationTypes;\n    this.thumbnail = thumbnail;\n    this.useLegacyApi = useLegacyApi;\n    this.behaviors = behaviors;\n    this.datasourceCount = datasourceCount;\n    this.enableNoResults = enableNoResults;\n    this.exampleGallery = exampleGallery;\n    this.tags = tags;\n    this.category = category;\n    this.deprecated = deprecated;\n    this.label = label;\n    this.labelExplanation = labelExplanation;\n    this.queryObjectCount = queryObjectCount;\n    this.parseMethod = parseMethod;\n  }\n\n  canBeAnnotationType(type: string): boolean {\n    return this.canBeAnnotationTypesLookup[type] || false;\n  }\n\n  clone() {\n    return new ChartMetadata(this);\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { ComponentType } from 'react';\nimport { isRequired, Plugin, QueryFormData } from '../..';\nimport ChartMetadata from './ChartMetadata';\nimport getChartMetadataRegistry from '../registries/ChartMetadataRegistrySingleton';\nimport getChartBuildQueryRegistry from '../registries/ChartBuildQueryRegistrySingleton';\nimport getChartComponentRegistry from '../registries/ChartComponentRegistrySingleton';\nimport getChartControlPanelRegistry from '../registries/ChartControlPanelRegistrySingleton';\nimport getChartTransformPropsRegistry from '../registries/ChartTransformPropsRegistrySingleton';\nimport { BuildQueryFunction, TransformProps } from '../types/TransformFunction';\nimport { ChartControlPanel } from './ChartControlPanel';\nimport { ChartProps } from '..';\n\nfunction IDENTITY<T>(x: T) {\n  return x;\n}\n\nconst EMPTY = {};\n\nexport type PromiseOrValue<T> = Promise<T> | T;\nexport type PromiseOrValueLoader<T> = () => PromiseOrValue<T>;\nexport type ChartType = ComponentType<any>;\ntype ValueOrModuleWithValue<T> = T | { default: T };\n\ninterface ChartPluginConfig<\n  FormData extends QueryFormData = QueryFormData,\n  Props extends ChartProps = ChartProps,\n> {\n  metadata: ChartMetadata;\n  /** Use buildQuery for immediate value. For lazy-loading, use loadBuildQuery. */\n  buildQuery?: BuildQueryFunction<FormData>;\n  /** Use loadBuildQuery for dynamic import (lazy-loading) */\n  loadBuildQuery?: PromiseOrValueLoader<\n    ValueOrModuleWithValue<BuildQueryFunction<FormData>>\n  >;\n  /** Use transformProps for immediate value. For lazy-loading, use loadTransformProps.  */\n  transformProps?: TransformProps<Props>;\n  /** Use loadTransformProps for dynamic import (lazy-loading) */\n  loadTransformProps?: PromiseOrValueLoader<\n    ValueOrModuleWithValue<TransformProps<Props>>\n  >;\n  /** Use Chart for immediate value. For lazy-loading, use loadChart. */\n  Chart?: ChartType;\n  /** Use loadChart for dynamic import (lazy-loading) */\n  loadChart?: PromiseOrValueLoader<ValueOrModuleWithValue<ChartType>>;\n  /** Control panel configuration object */\n  controlPanel?: ChartControlPanel;\n}\n\n/**\n * Loaders of the form `() => import('foo')` may return esmodules\n * which require the value to be extracted as `module.default`\n * */\nfunction sanitizeLoader<T extends object>(\n  loader: PromiseOrValueLoader<ValueOrModuleWithValue<T>>,\n): PromiseOrValueLoader<T> {\n  return () => {\n    const loaded = loader();\n\n    return loaded instanceof Promise\n      ? (loaded.then(\n          module => ('default' in module && module.default) || module,\n        ) as Promise<T>)\n      : (loaded as T);\n  };\n}\n\nexport default class ChartPlugin<\n  FormData extends QueryFormData = QueryFormData,\n  Props extends ChartProps = ChartProps,\n> extends Plugin {\n  controlPanel: ChartControlPanel;\n\n  metadata: ChartMetadata;\n\n  loadBuildQuery?: PromiseOrValueLoader<BuildQueryFunction<FormData>>;\n\n  loadTransformProps: PromiseOrValueLoader<TransformProps<Props>>;\n\n  loadChart: PromiseOrValueLoader<ChartType>;\n\n  constructor(config: ChartPluginConfig<FormData, Props>) {\n    super();\n    const {\n      metadata,\n      buildQuery,\n      loadBuildQuery,\n      transformProps = IDENTITY,\n      loadTransformProps,\n      Chart,\n      loadChart,\n      controlPanel = EMPTY,\n    } = config;\n    this.controlPanel = controlPanel;\n    this.metadata = metadata;\n    this.loadBuildQuery =\n      (loadBuildQuery && sanitizeLoader(loadBuildQuery)) ||\n      (buildQuery && sanitizeLoader(() => buildQuery)) ||\n      undefined;\n    this.loadTransformProps = sanitizeLoader(\n      loadTransformProps ?? (() => transformProps),\n    );\n\n    if (loadChart) {\n      this.loadChart = sanitizeLoader<ChartType>(loadChart);\n    } else if (Chart) {\n      this.loadChart = () => Chart;\n    } else {\n      throw new Error('Chart or loadChart is required');\n    }\n  }\n\n  register() {\n    const key: string = this.config.key || isRequired('config.key');\n    getChartMetadataRegistry().registerValue(key, this.metadata);\n    getChartComponentRegistry().registerLoader(key, this.loadChart);\n    getChartControlPanelRegistry().registerValue(key, this.controlPanel);\n    getChartTransformPropsRegistry().registerLoader(\n      key,\n      this.loadTransformProps,\n    );\n    if (this.loadBuildQuery) {\n      getChartBuildQueryRegistry().registerLoader(key, this.loadBuildQuery);\n    }\n    return this;\n  }\n\n  unregister() {\n    const key: string = this.config.key || isRequired('config.key');\n    getChartMetadataRegistry().remove(key);\n    getChartComponentRegistry().remove(key);\n    getChartControlPanelRegistry().remove(key);\n    getChartTransformPropsRegistry().remove(key);\n    getChartBuildQueryRegistry().remove(key);\n    return this;\n  }\n\n  configure(config: { [key: string]: unknown }, replace?: boolean) {\n    super.configure(config, replace);\n\n    return this;\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Registry, makeSingleton, OverwritePolicy } from '../..';\nimport { ChartType } from '../models/ChartPlugin';\n\nclass ChartComponentRegistry extends Registry<ChartType> {\n  constructor() {\n    super({ name: 'ChartComponent', overwritePolicy: OverwritePolicy.Warn });\n  }\n}\n\nconst getInstance = makeSingleton(ChartComponentRegistry);\n\nexport default getInstance;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Registry, makeSingleton, OverwritePolicy } from '../..';\nimport { TransformProps } from '../types/TransformFunction';\n\nclass ChartTransformPropsRegistry extends Registry<TransformProps<any>> {\n  constructor() {\n    super({\n      name: 'ChartTransformProps',\n      overwritePolicy: OverwritePolicy.Warn,\n    });\n  }\n}\n\nconst getInstance = makeSingleton(ChartTransformPropsRegistry);\n\nexport default getInstance;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n * Faster debounce delay for inputs without expensive operation.\n */\nexport const FAST_DEBOUNCE = 250;\n\n/**\n * Slower debounce delay for inputs with expensive API calls.\n */\nexport const SLOW_DEBOUNCE = 500;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { ExtensibleFunction } from '../models';\nimport { getNumberFormatter, NumberFormats } from '../number-format';\nimport { Currency } from '../query';\n\ninterface CurrencyFormatterConfig {\n  d3Format?: string;\n  currency: Currency;\n  locale?: string;\n}\n\ninterface CurrencyFormatter {\n  (value: number | null | undefined): string;\n}\n\nexport const getCurrencySymbol = (currency: Partial<Currency>) =>\n  new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: currency.symbol,\n  })\n    .formatToParts(1)\n    .find(x => x.type === 'currency')?.value;\n\nclass CurrencyFormatter extends ExtensibleFunction {\n  d3Format: string;\n\n  locale: string;\n\n  currency: Currency;\n\n  constructor(config: CurrencyFormatterConfig) {\n    super((value: number) => this.format(value));\n    this.d3Format = config.d3Format || NumberFormats.SMART_NUMBER;\n    this.currency = config.currency;\n    this.locale = config.locale || 'en-US';\n  }\n\n  hasValidCurrency() {\n    return Boolean(this.currency?.symbol);\n  }\n\n  getNormalizedD3Format() {\n    return this.d3Format.replace(/\\$|%/g, '');\n  }\n\n  format(value: number) {\n    const formattedValue = getNumberFormatter(this.getNormalizedD3Format())(\n      value,\n    );\n    if (!this.hasValidCurrency()) {\n      return formattedValue as string;\n    }\n\n    if (this.currency.symbolPosition === 'prefix') {\n      return `${getCurrencySymbol(this.currency)} ${formattedValue}`;\n    }\n    return `${formattedValue} ${getCurrencySymbol(this.currency)}`;\n  }\n}\n\nexport default CurrencyFormatter;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  Currency,\n  CurrencyFormatter,\n  ensureIsArray,\n  getNumberFormatter,\n  isSavedMetric,\n  QueryFormMetric,\n  ValueFormatter,\n} from '@superset-ui/core';\n\nexport const buildCustomFormatters = (\n  metrics: QueryFormMetric | QueryFormMetric[] | undefined,\n  savedCurrencyFormats: Record<string, Currency>,\n  savedColumnFormats: Record<string, string>,\n  d3Format: string | undefined,\n  currencyFormat: Currency | undefined,\n) => {\n  const metricsArray = ensureIsArray(metrics);\n  return metricsArray.reduce((acc, metric) => {\n    if (isSavedMetric(metric)) {\n      const actualD3Format = d3Format ?? savedColumnFormats[metric];\n      const actualCurrencyFormat = currencyFormat?.symbol\n        ? currencyFormat\n        : savedCurrencyFormats[metric];\n      return actualCurrencyFormat\n        ? {\n            ...acc,\n            [metric]: new CurrencyFormatter({\n              d3Format: actualD3Format,\n              currency: actualCurrencyFormat,\n            }),\n          }\n        : {\n            ...acc,\n            [metric]: getNumberFormatter(actualD3Format),\n          };\n    }\n    return acc;\n  }, {});\n};\n\nexport const getCustomFormatter = (\n  customFormatters: Record<string, ValueFormatter>,\n  metrics: QueryFormMetric | QueryFormMetric[] | undefined,\n  key?: string,\n) => {\n  const metricsArray = ensureIsArray(metrics);\n  if (metricsArray.length === 1 && isSavedMetric(metricsArray[0])) {\n    return customFormatters[metricsArray[0]];\n  }\n  return key ? customFormatters[key] : undefined;\n};\n\nexport const getValueFormatter = (\n  metrics: QueryFormMetric | QueryFormMetric[] | undefined,\n  savedCurrencyFormats: Record<string, Currency>,\n  savedColumnFormats: Record<string, string>,\n  d3Format: string | undefined,\n  currencyFormat: Currency | undefined,\n  key?: string,\n) => {\n  const customFormatter = getCustomFormatter(\n    buildCustomFormatters(\n      metrics,\n      savedCurrencyFormats,\n      savedColumnFormats,\n      d3Format,\n      currencyFormat,\n    ),\n    metrics,\n    key,\n  );\n\n  if (customFormatter) {\n    return customFormatter;\n  }\n  if (currencyFormat?.symbol) {\n    return new CurrencyFormatter({ currency: currencyFormat, d3Format });\n  }\n  return getNumberFormatter(d3Format);\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/** The type of an imported module. Don't fully understand this, yet. */\nexport type Module = any;\n\n/**\n * This is where packages are stored. We use window, because it plays well with Webpack.\n * To avoid\n * Have to amend the type of window, because window's usual type doesn't describe these fields.\n */\ninterface ModuleReferencer {\n  [packageKey: string]: Promise<Module>;\n}\n\ndeclare const window: Window & typeof globalThis & ModuleReferencer;\n\nconst modulePromises: { [key: string]: Promise<Module> } = {};\n\nconst withNamespace = (name: string) => `__superset__/${name}`;\n\n/**\n * Dependency management using global variables, because for the life of me\n * I can't figure out how to hook into UMD from a dynamically imported package.\n *\n * This defines a dynamically imported js module that can be used to import from\n * multiple different plugins.\n *\n * When importing a common module (such as react or lodash or superset-ui)\n * from a plugin, the plugin's build config will be able to\n * reference these globals instead of rebuilding them.\n *\n * @param name the module's name (should match name in package.json)\n * @param promise the promise resulting from a call to `import(name)`\n */\nexport async function defineSharedModule(\n  name: string,\n  fetchModule: () => Promise<Module>,\n) {\n  // this field on window is used by dynamic plugins to reference the module\n  const moduleKey = withNamespace(name);\n\n  if (!window[moduleKey] && !modulePromises[name]) {\n    // if the module has not been loaded, load it\n    const modulePromise = fetchModule();\n    modulePromises[name] = modulePromise;\n    // wait for the module to load, and attach the result to window\n    // so that it can be referenced by plugins\n    window[moduleKey] = await modulePromise;\n  }\n\n  // we always return a reference to the promise.\n  // Multiple consumers can `.then()` or `await` the same promise,\n  // even long after it has completed,\n  // and it will always call back with the same reference.\n  return modulePromises[name];\n}\n\n/**\n * Define multiple shared modules at once, using a map of name -> `import(name)`\n *\n * @see defineSharedModule\n * @param moduleMap\n */\nexport async function defineSharedModules(moduleMap: {\n  [key: string]: () => Promise<Module>;\n}) {\n  return Promise.all(\n    Object.entries(moduleMap).map(([name, fetchModule]) =>\n      defineSharedModule(name, fetchModule),\n    ),\n  );\n}\n\n// only exposed for tests\nexport function reset() {\n  Object.keys(modulePromises).forEach(key => {\n    delete window[withNamespace(key)];\n    delete modulePromises[key];\n  });\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { EffectCallback, useEffect } from 'react';\n\nexport const useComponentDidMount = (effect: EffectCallback) => {\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(effect, []);\n};\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport mexp from 'math-expression-evaluator';\n\nconst REPLACE_OPERATORS: [RegExp, string][] = [\n  [new RegExp(/==/g), 'Eq'],\n  [new RegExp(/>=/g), 'Gte'],\n  [new RegExp(/<=/g), 'Lte'],\n  [new RegExp(/>/g), 'Gt'],\n  [new RegExp(/</g), 'Lt'],\n];\n\nconst TOKENS = [\n  {\n    type: 3,\n    token: 'x',\n    show: 'x',\n    value: 'x',\n  },\n  {\n    type: 2,\n    token: '&',\n    show: '&',\n    value: (a: number, b: number): number => a & b,\n  },\n  {\n    type: 2,\n    token: '|',\n    show: '|',\n    value: (a: number, b: number): number => a | b,\n  },\n  {\n    type: 2,\n    token: 'and',\n    show: 'and',\n    value: (a: number, b: number): number => a && b,\n  },\n  {\n    type: 2,\n    token: 'xor',\n    show: 'xor',\n    value: (a: number, b: number): number => a ^ b,\n  },\n  {\n    type: 2,\n    token: 'or',\n    show: 'or',\n    value: (a: number, b: number): number => Number(a || b),\n  },\n  {\n    type: 2,\n    token: 'Eq',\n    show: 'Eq',\n    value: (a: number, b: number): number => Number(a === b),\n  },\n  {\n    type: 2,\n    token: 'Lt',\n    show: 'Lt',\n    value: (a: number, b: number): number => Number(a < b),\n  },\n  {\n    type: 2,\n    token: 'Lte',\n    show: 'Lte',\n    value: (a: number, b: number): number => Number(a <= b),\n  },\n  {\n    type: 2,\n    token: 'Gt',\n    show: 'Gt',\n    value: (a: number, b: number): number => Number(a > b),\n  },\n  {\n    type: 2,\n    token: 'Gte',\n    show: 'Gte',\n    value: (a: number, b: number): number => Number(a >= b),\n  },\n];\n\nexport function evalExpression(expression: string, value: number): number {\n  let parsedExpression = expression;\n  // replace `<` with `Lt` (and others) to avoid clashes with builtin function operators\n  // that are not needed in Superset.\n  REPLACE_OPERATORS.forEach(([key, value]) => {\n    parsedExpression = parsedExpression.replace(key, value);\n  });\n  const subExpressions = String(parsedExpression).split('=');\n  parsedExpression = subExpressions[1] ?? subExpressions[0];\n  // we can ignore the type requirement on `TOKENS`, as value is always `number`\n  // and doesn't need to consider `number | undefined`.\n  // @ts-ignore\n  return Number(mexp.eval(parsedExpression, TOKENS, { x: value }));\n}\n\nexport function isValidExpression(expression: string): boolean {\n  try {\n    evalExpression(expression, 0);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\ninterface PlainObject {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any;\n}\n\nexport default class Plugin {\n  config: PlainObject;\n\n  constructor() {\n    this.config = {};\n  }\n\n  resetConfig() {\n    // The child class can set default config\n    // by overriding this function.\n    this.config = {};\n\n    return this;\n  }\n\n  configure(config: PlainObject, replace = false) {\n    this.config = replace ? config : { ...this.config, ...config };\n\n    return this;\n  }\n\n  register() {\n    return this;\n  }\n\n  unregister() {\n    return this;\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport Plugin from './Plugin';\n\nexport default class Preset {\n  name: string;\n\n  description: string;\n\n  presets: Preset[];\n\n  plugins: Plugin[];\n\n  constructor(\n    config: {\n      name?: string;\n      description?: string;\n      presets?: Preset[];\n      plugins?: Plugin[];\n    } = {},\n  ) {\n    const { name = '', description = '', presets = [], plugins = [] } = config;\n    this.name = name;\n    this.description = description;\n    this.presets = presets;\n    this.plugins = plugins;\n  }\n\n  register() {\n    this.presets.forEach(preset => {\n      preset.register();\n    });\n    this.plugins.forEach(plugin => {\n      plugin.register();\n    });\n\n    return this;\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable no-underscore-dangle */\n\nimport { QueryFormData } from '@superset-ui/core';\nimport { TimeGranularity } from '../time-format';\n\nexport default function extractTimegrain(\n  formData: QueryFormData,\n): TimeGranularity | undefined {\n  const { time_grain_sqla, extra_filters, extra_form_data } = formData;\n  if (extra_form_data?.time_grain_sqla) {\n    return extra_form_data.time_grain_sqla;\n  }\n  const extra_grain = (extra_filters || []).filter(\n    filter => filter.col === '__time_grain',\n  );\n  if (extra_grain.length) {\n    return extra_grain[0].val as TimeGranularity;\n  }\n  return time_grain_sqla;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { isEmpty, isBoolean } from 'lodash';\n\nimport { QueryObject } from './types';\n\nexport default function normalizeOrderBy(\n  queryObject: QueryObject,\n): QueryObject {\n  if (Array.isArray(queryObject.orderby) && queryObject.orderby.length > 0) {\n    // ensure a valid orderby clause\n    const orderbyClause = queryObject.orderby[0];\n    if (\n      Array.isArray(orderbyClause) &&\n      orderbyClause.length === 2 &&\n      !isEmpty(orderbyClause[0]) &&\n      isBoolean(orderbyClause[1])\n    ) {\n      return queryObject;\n    }\n  }\n\n  // ensure that remove invalid orderby clause\n  const cloneQueryObject = { ...queryObject };\n  delete cloneQueryObject.series_limit_metric;\n  delete cloneQueryObject.legacy_order_by;\n  delete cloneQueryObject.order_desc;\n  delete cloneQueryObject.orderby;\n\n  const isAsc = !queryObject.order_desc;\n  if (\n    queryObject.series_limit_metric !== undefined &&\n    queryObject.series_limit_metric !== null &&\n    !isEmpty(queryObject.series_limit_metric)\n  ) {\n    return {\n      ...cloneQueryObject,\n      orderby: [[queryObject.series_limit_metric, isAsc]],\n    };\n  }\n\n  // todo: Removed `legacy_order_by` after refactoring\n  if (\n    queryObject.legacy_order_by !== undefined &&\n    queryObject.legacy_order_by !== null &&\n    !isEmpty(queryObject.legacy_order_by)\n  ) {\n    return {\n      ...cloneQueryObject,\n      // @ts-ignore\n      orderby: [[queryObject.legacy_order_by, isAsc]],\n    };\n  }\n\n  if (Array.isArray(queryObject.metrics) && queryObject.metrics.length > 0) {\n    return {\n      ...cloneQueryObject,\n      orderby: [[queryObject.metrics[0], isAsc]],\n    };\n  }\n\n  return cloneQueryObject;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/* eslint camelcase: 0 */\nimport { DataRecord } from './QueryResponse';\nimport { TimeGranularity } from '../../time-format';\n\nexport enum AnnotationType {\n  Event = 'EVENT',\n  Formula = 'FORMULA',\n  Interval = 'INTERVAL',\n  Timeseries = 'TIME_SERIES',\n}\n\nexport enum AnnotationSourceType {\n  Line = 'line',\n  Native = 'NATIVE',\n  Table = 'table',\n  Undefined = '',\n}\n\nexport enum AnnotationOpacity {\n  High = 'opacityHigh',\n  Low = 'opacityLow',\n  Medium = 'opacityMedium',\n  Undefined = '',\n}\n\nexport enum AnnotationStyle {\n  Dashed = 'dashed',\n  Dotted = 'dotted',\n  Solid = 'solid',\n  LongDashed = 'longDashed',\n}\n\ntype BaseAnnotationLayer = {\n  color?: string | null;\n  name: string;\n  opacity?: AnnotationOpacity;\n  show: boolean;\n  showLabel: boolean;\n  style: AnnotationStyle;\n  width?: number;\n};\n\ntype AnnotationOverrides = {\n  granularity?: string | null;\n  time_grain_sqla?: TimeGranularity | null;\n  time_range?: string | null;\n  time_shift?: string | null;\n};\n\ntype LineSourceAnnotationLayer = {\n  hideLine?: boolean;\n  overrides?: AnnotationOverrides;\n  sourceType: AnnotationSourceType.Line;\n  titleColumn?: string;\n  // viz id\n  value: number;\n};\n\ntype NativeSourceAnnotationLayer = {\n  sourceType: AnnotationSourceType.Native;\n  // annotation id\n  value: number;\n};\n\ntype TableSourceAnnotationLayer = {\n  descriptionColumns?: string[];\n  timeColumn?: string;\n  intervalEndColumn?: string;\n  overrides?: AnnotationOverrides;\n  sourceType: AnnotationSourceType.Table;\n  titleColumn?: string;\n  // viz id\n  value: number;\n};\n\nexport type EventAnnotationLayer = BaseAnnotationLayer &\n  (TableSourceAnnotationLayer | NativeSourceAnnotationLayer) & {\n    annotationType: AnnotationType.Event;\n  };\n\nexport type IntervalAnnotationLayer = BaseAnnotationLayer &\n  (TableSourceAnnotationLayer | NativeSourceAnnotationLayer) & {\n    annotationType: AnnotationType.Interval;\n  };\n\nexport type TableAnnotationLayer = BaseAnnotationLayer &\n  TableSourceAnnotationLayer & {\n    annotationType: AnnotationType.Event | AnnotationType.Interval;\n  };\n\nexport type FormulaAnnotationLayer = BaseAnnotationLayer & {\n  annotationType: AnnotationType.Formula;\n  // the mathjs parseable formula\n  sourceType?: AnnotationSourceType.Undefined;\n  value: string;\n};\n\nexport type TimeseriesAnnotationLayer = BaseAnnotationLayer &\n  LineSourceAnnotationLayer & {\n    annotationType: AnnotationType.Timeseries;\n    showMarkers?: boolean;\n    value: number;\n  };\n\nexport type AnnotationLayer =\n  | EventAnnotationLayer\n  | IntervalAnnotationLayer\n  | FormulaAnnotationLayer\n  | TimeseriesAnnotationLayer\n  | TableAnnotationLayer;\n\nexport function isFormulaAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is FormulaAnnotationLayer {\n  return layer.annotationType === AnnotationType.Formula;\n}\n\nexport function isEventAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is EventAnnotationLayer {\n  return layer.annotationType === AnnotationType.Event;\n}\n\nexport function isIntervalAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is IntervalAnnotationLayer {\n  return layer.annotationType === AnnotationType.Interval;\n}\n\nexport function isTimeseriesAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is TimeseriesAnnotationLayer {\n  return layer.annotationType === AnnotationType.Timeseries;\n}\n\nexport function isTableAnnotationLayer(\n  layer: AnnotationLayer,\n): layer is TableAnnotationLayer {\n  return layer.sourceType === AnnotationSourceType.Table;\n}\n\nexport type RecordAnnotationResult = {\n  records: DataRecord[];\n};\n\nexport type TimeseriesAnnotationResult = {\n  key: string;\n  values: { x: string | number; y?: number }[];\n}[];\n\nexport type AnnotationResult =\n  | RecordAnnotationResult\n  | TimeseriesAnnotationResult;\n\nexport function isTimeseriesAnnotationResult(\n  result: AnnotationResult,\n): result is TimeseriesAnnotationResult {\n  return Array.isArray(result);\n}\n\nexport function isRecordAnnotationResult(\n  result: any,\n): result is RecordAnnotationResult {\n  return Array.isArray(result?.records);\n}\n\nexport type AnnotationData = { [key: string]: AnnotationResult };\n\nexport type Annotation = {\n  descriptions?: string[];\n  intervalEnd?: string;\n  time?: string;\n  title?: string;\n};\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport createMultiFormatter from '../factories/createMultiFormatter';\n\nconst smartDateDetailedFormatter = createMultiFormatter({\n  id: 'smart_date_detailed',\n  label: 'Detailed adaptive formatter',\n  formats: {\n    millisecond: '%Y-%m-%d %H:%M:%S.%L',\n    second: '%Y-%m-%d %H:%M:%S',\n    minute: '%Y-%m-%d %H:%M',\n    hour: '%Y-%m-%d %H:%M',\n    day: '%Y-%m-%d',\n    week: '%Y-%m-%d',\n    month: '%Y-%m-%d',\n    year: '%Y',\n  },\n});\n\nexport default smartDateDetailedFormatter;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport default function ensureIsInt<T>(\n  value: T,\n  defaultValue?: number,\n): number {\n  const val = parseInt(String(value), 10);\n  const defaultOrNaN = defaultValue === undefined ? NaN : defaultValue;\n  return Number.isNaN(val) ? defaultOrNaN : val;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function isEqualArray<T extends unknown[] | undefined | null>(\n  arrA: T,\n  arrB: T,\n) {\n  return (\n    arrA === arrB ||\n    (!arrA && !arrB) ||\n    !!(\n      arrA &&\n      arrB &&\n      arrA.length === arrB.length &&\n      arrA.every((x, i) => x === arrB[i])\n    )\n  );\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '../translation';\n\n/**\n * formerly called numeric()\n * @param v\n */\nexport default function numeric(v: unknown) {\n  if (v && Number.isNaN(Number(v))) {\n    return t('is expected to be a number');\n  }\n  return false;\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '../translation';\n\n/**\n * Validate a [Mapbox styles URL](https://docs.mapbox.com/help/glossary/style-url/)\n * @param v\n */\nexport default function validateMapboxStylesUrl(v: unknown) {\n  if (\n    typeof v === 'string' &&\n    v.trim().length > 0 &&\n    v.trim().startsWith('mapbox://styles/')\n  ) {\n    return false;\n  }\n\n  return t('is expected to be a Mapbox URL');\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '../translation';\n\nexport default function validateInteger(v: unknown) {\n  if (\n    (typeof v === 'string' &&\n      v.trim().length > 0 &&\n      Number.isFinite(Number(v.trim()))) ||\n    (typeof v === 'number' && Number.isFinite(v))\n  ) {\n    return false;\n  }\n\n  return t('is expected to be a number');\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport afghanistan from './countries/afghanistan.geojson';\nimport albania from './countries/albania.geojson';\nimport algeria from './countries/algeria.geojson';\nimport argentina from './countries/argentina.geojson';\nimport australia from './countries/australia.geojson';\nimport austria from './countries/austria.geojson';\nimport belgium from './countries/belgium.geojson';\nimport bolivia from './countries/bolivia.geojson';\nimport brazil from './countries/brazil.geojson';\nimport bulgaria from './countries/bulgaria.geojson';\nimport burundi from './countries/burundi.geojson';\nimport canada from './countries/canada.geojson';\nimport chile from './countries/chile.geojson';\nimport china from './countries/china.geojson';\nimport colombia from './countries/colombia.geojson';\nimport costa_rica from './countries/costa_rica.geojson';\nimport cuba from './countries/cuba.geojson';\nimport cyprus from './countries/cyprus.geojson';\nimport denmark from './countries/denmark.geojson';\nimport dominican_republic from './countries/dominican_republic.geojson';\nimport ecuador from './countries/ecuador.geojson';\nimport egypt from './countries/egypt.geojson';\nimport el_salvador from './countries/el_salvador.geojson';\nimport estonia from './countries/estonia.geojson';\nimport ethiopia from './countries/ethiopia.geojson';\nimport france from './countries/france.geojson';\nimport france_regions from './countries/france_regions.geojson';\nimport finland from './countries/finland.geojson';\nimport germany from './countries/germany.geojson';\nimport guatemala from './countries/guatemala.geojson';\nimport haiti from './countries/haiti.geojson';\nimport honduras from './countries/honduras.geojson';\nimport iceland from './countries/iceland.geojson';\nimport india from './countries/india.geojson';\nimport indonesia from './countries/indonesia.geojson';\nimport iran from './countries/iran.geojson';\nimport italy from './countries/italy.geojson';\nimport italy_regions from './countries/italy_regions.geojson';\nimport japan from './countries/japan.geojson';\nimport jordan from './countries/jordan.geojson';\nimport kazakhstan from './countries/kazakhstan.geojson';\nimport kenya from './countries/kenya.geojson';\nimport korea from './countries/korea.geojson';\nimport kuwait from './countries/kuwait.geojson';\nimport kyrgyzstan from './countries/kyrgyzstan.geojson';\nimport latvia from './countries/latvia.geojson';\nimport liechtenstein from './countries/liechtenstein.geojson';\nimport lithuania from './countries/lithuania.geojson';\nimport malaysia from './countries/malaysia.geojson';\nimport mexico from './countries/mexico.geojson';\nimport morocco from './countries/morocco.geojson';\nimport myanmar from './countries/myanmar.geojson';\nimport netherlands from './countries/netherlands.geojson';\nimport nicaragua from './countries/nicaragua.geojson';\nimport nigeria from './countries/nigeria.geojson';\nimport norway from './countries/norway.geojson';\nimport oman from './countries/oman.geojson';\nimport pakistan from './countries/pakistan.geojson';\nimport panama from './countries/panama.geojson';\nimport papua_new_guinea from './countries/papua_new_guinea.geojson';\nimport paraguay from './countries/paraguay.geojson';\nimport peru from './countries/peru.geojson';\nimport philippines from './countries/philippines.geojson';\nimport portugal from './countries/portugal.geojson';\nimport poland from './countries/poland.geojson';\nimport puerto_rico from './countries/puerto_rico.geojson';\nimport qatar from './countries/qatar.geojson';\nimport russia from './countries/russia.geojson';\nimport rwanda from './countries/rwanda.geojson';\nimport saint_barthelemy from './countries/saint_barthelemy.geojson';\nimport saint_martin from './countries/saint_martin.geojson';\nimport saudi_arabia from './countries/saudi_arabia.geojson';\nimport singapore from './countries/singapore.geojson';\nimport slovenia from './countries/slovenia.geojson';\nimport spain from './countries/spain.geojson';\nimport sri_lanka from './countries/sri_lanka.geojson';\nimport sweden from './countries/sweden.geojson';\nimport switzerland from './countries/switzerland.geojson';\nimport syria from './countries/syria.geojson';\nimport tajikistan from './countries/tajikistan.geojson';\nimport tanzania from './countries/tanzania.geojson';\nimport thailand from './countries/thailand.geojson';\nimport timorleste from './countries/timorleste.geojson';\nimport turkey from './countries/turkey.geojson';\nimport turkmenistan from './countries/turkmenistan.geojson';\nimport uganda from './countries/uganda.geojson';\nimport uk from './countries/uk.geojson';\nimport ukraine from './countries/ukraine.geojson';\nimport united_arab_emirates from './countries/united_arab_emirates.geojson';\nimport uruguay from './countries/uruguay.geojson';\nimport usa from './countries/usa.geojson';\nimport uzbekistan from './countries/uzbekistan.geojson';\nimport venezuela from './countries/venezuela.geojson';\nimport vietnam from './countries/vietnam.geojson';\nimport zambia from './countries/zambia.geojson';\n\nexport const countries = {\n  afghanistan,\n  albania,\n  algeria,\n  argentina,\n  australia,\n  austria,\n  belgium,\n  bolivia,\n  brazil,\n  bulgaria,\n  burundi,\n  canada,\n  chile,\n  china,\n  colombia,\n  costa_rica,\n  cuba,\n  cyprus,\n  denmark,\n  dominican_republic,\n  ecuador,\n  egypt,\n  el_salvador,\n  estonia,\n  ethiopia,\n  france,\n  france_regions,\n  finland,\n  germany,\n  guatemala,\n  haiti,\n  honduras,\n  iceland,\n  india,\n  indonesia,\n  iran,\n  italy,\n  italy_regions,\n  japan,\n  jordan,\n  kazakhstan,\n  kenya,\n  korea,\n  kuwait,\n  kyrgyzstan,\n  latvia,\n  liechtenstein,\n  lithuania,\n  malaysia,\n  mexico,\n  morocco,\n  myanmar,\n  netherlands,\n  nicaragua,\n  nigeria,\n  norway,\n  oman,\n  pakistan,\n  panama,\n  papua_new_guinea,\n  paraguay,\n  peru,\n  philippines,\n  portugal,\n  poland,\n  puerto_rico,\n  qatar,\n  russia,\n  rwanda,\n  saint_barthelemy,\n  saint_martin,\n  saudi_arabia,\n  singapore,\n  slovenia,\n  spain,\n  sri_lanka,\n  sweden,\n  switzerland,\n  syria,\n  tajikistan,\n  tanzania,\n  thailand,\n  timorleste,\n  turkey,\n  turkmenistan,\n  uganda,\n  uk,\n  ukraine,\n  united_arab_emirates,\n  uruguay,\n  usa,\n  uzbekistan,\n  venezuela,\n  vietnam,\n  zambia,\n};\n\nexport const countryOptions = Object.keys(countries).map(x => {\n  if (x === 'uk' || x === 'usa') {\n    return [x, x.toUpperCase()];\n  }\n  if (x === 'italy_regions') {\n    return [x, 'Italy (regions)'];\n  }\n  if (x === 'france_regions') {\n    return [x, 'France (regions)'];\n  }\n  return [\n    x,\n    x\n      .split('_')\n      .map(e => e[0].toUpperCase() + e.slice(1))\n      .join(' '),\n  ];\n});\n\nexport default countries;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\ntype Rect = {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n};\n\nexport function getLabelFontSize(width: number): number {\n  if (width > 550) {\n    return 0.8;\n  }\n\n  if (width > 400 && width <= 550) {\n    return 0.55;\n  }\n\n  return 0.45;\n}\n\nexport const isOverlapping = (rect1: Rect, rect2: Rect): boolean => {\n  const { x: x1, y: y1, width: width1, height: height1 } = rect1;\n  const { x: x2, y: y2, width: width2, height: height2 } = rect2;\n\n  return !(\n    x1 > x2 + width2 ||\n    x1 + width1 < x2 ||\n    y1 > y2 + height2 ||\n    y1 + height1 < y2\n  );\n};\n\nexport const getRectangle = (element: SVGElement, offset = 0): Rect => {\n  const { x, y, width, height } = element.getBoundingClientRect();\n\n  return {\n    x,\n    y: y + offset,\n    width,\n    height: height - offset * 2,\n  };\n};\n\nexport const getOverlappingElements = (\n  elements: SVGElement[],\n): SVGElement[] => {\n  const overlappingElements: SVGElement[] = [];\n\n  elements.forEach((e1, index1) => {\n    const rect1: Rect = getRectangle(e1, 1);\n\n    elements.forEach((e2, index2) => {\n      if (index2 <= index1) return;\n      const rect2: Rect = getRectangle(e2, 1);\n\n      if (isOverlapping(rect1, rect2)) {\n        overlappingElements.push(elements[index2]);\n        overlappingElements.push(elements[index1]);\n      }\n    });\n  });\n\n  return overlappingElements;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport enum ColorBy {\n  Metric = 'metric',\n  Country = 'country',\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { OptionName } from 'echarts/types/src/util/types';\nimport {\n  AnnotationLayer,\n  AxisType,\n  ContributionType,\n  QueryFormData,\n  QueryFormMetric,\n  TimeFormatter,\n  TimeGranularity,\n} from '@superset-ui/core';\nimport {\n  BaseChartProps,\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  CrossFilterTransformedProps,\n  LegendFormData,\n  StackType,\n  TitleFormData,\n} from '../types';\n\nexport enum OrientationType {\n  Vertical = 'vertical',\n  Horizontal = 'horizontal',\n}\n\nexport enum EchartsTimeseriesSeriesType {\n  Line = 'line',\n  Scatter = 'scatter',\n  Smooth = 'smooth',\n  Bar = 'bar',\n  Start = 'start',\n  Middle = 'middle',\n  End = 'end',\n}\n\nexport type EchartsTimeseriesFormData = QueryFormData & {\n  annotationLayers: AnnotationLayer[];\n  area: boolean;\n  colorScheme?: string;\n  contributionMode?: ContributionType;\n  forecastEnabled: boolean;\n  forecastPeriods: number;\n  forecastInterval: number;\n  forecastSeasonalityDaily: null;\n  forecastSeasonalityWeekly: null;\n  forecastSeasonalityYearly: null;\n  logAxis: boolean;\n  markerEnabled: boolean;\n  markerSize: number;\n  metrics: QueryFormMetric[];\n  minorSplitLine: boolean;\n  minorTicks: boolean;\n  opacity: number;\n  orderDesc: boolean;\n  rowLimit: number;\n  seriesType: EchartsTimeseriesSeriesType;\n  stack: StackType;\n  timeCompare?: string[];\n  tooltipTimeFormat?: string;\n  truncateXAxis: boolean;\n  truncateYAxis: boolean;\n  yAxisFormat?: string;\n  xAxisForceCategorical?: boolean;\n  xAxisTimeFormat?: string;\n  timeGrainSqla?: TimeGranularity;\n  xAxisBounds: [number | undefined | null, number | undefined | null];\n  yAxisBounds: [number | undefined | null, number | undefined | null];\n  zoomable: boolean;\n  richTooltip: boolean;\n  xAxisLabelRotation: number;\n  showValue: boolean;\n  onlyTotal: boolean;\n  showExtraControls: boolean;\n  percentageThreshold: number;\n  orientation?: OrientationType;\n} & LegendFormData &\n  TitleFormData;\n\nexport interface EchartsTimeseriesChartProps\n  extends BaseChartProps<EchartsTimeseriesFormData> {\n  formData: EchartsTimeseriesFormData;\n}\n\nexport type TimeseriesChartTransformedProps =\n  BaseTransformedProps<EchartsTimeseriesFormData> &\n    ContextMenuTransformedProps &\n    CrossFilterTransformedProps & {\n      legendData?: OptionName[];\n      xValueFormatter: TimeFormatter | StringConstructor;\n      xAxis: {\n        label: string;\n        type: AxisType;\n      };\n      onFocusedSeries: (series: string | null) => void;\n    };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { TreePathInfo } from '../types';\n\nexport const COLOR_SATURATION = [0.7, 0.4];\nexport const LABEL_FONTSIZE = 11;\nexport const BORDER_WIDTH = 2;\nexport const GAP_WIDTH = 2;\nexport const BORDER_COLOR = '#fff';\n\nexport const extractTreePathInfo = (\n  treePathInfo: TreePathInfo[] | undefined,\n) => {\n  const treePath = (treePathInfo ?? [])\n    .map(pathInfo => pathInfo?.name || '')\n    .filter(path => path !== '');\n\n  // the 1st tree path is metric label\n  const metricLabel = treePath.shift() || '';\n  return { metricLabel, treePath };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { JsonValue, t, TimeGranularity } from '@superset-ui/core';\nimport { ReactNode } from 'react';\nimport {\n  LabelPositionEnum,\n  LegendFormData,\n  LegendOrientation,\n  LegendType,\n  TitleFormData,\n} from './types';\n\n// eslint-disable-next-line import/prefer-default-export\nexport const NULL_STRING = '<NULL>';\n\nexport const TIMESERIES_CONSTANTS = {\n  gridOffsetRight: 20,\n  gridOffsetLeft: 20,\n  gridOffsetTop: 20,\n  gridOffsetBottom: 20,\n  gridOffsetBottomZoomable: 80,\n  legendRightTopOffset: 30,\n  legendTopRightOffset: 55,\n  zoomBottom: 30,\n  toolboxTop: 0,\n  toolboxRight: 5,\n  dataZoomStart: 0,\n  dataZoomEnd: 100,\n  yAxisLabelTopOffset: 20,\n  extraControlsOffset: 22,\n};\n\nexport const LABEL_POSITION: [LabelPositionEnum, string][] = [\n  [LabelPositionEnum.Top, 'Top'],\n  [LabelPositionEnum.Left, 'Left'],\n  [LabelPositionEnum.Right, 'Right'],\n  [LabelPositionEnum.Bottom, 'Bottom'],\n  [LabelPositionEnum.Inside, 'Inside'],\n  [LabelPositionEnum.InsideBottomLeft, 'Inside left'],\n  [LabelPositionEnum.InsideBottomRight, 'Inside right'],\n  [LabelPositionEnum.InsideTop, 'Inside top'],\n  [LabelPositionEnum.InsideBottom, 'Inside bottom'],\n  [LabelPositionEnum.InsideTopLeft, 'Inside top left'],\n  [LabelPositionEnum.InsideBottomLeft, 'Inside bottom left'],\n  [LabelPositionEnum.InsideTopRight, 'Inside top right'],\n  [LabelPositionEnum.InsideBottomRight, 'Inside bottom right'],\n];\n\nexport enum OpacityEnum {\n  Transparent = 0,\n  SemiTransparent = 0.3,\n  NonTransparent = 1,\n}\n\nexport enum StackControlsValue {\n  Stack = 'Stack',\n  Stream = 'Stream',\n  Expand = 'Expand',\n}\n\nexport const StackControlOptions: [\n  JsonValue,\n  Exclude<ReactNode, null | undefined | boolean>,\n][] = [\n  [null, t('None')],\n  [StackControlsValue.Stack, t('Stack')],\n  [StackControlsValue.Stream, t('Stream')],\n];\n\nexport const AreaChartStackControlOptions: [\n  JsonValue,\n  Exclude<ReactNode, null | undefined | boolean>,\n][] = [...StackControlOptions, [StackControlsValue.Expand, t('Expand')]];\n\nexport const TIMEGRAIN_TO_TIMESTAMP = {\n  [TimeGranularity.HOUR]: 3600 * 1000,\n  [TimeGranularity.DAY]: 3600 * 1000 * 24,\n  [TimeGranularity.MONTH]: 3600 * 1000 * 24 * 31,\n  [TimeGranularity.QUARTER]: 3600 * 1000 * 24 * 31 * 3,\n  [TimeGranularity.YEAR]: 3600 * 1000 * 24 * 31 * 12,\n};\n\nexport const DEFAULT_LEGEND_FORM_DATA: LegendFormData = {\n  legendMargin: null,\n  legendOrientation: LegendOrientation.Top,\n  legendType: LegendType.Scroll,\n  showLegend: true,\n};\n\nexport const DEFAULT_TITLE_FORM_DATA: TitleFormData = {\n  xAxisTitle: '',\n  xAxisTitleMargin: 0,\n  yAxisTitle: '',\n  yAxisTitleMargin: 0,\n  yAxisTitlePosition: 'Top',\n};\n\nexport { DEFAULT_FORM_DATA } from './Timeseries/constants';\n\n// How far away from the mouse should the tooltip be\nexport const TOOLTIP_POINTER_MARGIN = 10;\n\n// If no satisfactory position can be found, how far away\n// from the edge of the window should the tooltip be kept\nexport const TOOLTIP_OVERFLOW_MARGIN = 5;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { LegendOrientation } from './types';\n\nexport const defaultGrid = {\n  containLabel: true,\n};\n\nexport const defaultYAxis = {\n  scale: true,\n  yAxisLabelRotation: 0,\n};\n\nexport const defaultXAxis = {\n  xAxisLabelRotation: 0,\n};\n\nexport const defaultLegendPadding = {\n  [LegendOrientation.Top]: 20,\n  [LegendOrientation.Bottom]: 20,\n  [LegendOrientation.Left]: 170,\n  [LegendOrientation.Right]: 170,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { RefObject } from 'react';\nimport {\n  ChartDataResponseResult,\n  ChartProps,\n  ContextMenuFilters,\n  FilterState,\n  HandlerFunction,\n  LegendState,\n  PlainObject,\n  QueryFormColumn,\n  SetDataMaskHook,\n  ChartPlugin,\n  SqlaFormData,\n  ChartMetadata,\n} from '@superset-ui/core';\nimport { EChartsCoreOption, ECharts } from 'echarts';\nimport { TooltipMarker } from 'echarts/types/src/util/format';\nimport { StackControlsValue } from './constants';\n\nexport type EchartsStylesProps = {\n  height: number;\n  width: number;\n};\n\nexport type Refs = {\n  echartRef?: React.Ref<EchartsHandler>;\n  divRef?: RefObject<HTMLDivElement>;\n};\n\nexport interface EchartsProps {\n  height: number;\n  width: number;\n  echartOptions: EChartsCoreOption;\n  eventHandlers?: EventHandlers;\n  zrEventHandlers?: EventHandlers;\n  selectedValues?: Record<number, string>;\n  forceClear?: boolean;\n  refs: Refs;\n}\n\nexport interface EchartsHandler {\n  getEchartInstance: () => ECharts | undefined;\n}\n\nexport enum ForecastSeriesEnum {\n  Observation = '',\n  ForecastTrend = '__yhat',\n  ForecastUpper = '__yhat_upper',\n  ForecastLower = '__yhat_lower',\n}\n\nexport type ForecastSeriesContext = {\n  name: string;\n  type: ForecastSeriesEnum;\n};\n\nexport enum LegendOrientation {\n  Top = 'top',\n  Bottom = 'bottom',\n  Left = 'left',\n  Right = 'right',\n}\n\nexport enum LegendType {\n  Scroll = 'scroll',\n  Plain = 'plain',\n}\n\nexport type ForecastValue = {\n  marker: TooltipMarker;\n  observation?: number;\n  forecastTrend?: number;\n  forecastLower?: number;\n  forecastUpper?: number;\n};\n\nexport type LegendFormData = {\n  legendMargin: number | null | string;\n  legendOrientation: LegendOrientation;\n  legendType: LegendType;\n  showLegend: boolean;\n};\n\nexport type EventHandlers = Record<string, { (props: any): void }>;\n\nexport enum LabelPositionEnum {\n  Top = 'top',\n  Left = 'left',\n  Right = 'right',\n  Bottom = 'bottom',\n  Inside = 'inside',\n  InsideLeft = 'insideLeft',\n  InsideRight = 'insideRight',\n  InsideTop = 'insideTop',\n  InsideBottom = 'insideBottom',\n  InsideTopLeft = 'insideTopLeft',\n  InsideBottomLeft = 'insideBottomLeft',\n  InsideTopRight = 'insideTopRight',\n  InsideBottomRight = 'insideBottomRight',\n}\n\nexport interface BaseChartProps<T extends PlainObject> extends ChartProps<T> {\n  queriesData: ChartDataResponseResult[];\n}\n\nexport interface BaseTransformedProps<F> {\n  echartOptions: EChartsCoreOption;\n  formData: F;\n  height: number;\n  onContextMenu?: (\n    clientX: number,\n    clientY: number,\n    filters?: ContextMenuFilters,\n  ) => void;\n  setDataMask?: SetDataMaskHook;\n  onLegendStateChanged?: (state: LegendState) => void;\n  filterState?: FilterState;\n  refs: Refs;\n  width: number;\n  emitCrossFilters?: boolean;\n  coltypeMapping?: Record<string, number>;\n}\n\nexport type CrossFilterTransformedProps = {\n  groupby: QueryFormColumn[];\n  labelMap: Record<string, string[]>;\n  setControlValue?: HandlerFunction;\n  setDataMask: SetDataMaskHook;\n  selectedValues: Record<number, string>;\n  emitCrossFilters?: boolean;\n};\n\nexport type ContextMenuTransformedProps = {\n  onContextMenu?: (\n    clientX: number,\n    clientY: number,\n    filters?: ContextMenuFilters,\n  ) => void;\n  setDataMask?: SetDataMaskHook;\n};\n\nexport interface TitleFormData {\n  xAxisTitle: string;\n  xAxisTitleMargin: number;\n  yAxisTitle: string;\n  yAxisTitleMargin: number;\n  yAxisTitlePosition: string;\n}\n\nexport type StackType = boolean | null | Partial<StackControlsValue>;\n\nexport interface TreePathInfo {\n  name: string;\n  dataIndex: number;\n  value: number | number[];\n}\n\nexport class EchartsChartPlugin<\n  T extends SqlaFormData = SqlaFormData,\n  P extends ChartProps = ChartProps,\n> extends ChartPlugin<T, P> {\n  constructor(props: any) {\n    const { metadata, ...restProps } = props;\n    super({\n      ...restProps,\n      metadata: new ChartMetadata({\n        parseMethod: 'json',\n        ...metadata,\n      }),\n    });\n  }\n}\n\nexport * from './Timeseries/types';\n","/* eslint-disable no-underscore-dangle */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AxisType,\n  ChartDataResponseResult,\n  DataRecord,\n  DataRecordValue,\n  DTTM_ALIAS,\n  ensureIsArray,\n  GenericDataType,\n  LegendState,\n  normalizeTimestamp,\n  NumberFormats,\n  NumberFormatter,\n  SupersetTheme,\n  TimeFormatter,\n  ValueFormatter,\n} from '@superset-ui/core';\nimport { SortSeriesType } from '@superset-ui/chart-controls';\nimport { format, LegendComponentOption, SeriesOption } from 'echarts';\nimport { maxBy, meanBy, minBy, orderBy, sumBy } from 'lodash';\nimport {\n  NULL_STRING,\n  StackControlsValue,\n  TIMESERIES_CONSTANTS,\n} from '../constants';\nimport {\n  EchartsTimeseriesSeriesType,\n  LegendOrientation,\n  LegendType,\n  StackType,\n} from '../types';\nimport { defaultLegendPadding } from '../defaults';\n\nfunction isDefined<T>(value: T | undefined | null): boolean {\n  return value !== undefined && value !== null;\n}\n\nexport function extractDataTotalValues(\n  data: DataRecord[],\n  opts: {\n    stack: StackType;\n    percentageThreshold: number;\n    xAxisCol: string;\n    legendState?: LegendState;\n  },\n): {\n  totalStackedValues: number[];\n  thresholdValues: number[];\n} {\n  const totalStackedValues: number[] = [];\n  const thresholdValues: number[] = [];\n  const { stack, percentageThreshold, xAxisCol, legendState } = opts;\n  if (stack) {\n    data.forEach(datum => {\n      const values = Object.keys(datum).reduce((prev, curr) => {\n        if (curr === xAxisCol) {\n          return prev;\n        }\n        if (legendState && !legendState[curr]) {\n          return prev;\n        }\n        const value = datum[curr] || 0;\n        return prev + (value as number);\n      }, 0);\n      totalStackedValues.push(values);\n      thresholdValues.push(((percentageThreshold || 0) / 100) * values);\n    });\n  }\n  return {\n    totalStackedValues,\n    thresholdValues,\n  };\n}\n\nexport function extractShowValueIndexes(\n  series: SeriesOption[],\n  opts: {\n    stack: StackType;\n    onlyTotal?: boolean;\n    isHorizontal?: boolean;\n    legendState?: LegendState;\n  },\n): number[] {\n  const showValueIndexes: number[] = [];\n  const { legendState, stack, isHorizontal, onlyTotal } = opts;\n  if (stack) {\n    series.forEach((entry, seriesIndex) => {\n      const { data = [] } = entry;\n      (data as [any, number][]).forEach((datum, dataIndex) => {\n        if (entry.id && legendState && !legendState[entry.id]) {\n          return;\n        }\n        if (!onlyTotal && datum[isHorizontal ? 0 : 1] !== null) {\n          showValueIndexes[dataIndex] = seriesIndex;\n        }\n        if (onlyTotal) {\n          if (datum[isHorizontal ? 0 : 1] > 0) {\n            showValueIndexes[dataIndex] = seriesIndex;\n          }\n          if (\n            !showValueIndexes[dataIndex] &&\n            datum[isHorizontal ? 0 : 1] !== null\n          ) {\n            showValueIndexes[dataIndex] = seriesIndex;\n          }\n        }\n      });\n    });\n  }\n  return showValueIndexes;\n}\n\nexport function sortAndFilterSeries(\n  rows: DataRecord[],\n  xAxis: string,\n  extraMetricLabels: any[],\n  sortSeriesType?: SortSeriesType,\n  sortSeriesAscending?: boolean,\n): string[] {\n  const seriesNames = Object.keys(rows[0])\n    .filter(key => key !== xAxis)\n    .filter(key => !extraMetricLabels.includes(key));\n\n  let aggregator: (name: string) => { name: string; value: any };\n\n  switch (sortSeriesType) {\n    case SortSeriesType.Sum:\n      aggregator = name => ({ name, value: sumBy(rows, name) });\n      break;\n    case SortSeriesType.Min:\n      aggregator = name => ({ name, value: minBy(rows, name)?.[name] });\n      break;\n    case SortSeriesType.Max:\n      aggregator = name => ({ name, value: maxBy(rows, name)?.[name] });\n      break;\n    case SortSeriesType.Avg:\n      aggregator = name => ({ name, value: meanBy(rows, name) });\n      break;\n    default:\n      aggregator = name => ({ name, value: name.toLowerCase() });\n      break;\n  }\n\n  const sortedValues = seriesNames.map(aggregator);\n\n  return orderBy(\n    sortedValues,\n    ['value'],\n    [sortSeriesAscending ? 'asc' : 'desc'],\n  ).map(({ name }) => name);\n}\n\nexport function sortRows(\n  rows: DataRecord[],\n  totalStackedValues: number[],\n  xAxis: string,\n  xAxisSortSeries: SortSeriesType,\n  xAxisSortSeriesAscending: boolean,\n) {\n  const sortedRows = rows.map((row, idx) => {\n    let sortKey: DataRecordValue = '';\n    let aggregate: number | undefined;\n    let entries = 0;\n    Object.entries(row).forEach(([key, value]) => {\n      const isValueDefined = isDefined(value);\n      if (key === xAxis) {\n        sortKey = value;\n      }\n      if (\n        xAxisSortSeries === SortSeriesType.Name ||\n        typeof value !== 'number'\n      ) {\n        return;\n      }\n\n      if (!(xAxisSortSeries === SortSeriesType.Avg && !isValueDefined)) {\n        entries += 1;\n      }\n\n      switch (xAxisSortSeries) {\n        case SortSeriesType.Avg:\n        case SortSeriesType.Sum:\n          if (aggregate === undefined) {\n            aggregate = value;\n          } else {\n            aggregate += value;\n          }\n          break;\n        case SortSeriesType.Min:\n          aggregate =\n            aggregate === undefined || (isValueDefined && value < aggregate)\n              ? value\n              : aggregate;\n          break;\n        case SortSeriesType.Max:\n          aggregate =\n            aggregate === undefined || (isValueDefined && value > aggregate)\n              ? value\n              : aggregate;\n          break;\n        default:\n          break;\n      }\n    });\n    if (\n      xAxisSortSeries === SortSeriesType.Avg &&\n      entries > 0 &&\n      aggregate !== undefined\n    ) {\n      aggregate /= entries;\n    }\n\n    const value =\n      xAxisSortSeries === SortSeriesType.Name\n        ? typeof sortKey === 'string'\n          ? sortKey.toLowerCase()\n          : sortKey\n        : aggregate;\n\n    return {\n      key: sortKey,\n      value,\n      row,\n      totalStackedValue: totalStackedValues[idx],\n    };\n  });\n\n  return orderBy(\n    sortedRows,\n    ['value'],\n    [xAxisSortSeriesAscending ? 'asc' : 'desc'],\n  ).map(({ row, totalStackedValue }) => ({ row, totalStackedValue }));\n}\n\nexport function extractSeries(\n  data: DataRecord[],\n  opts: {\n    fillNeighborValue?: number;\n    xAxis?: string;\n    extraMetricLabels?: string[];\n    removeNulls?: boolean;\n    stack?: StackType;\n    totalStackedValues?: number[];\n    isHorizontal?: boolean;\n    sortSeriesType?: SortSeriesType;\n    sortSeriesAscending?: boolean;\n    xAxisSortSeries?: SortSeriesType;\n    xAxisSortSeriesAscending?: boolean;\n  } = {},\n): [SeriesOption[], number[], number | undefined] {\n  const {\n    fillNeighborValue,\n    xAxis = DTTM_ALIAS,\n    extraMetricLabels = [],\n    removeNulls = false,\n    stack = false,\n    totalStackedValues = [],\n    isHorizontal = false,\n    sortSeriesType,\n    sortSeriesAscending,\n    xAxisSortSeries,\n    xAxisSortSeriesAscending,\n  } = opts;\n  if (data.length === 0) return [[], [], undefined];\n  const rows: DataRecord[] = data.map(datum => ({\n    ...datum,\n    [xAxis]: datum[xAxis],\n  }));\n  const sortedSeries = sortAndFilterSeries(\n    rows,\n    xAxis,\n    extraMetricLabels,\n    sortSeriesType,\n    sortSeriesAscending,\n  );\n  const sortedRows =\n    isDefined(xAxisSortSeries) && isDefined(xAxisSortSeriesAscending)\n      ? sortRows(\n          rows,\n          totalStackedValues,\n          xAxis,\n          xAxisSortSeries!,\n          xAxisSortSeriesAscending!,\n        )\n      : rows.map((row, idx) => ({\n          row,\n          totalStackedValue: totalStackedValues[idx],\n        }));\n\n  let minPositiveValue: number | undefined;\n  const finalSeries = sortedSeries.map(name => ({\n    id: name,\n    name,\n    data: sortedRows\n      .map(({ row, totalStackedValue }, idx) => {\n        const currentValue = row[name];\n        if (\n          typeof currentValue === 'number' &&\n          currentValue > 0 &&\n          (minPositiveValue === undefined || minPositiveValue > currentValue)\n        ) {\n          minPositiveValue = currentValue;\n        }\n        const isNextToDefinedValue =\n          isDefined(rows[idx - 1]?.[name]) || isDefined(rows[idx + 1]?.[name]);\n        const isFillNeighborValue =\n          !isDefined(currentValue) &&\n          isNextToDefinedValue &&\n          fillNeighborValue !== undefined;\n        let value: DataRecordValue | undefined = currentValue;\n        if (isFillNeighborValue) {\n          value = fillNeighborValue;\n        } else if (\n          stack === StackControlsValue.Expand &&\n          totalStackedValue !== undefined\n        ) {\n          value = ((value || 0) as number) / totalStackedValue;\n        }\n        return [row[xAxis], value];\n      })\n      .filter(obs => !removeNulls || (obs[0] !== null && obs[1] !== null))\n      .map(obs => (isHorizontal ? [obs[1], obs[0]] : obs)),\n  }));\n  return [\n    finalSeries,\n    sortedRows.map(({ totalStackedValue }) => totalStackedValue),\n    minPositiveValue,\n  ];\n}\n\nexport function formatSeriesName(\n  name: DataRecordValue | undefined,\n  {\n    numberFormatter,\n    timeFormatter,\n    coltype,\n  }: {\n    numberFormatter?: ValueFormatter;\n    timeFormatter?: TimeFormatter;\n    coltype?: GenericDataType;\n  } = {},\n): string {\n  if (name === undefined || name === null) {\n    return NULL_STRING;\n  }\n  if (typeof name === 'boolean') {\n    return name.toString();\n  }\n  if (name instanceof Date || coltype === GenericDataType.Temporal) {\n    const normalizedName =\n      typeof name === 'string' ? normalizeTimestamp(name) : name;\n    const d =\n      normalizedName instanceof Date\n        ? normalizedName\n        : new Date(normalizedName);\n\n    return timeFormatter ? timeFormatter(d) : d.toISOString();\n  }\n  if (typeof name === 'number') {\n    return numberFormatter ? numberFormatter(name) : name.toString();\n  }\n  return name;\n}\n\nexport const getColtypesMapping = ({\n  coltypes = [],\n  colnames = [],\n}: Pick<ChartDataResponseResult, 'coltypes' | 'colnames'>): Record<\n  string,\n  GenericDataType\n> =>\n  colnames.reduce(\n    (accumulator, item, index) => ({ ...accumulator, [item]: coltypes[index] }),\n    {},\n  );\n\nexport function extractGroupbyLabel({\n  datum = {},\n  groupby,\n  numberFormatter,\n  timeFormatter,\n  coltypeMapping = {},\n}: {\n  datum?: DataRecord;\n  groupby?: string[] | null;\n  numberFormatter?: NumberFormatter;\n  timeFormatter?: TimeFormatter;\n  coltypeMapping?: Record<string, GenericDataType>;\n}): string {\n  return ensureIsArray(groupby)\n    .map(val =>\n      formatSeriesName(datum[val], {\n        numberFormatter,\n        timeFormatter,\n        ...(coltypeMapping[val] && { coltype: coltypeMapping[val] }),\n      }),\n    )\n    .join(', ');\n}\n\nexport function getLegendProps(\n  type: LegendType,\n  orientation: LegendOrientation,\n  show: boolean,\n  theme: SupersetTheme,\n  zoomable = false,\n  legendState?: LegendState,\n): LegendComponentOption | LegendComponentOption[] {\n  const legend: LegendComponentOption | LegendComponentOption[] = {\n    orient: [LegendOrientation.Top, LegendOrientation.Bottom].includes(\n      orientation,\n    )\n      ? 'horizontal'\n      : 'vertical',\n    show,\n    type,\n    selected: legendState,\n    selector: ['all', 'inverse'],\n    selectorLabel: {\n      fontFamily: theme.typography.families.sansSerif,\n      fontSize: theme.typography.sizes.s,\n      color: theme.colors.grayscale.base,\n      borderColor: theme.colors.grayscale.base,\n    },\n  };\n  switch (orientation) {\n    case LegendOrientation.Left:\n      legend.left = 0;\n      break;\n    case LegendOrientation.Right:\n      legend.right = 0;\n      legend.top = zoomable ? TIMESERIES_CONSTANTS.legendRightTopOffset : 0;\n      break;\n    case LegendOrientation.Bottom:\n      legend.bottom = 0;\n      break;\n    case LegendOrientation.Top:\n    default:\n      legend.top = 0;\n      legend.right = zoomable ? TIMESERIES_CONSTANTS.legendTopRightOffset : 0;\n      break;\n  }\n  return legend;\n}\n\nexport function getChartPadding(\n  show: boolean,\n  orientation: LegendOrientation,\n  margin?: string | number | null,\n  padding?: { top?: number; bottom?: number; left?: number; right?: number },\n  isHorizontal?: boolean,\n): {\n  bottom: number;\n  left: number;\n  right: number;\n  top: number;\n} {\n  let legendMargin;\n  if (!show) {\n    legendMargin = 0;\n  } else if (\n    margin === null ||\n    margin === undefined ||\n    typeof margin === 'string'\n  ) {\n    legendMargin = defaultLegendPadding[orientation];\n  } else {\n    legendMargin = margin;\n  }\n\n  const { bottom = 0, left = 0, right = 0, top = 0 } = padding || {};\n\n  if (isHorizontal) {\n    return {\n      left:\n        left + (orientation === LegendOrientation.Bottom ? legendMargin : 0),\n      right:\n        right + (orientation === LegendOrientation.Right ? legendMargin : 0),\n      top: top + (orientation === LegendOrientation.Top ? legendMargin : 0),\n      bottom:\n        bottom + (orientation === LegendOrientation.Left ? legendMargin : 0),\n    };\n  }\n\n  return {\n    left: left + (orientation === LegendOrientation.Left ? legendMargin : 0),\n    right: right + (orientation === LegendOrientation.Right ? legendMargin : 0),\n    top: top + (orientation === LegendOrientation.Top ? legendMargin : 0),\n    bottom:\n      bottom + (orientation === LegendOrientation.Bottom ? legendMargin : 0),\n  };\n}\n\nexport function dedupSeries(series: SeriesOption[]): SeriesOption[] {\n  const counter = new Map<string, number>();\n  return series.map(row => {\n    let { id } = row;\n    if (id === undefined) return row;\n    id = String(id);\n    const count = counter.get(id) || 0;\n    const suffix = count > 0 ? ` (${count})` : '';\n    counter.set(id, count + 1);\n    return {\n      ...row,\n      id: `${id}${suffix}`,\n    };\n  });\n}\n\nexport function sanitizeHtml(text: string): string {\n  return format.encodeHTML(text);\n}\n\nexport function getAxisType(\n  stack: StackType,\n  forceCategorical?: boolean,\n  dataType?: GenericDataType,\n): AxisType {\n  if (forceCategorical) {\n    return AxisType.Category;\n  }\n  if (dataType === GenericDataType.Temporal) {\n    return AxisType.Time;\n  }\n  if (dataType === GenericDataType.Numeric && !stack) {\n    return AxisType.Value;\n  }\n  return AxisType.Category;\n}\n\nexport function getOverMaxHiddenFormatter(\n  config: {\n    max?: number;\n    formatter?: ValueFormatter;\n  } = {},\n) {\n  const { max, formatter } = config;\n  // Only apply this logic if there's a MAX set in the controls\n  const shouldHideIfOverMax = !!max || max === 0;\n\n  return new NumberFormatter({\n    formatFunc: value =>\n      `${\n        shouldHideIfOverMax && value > max\n          ? ''\n          : formatter?.format(value) || value\n      }`,\n    id: NumberFormats.OVER_MAX_HIDDEN,\n  });\n}\n\nexport function calculateLowerLogTick(minPositiveValue: number) {\n  const logBase10 = Math.floor(Math.log10(minPositiveValue));\n  return Math.pow(10, logBase10);\n}\n\ntype BoundsType = {\n  min?: number | 'dataMin';\n  max?: number | 'dataMax';\n  scale?: true;\n};\n\nexport function getMinAndMaxFromBounds(\n  axisType: AxisType,\n  truncateAxis: boolean,\n  min?: number,\n  max?: number,\n  seriesType?: EchartsTimeseriesSeriesType,\n): BoundsType | {} {\n  if (axisType === AxisType.Value && truncateAxis) {\n    const ret: BoundsType = {};\n    if (seriesType === EchartsTimeseriesSeriesType.Bar) {\n      ret.scale = true;\n    }\n    if (min !== undefined) {\n      ret.min = min;\n    } else if (seriesType !== EchartsTimeseriesSeriesType.Bar) {\n      ret.min = 'dataMin';\n    }\n    if (max !== undefined) {\n      ret.max = max;\n    } else if (seriesType !== EchartsTimeseriesSeriesType.Bar) {\n      ret.max = 'dataMax';\n    }\n    return ret;\n  }\n  return {};\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  QueryFormData,\n  DataRecord,\n  SetDataMaskHook,\n  DataRecordValue,\n  JsonObject,\n  TimeFormatter,\n  NumberFormatter,\n  QueryFormMetric,\n  QueryFormColumn,\n  TimeGranularity,\n  ContextMenuFilters,\n  Currency,\n} from '@superset-ui/core';\nimport { ColorFormatters } from '@superset-ui/chart-controls';\n\nexport interface PivotTableStylesProps {\n  height: number;\n  width: number | string;\n  margin: number;\n}\n\nexport type FilterType = Record<string, DataRecordValue>;\nexport type SelectedFiltersType = Record<string, DataRecordValue[]>;\n\nexport type DateFormatter =\n  | TimeFormatter\n  | NumberFormatter\n  | ((value: DataRecordValue) => string);\nexport enum MetricsLayoutEnum {\n  ROWS = 'ROWS',\n  COLUMNS = 'COLUMNS',\n}\n\ninterface PivotTableCustomizeProps {\n  groupbyRows: QueryFormColumn[];\n  groupbyColumns: QueryFormColumn[];\n  metrics: QueryFormMetric[];\n  tableRenderer: string;\n  colOrder: string;\n  rowOrder: string;\n  aggregateFunction: string;\n  transposePivot: boolean;\n  combineMetric: boolean;\n  rowSubtotalPosition: boolean;\n  colSubtotalPosition: boolean;\n  colTotals: boolean;\n  colSubTotals: boolean;\n  rowTotals: boolean;\n  rowSubTotals: boolean;\n  valueFormat: string;\n  currencyFormat: Currency;\n  setDataMask: SetDataMaskHook;\n  emitCrossFilters?: boolean;\n  selectedFilters?: SelectedFiltersType;\n  verboseMap: JsonObject;\n  columnFormats: JsonObject;\n  currencyFormats: Record<string, Currency>;\n  metricsLayout?: MetricsLayoutEnum;\n  metricColorFormatters: ColorFormatters;\n  dateFormatters: Record<string, DateFormatter | undefined>;\n  legacy_order_by: QueryFormMetric[] | QueryFormMetric | null;\n  order_desc: boolean;\n  onContextMenu?: (\n    clientX: number,\n    clientY: number,\n    filters?: ContextMenuFilters,\n  ) => void;\n  timeGrainSqla?: TimeGranularity;\n  time_grain_sqla?: TimeGranularity;\n  granularity_sqla?: string;\n}\n\nexport type PivotTableQueryFormData = QueryFormData &\n  PivotTableStylesProps &\n  PivotTableCustomizeProps;\n\nexport type PivotTableProps = PivotTableStylesProps &\n  PivotTableCustomizeProps & {\n    data: DataRecord[];\n  };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SetDataMaskHook } from '@superset-ui/core';\n\nexport const updateExternalFormData = (\n  setDataMask: SetDataMaskHook = () => {},\n  pageNumber: number,\n  pageSize: number,\n) =>\n  setDataMask({\n    ownState: {\n      currentPage: pageNumber,\n      pageSize,\n    },\n  });\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { formatSelectOptions } from '@superset-ui/chart-controls';\nimport { addLocaleData, t } from '@superset-ui/core';\nimport i18n from './i18n';\n\naddLocaleData(i18n);\n\nexport const PAGE_SIZE_OPTIONS = formatSelectOptions<number>([\n  [0, t('page_size.all')],\n  10,\n  20,\n  50,\n  100,\n  200,\n]);\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Locale } from '@superset-ui/core';\n\nconst en = {\n  'Query Mode': [''],\n  Aggregate: [''],\n  'Raw Records': [''],\n  'Emit Filter Events': [''],\n  'Show Cell Bars': [''],\n  'page_size.show': ['Show'],\n  'page_size.all': ['All'],\n  'page_size.entries': ['entries'],\n  'table.previous_page': ['Previous'],\n  'table.next_page': ['Next'],\n  'search.num_records': ['%s record', '%s records...'],\n};\n\nconst translations: Partial<Record<Locale, typeof en>> = {\n  en,\n  fr: {\n    'Query Mode': [''],\n    Aggregate: [''],\n    'Raw Records': [''],\n    'Emit Filter Events': [''],\n    'Show Cell Bars': [''],\n    'page_size.show': ['Afficher'],\n    'page_size.all': ['tous'],\n    'page_size.entries': ['entres'],\n    'table.previous_page': ['Prcdent'],\n    'table.next_page': ['Suivante'],\n    'search.num_records': ['%s enregistrement', '%s enregistrements...'],\n  },\n  zh: {\n    'Query Mode': [''],\n    Aggregate: [''],\n    'Raw Records': [''],\n    'Emit Filter Events': [''],\n    'Show Cell Bars': [''],\n    'page_size.show': [''],\n    'page_size.all': [''],\n    'page_size.entries': [''],\n    'table.previous_page': [''],\n    'table.next_page': [''],\n    'search.num_records': ['%s...'],\n  },\n};\n\nexport default translations;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataRecordValue,\n  normalizeTimestamp,\n  TimeFormatFunction,\n} from '@superset-ui/core';\n\n/**\n * Extended Date object with a custom formatter, and retains the original input\n * when the formatter is simple `String(..)`.\n */\nexport default class DateWithFormatter extends Date {\n  formatter: TimeFormatFunction;\n\n  input: DataRecordValue;\n\n  constructor(\n    input: DataRecordValue,\n    { formatter = String }: { formatter?: TimeFormatFunction } = {},\n  ) {\n    let value = input;\n    // assuming timestamps without a timezone is in UTC time\n    if (typeof value === 'string') {\n      value = normalizeTimestamp(value);\n    }\n\n    super(value as string);\n\n    this.input = input;\n    this.formatter = formatter;\n    this.toString = (): string => {\n      if (this.formatter === String) {\n        return String(this.input);\n      }\n      return this.formatter ? this.formatter(this) : Date.toString.call(this);\n    };\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useContext, useEffect, useReducer } from 'react';\nimport {\n  ChartMetadata,\n  defineSharedModules,\n  isFeatureEnabled,\n  FeatureFlag,\n  getChartMetadataRegistry,\n  logging,\n  makeApi,\n} from '@superset-ui/core';\nimport { omitBy } from 'lodash';\n\nconst metadataRegistry = getChartMetadataRegistry();\n\nexport type PluginContextType = {\n  loading: boolean;\n  /** These are actually only the dynamic plugins */\n  dynamicPlugins: {\n    [key: string]: {\n      key: string;\n      mounting: boolean;\n      error: null | Error;\n    };\n  };\n  keys: string[];\n  /** Mounted means the plugin's js bundle has been imported */\n  mountedPluginMetadata: Record<string, ChartMetadata>;\n  fetchAll: () => void;\n};\n\nconst dummyPluginContext: PluginContextType = {\n  loading: true,\n  dynamicPlugins: {},\n  keys: [],\n  mountedPluginMetadata: {},\n  fetchAll: () => {},\n};\n\n/**\n * It is highly recommended to use the usePluginContext hook instead.\n * @see usePluginContext\n */\nexport const PluginContext = React.createContext(dummyPluginContext);\n\n/**\n * The plugin context provides info about what dynamic plugins are available.\n * It also provides loading info for the plugins' javascript bundles.\n *\n * Note: This does not include any information about static plugins.\n * Those are compiled into the Superset bundle at build time.\n * Dynamic plugins are added by the end user and can be any webhosted javascript.\n */\nexport const usePluginContext = () => useContext(PluginContext);\n\n// the plugin returned from the API\ntype Plugin = {\n  name: string;\n  key: string;\n  bundle_url: string;\n  id: number;\n};\n\n// when a plugin completes loading\ntype CompleteAction = {\n  type: 'complete';\n  key: string;\n  error: null | Error;\n};\n\n// when plugins start loading\ntype BeginAction = {\n  type: 'begin';\n  keys: string[];\n};\n\ntype ChangedKeysAction = {\n  type: 'changed keys';\n};\n\ntype PluginAction = BeginAction | CompleteAction | ChangedKeysAction;\n\nfunction getRegistryData() {\n  return {\n    keys: metadataRegistry.keys(),\n    mountedPluginMetadata: omitBy(\n      metadataRegistry.getMap(),\n      value => value === undefined,\n    ) as Record<string, ChartMetadata>, // cast required to get rid of undefined values\n  };\n}\n\nfunction pluginContextReducer(\n  state: PluginContextType,\n  action: PluginAction,\n): PluginContextType {\n  switch (action.type) {\n    case 'begin': {\n      const plugins = { ...state.dynamicPlugins };\n      action.keys.forEach(key => {\n        plugins[key] = { key, error: null, mounting: true };\n      });\n      return {\n        ...state,\n        loading: action.keys.length > 0,\n        dynamicPlugins: plugins,\n      };\n    }\n    case 'complete': {\n      return {\n        ...state,\n        loading: Object.values(state.dynamicPlugins).some(\n          plugin => plugin.mounting && plugin.key !== action.key,\n        ),\n        dynamicPlugins: {\n          ...state.dynamicPlugins,\n          [action.key]: {\n            key: action.key,\n            mounting: false,\n            error: action.error,\n          },\n        },\n      };\n    }\n    case 'changed keys': {\n      return {\n        ...state,\n        ...getRegistryData(),\n      };\n    }\n    default:\n      return state;\n  }\n}\n\nconst pluginApi = makeApi<{}, { result: Plugin[] }>({\n  method: 'GET',\n  endpoint: '/dynamic-plugins/api/read',\n});\n\nconst sharedModules = {\n  react: () => import('react'),\n  lodash: () => import('lodash'),\n  'react-dom': () => import('react-dom'),\n  '@superset-ui/chart-controls': () => import('@superset-ui/chart-controls'),\n  '@superset-ui/core': () => import('@superset-ui/core'),\n};\n\nexport const DynamicPluginProvider: React.FC = ({ children }) => {\n  const [pluginState, dispatch] = useReducer(\n    pluginContextReducer,\n    dummyPluginContext,\n    state => ({\n      ...state,\n      ...getRegistryData(),\n      // eslint-disable-next-line @typescript-eslint/no-use-before-define\n      fetchAll,\n      loading: isFeatureEnabled(FeatureFlag.DynamicPlugins),\n      // TODO: Write fetchByKeys\n    }),\n  );\n\n  // For now, we fetch all the plugins at the same time.\n  // In the future it would be nice to fetch on an as-needed basis.\n  // That will most likely depend on having a json manifest for each plugin.\n  async function fetchAll() {\n    try {\n      await defineSharedModules(sharedModules);\n      const { result: plugins } = await pluginApi({});\n      dispatch({ type: 'begin', keys: plugins.map(plugin => plugin.key) });\n      await Promise.all(\n        plugins.map(async plugin => {\n          let error: Error | null = null;\n          try {\n            await import(/* webpackIgnore: true */ plugin.bundle_url);\n          } catch (err) {\n            logging.error(\n              `Failed to load plugin ${plugin.key} with the following error:`,\n              err.stack,\n            );\n            error = err;\n          }\n          dispatch({\n            type: 'complete',\n            key: plugin.key,\n            error,\n          });\n        }),\n      );\n    } catch (error) {\n      logging.error('Failed to load dynamic plugins', error.stack || error);\n    }\n  }\n\n  useEffect(() => {\n    if (isFeatureEnabled(FeatureFlag.DynamicPlugins)) {\n      fetchAll();\n    }\n    const registryListener = () => {\n      dispatch({ type: 'changed keys' });\n    };\n    metadataRegistry.addListener(registryListener);\n    return () => {\n      metadataRegistry.removeListener(registryListener);\n    };\n  }, []);\n\n  return (\n    <PluginContext.Provider value={pluginState}>\n      {children}\n    </PluginContext.Provider>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport ErrorMessageWithStackTrace from 'src/components/ErrorMessage/ErrorMessageWithStackTrace';\n\nexport interface ErrorBoundaryProps {\n  children: React.ReactNode;\n  onError?: (error: Error, info: React.ErrorInfo) => void;\n  showMessage?: boolean;\n}\n\ninterface ErrorBoundaryState {\n  error: Error | null;\n  info: React.ErrorInfo | null;\n}\n\nexport default class ErrorBoundary extends React.Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  static defaultProps: Partial<ErrorBoundaryProps> = {\n    showMessage: true,\n  };\n\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { error: null, info: null };\n  }\n\n  componentDidCatch(error: Error, info: React.ErrorInfo): void {\n    this.props.onError?.(error, info);\n    this.setState({ error, info });\n  }\n\n  render() {\n    const { error, info } = this.state;\n    if (error) {\n      const firstLine = error.toString();\n      const messageString = `${t('Unexpected error')}${\n        firstLine ? `: ${firstLine}` : ''\n      }`;\n      const messageElement = (\n        <span>\n          <strong>{t('Unexpected error')}</strong>\n          {firstLine ? `: ${firstLine}` : ''}\n        </span>\n      );\n\n      if (this.props.showMessage) {\n        return (\n          <ErrorMessageWithStackTrace\n            subtitle={messageElement}\n            copyText={messageString}\n            stackTrace={info?.componentStack}\n          />\n        );\n      }\n      return null;\n    }\n    return this.props.children;\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { styled, css, SupersetTheme } from '@superset-ui/core';\nimport cx from 'classnames';\nimport { Interweave } from 'interweave';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport Icons from 'src/components/Icons';\nimport { ToastType, ToastMeta } from './types';\n\nconst ToastContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  span {\n    padding: 0 11px;\n  }\n`;\n\nconst StyledIcon = (theme: SupersetTheme) => css`\n  min-width: ${theme.gridUnit * 5}px;\n  color: ${theme.colors.grayscale.base};\n`;\n\ninterface ToastPresenterProps {\n  toast: ToastMeta;\n  onCloseToast: (id: string) => void;\n}\n\nexport default function Toast({ toast, onCloseToast }: ToastPresenterProps) {\n  const hideTimer = useRef<ReturnType<typeof setTimeout>>();\n  const [visible, setVisible] = useState(false);\n  const showToast = () => {\n    setVisible(true);\n  };\n\n  const handleClosePress = useCallback(() => {\n    if (hideTimer.current) {\n      clearTimeout(hideTimer.current);\n    }\n    // Wait for the transition\n    setVisible(() => {\n      setTimeout(() => {\n        onCloseToast(toast.id);\n      }, 150);\n      return false;\n    });\n  }, [onCloseToast, toast.id]);\n\n  useEffect(() => {\n    setTimeout(showToast);\n\n    if (toast.duration > 0) {\n      hideTimer.current = setTimeout(handleClosePress, toast.duration);\n    }\n    return () => {\n      if (hideTimer.current) {\n        clearTimeout(hideTimer.current);\n      }\n    };\n  }, [handleClosePress, toast.duration]);\n\n  let className = 'toast--success';\n  let icon = <Icons.CircleCheckSolid css={theme => StyledIcon(theme)} />;\n\n  if (toast.toastType === ToastType.Warning) {\n    icon = <Icons.WarningSolid css={StyledIcon} />;\n    className = 'toast--warning';\n  } else if (toast.toastType === ToastType.Danger) {\n    icon = <Icons.ErrorSolid css={StyledIcon} />;\n    className = 'toast--danger';\n  } else if (toast.toastType === ToastType.Info) {\n    icon = <Icons.InfoSolid css={StyledIcon} />;\n    className = 'toast--info';\n  }\n\n  return (\n    <ToastContainer\n      className={cx('alert', 'toast', visible && 'toast--visible', className)}\n      data-test=\"toast-container\"\n      role=\"alert\"\n    >\n      {icon}\n      <Interweave content={toast.text} noHtml={!toast.allowHtml} />\n      <i\n        className=\"fa fa-close pull-right pointer\"\n        role=\"button\"\n        tabIndex={0}\n        onClick={handleClosePress}\n        aria-label=\"Close\"\n        data-test=\"close-button\"\n      />\n    </ToastContainer>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { styled } from '@superset-ui/core';\nimport { ToastMeta } from 'src/components/MessageToasts/types';\nimport Toast from './Toast';\n\nexport interface VisualProps {\n  position: 'bottom' | 'top';\n}\n\nconst StyledToastPresenter = styled.div<VisualProps>`\n  max-width: 600px;\n  position: fixed;\n  ${({ position }) => (position === 'bottom' ? 'bottom' : 'top')}: 0px;\n  right: 0px;\n  margin-right: 50px;\n  margin-bottom: 50px;\n  z-index: ${({ theme }) => theme.zIndex.max};\n  word-break: break-word;\n\n  .toast {\n    background: ${({ theme }) => theme.colors.grayscale.dark1};\n    border-radius: ${({ theme }) => theme.borderRadius};\n    box-shadow: 0 2px 4px 0\n      fade(\n        ${({ theme }) => theme.colors.grayscale.dark2},\n        ${({ theme }) => theme.opacity.mediumLight}\n      );\n    color: ${({ theme }) => theme.colors.grayscale.light5};\n    opacity: 0;\n    position: relative;\n    transform: translateY(-100%);\n    white-space: pre-line;\n    will-change: transform, opacity;\n    transition:\n      transform ${({ theme }) => theme.transitionTiming}s,\n      opacity ${({ theme }) => theme.transitionTiming}s;\n\n    &:after {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 6px;\n      height: 100%;\n    }\n  }\n\n  .toast > button {\n    color: ${({ theme }) => theme.colors.grayscale.light5};\n    opacity: 1;\n  }\n\n  .toast--visible {\n    opacity: 1;\n    transform: translateY(0);\n  }\n`;\n\ntype ToastPresenterProps = Partial<VisualProps> & {\n  toasts: Array<ToastMeta>;\n  removeToast: () => any;\n};\n\nexport default function ToastPresenter({\n  toasts,\n  removeToast,\n  position = 'bottom',\n}: ToastPresenterProps) {\n  return (\n    <>\n      {toasts.length > 0 && (\n        <StyledToastPresenter id=\"toast-presenter\" position={position}>\n          {toasts.map(toast => (\n            <Toast key={toast.id} toast={toast} onCloseToast={removeToast} />\n          ))}\n        </StyledToastPresenter>\n      )}\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport ToastPresenter from './ToastPresenter';\n\nimport { removeToast } from './actions';\n\nconst ToastContainer = connect(\n  ({ messageToasts: toasts }: any) => ({ toasts }),\n  dispatch => bindActionCreators({ removeToast }, dispatch),\n)(ToastPresenter);\n\nexport default ToastContainer;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport enum SingleValueType {\n  Minimum,\n  Exact,\n  Maximum,\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { getNumberFormatter } from '@superset-ui/core';\nimport { getFormattedUTCTime } from './utils';\n\nexport default function transformProps(chartProps) {\n  const { height, formData, queriesData, datasource } = chartProps;\n  const {\n    cellPadding,\n    cellRadius,\n    cellSize,\n    domainGranularity,\n    linearColorScheme,\n    showLegend,\n    showMetricName,\n    showValues,\n    steps,\n    subdomainGranularity,\n    xAxisTimeFormat,\n    yAxisFormat,\n  } = formData;\n\n  const { verboseMap } = datasource;\n  const timeFormatter = ts => getFormattedUTCTime(ts, xAxisTimeFormat);\n  const valueFormatter = getNumberFormatter(yAxisFormat);\n\n  return {\n    height,\n    data: queriesData[0].data,\n    cellPadding,\n    cellRadius,\n    cellSize,\n    domainGranularity,\n    linearColorScheme,\n    showLegend,\n    showMetricName,\n    showValues,\n    steps,\n    subdomainGranularity,\n    timeFormatter,\n    valueFormatter,\n    verboseMap,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { getTimeFormatter } from '@superset-ui/core';\n\n// Assume that given timestamp is UTC\nexport const getFormattedUTCTime = (\n  ts: number | string,\n  timeFormat?: string,\n) => {\n  const date = new Date(ts);\n  const offset = date.getTimezoneOffset() * 60 * 1000;\n  return getTimeFormatter(timeFormat)(date.getTime() - offset);\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, legacyValidateInteger } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  D3_FORMAT_DOCS,\n  D3_TIME_FORMAT_OPTIONS,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Time'),\n      expanded: true,\n      description: t('Time related form attributes'),\n      controlSetRows: [['granularity_sqla'], ['time_range']],\n    },\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'domain_granularity',\n            config: {\n              type: 'SelectControl',\n              label: t('Domain'),\n              default: 'month',\n              choices: [\n                ['hour', t('hour')],\n                ['day', t('day')],\n                ['week', t('week')],\n                ['month', t('month')],\n                ['year', t('year')],\n              ],\n              description: t('The time unit used for the grouping of blocks'),\n            },\n          },\n          {\n            name: 'subdomain_granularity',\n            config: {\n              type: 'SelectControl',\n              label: t('Subdomain'),\n              default: 'day',\n              choices: [\n                ['min', t('min')],\n                ['hour', t('hour')],\n                ['day', t('day')],\n                ['week', t('week')],\n                ['month', t('month')],\n              ],\n              description: t(\n                'The time unit for each block. Should be a smaller unit than ' +\n                  'domain_granularity. Should be larger or equal to Time Grain',\n              ),\n            },\n          },\n        ],\n        ['metrics'],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      tabOverride: 'customize',\n      controlSetRows: [\n        ['linear_color_scheme'],\n        [\n          {\n            name: 'cell_size',\n            config: {\n              type: 'TextControl',\n              isInt: true,\n              default: 10,\n              validators: [legacyValidateInteger],\n              renderTrigger: true,\n              label: t('Cell Size'),\n              description: t('The size of the square cell, in pixels'),\n            },\n          },\n          {\n            name: 'cell_padding',\n            config: {\n              type: 'TextControl',\n              isInt: true,\n              validators: [legacyValidateInteger],\n              renderTrigger: true,\n              default: 2,\n              label: t('Cell Padding'),\n              description: t('The distance between cells, in pixels'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'cell_radius',\n            config: {\n              type: 'TextControl',\n              isInt: true,\n              validators: [legacyValidateInteger],\n              renderTrigger: true,\n              default: 0,\n              label: t('Cell Radius'),\n              description: t('The pixel radius'),\n            },\n          },\n          {\n            name: 'steps',\n            config: {\n              type: 'TextControl',\n              isInt: true,\n              validators: [legacyValidateInteger],\n              renderTrigger: true,\n              default: 10,\n              label: t('Color Steps'),\n              description: t('The number color \"steps\"'),\n            },\n          },\n        ],\n        [\n          'y_axis_format',\n          {\n            name: 'x_axis_time_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Time Format'),\n              renderTrigger: true,\n              default: 'smart_date',\n              choices: D3_TIME_FORMAT_OPTIONS,\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_legend',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Legend'),\n              renderTrigger: true,\n              default: true,\n              description: t('Whether to display the legend (toggles)'),\n            },\n          },\n          {\n            name: 'show_values',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Values'),\n              renderTrigger: true,\n              default: false,\n              description: t(\n                'Whether to display the numerical values within the cells',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_metric_name',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Metric Names'),\n              renderTrigger: true,\n              default: true,\n              description: t('Whether to display the metric name as a title'),\n            },\n          },\n          null,\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    y_axis_format: {\n      label: t('Number Format'),\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport example from './images/example.jpg';\nimport controlPanel from './controlPanel';\nimport thumbnail from './images/thumbnail.png';\n\nconst metadata = new ChartMetadata({\n  category: t('Correlation'),\n  credits: ['https://github.com/wa0x6e/cal-heatmap'],\n  description: t(\n    \"Visualizes how a metric has changed over a time using a color scale and a calendar view. Gray values are used to indicate missing values and the linear color scheme is used to encode the magnitude of each day's value.\",\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('Calendar Heatmap'),\n  tags: [\n    t('Business'),\n    t('Comparison'),\n    t('Intensity'),\n    t('Pattern'),\n    t('Report'),\n    t('Trend'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class CalendarChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactCalendar'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function transformProps(chartProps) {\n  const { width, height, formData, queriesData } = chartProps;\n  const { yAxisFormat, colorScheme, sliceId } = formData;\n\n  return {\n    colorScheme,\n    data: queriesData[0].data,\n    height,\n    numberFormat: yAxisFormat,\n    width,\n    sliceId,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ensureIsArray, t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['groupby'],\n        ['columns'],\n        ['metric'],\n        ['adhoc_filters'],\n        ['row_limit'],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [['y_axis_format', null], ['color_scheme']],\n    },\n  ],\n  controlOverrides: {\n    y_axis_format: {\n      label: t('Number format'),\n      description: t('Choose a number format'),\n    },\n    groupby: {\n      label: t('Source'),\n      multi: false,\n      validators: [validateNonEmpty],\n      description: t('Choose a source'),\n    },\n    columns: {\n      label: t('Target'),\n      multi: false,\n      validators: [validateNonEmpty],\n      description: t('Choose a target'),\n    },\n  },\n  formDataOverrides: formData => {\n    const groupby = getStandardizedControls()\n      .popAllColumns()\n      .filter(col => !ensureIsArray(formData.columns).includes(col));\n    return {\n      ...formData,\n      groupby,\n      metric: getStandardizedControls().shiftMetric(),\n    };\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport example from './images/chord.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Flow'),\n  credits: ['https://github.com/d3/d3-chord'],\n  description: t(\n    'Showcases the flow or link between categories using thickness of chords. The value and corresponding thickness can be different for each side.',\n  ),\n  exampleGallery: [\n    { url: example, caption: t('Relationships between community channels') },\n  ],\n  name: t('Chord Diagram'),\n  tags: [\n    t('Aesthetic'),\n    t('Circular'),\n    t('Legacy'),\n    t('Proportional'),\n    t('Relational'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class ChordChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactChord'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function transformProps(chartProps) {\n  const { width, height, formData, queriesData } = chartProps;\n  const {\n    linearColorScheme,\n    numberFormat,\n    selectCountry,\n    colorScheme,\n    sliceId,\n  } = formData;\n\n  return {\n    width,\n    height,\n    data: queriesData[0].data,\n    country: selectCountry ? String(selectCountry).toLowerCase() : null,\n    linearColorScheme,\n    numberFormat,\n    colorScheme,\n    sliceId,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  D3_FORMAT_OPTIONS,\n  D3_FORMAT_DOCS,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { countryOptions } from './countries';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'select_country',\n            config: {\n              type: 'SelectControl',\n              label: t('Country'),\n              default: null,\n              choices: countryOptions,\n              description: t('Which country to plot the map for?'),\n              validators: [validateNonEmpty],\n            },\n          },\n        ],\n        ['entity'],\n        ['metric'],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      tabOverride: 'customize',\n      controlSetRows: [\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: 'SMART_NUMBER',\n              choices: D3_FORMAT_OPTIONS,\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n        ['linear_color_scheme'],\n      ],\n    },\n  ],\n  controlOverrides: {\n    entity: {\n      label: t('ISO 3166-2 Codes'),\n      description: t(\n        'Column containing ISO 3166-2 codes of region/province/department in your table.',\n      ),\n    },\n    metric: {\n      label: t('Metric'),\n      description: t('Metric to display bottom title'),\n    },\n    linear_color_scheme: {\n      renderTrigger: false,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    entity: getStandardizedControls().shiftColumn(),\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport exampleUsa from './images/exampleUsa.jpg';\nimport exampleGermany from './images/exampleGermany.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://bl.ocks.org/john-guerra'],\n  description: t(\n    \"Visualizes how a single metric varies across a country's principal subdivisions (states, provinces, etc) on a choropleth map. Each subdivision's value is elevated when you hover over the corresponding geographic boundary.\",\n  ),\n  exampleGallery: [{ url: exampleUsa }, { url: exampleGermany }],\n  name: t('Country Map'),\n  tags: [\n    t('2D'),\n    t('Comparison'),\n    t('Geo'),\n    t('Range'),\n    t('Report'),\n    t('Stacked'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class CountryMapChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactCountryMap'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n\nexport { default as countries } from './countries';\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  columnChoices,\n  ColumnOption,\n  ColumnMeta,\n  ControlPanelConfig,\n  ControlState,\n  formatSelectOptionsForRange,\n  SelectControlConfig,\n} from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Event definition'),\n      controlSetRows: [\n        ['entity'],\n        [\n          {\n            name: 'all_columns_x',\n            config: {\n              type: 'SelectControl',\n              label: t('Event Names'),\n              description: t('Columns to display'),\n              mapStateToProps: state => ({\n                choices: columnChoices(state?.datasource),\n              }),\n              // choices is from `mapStateToProps`\n              default: (control: ControlState) =>\n                control.choices?.[0]?.[0] || null,\n              validators: [validateNonEmpty],\n            },\n          },\n        ],\n        ['row_limit'],\n        [\n          {\n            name: 'order_by_entity',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Order by entity id'),\n              description: t(\n                'Important! Select this if the table is not already sorted by entity id, ' +\n                  'else there is no guarantee that all events for each entity are returned.',\n              ),\n              default: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'min_leaf_node_event_count',\n            config: {\n              type: 'SelectControl',\n              freeForm: false,\n              label: t('Minimum leaf node event count'),\n              default: 1,\n              choices: formatSelectOptionsForRange(1, 10),\n              description: t(\n                'Leaf nodes that represent fewer than this number of events will be initially ' +\n                  'hidden in the visualization',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [['adhoc_filters']],\n    },\n    {\n      label: t('Additional metadata'),\n      controlSetRows: [\n        [\n          {\n            name: 'all_columns',\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            config: {\n              type: 'SelectControl',\n              multi: true,\n              label: t('Metadata'),\n              default: [],\n              description: t('Select any columns for metadata inspection'),\n              optionRenderer: c => <ColumnOption showType column={c} />,\n              valueRenderer: c => <ColumnOption column={c} />,\n              valueKey: 'column_name',\n              allowAll: true,\n              mapStateToProps: state => ({\n                options: state.datasource?.columns || [],\n              }),\n              commaChoosesOption: false,\n              freeForm: true,\n            } as SelectControlConfig<ColumnMeta>,\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    entity: {\n      label: t('Entity ID'),\n      description: t('e.g., a \"user id\" column'),\n    },\n    row_limit: {\n      label: t('Max Events'),\n      description: t(\n        'The maximum number of events to return, equivalent to the number of rows',\n      ),\n    },\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Flow'),\n  credits: ['https://github.com/williaster/data-ui'],\n  description: t(\n    'Compares the lengths of time different activities take in a shared timeline view.',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('Event Flow'),\n  tags: [t('Legacy'), t('Progressive')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class EventFlowChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./EventFlow'),\n      loadTransformProps: () => import('./transformProps'),\n      metadata,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  GenericDataType,\n  getTimeFormatter,\n  getValueFormatter,\n} from '@superset-ui/core';\n\nexport default function transformProps(chartProps) {\n  const { width, height, formData, queriesData, datasource } = chartProps;\n  const {\n    bottomMargin,\n    canvasImageRendering,\n    allColumnsX,\n    allColumnsY,\n    linearColorScheme,\n    leftMargin,\n    metric,\n    normalized,\n    showLegend,\n    showPerc,\n    showValues,\n    sortXAxis,\n    sortYAxis,\n    xscaleInterval,\n    yscaleInterval,\n    yAxisBounds,\n    yAxisFormat,\n    timeFormat,\n    currencyFormat,\n  } = formData;\n  const { data = [], coltypes = [] } = queriesData[0];\n  const { columnFormats = {}, currencyFormats = {} } = datasource;\n  const valueFormatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    yAxisFormat,\n    currencyFormat,\n  );\n  const xAxisFormatter =\n    coltypes[0] === GenericDataType.Temporal\n      ? getTimeFormatter(timeFormat)\n      : coltypes[0] === GenericDataType.Numeric\n        ? Number\n        : String;\n  const yAxisFormatter =\n    coltypes[1] === GenericDataType.Temporal\n      ? getTimeFormatter(timeFormat)\n      : coltypes[1] === GenericDataType.Numeric\n        ? Number\n        : String;\n  return {\n    width,\n    height,\n    data,\n    bottomMargin,\n    canvasImageRendering,\n    colorScheme: linearColorScheme,\n    columnX: allColumnsX,\n    columnY: allColumnsY,\n    leftMargin,\n    metric,\n    normalized,\n    showLegend,\n    showPercentage: showPerc,\n    showValues,\n    sortXAxis,\n    sortYAxis,\n    xScaleInterval: parseInt(xscaleInterval, 10),\n    yScaleInterval: parseInt(yscaleInterval, 10),\n    yAxisBounds,\n    valueFormatter,\n    xAxisFormatter,\n    yAxisFormatter,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  formatSelectOptionsForRange,\n  sharedControls,\n  getStandardizedControls,\n  D3_TIME_FORMAT_DOCS,\n} from '@superset-ui/chart-controls';\n\nconst sortAxisChoices = [\n  ['alpha_asc', t('Axis ascending')],\n  ['alpha_desc', t('Axis descending')],\n  ['value_asc', t('Metric ascending')],\n  ['value_desc', t('Metric descending')],\n];\n\nconst dndAllColumns = {\n  ...sharedControls.entity,\n  description: t('Columns to display'),\n};\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'all_columns_x',\n            config: {\n              ...dndAllColumns,\n              label: t('X Axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'all_columns_y',\n            config: {\n              ...dndAllColumns,\n              label: t('Y Axis'),\n            },\n          },\n        ],\n        ['metric'],\n        ['adhoc_filters'],\n        ['row_limit'],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Heatmap Options'),\n      expanded: true,\n      tabOverride: 'customize',\n      controlSetRows: [\n        ['linear_color_scheme'],\n        [\n          {\n            name: 'xscale_interval',\n            config: {\n              type: 'SelectControl',\n              label: t('XScale Interval'),\n              renderTrigger: true,\n              choices: formatSelectOptionsForRange(1, 50),\n              default: 1,\n              clearable: false,\n              description: t(\n                'Number of steps to take between ticks when displaying the X scale',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'yscale_interval',\n            config: {\n              type: 'SelectControl',\n              label: t('YScale Interval'),\n              choices: formatSelectOptionsForRange(1, 50),\n              default: 1,\n              clearable: false,\n              renderTrigger: true,\n              description: t(\n                'Number of steps to take between ticks when displaying the Y scale',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'canvas_image_rendering',\n            config: {\n              type: 'SelectControl',\n              label: t('Rendering'),\n              renderTrigger: true,\n              choices: [\n                ['pixelated', t('pixelated (Sharp)')],\n                ['auto', t('auto (Smooth)')],\n              ],\n              default: 'pixelated',\n              description: t(\n                'image-rendering CSS attribute of the canvas object that ' +\n                  'defines how the browser scales up the image',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'normalize_across',\n            config: {\n              type: 'SelectControl',\n              label: t('Normalize Across'),\n              choices: [\n                ['heatmap', t('heatmap')],\n                ['x', t('x')],\n                ['y', t('y')],\n              ],\n              default: 'heatmap',\n              description: (\n                <>\n                  <div>\n                    {t(\n                      'Color will be shaded based the normalized (0% to 100%) value of a given cell against the other cells in the selected range: ',\n                    )}\n                  </div>\n                  <ul>\n                    <li>{t('x: values are normalized within each column')}</li>\n                    <li>{t('y: values are normalized within each row')}</li>\n                    <li>\n                      {t(\n                        'heatmap: values are normalized across the entire heatmap',\n                      )}\n                    </li>\n                  </ul>\n                </>\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'left_margin',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              clearable: false,\n              label: t('Left Margin'),\n              choices: [\n                ['auto', t('auto')],\n                [50, '50'],\n                [75, '75'],\n                [100, '100'],\n                [125, '125'],\n                [150, '150'],\n                [200, '200'],\n              ],\n              default: 'auto',\n              renderTrigger: true,\n              description: t(\n                'Left margin, in pixels, allowing for more room for axis labels',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'bottom_margin',\n            config: {\n              type: 'SelectControl',\n              clearable: false,\n              freeForm: true,\n              label: t('Bottom Margin'),\n              choices: [\n                ['auto', t('auto')],\n                [50, '50'],\n                [75, '75'],\n                [100, '100'],\n                [125, '125'],\n                [150, '150'],\n                [200, '200'],\n              ],\n              default: 'auto',\n              renderTrigger: true,\n              description: t(\n                'Bottom margin, in pixels, allowing for more room for axis labels',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Value bounds'),\n              renderTrigger: true,\n              default: [null, null],\n              description: t(\n                'Hard value bounds applied for color coding. Is only relevant ' +\n                  'and applied when the normalization is applied against the whole heatmap.',\n              ),\n            },\n          },\n        ],\n        ['y_axis_format'],\n        [\n          {\n            name: 'time_format',\n            config: {\n              ...sharedControls.x_axis_time_format,\n              default: '%d/%m/%Y',\n              description: `${D3_TIME_FORMAT_DOCS}.`,\n            },\n          },\n        ],\n        ['currency_format'],\n        [\n          {\n            name: 'sort_x_axis',\n            config: {\n              type: 'SelectControl',\n              label: t('Sort X Axis'),\n              choices: sortAxisChoices,\n              clearable: false,\n              default: 'alpha_asc',\n            },\n          },\n        ],\n        [\n          {\n            name: 'sort_y_axis',\n            config: {\n              type: 'SelectControl',\n              label: t('Sort Y Axis'),\n              choices: sortAxisChoices,\n              clearable: false,\n              default: 'alpha_asc',\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_legend',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Legend'),\n              renderTrigger: true,\n              default: true,\n              description: t('Whether to display the legend (toggles)'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_perc',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show percentage'),\n              renderTrigger: true,\n              description: t(\n                'Whether to include the percentage in the tooltip',\n              ),\n              default: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_values',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Values'),\n              renderTrigger: true,\n              default: false,\n              description: t(\n                'Whether to display the numerical values within the cells',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'normalized',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Normalized'),\n              renderTrigger: true,\n              description: t(\n                'Whether to apply a normal distribution based on rank on the color scale',\n              ),\n              default: false,\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    y_axis_format: {\n      label: t('Value Format'),\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport transportation from './images/transportation.jpg';\nimport channels from './images/channels.jpg';\nimport employment from './images/employment.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Correlation'),\n  credits: ['http://bl.ocks.org/mbostock/3074470'],\n  description: t(\n    'Visualize a related metric across pairs of groups. Heatmaps excel at showcasing the correlation or strength between two groups. Color is used to emphasize the strength of the link between each pair of groups.',\n  ),\n  exampleGallery: [\n    { url: transportation, caption: t('Sizes of vehicles') },\n    { url: channels, caption: t('Relationships between community channels') },\n    { url: employment, caption: t('Employment and education') },\n  ],\n  name: t('Heatmap'),\n  tags: [\n    t('Business'),\n    t('Intensity'),\n    t('Legacy'),\n    t('Density'),\n    t('Predictive'),\n    t('Single Metric'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class HeatmapChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactHeatmap'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function transformProps(chartProps) {\n  const { width, height, formData, queriesData } = chartProps;\n  const {\n    colorScheme,\n    linkLength,\n    normalized,\n    cumulative,\n    globalOpacity,\n    xAxisLabel,\n    yAxisLabel,\n    showLegend,\n    sliceId,\n  } = formData;\n\n  return {\n    width,\n    height,\n    data: queriesData[0].data,\n    binCount: parseInt(linkLength, 10),\n    colorScheme,\n    normalized,\n    cumulative,\n    opacity: globalOpacity,\n    xAxisLabel,\n    yAxisLabel,\n    showLegend,\n    sliceId,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  columnChoices,\n  ControlPanelConfig,\n  ControlPanelState,\n  formatSelectOptions,\n  getStandardizedControls,\n  sharedControls,\n  ControlState,\n} from '@superset-ui/chart-controls';\n\nconst columnsConfig = {\n  ...sharedControls.columns,\n  label: t('Columns'),\n  description: t('Select the numeric columns to draw the histogram'),\n  mapStateToProps: (state: ControlPanelState, controlState: ControlState) => ({\n    ...(sharedControls.columns.mapStateToProps?.(state, controlState) || {}),\n    choices: columnChoices(state.datasource),\n  }),\n  validators: [validateNonEmpty],\n};\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'all_columns_x',\n            config: columnsConfig,\n          },\n        ],\n        ['adhoc_filters'],\n        ['row_limit'],\n        ['groupby'],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        [\n          {\n            name: 'link_length',\n            config: {\n              type: 'SelectControl',\n              renderTrigger: true,\n              freeForm: true,\n              label: t('No of Bins'),\n              default: 5,\n              choices: formatSelectOptions([\n                '10',\n                '25',\n                '50',\n                '75',\n                '100',\n                '150',\n                '200',\n                '250',\n              ]),\n              description: t('Select the number of bins for the histogram'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'x_axis_label',\n            config: {\n              type: 'TextControl',\n              label: t('X Axis Label'),\n              renderTrigger: true,\n              default: '',\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_label',\n            config: {\n              type: 'TextControl',\n              label: t('Y Axis Label'),\n              renderTrigger: true,\n              default: '',\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_legend',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Legend'),\n              renderTrigger: true,\n              default: true,\n              description: t('Whether to display the legend (toggles)'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'normalized',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Normalized'),\n              renderTrigger: true,\n              description: t('Whether to normalize the histogram'),\n              default: false,\n            },\n          },\n        ],\n        [\n          {\n            name: 'cumulative',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Cumulative'),\n              renderTrigger: true,\n              description: t('Whether to make the histogram cumulative'),\n              default: false,\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport example1 from './images/example1.jpg';\nimport example2 from './images/example2.jpg';\nimport example3 from './images/example3.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Distribution'),\n  description: t(\n    'Take your data points, and group them into \"bins\" to see where the densest areas of information lie',\n  ),\n  exampleGallery: [\n    { url: example1, caption: t('Population age data') },\n    { url: example2 },\n    { url: example3 },\n  ],\n  name: t('Histogram'),\n  tags: [t('Comparison'), t('Legacy'), t('Pattern'), t('Range')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class HistogramChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Histogram'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function transformProps(chartProps) {\n  const { height, width, formData, queriesData } = chartProps;\n  const { horizonColorScale, seriesHeight } = formData;\n\n  return {\n    colorScale: horizonColorScale,\n    data: queriesData[0].data,\n    height,\n    seriesHeight: parseInt(seriesHeight, 10),\n    width,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  formatSelectOptions,\n} from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['metrics'],\n        ['adhoc_filters'],\n        ['groupby'],\n        ['limit', 'timeseries_limit_metric'],\n        ['order_desc'],\n        [\n          {\n            name: 'contribution',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Contribution'),\n              default: false,\n              description: t('Compute the contribution to the total'),\n            },\n          },\n        ],\n        ['row_limit', null],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'series_height',\n            config: {\n              type: 'SelectControl',\n              renderTrigger: true,\n              freeForm: true,\n              label: t('Series Height'),\n              default: '25',\n              choices: formatSelectOptions([\n                '10',\n                '25',\n                '40',\n                '50',\n                '75',\n                '100',\n                '150',\n                '200',\n              ]),\n              description: t('Pixel height of each series'),\n            },\n          },\n          {\n            name: 'horizon_color_scale',\n            config: {\n              type: 'SelectControl',\n              renderTrigger: true,\n              label: t('Value Domain'),\n              choices: [\n                ['series', t('series')],\n                ['overall', t('overall')],\n                ['change', t('change')],\n              ],\n              default: 'series',\n              description: t(\n                'series: Treat each series independently; overall: All series use the same scale; change: Show changes compared to the first data point in each series',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport example from './images/Horizon_Chart.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Distribution'),\n  credits: ['http://kmandov.github.io/d3-horizon-chart/'],\n  description: t(\n    'Compares how a metric changes over time between different groups. Each group is mapped to a row and change over time is visualized bar lengths and color.',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('Horizon Chart'),\n  tags: [t('Legacy')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class HorizonChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./HorizonChart'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateMapboxStylesUrl } from '@superset-ui/core';\nimport {\n  columnChoices,\n  ControlPanelConfig,\n  formatSelectOptions,\n  sharedControls,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\n\nconst columnsConfig = sharedControls.entity;\n\nconst colorChoices = [\n  ['rgb(0, 139, 139)', t('Dark Cyan')],\n  ['rgb(128, 0, 128)', t('Purple')],\n  ['rgb(255, 215, 0)', t('Gold')],\n  ['rgb(69, 69, 69)', t('Dim Gray')],\n  ['rgb(220, 20, 60)', t('Crimson')],\n  ['rgb(34, 139, 34)', t('Forest Green')],\n];\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'all_columns_x',\n            config: {\n              ...columnsConfig,\n              label: t('Longitude'),\n              description: t('Column containing longitude data'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'all_columns_y',\n            config: {\n              ...columnsConfig,\n              label: t('Latitude'),\n              description: t('Column containing latitude data'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'clustering_radius',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Clustering Radius'),\n              default: '60',\n              choices: formatSelectOptions([\n                '0',\n                '20',\n                '40',\n                '60',\n                '80',\n                '100',\n                '200',\n                '500',\n                '1000',\n              ]),\n              description: t(\n                'The radius (in pixels) the algorithm uses to define a cluster. ' +\n                  'Choose 0 to turn off clustering, but beware that a large ' +\n                  'number of points (>1000) will cause lag.',\n              ),\n            },\n          },\n        ],\n        ['row_limit'],\n        ['adhoc_filters'],\n        ['groupby'],\n      ],\n    },\n    {\n      label: t('Points'),\n      controlSetRows: [\n        [\n          {\n            name: 'point_radius',\n            config: {\n              type: 'SelectControl',\n              label: t('Point Radius'),\n              default: 'Auto',\n              description: t(\n                'The radius of individual points (ones that are not in a cluster). ' +\n                  'Either a numerical column or `Auto`, which scales the point based ' +\n                  'on the largest cluster',\n              ),\n              mapStateToProps: state => {\n                const datasourceChoices = columnChoices(state.datasource);\n                const choices: [string, string][] = [['Auto', t('Auto')]];\n                return {\n                  choices: choices.concat(datasourceChoices),\n                };\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'point_radius_unit',\n            config: {\n              type: 'SelectControl',\n              label: t('Point Radius Unit'),\n              default: 'Pixels',\n              choices: [\n                ['Pixels', t('Pixels')],\n                ['Miles', t('Miles')],\n                ['Kilometers', t('Kilometers')],\n              ],\n              description: t(\n                'The unit of measure for the specified point radius',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Labelling'),\n      controlSetRows: [\n        [\n          {\n            name: 'mapbox_label',\n            config: {\n              type: 'SelectControl',\n              multi: true,\n              label: t('label'),\n              default: [],\n              description: t(\n                '`count` is COUNT(*) if a group by is used. ' +\n                  'Numerical columns will be aggregated with the aggregator. ' +\n                  'Non-numerical columns will be used to label points. ' +\n                  'Leave empty to get a count of points in each cluster.',\n              ),\n              mapStateToProps: state => ({\n                choices: columnChoices(state.datasource),\n              }),\n            },\n          },\n        ],\n        [\n          {\n            name: 'pandas_aggfunc',\n            config: {\n              type: 'SelectControl',\n              label: t('Cluster label aggregator'),\n              clearable: false,\n              choices: [\n                ['sum', t('sum')],\n                ['mean', t('mean')],\n                ['min', t('min')],\n                ['max', t('max')],\n                ['std', t('std')],\n                ['var', t('var')],\n              ],\n              default: 'sum',\n              description: t(\n                'Aggregate function applied to the list of points ' +\n                  'in each cluster to produce the cluster label.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Visual Tweaks'),\n      controlSetRows: [\n        [\n          {\n            name: 'render_while_dragging',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Live render'),\n              default: true,\n              description: t(\n                'Points and clusters will update as the viewport is being changed',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'mapbox_style',\n            config: {\n              type: 'SelectControl',\n              label: t('Map Style'),\n              clearable: false,\n              renderTrigger: true,\n              freeForm: true,\n              validators: [validateMapboxStylesUrl],\n              choices: [\n                ['mapbox://styles/mapbox/streets-v9', t('Streets')],\n                ['mapbox://styles/mapbox/dark-v9', t('Dark')],\n                ['mapbox://styles/mapbox/light-v9', t('Light')],\n                [\n                  'mapbox://styles/mapbox/satellite-streets-v9',\n                  t('Satellite Streets'),\n                ],\n                ['mapbox://styles/mapbox/satellite-v9', t('Satellite')],\n                ['mapbox://styles/mapbox/outdoors-v9', t('Outdoors')],\n              ],\n              default: 'mapbox://styles/mapbox/light-v9',\n              description: t(\n                'Base layer map style. See Mapbox documentation: %s',\n                'https://docs.mapbox.com/help/glossary/style-url/',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'global_opacity',\n            config: {\n              type: 'TextControl',\n              label: t('Opacity'),\n              default: 1,\n              isFloat: true,\n              description: t(\n                'Opacity of all clusters, points, and labels. Between 0 and 1.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'mapbox_color',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('RGB Color'),\n              default: colorChoices[0][0],\n              choices: colorChoices,\n              description: t('The color for points and clusters in RGB'),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Viewport'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'viewport_longitude',\n            config: {\n              type: 'TextControl',\n              label: t('Default longitude'),\n              renderTrigger: true,\n              default: -122.405293,\n              isFloat: true,\n              description: t('Longitude of default viewport'),\n              places: 8,\n              // Viewport longitude changes shouldn't prompt user to re-run query\n              dontRefreshOnChange: true,\n            },\n          },\n          {\n            name: 'viewport_latitude',\n            config: {\n              type: 'TextControl',\n              label: t('Default latitude'),\n              renderTrigger: true,\n              default: 37.772123,\n              isFloat: true,\n              description: t('Latitude of default viewport'),\n              places: 8,\n              // Viewport latitude changes shouldn't prompt user to re-run query\n              dontRefreshOnChange: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'viewport_zoom',\n            config: {\n              type: 'TextControl',\n              label: t('Zoom'),\n              renderTrigger: true,\n              isFloat: true,\n              default: 11,\n              description: t('Zoom level of the map'),\n              places: 8,\n              // Viewport zoom shouldn't prompt user to re-run query\n              dontRefreshOnChange: true,\n            },\n          },\n          null,\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    groupby: {\n      description: t(\n        'One or many controls to group by. If grouping, latitude ' +\n          'and longitude columns must be present.',\n      ),\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/MapBox.jpg';\nimport example2 from './images/MapBox2.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://www.mapbox.com/mapbox-gl-js/api/'],\n  description: '',\n  exampleGallery: [\n    { url: example1, description: t('Light mode') },\n    { url: example2, description: t('Dark mode') },\n  ],\n  name: t('MapBox'),\n  tags: [\n    t('Business'),\n    t('Intensity'),\n    t('Legacy'),\n    t('Density'),\n    t('Scatter'),\n    t('Transformable'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class MapBoxChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./MapBox'),\n      loadTransformProps: () => import('./transformProps'),\n      metadata,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function transformProps(chartProps) {\n  const { formData, queriesData } = chartProps;\n  const {\n    groupby,\n    liftvaluePrecision,\n    metrics,\n    pvaluePrecision,\n    significanceLevel,\n  } = formData;\n\n  return {\n    alpha: significanceLevel,\n    data: queriesData[0].data,\n    groups: groupby,\n    liftValPrec: parseInt(liftvaluePrecision, 10),\n    metrics: metrics.map(metric =>\n      typeof metric === 'string' ? metric : metric.label,\n    ),\n    pValPrec: parseInt(pvaluePrecision, 10),\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['metrics'],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'groupby',\n            override: {\n              validators: [validateNonEmpty],\n            },\n          },\n        ],\n        ['limit', 'timeseries_limit_metric'],\n        ['order_desc'],\n        [\n          {\n            name: 'contribution',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Contribution'),\n              default: false,\n              description: t('Compute the contribution to the total'),\n            },\n          },\n        ],\n        ['row_limit', null],\n      ],\n    },\n    {\n      label: t('Parameters'),\n      expanded: false,\n      controlSetRows: [\n        [\n          {\n            name: 'significance_level',\n            config: {\n              type: 'TextControl',\n              label: t('Significance Level'),\n              default: 0.05,\n              description: t(\n                'Threshold alpha level for determining significance',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'pvalue_precision',\n            config: {\n              type: 'TextControl',\n              label: t('p-value precision'),\n              default: 6,\n              description: t(\n                'Number of decimal places with which to display p-values',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'liftvalue_precision',\n            config: {\n              type: 'TextControl',\n              label: t('Lift percent precision'),\n              default: 4,\n              description: t(\n                'Number of decimal places with which to display lift values',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Correlation'),\n  description: t(\n    'Table that visualizes paired t-tests, which are used to understand statistical differences between groups.',\n  ),\n  name: t('Paired t-test Table'),\n  tags: [t('Legacy'), t('Statistical'), t('Tabular')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class PairedTTestChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./PairedTTest'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function transformProps(chartProps) {\n  const { width, height, formData, queriesData } = chartProps;\n  const {\n    includeSeries,\n    linearColorScheme,\n    metrics,\n    secondaryMetric,\n    series,\n    showDatatable,\n  } = formData;\n\n  return {\n    width,\n    height,\n    data: queriesData[0].data,\n    includeSeries,\n    linearColorScheme,\n    metrics: metrics.map(m => m.label || m),\n    colorMetric:\n      secondaryMetric && secondaryMetric.label\n        ? secondaryMetric.label\n        : secondaryMetric,\n    series,\n    showDatatable,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['series'],\n        ['metrics'],\n        ['secondary_metric'],\n        ['adhoc_filters'],\n        ['limit', 'row_limit'],\n        ['timeseries_limit_metric'],\n        ['order_desc'],\n      ],\n    },\n    {\n      label: t('Options'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'show_datatable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Table'),\n              default: false,\n              renderTrigger: true,\n              description: t('Whether to display the interactive data table'),\n            },\n          },\n          {\n            name: 'include_series',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Include Series'),\n              renderTrigger: true,\n              default: false,\n              description: t('Include series name as an axis'),\n            },\n          },\n        ],\n        ['linear_color_scheme'],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/example1.jpg';\nimport example2 from './images/example2.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Ranking'),\n  credits: ['https://syntagmatic.github.io/parallel-coordinates'],\n  description: t(\n    'Plots the individual metrics for each row in the data vertically and links them together as a line. This chart is useful for comparing multiple metrics across all of the samples or rows in the data.',\n  ),\n  exampleGallery: [{ url: example1 }, { url: example2 }],\n  name: t('Parallel Coordinates'),\n  tags: [t('Coordinates'), t('Directional'), t('Legacy'), t('Relational')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class ParallelCoordinatesChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactParallelCoordinates'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function transformProps(chartProps) {\n  const { width, height, datasource, formData, queriesData } = chartProps;\n  const {\n    colorScheme,\n    dateTimeFormat,\n    equalDateSize,\n    groupby,\n    logScale,\n    metrics,\n    numberFormat,\n    partitionLimit,\n    partitionThreshold,\n    richTooltip,\n    timeSeriesOption,\n    sliceId,\n  } = formData;\n  const { verboseMap } = datasource;\n\n  return {\n    width,\n    height,\n    data: queriesData[0].data,\n    colorScheme,\n    dateTimeFormat,\n    equalDateSize,\n    levels: groupby.map(g => verboseMap[g] || g),\n    metrics,\n    numberFormat,\n    partitionLimit: partitionLimit && parseInt(partitionLimit, 10),\n    partitionThreshold: partitionThreshold && parseInt(partitionThreshold, 10),\n    timeSeriesOption,\n    useLogScale: logScale,\n    useRichTooltip: richTooltip,\n    sliceId,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport {\n  ColumnMeta,\n  InfoTooltipWithTrigger,\n} from '@superset-ui/chart-controls';\n\nconst propTypes = {\n  option: PropTypes.object.isRequired,\n};\n\n// This component provides a general tooltip for options\n// in a SelectControl\nexport default function OptionDescription({ option }: { option: ColumnMeta }) {\n  return (\n    <span>\n      <span className=\"m-r-5 option-label\">{option.label}</span>\n      {option.description && (\n        <InfoTooltipWithTrigger\n          className=\"m-r-5 text-muted\"\n          icon=\"question-circle-o\"\n          tooltip={option.description}\n          label={`descr-${option.label}`}\n        />\n      )}\n    </span>\n  );\n}\nOptionDescription.propTypes = propTypes;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  ColumnMeta,\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  D3_FORMAT_DOCS,\n  D3_FORMAT_OPTIONS,\n  D3_TIME_FORMAT_OPTIONS,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport OptionDescription from './OptionDescription';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['metrics'],\n        ['adhoc_filters'],\n        ['groupby'],\n        ['limit'],\n        ['timeseries_limit_metric'],\n        ['order_desc'],\n        [\n          {\n            name: 'contribution',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Contribution'),\n              default: false,\n              description: t('Compute the contribution to the total'),\n            },\n          },\n        ],\n        ['row_limit'],\n      ],\n    },\n    {\n      label: t('Time Series Options'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'time_series_option',\n            config: {\n              type: 'SelectControl',\n              label: t('Options'),\n              validators: [validateNonEmpty],\n              default: 'not_time',\n              valueKey: 'value',\n              options: [\n                {\n                  label: t('Not Time Series'),\n                  value: 'not_time',\n                  description: t('Ignore time'),\n                },\n                {\n                  label: t('Time Series'),\n                  value: 'time_series',\n                  description: t('Standard time series'),\n                },\n                {\n                  label: t('Aggregate Mean'),\n                  value: 'agg_mean',\n                  description: t('Mean of values over specified period'),\n                },\n                {\n                  label: t('Aggregate Sum'),\n                  value: 'agg_sum',\n                  description: t('Sum of values over specified period'),\n                },\n                {\n                  label: t('Difference'),\n                  value: 'point_diff',\n                  description: t(\n                    'Metric change in value from `since` to `until`',\n                  ),\n                },\n                {\n                  label: t('Percent Change'),\n                  value: 'point_percent',\n                  description: t(\n                    'Metric percent change in value from `since` to `until`',\n                  ),\n                },\n                {\n                  label: t('Factor'),\n                  value: 'point_factor',\n                  description: t(\n                    'Metric factor change from `since` to `until`',\n                  ),\n                },\n                {\n                  label: t('Advanced Analytics'),\n                  value: 'adv_anal',\n                  description: t('Use the Advanced Analytics options below'),\n                },\n              ],\n              optionRenderer: (op: ColumnMeta) => (\n                <OptionDescription option={op} />\n              ),\n              valueRenderer: (op: ColumnMeta) => (\n                <OptionDescription option={op} />\n              ),\n              description: t('Settings for time series'),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      tabOverride: 'customize',\n      controlSetRows: [\n        ['color_scheme'],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: 'SMART_NUMBER',\n              choices: D3_FORMAT_OPTIONS,\n              description: D3_FORMAT_DOCS,\n            },\n          },\n          {\n            name: 'date_time_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date Time Format'),\n              renderTrigger: true,\n              default: 'smart_date',\n              choices: D3_TIME_FORMAT_OPTIONS,\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n        [\n          {\n            name: 'partition_limit',\n            config: {\n              type: 'TextControl',\n              label: t('Partition Limit'),\n              isInt: true,\n              default: '5',\n              description: t(\n                'The maximum number of subdivisions of each group; ' +\n                  'lower values are pruned first',\n              ),\n            },\n          },\n          {\n            name: 'partition_threshold',\n            config: {\n              type: 'TextControl',\n              label: t('Partition Threshold'),\n              isFloat: true,\n              default: '0.05',\n              description: t(\n                'Partitions whose height to parent height proportions are ' +\n                  'below this value are pruned',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'log_scale',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Log Scale'),\n              default: false,\n              renderTrigger: true,\n              description: t('Use a log scale'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'equal_date_size',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Equal Date Sizes'),\n              default: true,\n              renderTrigger: true,\n              description: t(\n                'Check to force date partitions to have the same height',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'rich_tooltip',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Rich Tooltip'),\n              renderTrigger: true,\n              default: true,\n              description: t(\n                'The rich tooltip shows a list of all series for that point in time',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Advanced Analytics'),\n      tabOverride: 'data',\n      description: t(\n        'This section contains options ' +\n          'that allow for advanced analytical post processing ' +\n          'of query results',\n      ),\n      controlSetRows: [\n        // eslint-disable-next-line react/jsx-key\n        [\n          <ControlSubSectionHeader>\n            {t('Rolling Window')}\n          </ControlSubSectionHeader>,\n        ],\n        [\n          {\n            name: 'rolling_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Rolling Function'),\n              default: 'None',\n              choices: [\n                ['None', t('None')],\n                ['mean', t('mean')],\n                ['sum', t('sum')],\n                ['std', t('std')],\n                ['cumsum', t('cumsum')],\n              ],\n              description: t(\n                'Defines a rolling window function to apply, works along ' +\n                  'with the [Periods] text box',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'rolling_periods',\n            config: {\n              type: 'TextControl',\n              label: t('Periods'),\n              isInt: true,\n              description: t(\n                'Defines the size of the rolling window function, ' +\n                  'relative to the time granularity selected',\n              ),\n            },\n          },\n          {\n            name: 'min_periods',\n            config: {\n              type: 'TextControl',\n              label: t('Min Periods'),\n              isInt: true,\n              description: t(\n                'The minimum number of rolling periods required to show ' +\n                  'a value. For instance if you do a cumulative sum on 7 days ' +\n                  'you may want your \"Min Period\" to be 7, so that all data points ' +\n                  'shown are the total of 7 periods. This will hide the \"ramp up\" ' +\n                  'taking place over the first 7 periods',\n              ),\n            },\n          },\n        ],\n        // eslint-disable-next-line react/jsx-key\n        [\n          <ControlSubSectionHeader>\n            {t('Time Comparison')}\n          </ControlSubSectionHeader>,\n        ],\n        [\n          {\n            name: 'time_compare',\n            config: {\n              type: 'SelectControl',\n              multi: true,\n              freeForm: true,\n              label: t('Time Shift'),\n              choices: [\n                ['1 day', t('1 day')],\n                ['1 week', t('1 week')],\n                ['28 days', t('28 days')],\n                ['30 days', t('30 days')],\n                ['52 weeks', t('52 weeks')],\n                ['1 year', t('1 year')],\n                ['104 weeks', t('104 weeks')],\n                ['2 years', t('2 years')],\n                ['156 weeks', t('156 weeks')],\n                ['3 years', t('3 years')],\n              ],\n              description: t(\n                'Overlay one or more timeseries from a ' +\n                  'relative time period. Expects relative time deltas ' +\n                  'in natural language (example: 24 hours, 7 days, ' +\n                  '52 weeks, 365 days). Free text is supported.',\n              ),\n            },\n          },\n          {\n            name: 'comparison_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Calculation type'),\n              default: 'values',\n              choices: [\n                ['values', t('Actual Values')],\n                ['absolute', t('Difference')],\n                ['percentage', t('Percentage change')],\n                ['ratio', t('Ratio')],\n              ],\n              description: t(\n                'How to display time shifts: as individual lines; as the ' +\n                  'difference between the main time series and each time shift; ' +\n                  'as the percentage change; or as the ratio between series and time shifts.',\n              ),\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('Resample')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'resample_rule',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Rule'),\n              default: null,\n              choices: [\n                ['1T', t('1T')],\n                ['1H', t('1H')],\n                ['1D', t('1D')],\n                ['7D', t('7D')],\n                ['1M', t('1M')],\n                ['1AS', t('1AS')],\n              ],\n              description: t('Pandas resample rule'),\n            },\n          },\n          {\n            name: 'resample_method',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Method'),\n              default: null,\n              choices: [\n                ['asfreq', t('asfreq')],\n                ['bfill', t('bfill')],\n                ['ffill', t('ffill')],\n                ['median', t('median')],\n                ['mean', t('mean')],\n                ['sum', t('sum')],\n              ],\n              description: t('Pandas resample method'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n    metrics: getStandardizedControls().popAllMetrics(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Part of a Whole'),\n  description: t('Compare the same summarized metric across multiple groups.'),\n  exampleGallery: [{ url: example }],\n  name: t('Partition Chart'),\n  tags: [t('Categorical'), t('Comparison'), t('Legacy'), t('Proportional')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class PartitionChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactPartition'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport default function transformProps(chartProps) {\n  const { width, height, formData, queriesData } = chartProps;\n  const {\n    colorScheme,\n    dateTimeFormat,\n    numberFormat,\n    richTooltip,\n    roseAreaProportion,\n    sliceId,\n  } = formData;\n\n  return {\n    width,\n    height,\n    data: queriesData[0].data,\n    colorScheme,\n    dateTimeFormat,\n    numberFormat,\n    useAreaProportions: roseAreaProportion,\n    useRichTooltip: richTooltip,\n    sliceId,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  D3_FORMAT_DOCS,\n  D3_FORMAT_OPTIONS,\n  D3_TIME_FORMAT_OPTIONS,\n  sections,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.legacyTimeseriesTime,\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['metrics'],\n        ['adhoc_filters'],\n        ['groupby'],\n        ['limit', 'timeseries_limit_metric'],\n        ['order_desc'],\n        [\n          {\n            name: 'contribution',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Contribution'),\n              default: false,\n              description: t('Compute the contribution to the total'),\n            },\n          },\n        ],\n        ['row_limit', null],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: 'SMART_NUMBER',\n              choices: D3_FORMAT_OPTIONS,\n              description: D3_FORMAT_DOCS,\n            },\n          },\n          {\n            name: 'date_time_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date Time Format'),\n              renderTrigger: true,\n              default: 'smart_date',\n              choices: D3_TIME_FORMAT_OPTIONS,\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n        [\n          {\n            name: 'rich_tooltip',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Rich Tooltip'),\n              renderTrigger: true,\n              default: true,\n              description: t(\n                'The rich tooltip shows a list of all series for that point in time',\n              ),\n            },\n          },\n          {\n            name: 'rose_area_proportion',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Use Area Proportions'),\n              description: t(\n                'Check if the Rose Chart should use segment area instead of ' +\n                  'segment radius for proportioning',\n              ),\n              default: false,\n              renderTrigger: true,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Advanced Analytics'),\n      tabOverride: 'data',\n      description: t(\n        'This section contains options ' +\n          'that allow for advanced analytical post processing ' +\n          'of query results',\n      ),\n      controlSetRows: [\n        // eslint-disable-next-line react/jsx-key\n        [\n          <ControlSubSectionHeader>\n            {t('Rolling Window')}\n          </ControlSubSectionHeader>,\n        ],\n        [\n          {\n            name: 'rolling_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Rolling Function'),\n              default: 'None',\n              choices: [\n                ['None', t('None')],\n                ['mean', t('mean')],\n                ['sum', t('sum')],\n                ['std', t('std')],\n                ['cumsum', t('cumsum')],\n              ],\n              description: t(\n                'Defines a rolling window function to apply, works along ' +\n                  'with the [Periods] text box',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'rolling_periods',\n            config: {\n              type: 'TextControl',\n              label: t('Periods'),\n              isInt: true,\n              description: t(\n                'Defines the size of the rolling window function, ' +\n                  'relative to the time granularity selected',\n              ),\n            },\n          },\n          {\n            name: 'min_periods',\n            config: {\n              type: 'TextControl',\n              label: t('Min Periods'),\n              isInt: true,\n              description: t(\n                'The minimum number of rolling periods required to show ' +\n                  'a value. For instance if you do a cumulative sum on 7 days ' +\n                  'you may want your \"Min Period\" to be 7, so that all data points ' +\n                  'shown are the total of 7 periods. This will hide the \"ramp up\" ' +\n                  'taking place over the first 7 periods',\n              ),\n            },\n          },\n        ],\n        // eslint-disable-next-line react/jsx-key\n        [\n          <ControlSubSectionHeader>\n            {t('Time Comparison')}\n          </ControlSubSectionHeader>,\n        ],\n        [\n          {\n            name: 'time_compare',\n            config: {\n              type: 'SelectControl',\n              multi: true,\n              freeForm: true,\n              label: t('Time Shift'),\n              choices: [\n                ['1 day', t('1 day')],\n                ['1 week', t('1 week')],\n                ['28 days', t('28 days')],\n                ['30 days', t('30 days')],\n                ['52 weeks', t('52 weeks')],\n                ['1 year', t('1 year')],\n                ['104 weeks', t('104 weeks')],\n                ['2 years', t('2 years')],\n                ['156 weeks', t('156 weeks')],\n                ['3 years', t('3 years')],\n              ],\n              description: t(\n                'Overlay one or more timeseries from a ' +\n                  'relative time period. Expects relative time deltas ' +\n                  'in natural language (example:  24 hours, 7 days, ' +\n                  '52 weeks, 365 days). Free text is supported.',\n              ),\n            },\n          },\n          {\n            name: 'comparison_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Calculation type'),\n              default: 'values',\n              choices: [\n                ['values', t('Actual Values')],\n                ['absolute', t('Difference')],\n                ['percentage', t('Percentage change')],\n                ['ratio', t('Ratio')],\n              ],\n              description: t(\n                'How to display time shifts: as individual lines; as the ' +\n                  'difference between the main time series and each time shift; ' +\n                  'as the percentage change; or as the ratio between series and time shifts.',\n              ),\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('Resample')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'resample_rule',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Rule'),\n              default: null,\n              choices: [\n                ['1T', t('1T')],\n                ['1H', t('1H')],\n                ['1D', t('1D')],\n                ['7D', t('7D')],\n                ['1M', t('1M')],\n                ['1AS', t('1AS')],\n              ],\n              description: t('Pandas resample rule'),\n            },\n          },\n          {\n            name: 'resample_method',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Method'),\n              default: null,\n              choices: [\n                ['asfreq', t('asfreq')],\n                ['bfill', t('bfill')],\n                ['ffill', t('ffill')],\n                ['median', t('median')],\n                ['mean', t('mean')],\n                ['sum', t('sum')],\n              ],\n              description: t('Pandas resample method'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n    metrics: getStandardizedControls().popAllMetrics(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/example1.jpg';\nimport example2 from './images/example2.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Ranking'),\n  description: t(\n    'A polar coordinate chart where the circle is broken into wedges of equal angle, and the value represented by any wedge is illustrated by its area, rather than its radius or sweep angle.',\n  ),\n  exampleGallery: [{ url: example1 }, { url: example2 }],\n  name: t('Nightingale Rose Chart'),\n  tags: [\n    t('Legacy'),\n    t('Advanced-Analytics'),\n    t('Circular'),\n    t('Multi-Layers'),\n    t('Pattern'),\n    t('Time'),\n    t('Trend'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class RoseChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactRose'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getLabelFontSize } from './utils';\n\nexport default function transformProps(chartProps) {\n  const { width, height, formData, queriesData } = chartProps;\n  const { colorScheme, sliceId } = formData;\n\n  return {\n    width,\n    height,\n    data: queriesData[0].data,\n    colorScheme,\n    fontSize: getLabelFontSize(width),\n    sliceId,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'groupby',\n            override: {\n              label: t('Source / Target'),\n              description: t('Choose a source and a target'),\n            },\n          },\n        ],\n        ['metric'],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'row_limit',\n            override: {\n              description: t(\n                'Limiting rows may result in incomplete data and misleading charts. Consider filtering or grouping source/target names instead.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [['color_scheme']],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Sankey.jpg';\nimport example2 from './images/Sankey2.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Flow'),\n  credits: ['https://github.com/d3/d3-sankey'],\n  description: t(\n    \"Visualizes the flow of different group's values through different stages of a system. New stages in the pipeline are visualized as nodes or layers. The thickness of the bars or edges represent the metric being visualized.\",\n  ),\n  exampleGallery: [\n    { url: example1, description: t('Demographics') },\n    { url: example2, description: t('Survey Responses') },\n  ],\n  name: t('Sankey Diagram'),\n  tags: [\n    t('Categorical'),\n    t('Directional'),\n    t('Legacy'),\n    t('Percentages'),\n    t('Proportional'),\n    t('Relational'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class SankeyChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactSankey'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport memoizeOne from 'memoize-one';\nimport {\n  CurrencyFormatter,\n  DataRecord,\n  extractTimegrain,\n  GenericDataType,\n  getMetricLabel,\n  getNumberFormatter,\n  getTimeFormatter,\n  getTimeFormatterForGranularity,\n  NumberFormats,\n  QueryMode,\n  smartDateFormatter,\n  TimeFormats,\n  TimeFormatter,\n} from '@superset-ui/core';\nimport {\n  ColorFormatters,\n  getColorFormatters,\n} from '@superset-ui/chart-controls';\n\nimport isEqualColumns from './utils/isEqualColumns';\nimport DateWithFormatter from './utils/DateWithFormatter';\nimport {\n  DataColumnMeta,\n  TableChartProps,\n  TableChartTransformedProps,\n} from './types';\n\nconst { PERCENT_3_POINT } = NumberFormats;\nconst { DATABASE_DATETIME } = TimeFormats;\n\nfunction isNumeric(key: string, data: DataRecord[] = []) {\n  return data.every(\n    x => x[key] === null || x[key] === undefined || typeof x[key] === 'number',\n  );\n}\n\nconst processDataRecords = memoizeOne(function processDataRecords(\n  data: DataRecord[] | undefined,\n  columns: DataColumnMeta[],\n) {\n  if (!data?.[0]) {\n    return data || [];\n  }\n  const timeColumns = columns.filter(\n    column => column.dataType === GenericDataType.Temporal,\n  );\n\n  if (timeColumns.length > 0) {\n    return data.map(x => {\n      const datum = { ...x };\n      timeColumns.forEach(({ key, formatter }) => {\n        // Convert datetime with a custom date class so we can use `String(...)`\n        // formatted value for global search, and `date.getTime()` for sorting.\n        datum[key] = new DateWithFormatter(x[key], {\n          formatter: formatter as TimeFormatter,\n        });\n      });\n      return datum;\n    });\n  }\n  return data;\n});\n\nconst processColumns = memoizeOne(function processColumns(\n  props: TableChartProps,\n) {\n  const {\n    datasource: { columnFormats, currencyFormats, verboseMap },\n    rawFormData: {\n      table_timestamp_format: tableTimestampFormat,\n      metrics: metrics_,\n      percent_metrics: percentMetrics_,\n      column_config: columnConfig = {},\n    },\n    queriesData,\n  } = props;\n  const granularity = extractTimegrain(props.rawFormData);\n  const { data: records, colnames, coltypes } = queriesData[0] || {};\n  // convert `metrics` and `percentMetrics` to the key names in `data.records`\n  const metrics = (metrics_ ?? []).map(getMetricLabel);\n  const rawPercentMetrics = (percentMetrics_ ?? []).map(getMetricLabel);\n  // column names for percent metrics always starts with a '%' sign.\n  const percentMetrics = rawPercentMetrics.map((x: string) => `%${x}`);\n  const metricsSet = new Set(metrics);\n  const percentMetricsSet = new Set(percentMetrics);\n  const rawPercentMetricsSet = new Set(rawPercentMetrics);\n\n  const columns: DataColumnMeta[] = (colnames || [])\n    .filter(\n      key =>\n        // if a metric was only added to percent_metrics, they should not show up in the table.\n        !(rawPercentMetricsSet.has(key) && !metricsSet.has(key)),\n    )\n    .map((key: string, i) => {\n      const dataType = coltypes[i];\n      const config = columnConfig[key] || {};\n      // for the purpose of presentation, only numeric values are treated as metrics\n      // because users can also add things like `MAX(str_col)` as a metric.\n      const isMetric = metricsSet.has(key) && isNumeric(key, records);\n      const isPercentMetric = percentMetricsSet.has(key);\n      const label =\n        isPercentMetric && verboseMap?.hasOwnProperty(key.replace('%', ''))\n          ? `%${verboseMap[key.replace('%', '')]}`\n          : verboseMap?.[key] || key;\n      const isTime = dataType === GenericDataType.Temporal;\n      const isNumber = dataType === GenericDataType.Numeric;\n      const savedFormat = columnFormats?.[key];\n      const savedCurrency = currencyFormats?.[key];\n      const numberFormat = config.d3NumberFormat || savedFormat;\n      const currency = config.currencyFormat?.symbol\n        ? config.currencyFormat\n        : savedCurrency;\n\n      let formatter;\n\n      if (isTime || config.d3TimeFormat) {\n        // string types may also apply d3-time format\n        // pick adhoc format first, fallback to column level formats defined in\n        // datasource\n        const customFormat = config.d3TimeFormat || savedFormat;\n        const timeFormat = customFormat || tableTimestampFormat;\n        // When format is \"Adaptive Formatting\" (smart_date)\n        if (timeFormat === smartDateFormatter.id) {\n          if (granularity) {\n            // time column use formats based on granularity\n            formatter = getTimeFormatterForGranularity(granularity);\n          } else if (customFormat) {\n            // other columns respect the column-specific format\n            formatter = getTimeFormatter(customFormat);\n          } else if (isNumeric(key, records)) {\n            // if column is numeric values, it is considered a timestamp64\n            formatter = getTimeFormatter(DATABASE_DATETIME);\n          } else {\n            // if no column-specific format, print cell as is\n            formatter = String;\n          }\n        } else if (timeFormat) {\n          formatter = getTimeFormatter(timeFormat);\n        }\n      } else if (isPercentMetric) {\n        // percent metrics have a default format\n        formatter = getNumberFormatter(numberFormat || PERCENT_3_POINT);\n      } else if (isMetric || (isNumber && (numberFormat || currency))) {\n        formatter = currency\n          ? new CurrencyFormatter({\n              d3Format: numberFormat,\n              currency,\n            })\n          : getNumberFormatter(numberFormat);\n      }\n      return {\n        key,\n        label,\n        dataType,\n        isNumeric: dataType === GenericDataType.Numeric,\n        isMetric,\n        isPercentMetric,\n        formatter,\n        config,\n      };\n    });\n  return [metrics, percentMetrics, columns] as [\n    typeof metrics,\n    typeof percentMetrics,\n    typeof columns,\n  ];\n}, isEqualColumns);\n\n/**\n * Automatically set page size based on number of cells.\n */\nconst getPageSize = (\n  pageSize: number | string | null | undefined,\n  numRecords: number,\n  numColumns: number,\n) => {\n  if (typeof pageSize === 'number') {\n    // NaN is also has typeof === 'number'\n    return pageSize || 0;\n  }\n  if (typeof pageSize === 'string') {\n    return Number(pageSize) || 0;\n  }\n  // when pageSize not set, automatically add pagination if too many records\n  return numRecords * numColumns > 5000 ? 200 : 0;\n};\n\nconst defaultServerPaginationData = {};\nconst defaultColorFormatters = [] as ColorFormatters;\nconst transformProps = (\n  chartProps: TableChartProps,\n): TableChartTransformedProps => {\n  const {\n    height,\n    width,\n    rawFormData: formData,\n    queriesData = [],\n    filterState,\n    ownState: serverPaginationData,\n    hooks: {\n      onAddFilter: onChangeFilter,\n      setDataMask = () => {},\n      onContextMenu,\n    },\n    emitCrossFilters,\n  } = chartProps;\n\n  const {\n    align_pn: alignPositiveNegative = true,\n    color_pn: colorPositiveNegative = true,\n    show_cell_bars: showCellBars = true,\n    include_search: includeSearch = false,\n    page_length: pageLength,\n    server_pagination: serverPagination = false,\n    server_page_length: serverPageLength = 10,\n    order_desc: sortDesc = false,\n    query_mode: queryMode,\n    show_totals: showTotals,\n    conditional_formatting: conditionalFormatting,\n    allow_rearrange_columns: allowRearrangeColumns,\n  } = formData;\n  const timeGrain = extractTimegrain(formData);\n\n  const [metrics, percentMetrics, columns] = processColumns(chartProps);\n\n  let baseQuery;\n  let countQuery;\n  let totalQuery;\n  let rowCount;\n  if (serverPagination) {\n    [baseQuery, countQuery, totalQuery] = queriesData;\n    rowCount = (countQuery?.data?.[0]?.rowcount as number) ?? 0;\n  } else {\n    [baseQuery, totalQuery] = queriesData;\n    rowCount = baseQuery?.rowcount ?? 0;\n  }\n  const data = processDataRecords(baseQuery?.data, columns);\n  const totals =\n    showTotals && queryMode === QueryMode.Aggregate\n      ? totalQuery?.data[0]\n      : undefined;\n  const columnColorFormatters =\n    getColorFormatters(conditionalFormatting, data) ?? defaultColorFormatters;\n\n  return {\n    height,\n    width,\n    isRawRecords: queryMode === QueryMode.Raw,\n    data,\n    totals,\n    columns,\n    serverPagination,\n    metrics,\n    percentMetrics,\n    serverPaginationData: serverPagination\n      ? serverPaginationData\n      : defaultServerPaginationData,\n    setDataMask,\n    alignPositiveNegative,\n    colorPositiveNegative,\n    showCellBars,\n    sortDesc,\n    includeSearch,\n    rowCount,\n    pageSize: serverPagination\n      ? serverPageLength\n      : getPageSize(pageLength, data.length, columns.length),\n    filters: filterState.filters,\n    emitCrossFilters,\n    onChangeFilter,\n    columnColorFormatters,\n    timeGrain,\n    allowRearrangeColumns,\n    onContextMenu,\n  };\n};\n\nexport default transformProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { isEqualArray } from '@superset-ui/core';\nimport { TableChartProps } from '../types';\n\nexport default function isEqualColumns(\n  propsA: TableChartProps[],\n  propsB: TableChartProps[],\n) {\n  const a = propsA[0];\n  const b = propsB[0];\n  return (\n    a.datasource.columnFormats === b.datasource.columnFormats &&\n    a.datasource.currencyFormats === b.datasource.currencyFormats &&\n    a.datasource.verboseMap === b.datasource.verboseMap &&\n    a.formData.tableTimestampFormat === b.formData.tableTimestampFormat &&\n    a.formData.timeGrainSqla === b.formData.timeGrainSqla &&\n    JSON.stringify(a.formData.columnConfig || null) ===\n      JSON.stringify(b.formData.columnConfig || null) &&\n    isEqualArray(a.formData.metrics, b.formData.metrics) &&\n    isEqualArray(a.queriesData?.[0]?.colnames, b.queriesData?.[0]?.colnames) &&\n    isEqualArray(a.queriesData?.[0]?.coltypes, b.queriesData?.[0]?.coltypes) &&\n    JSON.stringify(a.formData.extraFilters || null) ===\n      JSON.stringify(b.formData.extraFilters || null) &&\n    JSON.stringify(a.formData.extraFormData || null) ===\n      JSON.stringify(b.formData.extraFormData || null) &&\n    JSON.stringify(a.rawFormData.column_config || null) ===\n      JSON.stringify(b.rawFormData.column_config || null)\n  );\n}\n","/* eslint-disable camelcase */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport {\n  ChartDataResponseResult,\n  ensureIsArray,\n  GenericDataType,\n  isAdhocColumn,\n  isPhysicalColumn,\n  QueryFormColumn,\n  QueryMode,\n  smartDateFormatter,\n  t,\n} from '@superset-ui/core';\nimport {\n  ColumnOption,\n  ControlConfig,\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlStateMapping,\n  D3_TIME_FORMAT_OPTIONS,\n  QueryModeLabel,\n  sharedControls,\n  ControlPanelState,\n  ControlState,\n  Dataset,\n  ColumnMeta,\n  defineSavedMetrics,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\n\nimport { PAGE_SIZE_OPTIONS } from './consts';\n\nfunction getQueryMode(controls: ControlStateMapping): QueryMode {\n  const mode = controls?.query_mode?.value;\n  if (mode === QueryMode.Aggregate || mode === QueryMode.Raw) {\n    return mode as QueryMode;\n  }\n  const rawColumns = controls?.all_columns?.value as\n    | QueryFormColumn[]\n    | undefined;\n  const hasRawColumns = rawColumns && rawColumns.length > 0;\n  return hasRawColumns ? QueryMode.Raw : QueryMode.Aggregate;\n}\n\n/**\n * Visibility check\n */\nfunction isQueryMode(mode: QueryMode) {\n  return ({ controls }: Pick<ControlPanelsContainerProps, 'controls'>) =>\n    getQueryMode(controls) === mode;\n}\n\nconst isAggMode = isQueryMode(QueryMode.Aggregate);\nconst isRawMode = isQueryMode(QueryMode.Raw);\n\nconst validateAggControlValues = (\n  controls: ControlStateMapping,\n  values: any[],\n) => {\n  const areControlsEmpty = values.every(val => ensureIsArray(val).length === 0);\n  return areControlsEmpty && isAggMode({ controls })\n    ? [t('Group By, Metrics or Percentage Metrics must have a value')]\n    : [];\n};\n\nconst queryMode: ControlConfig<'RadioButtonControl'> = {\n  type: 'RadioButtonControl',\n  label: t('Query mode'),\n  default: null,\n  options: [\n    [QueryMode.Aggregate, QueryModeLabel[QueryMode.Aggregate]],\n    [QueryMode.Raw, QueryModeLabel[QueryMode.Raw]],\n  ],\n  mapStateToProps: ({ controls }) => ({ value: getQueryMode(controls) }),\n  rerender: ['all_columns', 'groupby', 'metrics', 'percent_metrics'],\n};\n\nconst allColumnsControl: typeof sharedControls.groupby = {\n  ...sharedControls.groupby,\n  label: t('Columns'),\n  description: t('Columns to display'),\n  multi: true,\n  freeForm: true,\n  allowAll: true,\n  commaChoosesOption: false,\n  optionRenderer: c => <ColumnOption showType column={c} />,\n  valueRenderer: c => <ColumnOption column={c} />,\n  valueKey: 'column_name',\n  mapStateToProps: ({ datasource, controls }, controlState) => ({\n    options: datasource?.columns || [],\n    queryMode: getQueryMode(controls),\n    externalValidationErrors:\n      isRawMode({ controls }) && ensureIsArray(controlState?.value).length === 0\n        ? [t('must have a value')]\n        : [],\n  }),\n  visibility: isRawMode,\n  resetOnHide: false,\n};\n\nconst percentMetricsControl: typeof sharedControls.metrics = {\n  ...sharedControls.metrics,\n  label: t('Percentage metrics'),\n  description: t(\n    'Select one or many metrics to display, that will be displayed in the percentages of total. ' +\n      'Percentage metrics will be calculated only from data within the row limit. ' +\n      'You can use an aggregation function on a column or write custom SQL to create a percentage metric.',\n  ),\n  visibility: isAggMode,\n  resetOnHide: false,\n  mapStateToProps: ({ datasource, controls }, controlState) => ({\n    columns: datasource?.columns || [],\n    savedMetrics: defineSavedMetrics(datasource),\n    datasource,\n    datasourceType: datasource?.type,\n    queryMode: getQueryMode(controls),\n    externalValidationErrors: validateAggControlValues(controls, [\n      controls.groupby?.value,\n      controls.metrics?.value,\n      controlState?.value,\n    ]),\n  }),\n  rerender: ['groupby', 'metrics'],\n  default: [],\n  validators: [],\n};\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'query_mode',\n            config: queryMode,\n          },\n        ],\n        [\n          {\n            name: 'groupby',\n            override: {\n              visibility: isAggMode,\n              resetOnHide: false,\n              mapStateToProps: (\n                state: ControlPanelState,\n                controlState: ControlState,\n              ) => {\n                const { controls } = state;\n                const originalMapStateToProps =\n                  sharedControls?.groupby?.mapStateToProps;\n                const newState =\n                  originalMapStateToProps?.(state, controlState) ?? {};\n                newState.externalValidationErrors = validateAggControlValues(\n                  controls,\n                  [\n                    controls.metrics?.value,\n                    controls.percent_metrics?.value,\n                    controlState.value,\n                  ],\n                );\n\n                return newState;\n              },\n              rerender: ['metrics', 'percent_metrics'],\n            },\n          },\n        ],\n        [\n          {\n            name: 'time_grain_sqla',\n            config: {\n              ...sharedControls.time_grain_sqla,\n              visibility: ({ controls }) => {\n                const dttmLookup = Object.fromEntries(\n                  ensureIsArray(controls?.groupby?.options).map(option => [\n                    option.column_name,\n                    option.is_dttm,\n                  ]),\n                );\n\n                return ensureIsArray(controls?.groupby.value)\n                  .map(selection => {\n                    if (isAdhocColumn(selection)) {\n                      return true;\n                    }\n                    if (isPhysicalColumn(selection)) {\n                      return !!dttmLookup[selection];\n                    }\n                    return false;\n                  })\n                  .some(Boolean);\n              },\n            },\n          },\n          'temporal_columns_lookup',\n        ],\n        [\n          {\n            name: 'metrics',\n            override: {\n              validators: [],\n              visibility: isAggMode,\n              resetOnHide: false,\n              mapStateToProps: (\n                { controls, datasource, form_data }: ControlPanelState,\n                controlState: ControlState,\n              ) => ({\n                columns: datasource?.columns[0]?.hasOwnProperty('filterable')\n                  ? (datasource as Dataset)?.columns?.filter(\n                      (c: ColumnMeta) => c.filterable,\n                    )\n                  : datasource?.columns,\n                savedMetrics: defineSavedMetrics(datasource),\n                // current active adhoc metrics\n                selectedMetrics:\n                  form_data.metrics ||\n                  (form_data.metric ? [form_data.metric] : []),\n                datasource,\n                externalValidationErrors: validateAggControlValues(controls, [\n                  controls.groupby?.value,\n                  controls.percent_metrics?.value,\n                  controlState.value,\n                ]),\n              }),\n              rerender: ['groupby', 'percent_metrics'],\n            },\n          },\n          {\n            name: 'all_columns',\n            config: allColumnsControl,\n          },\n        ],\n        [\n          {\n            name: 'percent_metrics',\n            config: percentMetricsControl,\n          },\n        ],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'timeseries_limit_metric',\n            override: {\n              visibility: isAggMode,\n              resetOnHide: false,\n            },\n          },\n          {\n            name: 'order_by_cols',\n            config: {\n              type: 'SelectControl',\n              label: t('Ordering'),\n              description: t('Order results by selected columns'),\n              multi: true,\n              default: [],\n              mapStateToProps: ({ datasource }) => ({\n                choices: datasource?.hasOwnProperty('order_by_choices')\n                  ? (datasource as Dataset)?.order_by_choices\n                  : datasource?.columns || [],\n              }),\n              visibility: isRawMode,\n              resetOnHide: false,\n            },\n          },\n        ],\n        [\n          {\n            name: 'server_pagination',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Server pagination'),\n              description: t(\n                'Enable server side pagination of results (experimental feature)',\n              ),\n              default: false,\n            },\n          },\n        ],\n        [\n          {\n            name: 'row_limit',\n            override: {\n              default: 1000,\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                !controls?.server_pagination?.value,\n            },\n          },\n          {\n            name: 'server_page_length',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Server Page Length'),\n              default: 10,\n              choices: PAGE_SIZE_OPTIONS,\n              description: t('Rows per page, 0 means no pagination'),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.server_pagination?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'order_desc',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort descending'),\n              default: true,\n              description: t(\n                'If enabled, this control sorts the results/values descending, otherwise it sorts the results ascending.',\n              ),\n              visibility: isAggMode,\n              resetOnHide: false,\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_totals',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show summary'),\n              default: false,\n              description: t(\n                'Show total aggregations of selected metrics. Note that row limit does not apply to the result.',\n              ),\n              visibility: isAggMode,\n              resetOnHide: false,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Options'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'table_timestamp_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Timestamp format'),\n              default: smartDateFormatter.id,\n              renderTrigger: true,\n              clearable: false,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              description: t('D3 time format for datetime columns'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'page_length',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              renderTrigger: true,\n              label: t('Page length'),\n              default: null,\n              choices: PAGE_SIZE_OPTIONS,\n              description: t('Rows per page, 0 means no pagination'),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                !controls?.server_pagination?.value,\n            },\n          },\n          null,\n        ],\n        [\n          {\n            name: 'include_search',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Search box'),\n              renderTrigger: true,\n              default: false,\n              description: t('Whether to include a client-side search box'),\n            },\n          },\n          {\n            name: 'show_cell_bars',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Cell bars'),\n              renderTrigger: true,\n              default: true,\n              description: t(\n                'Whether to display a bar chart background in table columns',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'align_pn',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Align +/-'),\n              renderTrigger: true,\n              default: false,\n              description: t(\n                'Whether to align background charts with both positive and negative values at 0',\n              ),\n            },\n          },\n          {\n            name: 'color_pn',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Color +/-'),\n              renderTrigger: true,\n              default: true,\n              description: t(\n                'Whether to colorize numeric values by whether they are positive or negative',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'allow_rearrange_columns',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Allow columns to be rearranged'),\n              renderTrigger: true,\n              default: false,\n              description: t(\n                \"Allow end user to drag-and-drop column headers to rearrange them. Note their changes won't persist for the next time they open the chart.\",\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'column_config',\n            config: {\n              type: 'ColumnConfigControl',\n              label: t('Customize columns'),\n              description: t('Further customize how to display each column'),\n              width: 400,\n              height: 320,\n              renderTrigger: true,\n              shouldMapStateToProps() {\n                return true;\n              },\n              mapStateToProps(explore, _, chart) {\n                return {\n                  queryResponse: chart?.queriesResponse?.[0] as\n                    | ChartDataResponseResult\n                    | undefined,\n                };\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'conditional_formatting',\n            config: {\n              type: 'ConditionalFormattingControl',\n              renderTrigger: true,\n              label: t('Conditional formatting'),\n              description: t(\n                'Apply conditional color formatting to numeric columns',\n              ),\n              shouldMapStateToProps() {\n                return true;\n              },\n              mapStateToProps(explore, _, chart) {\n                const verboseMap = explore?.datasource?.hasOwnProperty(\n                  'verbose_map',\n                )\n                  ? (explore?.datasource as Dataset)?.verbose_map\n                  : explore?.datasource?.columns ?? {};\n                const chartStatus = chart?.chartStatus;\n                const { colnames, coltypes } =\n                  chart?.queriesResponse?.[0] ?? {};\n                const numericColumns =\n                  Array.isArray(colnames) && Array.isArray(coltypes)\n                    ? colnames\n                        .filter(\n                          (colname: string, index: number) =>\n                            coltypes[index] === GenericDataType.Numeric,\n                        )\n                        .map(colname => ({\n                          value: colname,\n                          label: verboseMap[colname] ?? colname,\n                        }))\n                    : [];\n                return {\n                  removeIrrelevantConditions: chartStatus === 'success',\n                  columnOptions: numericColumns,\n                  verboseMap,\n                };\n              },\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AdhocColumn,\n  buildQueryContext,\n  ensureIsArray,\n  getMetricLabel,\n  isPhysicalColumn,\n  QueryMode,\n  QueryObject,\n  removeDuplicates,\n} from '@superset-ui/core';\nimport { PostProcessingRule } from '@superset-ui/core/src/query/types/PostProcessing';\nimport { BuildQuery } from '@superset-ui/core/src/chart/registries/ChartBuildQueryRegistrySingleton';\nimport { TableChartFormData } from './types';\nimport { updateExternalFormData } from './DataTable/utils/externalAPIs';\n\n/**\n * Infer query mode from form data. If `all_columns` is set, then raw records mode,\n * otherwise defaults to aggregation mode.\n *\n * The same logic is used in `controlPanel` with control values as well.\n */\nexport function getQueryMode(formData: TableChartFormData) {\n  const { query_mode: mode } = formData;\n  if (mode === QueryMode.Aggregate || mode === QueryMode.Raw) {\n    return mode;\n  }\n  const rawColumns = formData?.all_columns;\n  const hasRawColumns = rawColumns && rawColumns.length > 0;\n  return hasRawColumns ? QueryMode.Raw : QueryMode.Aggregate;\n}\n\nconst buildQuery: BuildQuery<TableChartFormData> = (\n  formData: TableChartFormData,\n  options,\n) => {\n  const {\n    percent_metrics: percentMetrics,\n    order_desc: orderDesc = false,\n    extra_form_data,\n  } = formData;\n  const queryMode = getQueryMode(formData);\n  const sortByMetric = ensureIsArray(formData.timeseries_limit_metric)[0];\n  const time_grain_sqla =\n    extra_form_data?.time_grain_sqla || formData.time_grain_sqla;\n  let formDataCopy = formData;\n  // never include time in raw records mode\n  if (queryMode === QueryMode.Raw) {\n    formDataCopy = {\n      ...formData,\n      include_time: false,\n    };\n  }\n\n  return buildQueryContext(formDataCopy, baseQueryObject => {\n    let { metrics, orderby = [], columns = [] } = baseQueryObject;\n    let postProcessing: PostProcessingRule[] = [];\n\n    if (queryMode === QueryMode.Aggregate) {\n      metrics = metrics || [];\n      // override orderby with timeseries metric when in aggregation mode\n      if (sortByMetric) {\n        orderby = [[sortByMetric, !orderDesc]];\n      } else if (metrics?.length > 0) {\n        // default to ordering by first metric in descending order\n        // when no \"sort by\" metric is set (regardless if \"SORT DESC\" is set to true)\n        orderby = [[metrics[0], false]];\n      }\n      // add postprocessing for percent metrics only when in aggregation mode\n      if (percentMetrics && percentMetrics.length > 0) {\n        const percentMetricLabels = removeDuplicates(\n          percentMetrics.map(getMetricLabel),\n        );\n        metrics = removeDuplicates(\n          metrics.concat(percentMetrics),\n          getMetricLabel,\n        );\n        postProcessing = [\n          {\n            operation: 'contribution',\n            options: {\n              columns: percentMetricLabels,\n              rename_columns: percentMetricLabels.map(x => `%${x}`),\n            },\n          },\n        ];\n      }\n\n      columns = columns.map(col => {\n        if (\n          isPhysicalColumn(col) &&\n          time_grain_sqla &&\n          formData?.temporal_columns_lookup?.[col]\n        ) {\n          return {\n            timeGrain: time_grain_sqla,\n            columnType: 'BASE_AXIS',\n            sqlExpression: col,\n            label: col,\n            expressionType: 'SQL',\n          } as AdhocColumn;\n        }\n        return col;\n      });\n    }\n\n    const moreProps: Partial<QueryObject> = {};\n    const ownState = options?.ownState ?? {};\n    if (formDataCopy.server_pagination) {\n      moreProps.row_limit =\n        ownState.pageSize ?? formDataCopy.server_page_length;\n      moreProps.row_offset =\n        (ownState.currentPage ?? 0) * (ownState.pageSize ?? 0);\n    }\n\n    let queryObject = {\n      ...baseQueryObject,\n      columns,\n      orderby,\n      metrics,\n      post_processing: postProcessing,\n      ...moreProps,\n    };\n\n    if (\n      formData.server_pagination &&\n      options?.extras?.cachedChanges?.[formData.slice_id] &&\n      JSON.stringify(options?.extras?.cachedChanges?.[formData.slice_id]) !==\n        JSON.stringify(queryObject.filters)\n    ) {\n      queryObject = { ...queryObject, row_offset: 0 };\n      updateExternalFormData(\n        options?.hooks?.setDataMask,\n        0,\n        queryObject.row_limit ?? 0,\n      );\n    }\n    // Because we use same buildQuery for all table on the page we need split them by id\n    options?.hooks?.setCachedChanges({\n      [formData.slice_id]: queryObject.filters,\n    });\n\n    const extraQueries: QueryObject[] = [];\n    if (\n      metrics?.length &&\n      formData.show_totals &&\n      queryMode === QueryMode.Aggregate\n    ) {\n      extraQueries.push({\n        ...queryObject,\n        columns: [],\n        row_limit: 0,\n        row_offset: 0,\n        post_processing: [],\n        order_desc: undefined, // we don't need orderby stuff here,\n        orderby: undefined, // because this query will be used for get total aggregation.\n      });\n    }\n\n    const interactiveGroupBy = formData.extra_form_data?.interactive_groupby;\n    if (interactiveGroupBy && queryObject.columns) {\n      queryObject.columns = [\n        ...new Set([...queryObject.columns, ...interactiveGroupBy]),\n      ];\n    }\n\n    if (formData.server_pagination) {\n      return [\n        { ...queryObject },\n        {\n          ...queryObject,\n          row_limit: 0,\n          row_offset: 0,\n          post_processing: [],\n          is_rowcount: true,\n        },\n        ...extraQueries,\n      ];\n    }\n\n    return [queryObject, ...extraQueries];\n  });\n};\n\n// Use this closure to cache changing of external filters, if we have server pagination we need reset page to 0, after\n// external filter changed\nexport const cachedBuildQuery = (): BuildQuery<TableChartFormData> => {\n  let cachedChanges: any = {};\n  const setCachedChanges = (newChanges: any) => {\n    cachedChanges = { ...cachedChanges, ...newChanges };\n  };\n\n  return (formData, options) =>\n    buildQuery(\n      { ...formData },\n      {\n        extras: { cachedChanges },\n        ownState: options?.ownState ?? {},\n        hooks: {\n          ...options?.hooks,\n          setDataMask: () => {},\n          setCachedChanges,\n        },\n      },\n    );\n};\n\nexport default cachedBuildQuery();\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Table.jpg';\nimport example2 from './images/Table2.jpg';\nimport example3 from './images/Table3.jpg';\nimport controlPanel from './controlPanel';\nimport buildQuery from './buildQuery';\nimport { TableChartFormData, TableChartProps } from './types';\n\n// must export something for the module to be exist in dev mode\nexport { default as __hack__ } from './types';\nexport * from './types';\n\nconst metadata = new ChartMetadata({\n  behaviors: [\n    Behavior.InteractiveChart,\n    Behavior.DrillToDetail,\n    Behavior.DrillBy,\n  ],\n  category: t('Table'),\n  canBeAnnotationTypes: ['EVENT', 'INTERVAL'],\n  description: t(\n    'Classic row-by-column spreadsheet like view of a dataset. Use tables to showcase a view into the underlying data or to show aggregated metrics.',\n  ),\n  exampleGallery: [{ url: example1 }, { url: example2 }, { url: example3 }],\n  name: t('Table'),\n  tags: [\n    t('Additive'),\n    t('Business'),\n    t('Pattern'),\n    t('Popular'),\n    t('Report'),\n    t('Sequential'),\n    t('Tabular'),\n    t('Description'),\n  ],\n  thumbnail,\n});\n\nexport default class TableChartPlugin extends ChartPlugin<\n  TableChartFormData,\n  TableChartProps\n> {\n  constructor() {\n    super({\n      loadChart: () => import('./TableChart'),\n      metadata,\n      transformProps,\n      controlPanel,\n      buildQuery,\n    });\n  }\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { ChartProps, getColumnLabel } from '@superset-ui/core';\nimport { WordCloudProps, WordCloudEncoding } from '../chart/WordCloud';\nimport { LegacyWordCloudFormData } from './types';\n\nfunction getMetricLabel(\n  metric: LegacyWordCloudFormData['metric'],\n): string | undefined {\n  if (typeof metric === 'string' || typeof metric === 'undefined') {\n    return metric;\n  }\n  if (Array.isArray(metric)) {\n    return metric.length > 0 ? getMetricLabel(metric[0]) : undefined;\n  }\n\n  return metric.label;\n}\n\nexport default function transformProps(chartProps: ChartProps): WordCloudProps {\n  const { width, height, formData, queriesData } = chartProps;\n  const {\n    colorScheme,\n    metric,\n    rotation,\n    series,\n    sizeFrom = 0,\n    sizeTo,\n    sliceId,\n  } = formData as LegacyWordCloudFormData;\n\n  const metricLabel = getMetricLabel(metric);\n  const seriesLabel = getColumnLabel(series);\n\n  const encoding: Partial<WordCloudEncoding> = {\n    color: {\n      field: seriesLabel,\n      scale: {\n        scheme: colorScheme,\n      },\n      type: 'nominal',\n    },\n    fontSize:\n      typeof metricLabel === 'undefined'\n        ? undefined\n        : {\n            field: metricLabel,\n            scale: {\n              range: [sizeFrom, sizeTo],\n              zero: true,\n            },\n            type: 'quantitative',\n          },\n    text: {\n      field: seriesLabel,\n    },\n  };\n\n  return {\n    data: queriesData[0].data,\n    encoding,\n    height,\n    rotation,\n    width,\n    sliceId,\n  };\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { buildQueryContext } from '@superset-ui/core';\nimport { WordCloudFormData } from '../types';\n\nexport default function buildQuery(formData: WordCloudFormData) {\n  // Set the single QueryObject's groupby field with series in formData\n  const { metric, sort_by_metric } = formData;\n\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      ...(sort_by_metric && { orderby: [[metric, false]] }),\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['series'],\n        ['metric'],\n        ['adhoc_filters'],\n        ['row_limit'],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Options'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'size_from',\n            config: {\n              type: 'TextControl',\n              isInt: true,\n              label: t('Minimum Font Size'),\n              renderTrigger: true,\n              default: 10,\n              description: t('Font size for the smallest value in the list'),\n            },\n          },\n          {\n            name: 'size_to',\n            config: {\n              type: 'TextControl',\n              isInt: true,\n              label: t('Maximum Font Size'),\n              renderTrigger: true,\n              default: 70,\n              description: t('Font size for the biggest value in the list'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'rotation',\n            config: {\n              type: 'SelectControl',\n              label: t('Word Rotation'),\n              choices: [\n                ['random', t('random')],\n                ['flat', t('flat')],\n                ['square', t('square')],\n              ],\n              renderTrigger: true,\n              default: 'square',\n              clearable: false,\n              description: t('Rotation to apply to words in the cloud'),\n            },\n          },\n        ],\n        ['color_scheme'],\n      ],\n    },\n  ],\n  controlOverrides: {\n    series: {\n      validators: [validateNonEmpty],\n      clearable: false,\n    },\n    row_limit: {\n      default: 100,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    series: getStandardizedControls().shiftColumn(),\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport {\n  Encodable,\n  ColorSchemeResolver,\n  TimeFormatResolver,\n  CategoricalColorScaleResolver,\n  defaultColorSchemeResolver,\n  addPrefix,\n} from 'encodable';\nimport {\n  CategoricalColorNamespace,\n  getCategoricalSchemeRegistry,\n  getSequentialSchemeRegistry,\n  getNumberFormatter,\n  getTimeFormatter,\n  LOCAL_PREFIX,\n  getTimeFormatterRegistry,\n} from '@superset-ui/core';\n\nconst timeFormat: TimeFormatResolver = ({\n  format,\n  formatInLocalTime = false,\n} = {}) => {\n  const formatString = formatInLocalTime\n    ? addPrefix(\n        LOCAL_PREFIX,\n        format ?? getTimeFormatterRegistry().getDefaultKey()!,\n      )\n    : format;\n\n  return getTimeFormatter(formatString);\n};\n\nconst colorSchemeResolver: ColorSchemeResolver = ({\n  name,\n  type = 'categorical',\n} = {}) => {\n  if (type === 'sequential') {\n    const scheme = getSequentialSchemeRegistry().get(name);\n\n    return typeof scheme === 'undefined'\n      ? scheme\n      : { type: 'sequential', ...scheme };\n  }\n  if (type === 'categorical') {\n    const scheme = getCategoricalSchemeRegistry().get(name);\n\n    return typeof scheme === 'undefined'\n      ? scheme\n      : { type: 'categorical', ...scheme };\n  }\n  return defaultColorSchemeResolver({ name, type });\n};\n\nconst colorScaleResolver: CategoricalColorScaleResolver = ({\n  name,\n  namespace,\n} = {}) => CategoricalColorNamespace.getScale(name, namespace);\n\nexport default function configureEncodable() {\n  Encodable.setNumberFormatResolver(getNumberFormatter)\n    .setTimeFormatResolver(timeFormat)\n    .setColorSchemeResolver(colorSchemeResolver)\n    .setCategoricalColorScaleResolver(colorScaleResolver);\n}\n","/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from '../legacyPlugin/transformProps';\nimport buildQuery from './buildQuery';\nimport { WordCloudFormData } from '../types';\nimport thumbnail from '../images/thumbnail.png';\nimport example1 from '../images/Word_Cloud.jpg';\nimport example2 from '../images/Word_Cloud_2.jpg';\nimport controlPanel from './controlPanel';\nimport configureEncodable from '../configureEncodable';\n\nconfigureEncodable();\n\nconst metadata = new ChartMetadata({\n  category: t('Ranking'),\n  credits: ['https://github.com/jasondavies/d3-cloud'],\n  description: t(\n    'Visualizes the words in a column that appear the most often. Bigger font corresponds to higher frequency.',\n  ),\n  exampleGallery: [{ url: example1 }, { url: example2 }],\n  name: t('Word Cloud'),\n  tags: [\n    t('Aesthetic'),\n    t('Categorical'),\n    t('Comparison'),\n    t('Description'),\n    t('Density'),\n    t('Single Metric'),\n  ],\n  thumbnail,\n});\n\nexport default class WordCloudChartPlugin extends ChartPlugin<WordCloudFormData> {\n  constructor() {\n    super({\n      buildQuery,\n      loadChart: () => import('../chart/WordCloud'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { rgb } from 'd3-color';\nimport { getValueFormatter } from '@superset-ui/core';\n\nexport default function transformProps(chartProps) {\n  const {\n    width,\n    height,\n    formData,\n    queriesData,\n    hooks,\n    inContextMenu,\n    filterState,\n    emitCrossFilters,\n    datasource,\n  } = chartProps;\n  const { onContextMenu, setDataMask } = hooks;\n  const {\n    countryFieldtype,\n    entity,\n    maxBubbleSize,\n    showBubbles,\n    linearColorScheme,\n    colorPicker,\n    colorBy,\n    colorScheme,\n    sliceId,\n    metric,\n    yAxisFormat,\n    currencyFormat,\n  } = formData;\n  const { r, g, b } = colorPicker;\n  const { currencyFormats = {}, columnFormats = {} } = datasource;\n\n  const formatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    yAxisFormat,\n    currencyFormat,\n  );\n\n  return {\n    countryFieldtype,\n    entity,\n    data: queriesData[0].data,\n    width,\n    height,\n    maxBubbleSize: parseInt(maxBubbleSize, 10),\n    showBubbles,\n    linearColorScheme,\n    color: rgb(r, g, b).hex(),\n    colorBy,\n    colorScheme,\n    sliceId,\n    onContextMenu,\n    setDataMask,\n    inContextMenu,\n    filterState,\n    emitCrossFilters,\n    formatter,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  formatSelectOptions,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { ColorBy } from './utils';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['entity'],\n        [\n          {\n            name: 'country_fieldtype',\n            config: {\n              type: 'SelectControl',\n              label: t('Country Field Type'),\n              default: 'cca2',\n              choices: [\n                ['name', t('Full name')],\n                ['cioc', t('code International Olympic Committee (cioc)')],\n                ['cca2', t('code ISO 3166-1 alpha-2 (cca2)')],\n                ['cca3', t('code ISO 3166-1 alpha-3 (cca3)')],\n              ],\n              description: t(\n                'The country code standard that Superset should expect ' +\n                  'to find in the [country] column',\n              ),\n            },\n          },\n        ],\n        ['metric'],\n        ['adhoc_filters'],\n        ['row_limit'],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Options'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'show_bubbles',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Bubbles'),\n              default: false,\n              renderTrigger: true,\n              description: t('Whether to display bubbles on top of countries'),\n            },\n          },\n        ],\n        ['secondary_metric'],\n        [\n          {\n            name: 'max_bubble_size',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Max Bubble Size'),\n              default: '25',\n              choices: formatSelectOptions([\n                '5',\n                '10',\n                '15',\n                '25',\n                '50',\n                '75',\n                '100',\n              ]),\n            },\n          },\n        ],\n        ['color_picker'],\n        [\n          {\n            name: 'color_by',\n            config: {\n              type: 'RadioButtonControl',\n              label: t('Color by'),\n              default: ColorBy.Metric,\n              options: [\n                [ColorBy.Metric, t('Metric')],\n                [ColorBy.Country, t('Country')],\n              ],\n              description: t(\n                'Choose whether a country should be shaded by the metric, or assigned a color based on a categorical color palette',\n              ),\n            },\n          },\n        ],\n        ['linear_color_scheme'],\n        ['color_scheme'],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [['y_axis_format'], ['currency_format']],\n    },\n  ],\n  controlOverrides: {\n    entity: {\n      label: t('Country Column'),\n      description: t('3 letter code of the country'),\n    },\n    secondary_metric: {\n      label: t('Bubble Size'),\n      description: t('Metric that defines the size of the bubble'),\n    },\n    color_picker: {\n      label: t('Bubble Color'),\n    },\n    linear_color_scheme: {\n      label: t('Country Color Scheme'),\n      visibility: ({ controls }) =>\n        Boolean(controls?.color_by.value === ColorBy.Metric),\n    },\n    color_scheme: {\n      label: t('Country Color Scheme'),\n      visibility: ({ controls }) =>\n        Boolean(controls?.color_by.value === ColorBy.Country),\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    entity: getStandardizedControls().shiftColumn(),\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin, Behavior } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/WorldMap1.jpg';\nimport example2 from './images/WorldMap2.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['http://datamaps.github.io/'],\n  description: t(\n    'A map of the world, that can indicate values in different countries.',\n  ),\n  exampleGallery: [{ url: example1 }, { url: example2 }],\n  name: t('World Map'),\n  tags: [\n    t('2D'),\n    t('Aesthetic'),\n    t('Comparison'),\n    t('Intensity'),\n    t('Legacy'),\n    t('Multi-Dimensions'),\n    t('Multi-Layers'),\n    t('Multi-Variables'),\n    t('Scatter'),\n    t('Popular'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n  behaviors: [\n    Behavior.InteractiveChart,\n    Behavior.DrillToDetail,\n    Behavior.DrillBy,\n  ],\n});\n\nexport default class WorldMapChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./ReactWorldMap'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { validateNumber } from '@superset-ui/core';\n\nexport function tokenizeToNumericArray(value?: string): number[] | null {\n  if (!value?.trim()) return null;\n  const tokens = value.split(',');\n  if (tokens.some(token => validateNumber(token)))\n    throw new Error('All values should be numeric');\n  return tokens.map(token => parseFloat(token));\n}\n\nexport function tokenizeToStringArray(value?: string): string[] | null {\n  if (!value?.trim()) return null;\n  const tokens = value.split(',');\n  return tokens.map(token => token.trim());\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport isTruthy from './utils/isTruthy';\nimport {\n  tokenizeToNumericArray,\n  tokenizeToStringArray,\n} from './utils/tokenize';\nimport { formatLabel } from './utils';\n\nconst NOOP = () => {};\n\nconst grabD3Format = (datasource, targetMetric) => {\n  let foundFormatter;\n  const { metrics = [] } = datasource || {};\n  metrics.forEach(metric => {\n    if (metric.d3format && metric.metric_name === targetMetric) {\n      foundFormatter = metric.d3format;\n    }\n  });\n\n  return foundFormatter;\n};\n\nexport default function transformProps(chartProps) {\n  const {\n    width,\n    height,\n    annotationData,\n    datasource,\n    formData,\n    hooks,\n    queriesData,\n  } = chartProps;\n\n  const { onAddFilter = NOOP, onError = NOOP } = hooks;\n\n  const {\n    annotationLayers,\n    barStacked,\n    bottomMargin,\n    colorPicker,\n    colorScheme,\n    comparisonType,\n    contribution,\n    donut,\n    entity,\n    labelsOutside,\n    leftMargin,\n    lineInterpolation,\n    maxBubbleSize,\n    metric,\n    metrics = [],\n    orderBars,\n    pieLabelType,\n    reduceXTicks,\n    richTooltip,\n    sendTimeRange,\n    showBarValue,\n    showBrush,\n    showControls,\n    showLabels,\n    showLegend,\n    showMarkers,\n    size,\n    stackedStyle,\n    vizType,\n    x,\n    xAxisFormat,\n    xAxisLabel,\n    xAxisShowminmax,\n    xLogScale,\n    xTicksLayout,\n    y,\n    yAxisBounds,\n    yAxis2Bounds,\n    yAxisLabel,\n    yAxisShowminmax,\n    yAxis2Showminmax,\n    yLogScale,\n    sliceId,\n  } = formData;\n\n  let {\n    markerLabels,\n    markerLines,\n    markerLineLabels,\n    markers,\n    numberFormat,\n    rangeLabels,\n    ranges,\n    yAxisFormat,\n  } = formData;\n\n  const rawData = queriesData[0].data || [];\n  const data = Array.isArray(rawData)\n    ? rawData.map(row => ({\n        ...row,\n        values: row.values.map(value => ({ ...value })),\n        key: formatLabel(row.key, datasource.verboseMap),\n      }))\n    : rawData;\n\n  if (vizType === 'pie') {\n    numberFormat = numberFormat || grabD3Format(datasource, metric);\n  } else if (\n    ['line', 'dist_bar', 'bar', 'area'].includes(chartProps.formData.vizType)\n  ) {\n    yAxisFormat =\n      yAxisFormat ||\n      grabD3Format(datasource, metrics.length > 0 ? metrics[0] : undefined);\n  } else if (vizType === 'bullet') {\n    ranges = tokenizeToNumericArray(ranges) || [0, data.measures * 1.1];\n    rangeLabels = tokenizeToStringArray(rangeLabels);\n    markerLabels = tokenizeToStringArray(markerLabels);\n    markerLines = tokenizeToNumericArray(markerLines);\n    markerLineLabels = tokenizeToStringArray(markerLineLabels);\n    markers = tokenizeToNumericArray(markers);\n  }\n\n  return {\n    width,\n    height,\n    data,\n    annotationData,\n    annotationLayers,\n    areaStackedStyle: stackedStyle,\n    baseColor: colorPicker,\n    bottomMargin,\n    colorScheme,\n    comparisonType,\n    contribution,\n    entity,\n    isBarStacked: barStacked,\n    isDonut: donut,\n    isPieLabelOutside: labelsOutside,\n    leftMargin,\n    lineInterpolation,\n    markerLabels,\n    markerLines,\n    markerLineLabels,\n    markers,\n    maxBubbleSize: parseInt(maxBubbleSize, 10),\n    numberFormat,\n    onBrushEnd: isTruthy(sendTimeRange)\n      ? timeRange => {\n          onAddFilter('__time_range', timeRange, false, true);\n        }\n      : undefined,\n    onError,\n    orderBars,\n    pieLabelType,\n    rangeLabels,\n    ranges,\n    reduceXTicks,\n    showBarValue,\n    showBrush,\n    showControls,\n    showLabels,\n    showLegend,\n    showMarkers,\n    sizeField: size,\n    useRichTooltip: richTooltip,\n    vizType,\n    xAxisFormat,\n    xAxisLabel,\n    xAxisShowMinMax: xAxisShowminmax,\n    xField: x,\n    xIsLogScale: xLogScale,\n    xTicksLayout,\n    yAxisFormat,\n    yAxisBounds,\n    yAxis2Bounds,\n    yAxisLabel,\n    yAxisShowMinMax: yAxisShowminmax,\n    yAxis2ShowMinMax: yAxis2Showminmax,\n    yField: y,\n    yIsLogScale: yLogScale,\n    sliceId,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable react/jsx-key */\n\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelSectionConfig,\n  ControlSubSectionHeader,\n  CustomControlItem,\n  D3_TIME_FORMAT_OPTIONS,\n  D3_FORMAT_DOCS,\n  D3_FORMAT_OPTIONS,\n} from '@superset-ui/chart-controls';\n\n/*\n  Plugins in question:\n\n  AreaChartPlugin,\n  BarChartPlugin,\n  BubbleChartPlugin,\n  BulletChartPlugin,\n  CompareChartPlugin,\n  DistBarChartPlugin,\n  DualLineChartPlugin,\n  LineChartPlugin,\n  LineMultiChartPlugin,\n  PieChartPlugin,\n  TimePivotChartPlugin,\n*/\n\nexport const yAxis2Format: CustomControlItem = {\n  name: 'y_axis_2_format',\n  config: {\n    type: 'SelectControl',\n    freeForm: true,\n    label: t('Right Axis Format'),\n    default: 'SMART_NUMBER',\n    choices: D3_FORMAT_OPTIONS,\n    description: D3_FORMAT_DOCS,\n  },\n};\n\nexport const showMarkers: CustomControlItem = {\n  name: 'show_markers',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Show Markers'),\n    renderTrigger: true,\n    default: false,\n    description: t('Show data points as circle markers on the lines'),\n  },\n};\n\nexport const leftMargin: CustomControlItem = {\n  name: 'left_margin',\n  config: {\n    type: 'SelectControl',\n    freeForm: true,\n    clearable: false,\n    label: t('Left Margin'),\n    choices: [\n      ['auto', t('auto')],\n      [50, '50'],\n      [75, '75'],\n      [100, '100'],\n      [125, '125'],\n      [150, '150'],\n      [200, '200'],\n    ],\n    default: 'auto',\n    renderTrigger: true,\n    description: t(\n      'Left margin, in pixels, allowing for more room for axis labels',\n    ),\n  },\n};\n\nexport const yAxisShowMinmax: CustomControlItem = {\n  name: 'y_axis_showminmax',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Y bounds'),\n    renderTrigger: true,\n    default: false,\n    description: t('Whether to display the min and max values of the Y-axis'),\n  },\n};\n\nexport const yAxis2ShowMinmax: CustomControlItem = {\n  name: 'y_axis_2_showminmax',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Y 2 bounds'),\n    renderTrigger: true,\n    default: false,\n    description: t('Whether to display the min and max values of the Y-axis'),\n  },\n};\n\nexport const lineInterpolation: CustomControlItem = {\n  name: 'line_interpolation',\n  config: {\n    type: 'SelectControl',\n    label: t('Line Style'),\n    renderTrigger: true,\n    choices: [\n      ['linear', t('linear')],\n      ['basis', t('basis')],\n      ['cardinal', t('cardinal')],\n      ['monotone', t('monotone')],\n      ['step-before', t('step-before')],\n      ['step-after', t('step-after')],\n    ],\n    default: 'linear',\n    description: t('Line interpolation as defined by d3.js'),\n  },\n};\n\nexport const showBrush: CustomControlItem = {\n  name: 'show_brush',\n  config: {\n    type: 'SelectControl',\n    label: t('Show Range Filter'),\n    renderTrigger: true,\n    clearable: false,\n    default: 'auto',\n    choices: [\n      ['yes', t('Yes')],\n      ['no', t('No')],\n      ['auto', t('Auto')],\n    ],\n    description: t('Whether to display the time range interactive selector'),\n  },\n};\n\nexport const showLegend: CustomControlItem = {\n  name: 'show_legend',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Legend'),\n    renderTrigger: true,\n    default: true,\n    description: t('Whether to display the legend (toggles)'),\n  },\n};\n\nexport const showControls: CustomControlItem = {\n  name: 'show_controls',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Extra Controls'),\n    renderTrigger: true,\n    default: false,\n    description: t(\n      'Whether to show extra controls or not. Extra controls ' +\n        'include things like making mulitBar charts stacked ' +\n        'or side by side.',\n    ),\n  },\n};\n\nexport const xAxisLabel: CustomControlItem = {\n  name: 'x_axis_label',\n  config: {\n    type: 'TextControl',\n    label: t('X Axis Label'),\n    renderTrigger: true,\n    default: '',\n  },\n};\n\nexport const bottomMargin: CustomControlItem = {\n  name: 'bottom_margin',\n  config: {\n    type: 'SelectControl',\n    clearable: false,\n    freeForm: true,\n    label: t('Bottom Margin'),\n    choices: [\n      ['auto', t('auto')],\n      [50, '50'],\n      [75, '75'],\n      [100, '100'],\n      [125, '125'],\n      [150, '150'],\n      [200, '200'],\n    ],\n    default: 'auto',\n    renderTrigger: true,\n    description: t(\n      'Bottom margin, in pixels, allowing for more room for axis labels',\n    ),\n  },\n};\n\nexport const xTicksLayout: CustomControlItem = {\n  name: 'x_ticks_layout',\n  config: {\n    type: 'SelectControl',\n    label: t('X Tick Layout'),\n    choices: [\n      ['auto', t('auto')],\n      ['flat', t('flat')],\n      ['45', '45'],\n      ['staggered', t('staggered')],\n    ],\n    default: 'auto',\n    clearable: false,\n    renderTrigger: true,\n    description: t('The way the ticks are laid out on the X-axis'),\n  },\n};\n\nexport const xAxisFormat: CustomControlItem = {\n  name: 'x_axis_format',\n  config: {\n    type: 'SelectControl',\n    freeForm: true,\n    label: t('X Axis Format'),\n    renderTrigger: true,\n    choices: D3_TIME_FORMAT_OPTIONS,\n    default: 'smart_date',\n    description: D3_FORMAT_DOCS,\n  },\n};\n\nexport const yLogScale: CustomControlItem = {\n  name: 'y_log_scale',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Y Log Scale'),\n    default: false,\n    renderTrigger: true,\n    description: t('Use a log scale for the Y-axis'),\n  },\n};\n\nexport const yAxisBounds: CustomControlItem = {\n  name: 'y_axis_bounds',\n  config: {\n    type: 'BoundsControl',\n    label: t('Y Axis Bounds'),\n    renderTrigger: true,\n    default: [null, null],\n    description: t(\n      'Bounds for the Y-axis. When left empty, the bounds are ' +\n        'dynamically defined based on the min/max of the data. Note that ' +\n        \"this feature will only expand the axis range. It won't \" +\n        \"narrow the data's extent.\",\n    ),\n  },\n};\n\nexport const yAxis2Bounds: CustomControlItem = {\n  name: 'y_axis_2_bounds',\n  config: {\n    type: 'BoundsControl',\n    label: t('Y Axis 2 Bounds'),\n    renderTrigger: true,\n    default: [null, null],\n    description: t(\n      'Bounds for the Y-axis. When left empty, the bounds are ' +\n        'dynamically defined based on the min/max of the data. Note that ' +\n        \"this feature will only expand the axis range. It won't \" +\n        \"narrow the data's extent.\",\n    ),\n  },\n};\n\nexport const xAxisShowMinmax: CustomControlItem = {\n  name: 'x_axis_showminmax',\n  config: {\n    type: 'CheckboxControl',\n    label: t('X bounds'),\n    renderTrigger: true,\n    default: false,\n    description: t('Whether to display the min and max values of the X-axis'),\n  },\n};\n\nexport const richTooltip: CustomControlItem = {\n  name: 'rich_tooltip',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Rich Tooltip'),\n    renderTrigger: true,\n    default: true,\n    description: t(\n      'The rich tooltip shows a list of all series for that point in time',\n    ),\n  },\n};\n\nexport const showBarValue: CustomControlItem = {\n  name: 'show_bar_value',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Bar Values'),\n    default: false,\n    renderTrigger: true,\n    description: t('Show the value on top of the bar'),\n  },\n};\n\nexport const barStacked: CustomControlItem = {\n  name: 'bar_stacked',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Stacked Bars'),\n    renderTrigger: true,\n    default: false,\n    description: null,\n  },\n};\n\nexport const reduceXTicks: CustomControlItem = {\n  name: 'reduce_x_ticks',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Reduce X ticks'),\n    renderTrigger: true,\n    default: false,\n    description: t(\n      'Reduces the number of X-axis ticks to be rendered. ' +\n        'If true, the x-axis will not overflow and labels may be ' +\n        'missing. If false, a minimum width will be applied ' +\n        'to columns and the width may overflow into an ' +\n        'horizontal scroll.',\n    ),\n  },\n};\n\nexport const yAxisLabel: CustomControlItem = {\n  name: 'y_axis_label',\n  config: {\n    type: 'TextControl',\n    label: t('Y Axis Label'),\n    renderTrigger: true,\n    default: '',\n  },\n};\n\nexport const timeSeriesSection: ControlPanelSectionConfig[] = [\n  {\n    label: t('Query'),\n    expanded: true,\n    controlSetRows: [\n      ['metrics'],\n      ['adhoc_filters'],\n      ['groupby'],\n      ['limit'],\n      ['timeseries_limit_metric'],\n      ['order_desc'],\n      [\n        {\n          name: 'contribution',\n          config: {\n            type: 'CheckboxControl',\n            label: t('Contribution'),\n            default: false,\n            description: t('Compute the contribution to the total'),\n          },\n        },\n      ],\n      ['row_limit', null],\n    ],\n  },\n  {\n    label: t('Advanced Analytics'),\n    tabOverride: 'data',\n    description: t(\n      'This section contains options ' +\n        'that allow for advanced analytical post processing ' +\n        'of query results',\n    ),\n    controlSetRows: [\n      [\n        <ControlSubSectionHeader>\n          {t('Rolling Window')}\n        </ControlSubSectionHeader>,\n      ],\n      [\n        {\n          name: 'rolling_type',\n          config: {\n            type: 'SelectControl',\n            label: t('Rolling Function'),\n            default: 'None',\n            choices: [\n              ['None', t('None')],\n              ['mean', t('mean')],\n              ['sum', t('sum')],\n              ['std', t('std')],\n              ['cumsum', t('cumsum')],\n            ],\n            description: t(\n              'Defines a rolling window function to apply, works along ' +\n                'with the [Periods] text box',\n            ),\n          },\n        },\n      ],\n      [\n        {\n          name: 'rolling_periods',\n          config: {\n            type: 'TextControl',\n            label: t('Periods'),\n            isInt: true,\n            description: t(\n              'Defines the size of the rolling window function, ' +\n                'relative to the time granularity selected',\n            ),\n          },\n        },\n      ],\n      [\n        {\n          name: 'min_periods',\n          config: {\n            type: 'TextControl',\n            label: t('Min Periods'),\n            isInt: true,\n            description: t(\n              'The minimum number of rolling periods required to show ' +\n                'a value. For instance if you do a cumulative sum on 7 days ' +\n                'you may want your \"Min Period\" to be 7, so that all data points ' +\n                'shown are the total of 7 periods. This will hide the \"ramp up\" ' +\n                'taking place over the first 7 periods',\n            ),\n          },\n        },\n      ],\n      [\n        <ControlSubSectionHeader>\n          {t('Time Comparison')}\n        </ControlSubSectionHeader>,\n      ],\n      [\n        {\n          name: 'time_compare',\n          config: {\n            type: 'SelectControl',\n            multi: true,\n            freeForm: true,\n            label: t('Time Shift'),\n            choices: [\n              ['1 day', t('1 day')],\n              ['1 week', t('1 week')],\n              ['28 days', t('28 days')],\n              ['30 days', t('30 days')],\n              ['52 weeks', t('52 weeks')],\n              ['1 year', t('1 year')],\n              ['104 weeks', t('104 weeks')],\n              ['2 years', t('2 years')],\n              ['156 weeks', t('156 weeks')],\n              ['3 years', t('3 years')],\n            ],\n            description: t(\n              'Overlay one or more timeseries from a ' +\n                'relative time period. Expects relative time deltas ' +\n                'in natural language (example: 24 hours, 7 days, ' +\n                '52 weeks, 365 days). Free text is supported.',\n            ),\n          },\n        },\n      ],\n      [\n        {\n          name: 'comparison_type',\n          config: {\n            type: 'SelectControl',\n            label: t('Calculation type'),\n            default: 'values',\n            choices: [\n              ['values', t('Actual Values')],\n              ['absolute', t('Difference')],\n              ['percentage', t('Percentage change')],\n              ['ratio', t('Ratio')],\n            ],\n            description: t(\n              'How to display time shifts: as individual lines; as the ' +\n                'difference between the main time series and each time shift; ' +\n                'as the percentage change; or as the ratio between series and time shifts.',\n            ),\n          },\n        },\n      ],\n      [<ControlSubSectionHeader>{t('Resample')}</ControlSubSectionHeader>],\n      [\n        {\n          name: 'resample_rule',\n          config: {\n            type: 'SelectControl',\n            freeForm: true,\n            label: t('Rule'),\n            default: null,\n            choices: [\n              ['1T', t('1T')],\n              ['1H', t('1H')],\n              ['1D', t('1D')],\n              ['7D', t('7D')],\n              ['1M', t('1M')],\n              ['1AS', t('1AS')],\n            ],\n            description: t('Pandas resample rule'),\n          },\n        },\n      ],\n      [\n        {\n          name: 'resample_method',\n          config: {\n            type: 'SelectControl',\n            freeForm: true,\n            label: t('Method'),\n            default: null,\n            choices: [\n              ['asfreq', t('asfreq')],\n              ['bfill', t('bfill')],\n              ['ffill', t('ffill')],\n              ['median', t('median')],\n              ['mean', t('mean')],\n              ['sum', t('sum')],\n            ],\n            description: t('Pandas resample method'),\n          },\n        },\n      ],\n    ],\n  },\n];\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport { ControlPanelConfig, sections } from '@superset-ui/chart-controls';\nimport {\n  lineInterpolation,\n  showBrush,\n  showLegend,\n  showControls,\n  xAxisLabel,\n  bottomMargin,\n  xTicksLayout,\n  xAxisFormat,\n  yLogScale,\n  yAxisBounds,\n  xAxisShowMinmax,\n  richTooltip,\n  timeSeriesSection,\n} from '../NVD3Controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.legacyTimeseriesTime,\n    timeSeriesSection[0],\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        [showBrush, showLegend],\n        [\n          lineInterpolation,\n          {\n            name: 'stacked_style',\n            config: {\n              type: 'SelectControl',\n              label: t('Stacked Style'),\n              renderTrigger: true,\n              choices: [\n                ['stack', t('stack')],\n                ['stream', t('stream')],\n                ['expand', t('expand')],\n              ],\n              default: 'stack',\n              description: '',\n            },\n          },\n        ],\n        ['color_scheme'],\n        [richTooltip, showControls],\n      ],\n    },\n    {\n      label: t('X Axis'),\n      tabOverride: 'customize',\n      expanded: true,\n      controlSetRows: [\n        [xAxisLabel, bottomMargin],\n        [xTicksLayout, xAxisFormat],\n        [xAxisShowMinmax, null],\n      ],\n    },\n    {\n      label: t('Y Axis'),\n      tabOverride: 'customize',\n      expanded: true,\n      controlSetRows: [\n        ['y_axis_format', yAxisBounds],\n        [yLogScale, null],\n      ],\n    },\n    timeSeriesSection[1],\n    sections.annotations,\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin, ChartLabel } from '@superset-ui/core';\nimport transformProps from '../transformProps';\nimport example1 from './images/example1.jpg';\nimport example2 from './images/example2.jpg';\nimport example3 from './images/example3.jpg';\nimport example4 from './images/example4.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport { ANNOTATION_TYPES } from '../vendor/superset/AnnotationTypes';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Evolution'),\n  credits: ['http://nvd3.org'],\n  description: t(\n    'A time series chart that visualizes how a related metric from multiple groups vary over time. Each group is visualized using a different color.',\n  ),\n  exampleGallery: [\n    { url: example1, caption: t('Stretched style') },\n    { url: example2, caption: t('Stacked style') },\n    { url: example3, caption: t('Video game consoles') },\n    { url: example4, caption: t('Vehicle Types') },\n  ],\n  label: ChartLabel.Deprecated,\n  name: t('Time-series Area Chart (legacy)'),\n  supportedAnnotationTypes: [ANNOTATION_TYPES.INTERVAL, ANNOTATION_TYPES.EVENT],\n  tags: [\n    t('Aesthetic'),\n    t('Comparison'),\n    t('Continuous'),\n    t('Legacy'),\n    t('Line'),\n    t('Percentages'),\n    t('Proportional'),\n    t('Stacked'),\n    t('Time'),\n    t('Trend'),\n    t('nvd3'),\n    t('Deprecated'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\n/**\n * @deprecated in version 3.0.\n */\nexport default class AreaChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('../ReactNVD3'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport {\n  lineInterpolation,\n  showBrush,\n  showLegend,\n  showControls,\n  xAxisLabel,\n  yAxisLabel,\n  bottomMargin,\n  xTicksLayout,\n  xAxisFormat,\n  yLogScale,\n  yAxisBounds,\n  xAxisShowMinmax,\n  yAxisShowMinmax,\n  richTooltip,\n  showBarValue,\n  barStacked,\n  reduceXTicks,\n  leftMargin,\n  timeSeriesSection,\n} from '../NVD3Controls';\n\nconst config: ControlPanelConfig = {\n  controlOverrides: {\n    limit: {\n      rerender: ['timeseries_limit_metric', 'order_desc'],\n    },\n    timeseries_limit_metric: {\n      label: t('Series Limit Sort By'),\n      description: t(\n        'Metric used to order the limit if a series limit is present. ' +\n          'If undefined reverts to the first metric (where appropriate).',\n      ),\n      visibility: ({ controls }) => Boolean(controls?.limit.value),\n      mapStateToProps: (state, controlState) => {\n        const timeserieslimitProps =\n          sharedControls.timeseries_limit_metric.mapStateToProps?.(\n            state,\n            controlState,\n          ) || {};\n        timeserieslimitProps.value = state.controls?.limit?.value\n          ? controlState?.value\n          : [];\n        return timeserieslimitProps;\n      },\n    },\n    order_desc: {\n      label: t('Series Limit Sort Descending'),\n      default: false,\n      description: t(\n        'Whether to sort descending or ascending if a series limit is present',\n      ),\n      visibility: ({ controls }) => Boolean(controls?.limit.value),\n    },\n  },\n  controlPanelSections: [\n    sections.legacyTimeseriesTime,\n    timeSeriesSection[0],\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        [showBrush],\n        [showLegend],\n        [showBarValue],\n        [richTooltip],\n        [barStacked],\n        [lineInterpolation],\n        [showControls],\n        [bottomMargin],\n      ],\n    },\n    {\n      label: t('X Axis'),\n      expanded: true,\n      controlSetRows: [\n        [xAxisLabel],\n        [bottomMargin],\n        [xTicksLayout],\n        [xAxisFormat],\n        [xAxisShowMinmax],\n        [reduceXTicks],\n      ],\n    },\n    {\n      label: t('Y Axis'),\n      expanded: true,\n      controlSetRows: [\n        [yAxisLabel],\n        [leftMargin],\n        [yAxisShowMinmax],\n        [yLogScale],\n        ['y_axis_format'],\n        [yAxisBounds],\n      ],\n    },\n    timeSeriesSection[1],\n    sections.annotations,\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin, ChartLabel } from '@superset-ui/core';\nimport transformProps from '../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Time_Series_Bar_Chart.jpg';\nimport example2 from './images/Time_Series_Bar_Chart2.jpg';\nimport example3 from './images/Time_Series_Bar_Chart3.jpg';\nimport { ANNOTATION_TYPES } from '../vendor/superset/AnnotationTypes';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Evolution'),\n  credits: ['http://nvd3.org'],\n  description: t(\n    'Visualize how a metric changes over time using bars. Add a group by column to visualize group level metrics and how they change over time.',\n  ),\n  exampleGallery: [{ url: example1 }, { url: example2 }, { url: example3 }],\n  label: ChartLabel.Deprecated,\n  name: t('Time-series Bar Chart (legacy)'),\n  supportedAnnotationTypes: [ANNOTATION_TYPES.INTERVAL, ANNOTATION_TYPES.EVENT],\n  tags: [\n    t('Bar'),\n    t('Time'),\n    t('Trend'),\n    t('Stacked'),\n    t('Vertical'),\n    t('Percentages'),\n    t('Proportional'),\n    t('Advanced-Analytics'),\n    t('nvd3'),\n    t('Legacy'),\n    t('Deprecated'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\n/**\n * @deprecated in version 3.0.\n */\nexport default class BarChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('../ReactNVD3'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  formatSelectOptions,\n  D3_FORMAT_OPTIONS,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport {\n  showLegend,\n  xAxisLabel,\n  yAxisLabel,\n  bottomMargin,\n  xTicksLayout,\n  xAxisFormat,\n  yLogScale,\n  xAxisShowMinmax,\n  yAxisShowMinmax,\n  leftMargin,\n  yAxisBounds,\n} from '../NVD3Controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['series'],\n        ['entity'],\n        ['x'],\n        ['y'],\n        ['adhoc_filters'],\n        ['size'],\n        [\n          {\n            name: 'max_bubble_size',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Max Bubble Size'),\n              default: '25',\n              choices: formatSelectOptions([\n                '5',\n                '10',\n                '15',\n                '25',\n                '50',\n                '75',\n                '100',\n              ]),\n            },\n          },\n        ],\n        ['limit', null],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      tabOverride: 'customize',\n      controlSetRows: [['color_scheme'], [showLegend, null]],\n    },\n    {\n      label: t('X Axis'),\n      expanded: true,\n      tabOverride: 'customize',\n      controlSetRows: [\n        [xAxisLabel, leftMargin],\n        [\n          {\n            name: xAxisFormat.name,\n            config: {\n              ...xAxisFormat.config,\n              default: 'SMART_NUMBER',\n              choices: D3_FORMAT_OPTIONS,\n            },\n          },\n          xTicksLayout,\n        ],\n        [\n          {\n            name: 'x_log_scale',\n            config: {\n              type: 'CheckboxControl',\n              label: t('X Log Scale'),\n              default: false,\n              renderTrigger: true,\n              description: t('Use a log scale for the X-axis'),\n            },\n          },\n          xAxisShowMinmax,\n        ],\n      ],\n    },\n    {\n      label: t('Y Axis'),\n      expanded: true,\n      tabOverride: 'customize',\n      controlSetRows: [\n        [yAxisLabel, bottomMargin],\n        ['y_axis_format', null],\n        [yLogScale, yAxisShowMinmax],\n        [yAxisBounds],\n      ],\n    },\n  ],\n  controlOverrides: {\n    color_scheme: {\n      renderTrigger: false,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    series: getStandardizedControls().shiftColumn(),\n    entity: getStandardizedControls().shiftColumn(),\n    x: getStandardizedControls().shiftMetric(),\n    y: getStandardizedControls().shiftMetric(),\n    size: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin, ChartLabel } from '@superset-ui/core';\nimport transformProps from '../transformProps';\nimport example from './images/example.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Correlation'),\n  credits: ['http://nvd3.org'],\n  description: t(\n    'Visualizes a metric across three dimensions of data in a single chart (X axis, Y axis, and bubble size). Bubbles from the same group can be showcased using bubble color.',\n  ),\n  exampleGallery: [{ url: example }],\n  label: ChartLabel.Deprecated,\n  name: t('Bubble Chart (legacy)'),\n  tags: [\n    t('Multi-Dimensions'),\n    t('Aesthetic'),\n    t('Comparison'),\n    t('Legacy'),\n    t('Scatter'),\n    t('Time'),\n    t('Trend'),\n    t('nvd3'),\n    t('Deprecated'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\n/**\n * @deprecated in version 4.0.\n */\nexport default class BubbleChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('../ReactNVD3'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [['metric'], ['adhoc_filters']],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'ranges',\n            config: {\n              type: 'TextControl',\n              label: t('Ranges'),\n              default: '',\n              description: t('Ranges to highlight with shading'),\n            },\n          },\n          {\n            name: 'range_labels',\n            config: {\n              type: 'TextControl',\n              label: t('Range labels'),\n              default: '',\n              description: t('Labels for the ranges'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markers',\n            config: {\n              type: 'TextControl',\n              label: t('Markers'),\n              default: '',\n              description: t('List of values to mark with triangles'),\n            },\n          },\n          {\n            name: 'marker_labels',\n            config: {\n              type: 'TextControl',\n              label: t('Marker labels'),\n              default: '',\n              description: t('Labels for the markers'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'marker_lines',\n            config: {\n              type: 'TextControl',\n              label: t('Marker lines'),\n              default: '',\n              description: t('List of values to mark with lines'),\n            },\n          },\n          {\n            name: 'marker_line_labels',\n            config: {\n              type: 'TextControl',\n              label: t('Marker line labels'),\n              default: '',\n              description: t('Labels for the marker lines'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from '../transformProps';\nimport example from './images/example.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('KPI'),\n  credits: ['http://nvd3.org'],\n  description: t(\n    'Showcases the progress of a single metric against a given target. The higher the fill, the closer the metric is to the target.',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('Bullet Chart'),\n  tags: [t('Business'), t('Legacy'), t('Report'), t('nvd3')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class BulletChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('../ReactNVD3'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n  sections,\n} from '@superset-ui/chart-controls';\nimport {\n  xAxisLabel,\n  yAxisLabel,\n  bottomMargin,\n  xTicksLayout,\n  xAxisFormat,\n  yLogScale,\n  yAxisBounds,\n  xAxisShowMinmax,\n  yAxisShowMinmax,\n  leftMargin,\n  timeSeriesSection,\n} from '../NVD3Controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.legacyTimeseriesTime,\n    timeSeriesSection[0],\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [['color_scheme']],\n    },\n    {\n      label: t('X Axis'),\n      expanded: true,\n      controlSetRows: [\n        [xAxisLabel, bottomMargin],\n        [xTicksLayout, xAxisFormat],\n        [xAxisShowMinmax, null],\n      ],\n    },\n    {\n      label: t('Y Axis'),\n      expanded: true,\n      controlSetRows: [\n        [yAxisLabel, leftMargin],\n        [yAxisShowMinmax, yLogScale],\n        ['y_axis_format', yAxisBounds],\n      ],\n    },\n    timeSeriesSection[1],\n    sections.annotations,\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n    metrics: getStandardizedControls().popAllMetrics(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from '../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Evolution'),\n  credits: ['http://nvd3.org'],\n  description: t(\n    'Visualizes many different time-series objects in a single chart. This chart is being deprecated and we recommend using the Time-series Chart instead.',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('Time-series Percent Change'),\n  tags: [\n    t('Legacy'),\n    t('Time'),\n    t('nvd3'),\n    t('Advanced-Analytics'),\n    t('Comparison'),\n    t('Line'),\n    t('Percentages'),\n    t('Predictive'),\n    t('Trend'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class CompareChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('../ReactNVD3'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ensureIsArray, t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  ColumnMeta,\n  ControlPanelConfig,\n  sharedControls,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport {\n  showLegend,\n  showControls,\n  xAxisLabel,\n  bottomMargin,\n  xTicksLayout,\n  showBarValue,\n  barStacked,\n  reduceXTicks,\n  yAxisLabel,\n  yAxisShowMinmax,\n  yAxisBounds,\n  richTooltip,\n} from '../NVD3Controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['metrics'],\n        ['adhoc_filters'],\n        ['groupby'],\n        ['columns'],\n        ['row_limit'],\n        ['timeseries_limit_metric'],\n        ['order_desc'],\n        [\n          {\n            name: 'contribution',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Contribution'),\n              default: false,\n              description: t('Compute the contribution to the total'),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        [showLegend],\n        [showBarValue],\n        [richTooltip],\n        [barStacked],\n        [\n          {\n            name: 'order_bars',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort Bars'),\n              default: false,\n              renderTrigger: true,\n              description: t('Sort bars by x labels.'),\n            },\n          },\n        ],\n        ['y_axis_format'],\n        [yAxisLabel],\n        [showControls, null],\n        [yAxisShowMinmax],\n        [yAxisBounds],\n      ],\n    },\n    {\n      label: t('X Axis'),\n      expanded: true,\n      controlSetRows: [\n        [xAxisLabel],\n        [bottomMargin],\n        [xTicksLayout],\n        [reduceXTicks],\n      ],\n    },\n  ],\n  controlOverrides: {\n    groupby: {\n      validators: [validateNonEmpty],\n      mapStateToProps: (state, controlState) => {\n        const groupbyProps =\n          sharedControls.groupby.mapStateToProps?.(state, controlState) || {};\n        groupbyProps.canDropValue = (column: ColumnMeta) =>\n          !ensureIsArray(state.controls?.columns?.value).includes(\n            column.column_name,\n          );\n        return groupbyProps;\n      },\n      rerender: ['columns'],\n    },\n    columns: {\n      label: t('Breakdowns'),\n      description: t('Defines how each series is broken down'),\n      mapStateToProps: (state, controlState) => {\n        const columnsProps =\n          sharedControls.columns.mapStateToProps?.(state, controlState) || {};\n        columnsProps.canDropValue = (column: ColumnMeta) =>\n          !ensureIsArray(state.controls?.groupby?.value).includes(\n            column.column_name,\n          );\n        return columnsProps;\n      },\n      rerender: ['groupby'],\n    },\n  },\n  formDataOverrides: formData => {\n    const columns = getStandardizedControls().controls.columns.filter(\n      col => !ensureIsArray(formData.groupby).includes(col),\n    );\n    getStandardizedControls().controls.columns =\n      getStandardizedControls().controls.columns.filter(\n        col => !columns.includes(col),\n      );\n\n    return {\n      ...formData,\n      metrics: getStandardizedControls().popAllMetrics(),\n      columns,\n    };\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin, ChartLabel } from '@superset-ui/core';\nimport transformProps from '../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Bar_Chart.jpg';\nimport example2 from './images/Bar_Chart_2.jpg';\nimport example3 from './images/BarChart3.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Ranking'),\n  credits: ['http://nvd3.org'],\n  description: t(\n    'Compares metrics from different categories using bars. Bar lengths are used to indicate the magnitude of each value and color is used to differentiate groups.',\n  ),\n  exampleGallery: [\n    { url: example1, caption: 'Stacked style' },\n    { url: example2, caption: 'Grouped style' },\n    { url: example3 },\n  ],\n  label: ChartLabel.Deprecated,\n  name: t('Bar Chart (legacy)'),\n  tags: [\n    t('Additive'),\n    t('Bar'),\n    t('Categorical'),\n    t('Comparison'),\n    t('Discrete'),\n    t('Legacy'),\n    t('Percentages'),\n    t('Popular'),\n    t('Stacked'),\n    t('Vertical'),\n    t('nvd3'),\n    t('Deprecated'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\n/**\n * @deprecated in version 3.0.\n */\nexport default class DistBarChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('../ReactNVD3'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  sections,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport {\n  lineInterpolation,\n  showBrush,\n  showLegend,\n  xAxisLabel,\n  bottomMargin,\n  xTicksLayout,\n  xAxisFormat,\n  yLogScale,\n  yAxisBounds,\n  yAxisLabel,\n  xAxisShowMinmax,\n  yAxisShowMinmax,\n  richTooltip,\n  leftMargin,\n  showMarkers,\n  timeSeriesSection,\n} from '../NVD3Controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.legacyTimeseriesTime,\n    timeSeriesSection[0],\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        [showBrush],\n        [\n          {\n            name: 'send_time_range',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Propagate'),\n              renderTrigger: true,\n              default: false,\n              description: t('Send range filter events to other charts'),\n            },\n          },\n        ],\n        [showLegend],\n        [richTooltip],\n        [showMarkers],\n        [lineInterpolation],\n      ],\n    },\n    {\n      label: t('X Axis'),\n      expanded: true,\n      controlSetRows: [\n        [xAxisLabel],\n        [bottomMargin],\n        [xTicksLayout],\n        [xAxisFormat],\n        [xAxisShowMinmax, null],\n      ],\n    },\n    {\n      label: t('Y Axis'),\n      expanded: true,\n      controlSetRows: [\n        [yAxisLabel],\n        [leftMargin],\n        [yAxisShowMinmax],\n        [yLogScale],\n        ['y_axis_format'],\n        [yAxisBounds],\n      ],\n    },\n    timeSeriesSection[1],\n    sections.annotations,\n  ],\n  controlOverrides: {\n    row_limit: {\n      default: 50000,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin, ChartLabel } from '@superset-ui/core';\nimport transformProps from '../transformProps';\nimport example1 from './images/LineChart.jpg';\nimport example2 from './images/LineChart2.jpg';\nimport battery from './images/battery.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport { ANNOTATION_TYPES } from '../vendor/superset/AnnotationTypes';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  canBeAnnotationTypes: [ANNOTATION_TYPES.TIME_SERIES],\n  category: t('Evolution'),\n  credits: ['http://nvd3.org'],\n  description: t('Classic chart that visualizes how metrics change over time.'),\n  exampleGallery: [\n    { url: example1 },\n    { url: example2 },\n    { url: battery, caption: t('Battery level over time') },\n  ],\n  label: ChartLabel.Deprecated,\n  name: t('Time-series Line Chart (legacy)'),\n  supportedAnnotationTypes: [\n    ANNOTATION_TYPES.TIME_SERIES,\n    ANNOTATION_TYPES.INTERVAL,\n    ANNOTATION_TYPES.EVENT,\n    ANNOTATION_TYPES.FORMULA,\n  ],\n  tags: [t('Aesthetic'), t('Legacy'), t('nvd3'), t('Deprecated')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\n/**\n * @deprecated in version 3.0.\n */\nexport default class LineChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('../ReactNVD3'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  D3_FORMAT_OPTIONS,\n  getStandardizedControls,\n  sections,\n} from '@superset-ui/chart-controls';\nimport {\n  lineInterpolation,\n  showLegend,\n  xAxisLabel,\n  bottomMargin,\n  xAxisFormat,\n  yLogScale,\n  yAxisBounds,\n  xAxisShowMinmax,\n  yAxisShowMinmax,\n  yAxisLabel,\n  leftMargin,\n} from '../NVD3Controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.legacyTimeseriesTime,\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['metric'],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'freq',\n            config: {\n              type: 'SelectControl',\n              label: t('Frequency'),\n              default: 'W-MON',\n              freeForm: true,\n              clearable: false,\n              choices: [\n                ['AS', t('Year (freq=AS)')],\n                ['52W-MON', t('52 weeks starting Monday (freq=52W-MON)')],\n                ['W-SUN', t('1 week starting Sunday (freq=W-SUN)')],\n                ['W-MON', t('1 week starting Monday (freq=W-MON)')],\n                ['D', t('Day (freq=D)')],\n                ['4W-MON', t('4 weeks (freq=4W-MON)')],\n              ],\n              description: t(\n                `The periodicity over which to pivot time. Users can provide\n            \"Pandas\" offset alias.\n            Click on the info bubble for more details on accepted \"freq\" expressions.`,\n              ),\n              tooltipOnClick: () => {\n                window.open(\n                  'https://pandas.pydata.org/pandas-docs/stable/timeseries.html#offset-aliases',\n                );\n              },\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        [showLegend],\n        [lineInterpolation],\n        ['color_picker', null],\n      ],\n    },\n    {\n      label: t('X Axis'),\n      expanded: true,\n      controlSetRows: [\n        [xAxisLabel],\n        [bottomMargin],\n        [xAxisShowMinmax],\n        [\n          {\n            name: xAxisFormat.name,\n            config: {\n              ...xAxisFormat.config,\n              default: 'SMART_NUMBER',\n              choices: D3_FORMAT_OPTIONS,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Y Axis'),\n      expanded: true,\n      controlSetRows: [\n        [yAxisLabel],\n        [leftMargin],\n        [yAxisShowMinmax],\n        [yLogScale],\n        ['y_axis_format'],\n        [yAxisBounds],\n      ],\n    },\n  ],\n  controlOverrides: {\n    metric: {\n      clearable: false,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric,\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from '../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Evolution'),\n  credits: ['http://nvd3.org'],\n  description: '',\n  name: t('Time-series Period Pivot'),\n  tags: [t('Legacy'), t('Time'), t('nvd3')],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class TimePivotChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('../ReactNVD3'),\n      metadata,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { ChartProps } from '@superset-ui/core';\n\nconst NOOP = () => {};\n\nexport default function transformProps(chartProps: ChartProps) {\n  const { datasource, height, hooks, queriesData, rawFormData, width } =\n    chartProps;\n  const { onAddFilter = NOOP, setControlValue = NOOP } = hooks;\n\n  return {\n    datasource,\n    formData: rawFormData,\n    height,\n    onAddFilter,\n    payload: queriesData[0],\n    setControlValue,\n    viewport: {\n      ...rawFormData.viewport,\n      height,\n      width,\n    },\n    width,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { QueryResponse } from '@superset-ui/core';\nimport {\n  ColumnMeta,\n  ControlPanelState,\n  Dataset,\n} from '@superset-ui/chart-controls';\n\nexport function columnChoices(datasource: Dataset | QueryResponse | null) {\n  if (datasource?.columns) {\n    return datasource.columns\n      .map(col => [\n        col.column_name,\n        (col as ColumnMeta).verbose_name || col.column_name,\n      ])\n      .sort((opt1, opt2) =>\n        opt1[1].toLowerCase() > opt2[1].toLowerCase() ? 1 : -1,\n      );\n  }\n  return [];\n}\n\nexport const PRIMARY_COLOR = { r: 0, g: 122, b: 135, a: 1 };\n\nexport default {\n  default: null,\n  mapStateToProps: (state: ControlPanelState) => ({\n    choices: state.datasource\n      ? (state.datasource as Dataset).time_grain_sqla?.filter(\n          o => o[0] !== null,\n        )\n      : null,\n  }),\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint camelcase: 0 */\n\nexport function formatSelectOptions(options: (string | number)[]) {\n  return options.map(opt => [opt, opt.toString()]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// These are control configurations that are shared ONLY within the DeckGL viz plugin repo.\n\nimport React from 'react';\nimport {\n  FeatureFlag,\n  isFeatureEnabled,\n  t,\n  validateNonEmpty,\n  validateMapboxStylesUrl,\n} from '@superset-ui/core';\nimport { D3_FORMAT_OPTIONS, sharedControls } from '@superset-ui/chart-controls';\nimport { columnChoices, PRIMARY_COLOR } from './controls';\n\nconst DEFAULT_VIEWPORT = {\n  longitude: 6.85236157047845,\n  latitude: 31.222656842808707,\n  zoom: 1,\n  bearing: 0,\n  pitch: 0,\n};\n\nconst sandboxUrl =\n  'https://github.com/apache/superset/' +\n  'blob/master/superset-frontend/plugins/legacy-preset-chart-deckgl/src/utils/sandbox.ts';\nconst jsFunctionInfo = (\n  <div>\n    {t(\n      'For more information about objects are in context in the scope of this function, refer to the',\n    )}\n    <a href={sandboxUrl}>{t(\" source code of Superset's sandboxed parser\")}.</a>\n    .\n  </div>\n);\n\nfunction jsFunctionControl(\n  label,\n  description,\n  extraDescr = null,\n  height = 100,\n  defaultText = '',\n) {\n  return {\n    type: 'TextAreaControl',\n    language: 'javascript',\n    label,\n    description,\n    height,\n    default: defaultText,\n    aboveEditorSection: (\n      <div>\n        <p>{description}</p>\n        <p>{jsFunctionInfo}</p>\n        {extraDescr}\n      </div>\n    ),\n    warning: !isFeatureEnabled(FeatureFlag.EnableJavascriptControls)\n      ? t(\n          'This functionality is disabled in your environment for security reasons.',\n        )\n      : null,\n    readOnly: !isFeatureEnabled(FeatureFlag.EnableJavascriptControls),\n  };\n}\n\nexport const filterNulls = {\n  name: 'filter_nulls',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Ignore null locations'),\n    default: true,\n    description: t('Whether to ignore locations that are null'),\n  },\n};\n\nexport const autozoom = {\n  name: 'autozoom',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Auto Zoom'),\n    default: true,\n    renderTrigger: true,\n    description: t(\n      'When checked, the map will zoom to your data after each query',\n    ),\n  },\n};\n\nexport const dimension = {\n  name: 'dimension',\n  config: {\n    ...sharedControls.groupby,\n    label: t('Dimension'),\n    description: t('Select a dimension'),\n    multi: false,\n    default: null,\n  },\n};\n\nexport const jsColumns = {\n  name: 'js_columns',\n  config: {\n    ...sharedControls.groupby,\n    label: t('Extra data for JS'),\n    default: [],\n    description: t(\n      'List of extra columns made available in JavaScript functions',\n    ),\n  },\n};\n\nexport const jsDataMutator = {\n  name: 'js_data_mutator',\n  config: jsFunctionControl(\n    t('JavaScript data interceptor'),\n    t(\n      'Define a javascript function that receives the data array used in the visualization ' +\n        'and is expected to return a modified version of that array. This can be used ' +\n        'to alter properties of the data, filter, or enrich the array.',\n    ),\n  ),\n};\n\nexport const jsTooltip = {\n  name: 'js_tooltip',\n  config: jsFunctionControl(\n    t('JavaScript tooltip generator'),\n    t(\n      'Define a function that receives the input and outputs the content for a tooltip',\n    ),\n  ),\n};\n\nexport const jsOnclickHref = {\n  name: 'js_onclick_href',\n  config: jsFunctionControl(\n    t('JavaScript onClick href'),\n    t('Define a function that returns a URL to navigate to when user clicks'),\n  ),\n};\n\nexport const legendFormat = {\n  name: 'legend_format',\n  config: {\n    label: t('Legend Format'),\n    description: t('Choose the format for legend values'),\n    type: 'SelectControl',\n    clearable: false,\n    default: D3_FORMAT_OPTIONS[0][0],\n    choices: D3_FORMAT_OPTIONS,\n    renderTrigger: true,\n    freeForm: true,\n  },\n};\n\nexport const legendPosition = {\n  name: 'legend_position',\n  config: {\n    label: t('Legend Position'),\n    description: t('Choose the position of the legend'),\n    type: 'SelectControl',\n    clearable: false,\n    default: 'tr',\n    choices: [\n      [null, t('None')],\n      ['tl', t('Top left')],\n      ['tr', t('Top right')],\n      ['bl', t('Bottom left')],\n      ['br', t('Bottom right')],\n    ],\n    renderTrigger: true,\n  },\n};\n\nexport const lineColumn = {\n  name: 'line_column',\n  config: {\n    type: 'SelectControl',\n    label: t('Lines column'),\n    default: null,\n    description: t('The database columns that contains lines information'),\n    mapStateToProps: state => ({\n      choices: columnChoices(state.datasource),\n    }),\n    validators: [validateNonEmpty],\n  },\n};\n\nexport const lineWidth = {\n  name: 'line_width',\n  config: {\n    type: 'TextControl',\n    label: t('Line width'),\n    renderTrigger: true,\n    isInt: true,\n    default: 1,\n    description: t('The width of the lines'),\n  },\n};\n\nexport const fillColorPicker = {\n  name: 'fill_color_picker',\n  config: {\n    label: t('Fill Color'),\n    description: t(\n      ' Set the opacity to 0 if you do not want to override the color specified in the GeoJSON',\n    ),\n    type: 'ColorPickerControl',\n    default: PRIMARY_COLOR,\n    renderTrigger: true,\n  },\n};\n\nexport const strokeColorPicker = {\n  name: 'stroke_color_picker',\n  config: {\n    label: t('Stroke Color'),\n    description: t(\n      ' Set the opacity to 0 if you do not want to override the color specified in the GeoJSON',\n    ),\n    type: 'ColorPickerControl',\n    default: PRIMARY_COLOR,\n    renderTrigger: true,\n  },\n};\n\nexport const filled = {\n  name: 'filled',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Filled'),\n    renderTrigger: true,\n    description: t('Whether to fill the objects'),\n    default: true,\n  },\n};\n\nexport const stroked = {\n  name: 'stroked',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Stroked'),\n    renderTrigger: true,\n    description: t('Whether to display the stroke'),\n    default: false,\n  },\n};\n\nexport const extruded = {\n  name: 'extruded',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Extruded'),\n    renderTrigger: true,\n    default: true,\n    description: t('Whether to make the grid 3D'),\n  },\n};\n\nexport const gridSize = {\n  name: 'grid_size',\n  config: {\n    type: 'TextControl',\n    label: t('Grid Size'),\n    renderTrigger: true,\n    default: 20,\n    isInt: true,\n    description: t('Defines the grid size in pixels'),\n  },\n};\n\nexport const viewport = {\n  name: 'viewport',\n  config: {\n    type: 'ViewportControl',\n    label: t('Viewport'),\n    renderTrigger: false,\n    description: t('Parameters related to the view and perspective on the map'),\n    // default is whole world mostly centered\n    default: DEFAULT_VIEWPORT,\n    // Viewport changes shouldn't prompt user to re-run query\n    dontRefreshOnChange: true,\n  },\n};\n\nexport const spatial = {\n  name: 'spatial',\n  config: {\n    type: 'SpatialControl',\n    label: t('Longitude & Latitude'),\n    validators: [validateNonEmpty],\n    description: t('Point to your spatial columns'),\n    mapStateToProps: state => ({\n      choices: columnChoices(state.datasource),\n    }),\n  },\n};\n\nexport const pointRadiusFixed = {\n  name: 'point_radius_fixed',\n  config: {\n    type: 'FixedOrMetricControl',\n    label: t('Point Size'),\n    default: { type: 'fix', value: 1000 },\n    description: t('Fixed point radius'),\n    mapStateToProps: state => ({\n      datasource: state.datasource,\n    }),\n  },\n};\n\nexport const multiplier = {\n  name: 'multiplier',\n  config: {\n    type: 'TextControl',\n    label: t('Multiplier'),\n    isFloat: true,\n    renderTrigger: true,\n    default: 1,\n    description: t('Factor to multiply the metric by'),\n  },\n};\n\nexport const lineType = {\n  name: 'line_type',\n  config: {\n    type: 'SelectControl',\n    label: t('Lines encoding'),\n    clearable: false,\n    default: 'json',\n    description: t('The encoding format of the lines'),\n    choices: [\n      ['polyline', t('Polyline')],\n      ['json', t('JSON')],\n      ['geohash', t('geohash (square)')],\n    ],\n  },\n};\n\nexport const reverseLongLat = {\n  name: 'reverse_long_lat',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Reverse Lat & Long'),\n    default: false,\n  },\n};\n\nexport const mapboxStyle = {\n  name: 'mapbox_style',\n  config: {\n    type: 'SelectControl',\n    label: t('Map Style'),\n    clearable: false,\n    renderTrigger: true,\n    freeForm: true,\n    validators: [validateMapboxStylesUrl],\n    choices: [\n      ['mapbox://styles/mapbox/streets-v9', t('Streets')],\n      ['mapbox://styles/mapbox/dark-v9', t('Dark')],\n      ['mapbox://styles/mapbox/light-v9', t('Light')],\n      ['mapbox://styles/mapbox/satellite-streets-v9', t('Satellite Streets')],\n      ['mapbox://styles/mapbox/satellite-v9', t('Satellite')],\n      ['mapbox://styles/mapbox/outdoors-v9', t('Outdoors')],\n    ],\n    default: 'mapbox://styles/mapbox/light-v9',\n    description: t(\n      'Base layer map style. See Mapbox documentation: %s',\n      'https://docs.mapbox.com/help/glossary/style-url/',\n    ),\n  },\n};\n\nexport const geojsonColumn = {\n  name: 'geojson',\n  config: {\n    type: 'SelectControl',\n    label: t('GeoJson Column'),\n    validators: [validateNonEmpty],\n    description: t('Select the geojson column'),\n    mapStateToProps: state => ({\n      choices: columnChoices(state.datasource),\n    }),\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\nimport { t, validateNonEmpty, legacyValidateInteger } from '@superset-ui/core';\nimport timeGrainSqlaAnimationOverrides, {\n  columnChoices,\n  PRIMARY_COLOR,\n} from '../../utilities/controls';\nimport { formatSelectOptions } from '../../utilities/utils';\nimport {\n  filterNulls,\n  autozoom,\n  dimension,\n  jsColumns,\n  jsDataMutator,\n  jsTooltip,\n  jsOnclickHref,\n  legendFormat,\n  legendPosition,\n  viewport,\n  mapboxStyle,\n} from '../../utilities/Shared_DeckGL';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'start_spatial',\n            config: {\n              type: 'SpatialControl',\n              label: t('Start Longitude & Latitude'),\n              validators: [validateNonEmpty],\n              description: t('Point to your spatial columns'),\n              mapStateToProps: state => ({\n                choices: columnChoices(state.datasource),\n              }),\n            },\n          },\n          {\n            name: 'end_spatial',\n            config: {\n              type: 'SpatialControl',\n              label: t('End Longitude & Latitude'),\n              validators: [validateNonEmpty],\n              description: t('Point to your spatial columns'),\n              mapStateToProps: state => ({\n                choices: columnChoices(state.datasource),\n              }),\n            },\n          },\n        ],\n        ['row_limit', filterNulls],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Map'),\n      controlSetRows: [[mapboxStyle], [autozoom, viewport]],\n    },\n    {\n      label: t('Arc'),\n      controlSetRows: [\n        [\n          'color_picker',\n          {\n            name: 'target_color_picker',\n            config: {\n              label: t('Target Color'),\n              description: t('Color of the target location'),\n              type: 'ColorPickerControl',\n              default: PRIMARY_COLOR,\n              renderTrigger: true,\n            },\n          },\n        ],\n        [\n          {\n            name: dimension.name,\n            config: {\n              ...dimension.config,\n              label: t('Categorical Color'),\n              description: t(\n                'Pick a dimension from which categorical colors are defined',\n              ),\n            },\n          },\n          'color_scheme',\n        ],\n        [\n          {\n            name: 'stroke_width',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Stroke Width'),\n              validators: [legacyValidateInteger],\n              default: null,\n              renderTrigger: true,\n              choices: formatSelectOptions([1, 2, 3, 4, 5]),\n            },\n          },\n          legendPosition,\n        ],\n        [legendFormat, null],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n  controlOverrides: {\n    size: {\n      validators: [],\n    },\n    time_grain_sqla: timeGrainSqlaAnimationOverrides,\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'Plot the distance (like flight paths) between origin and destination.',\n  ),\n  name: t('deck.gl Arc'),\n  thumbnail,\n  exampleGallery: [{ url: example }],\n  useLegacyApi: true,\n  tags: [t('deckGL'), t('Geo'), t('3D'), t('Relational'), t('Web')],\n});\n\nexport default class ArcChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Arc'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '@superset-ui/core';\nimport { sharedControls } from '@superset-ui/chart-controls';\n\nexport const dndLineColumn = {\n  name: 'line_column',\n  config: {\n    ...sharedControls.entity,\n    label: t('Lines column'),\n    description: t('The database columns that contains lines information'),\n  },\n};\n\nexport const dndGeojsonColumn = {\n  name: 'geojson',\n  config: {\n    ...sharedControls.entity,\n    label: t('GeoJson Column'),\n    description: t('Select the geojson column'),\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\nimport { t, legacyValidateInteger } from '@superset-ui/core';\nimport { formatSelectOptions } from '../../utilities/utils';\nimport {\n  filterNulls,\n  jsColumns,\n  jsDataMutator,\n  jsTooltip,\n  jsOnclickHref,\n  fillColorPicker,\n  strokeColorPicker,\n  filled,\n  stroked,\n  extruded,\n  viewport,\n  mapboxStyle,\n  autozoom,\n  lineWidth,\n} from '../../utilities/Shared_DeckGL';\nimport { dndGeojsonColumn } from '../../utilities/sharedDndControls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [dndGeojsonColumn],\n        ['row_limit'],\n        [filterNulls],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Map'),\n      controlSetRows: [[mapboxStyle, viewport], [autozoom]],\n    },\n    {\n      label: t('GeoJson Settings'),\n      controlSetRows: [\n        [fillColorPicker, strokeColorPicker],\n        [filled, stroked],\n        [extruded],\n        [lineWidth],\n        [\n          {\n            name: 'line_width_unit',\n            config: {\n              type: 'SelectControl',\n              label: t('Line width unit'),\n              default: 'pixels',\n              choices: [\n                ['meters', t('meters')],\n                ['pixels', t('pixels')],\n              ],\n              renderTrigger: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'point_radius_scale',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Point Radius Scale'),\n              validators: [legacyValidateInteger],\n              default: null,\n              choices: formatSelectOptions([0, 100, 200, 300, 500]),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'The GeoJsonLayer takes in GeoJSON formatted data and renders it as interactive polygons, lines and points (circles, icons and/or texts).',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('deck.gl Geojson'),\n  thumbnail,\n  useLegacyApi: true,\n  tags: [t('deckGL'), t('2D'), t('Aesthetic')],\n});\n\nexport default class GeojsonChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Geojson'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  filterNulls,\n  autozoom,\n  jsColumns,\n  jsDataMutator,\n  jsTooltip,\n  jsOnclickHref,\n  extruded,\n  gridSize,\n  viewport,\n  spatial,\n  mapboxStyle,\n} from '../../utilities/Shared_DeckGL';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [spatial],\n        ['size'],\n        ['row_limit'],\n        [filterNulls],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Map'),\n      controlSetRows: [\n        [mapboxStyle],\n        [viewport],\n        ['color_scheme'],\n        [autozoom],\n        [gridSize],\n        [extruded],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n  controlOverrides: {\n    size: {\n      label: t('Height'),\n      description: t('Metric used to control height'),\n      validators: [validateNonEmpty],\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    size: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'Visualize geospatial data like 3D buildings, landscapes, or objects in grid view.',\n  ),\n  name: t('deck.gl Grid'),\n  thumbnail,\n  exampleGallery: [{ url: example }],\n  useLegacyApi: true,\n  tags: [t('deckGL'), t('3D'), t('Comparison'), t('Experimental')],\n});\n\nexport default class GridChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Grid'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport {\n  autozoom,\n  extruded,\n  filterNulls,\n  gridSize,\n  jsColumns,\n  jsDataMutator,\n  jsOnclickHref,\n  jsTooltip,\n  mapboxStyle,\n  spatial,\n  viewport,\n} from '../../utilities/Shared_DeckGL';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [spatial],\n        ['size'],\n        ['row_limit'],\n        [filterNulls],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Map'),\n      controlSetRows: [\n        [mapboxStyle],\n        ['color_scheme', viewport],\n        [autozoom],\n        [gridSize],\n        [extruded],\n        [\n          {\n            name: 'js_agg_function',\n            config: {\n              type: 'SelectControl',\n              label: t('Dynamic Aggregation Function'),\n              description: t(\n                'The function to use when aggregating points into groups',\n              ),\n              default: 'sum',\n              clearable: false,\n              renderTrigger: true,\n              choices: [\n                ['sum', t('sum')],\n                ['min', t('min')],\n                ['max', t('max')],\n                ['mean', t('mean')],\n                ['median', t('median')],\n                ['count', t('count')],\n                ['variance', t('variance')],\n                ['deviation', t('deviation')],\n                ['p1', t('p1')],\n                ['p5', t('p5')],\n                ['p95', t('p95')],\n                ['p99', t('p99')],\n              ],\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    size: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'Overlays a hexagonal grid on a map, and aggregates data within the boundary of each cell.',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('deck.gl 3D Hexagon'),\n  thumbnail,\n  useLegacyApi: true,\n  tags: [t('deckGL'), t('3D'), t('Geo'), t('Comparison'), t('Experimental')],\n});\n\nexport default class HexChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Hex'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelConfig,\n  formatSelectOptions,\n} from '@superset-ui/chart-controls';\nimport {\n  t,\n  validateNonEmpty,\n  legacyValidateNumber,\n  legacyValidateInteger,\n} from '@superset-ui/core';\nimport {\n  autozoom,\n  filterNulls,\n  jsColumns,\n  jsDataMutator,\n  jsOnclickHref,\n  jsTooltip,\n  mapboxStyle,\n  spatial,\n  viewport,\n} from '../../utilities/Shared_DeckGL';\n\nconst INTENSITY_OPTIONS = Array.from(\n  { length: 10 },\n  (_, index) => (index + 1) / 10,\n);\nconst RADIUS_PIXEL_OPTIONS = Array.from(\n  { length: 14 },\n  (_, index) => index * 5 + 5,\n);\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [spatial],\n        ['size'],\n        ['row_limit'],\n        [filterNulls],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'intensity',\n            config: {\n              type: 'SelectControl',\n              label: t('Intesity'),\n              description: t(\n                'Intensity is the value multiplied by the weight to obtain the final weight',\n              ),\n              freeForm: true,\n              clearable: false,\n              validators: [legacyValidateNumber],\n              default: 1,\n              choices: formatSelectOptions(INTENSITY_OPTIONS),\n            },\n          },\n        ],\n        [\n          {\n            name: 'radius_pixels',\n            config: {\n              type: 'SelectControl',\n              label: t('Intensity Radius'),\n              description: t(\n                'Intensity Radius is the radius at which the weight is distributed',\n              ),\n              freeForm: true,\n              clearable: false,\n              validators: [legacyValidateInteger],\n              default: 30,\n              choices: formatSelectOptions(RADIUS_PIXEL_OPTIONS),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Map'),\n      controlSetRows: [\n        [mapboxStyle],\n        [viewport],\n        ['linear_color_scheme'],\n        [autozoom],\n        [\n          {\n            name: 'aggregation',\n            config: {\n              type: 'SelectControl',\n              label: t('Aggregation'),\n              description: t(\n                'The function to use when aggregating points into groups',\n              ),\n              default: 'sum',\n              clearable: false,\n              renderTrigger: true,\n              choices: [\n                ['sum', t('sum')],\n                ['mean', t('mean')],\n              ],\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n  controlOverrides: {\n    size: {\n      label: t('Weight'),\n      description: t(\"Metric used as a weight for the grid's coloring\"),\n      validators: [validateNonEmpty],\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'Uses Gaussian Kernel Density Estimation to visualize spatial distribution of data',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('deck.gl Heatmap'),\n  thumbnail,\n  useLegacyApi: true,\n  tags: [t('deckGL'), t('Spatial'), t('Comparison'), t('Experimental')],\n});\n\nexport default class HeatmapChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Heatmap'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport { viewport, mapboxStyle } from '../utilities/Shared_DeckGL';\n\nexport default {\n  controlPanelSections: [\n    {\n      label: t('Map'),\n      expanded: true,\n      controlSetRows: [\n        [mapboxStyle],\n        [viewport],\n        [\n          {\n            name: 'deck_slices',\n            config: {\n              type: 'SelectAsyncControl',\n              multi: true,\n              label: t('deck.gl charts'),\n              validators: [validateNonEmpty],\n              default: [],\n              description: t(\n                'Pick a set of deck.gl charts to layer on top of one another',\n              ),\n              dataEndpoint:\n                '/sliceasync/api/read?_flt_0_viz_type=deck_&_flt_7_viz_type=deck_multi',\n              placeholder: t('Select charts'),\n              onAsyncErrorMessage: t('Error while fetching charts'),\n              mutator: (data: {\n                result?: { id: number; slice_name: string }[];\n              }) => {\n                if (!data?.result) {\n                  return [];\n                }\n                return data.result.map(o => ({\n                  value: o.id,\n                  label: o.slice_name,\n                }));\n              },\n            },\n          },\n          null,\n        ],\n      ],\n    },\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [['adhoc_filters']],\n    },\n  ],\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t('Compose multiple layers together to form complex visuals.'),\n  exampleGallery: [{ url: example }],\n  name: t('deck.gl Multiple Layers'),\n  thumbnail,\n  useLegacyApi: true,\n  tags: [t('deckGL'), t('Multi-Layers')],\n});\n\nexport default class MultiChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Multi'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport {\n  filterNulls,\n  autozoom,\n  jsColumns,\n  jsDataMutator,\n  jsTooltip,\n  jsOnclickHref,\n  viewport,\n  lineWidth,\n  lineType,\n  reverseLongLat,\n  mapboxStyle,\n} from '../../utilities/Shared_DeckGL';\nimport { dndLineColumn } from '../../utilities/sharedDndControls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [dndLineColumn],\n        [\n          {\n            ...lineType,\n            config: {\n              ...lineType.config,\n              choices: [\n                ['polyline', t('Polyline')],\n                ['json', t('JSON')],\n              ],\n            },\n          },\n        ],\n        ['row_limit'],\n        [filterNulls],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Map'),\n      expanded: true,\n      controlSetRows: [\n        [mapboxStyle],\n        [viewport],\n        ['color_picker'],\n        [lineWidth],\n        [\n          {\n            name: 'line_width_unit',\n            config: {\n              type: 'SelectControl',\n              label: t('Line width unit'),\n              default: 'pixels',\n              choices: [\n                ['meters', t('meters')],\n                ['pixels', t('pixels')],\n              ],\n              renderTrigger: true,\n            },\n          },\n        ],\n        [reverseLongLat],\n        [autozoom],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t('Visualizes connected points, which form a path, on a map.'),\n  name: t('deck.gl Path'),\n  thumbnail,\n  exampleGallery: [{ url: example }],\n  useLegacyApi: true,\n  tags: [t('deckGL'), t('Web')],\n});\n\nexport default class PathChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Path'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport timeGrainSqlaAnimationOverrides from '../../utilities/controls';\nimport { formatSelectOptions } from '../../utilities/utils';\nimport {\n  filterNulls,\n  autozoom,\n  jsColumns,\n  jsDataMutator,\n  jsTooltip,\n  jsOnclickHref,\n  legendFormat,\n  legendPosition,\n  fillColorPicker,\n  strokeColorPicker,\n  filled,\n  stroked,\n  extruded,\n  viewport,\n  pointRadiusFixed,\n  multiplier,\n  lineWidth,\n  lineType,\n  reverseLongLat,\n  mapboxStyle,\n} from '../../utilities/Shared_DeckGL';\nimport { dndLineColumn } from '../../utilities/sharedDndControls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            ...dndLineColumn,\n            config: {\n              ...dndLineColumn.config,\n              label: t('Polygon Column'),\n            },\n          },\n        ],\n        [\n          {\n            ...lineType,\n            config: {\n              ...lineType.config,\n              label: t('Polygon Encoding'),\n            },\n          },\n        ],\n        ['adhoc_filters'],\n        ['metric'],\n        [\n          {\n            ...pointRadiusFixed,\n            config: {\n              ...pointRadiusFixed.config,\n              label: t('Elevation'),\n            },\n          },\n        ],\n        ['row_limit'],\n        [reverseLongLat],\n        [filterNulls],\n      ],\n    },\n    {\n      label: t('Map'),\n      expanded: true,\n      controlSetRows: [[mapboxStyle], [viewport], [autozoom]],\n    },\n    {\n      label: t('Polygon Settings'),\n      expanded: true,\n      controlSetRows: [\n        [fillColorPicker, strokeColorPicker],\n        [filled, stroked],\n        [extruded],\n        [multiplier],\n        [lineWidth],\n        [\n          {\n            name: 'line_width_unit',\n            config: {\n              type: 'SelectControl',\n              label: t('Line width unit'),\n              default: 'pixels',\n              choices: [\n                ['meters', t('meters')],\n                ['pixels', t('pixels')],\n              ],\n              renderTrigger: true,\n            },\n          },\n        ],\n        ['linear_color_scheme'],\n        [\n          {\n            name: 'opacity',\n            config: {\n              type: 'SliderControl',\n              label: t('Opacity'),\n              default: 80,\n              step: 1,\n              min: 0,\n              max: 100,\n              renderTrigger: true,\n              description: t('Opacity, expects values between 0 and 100'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'num_buckets',\n            config: {\n              type: 'SelectControl',\n              multi: false,\n              freeForm: true,\n              label: t('Number of buckets to group data'),\n              default: 5,\n              choices: formatSelectOptions([2, 3, 5, 10]),\n              description: t('How many buckets should the data be grouped in.'),\n              renderTrigger: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'break_points',\n            config: {\n              type: 'SelectControl',\n              multi: true,\n              freeForm: true,\n              label: t('Bucket break points'),\n              choices: formatSelectOptions([]),\n              description: t(\n                'List of n+1 values for bucketing metric into n buckets.',\n              ),\n              renderTrigger: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'table_filter',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Emit Filter Events'),\n              renderTrigger: true,\n              default: false,\n              description: t('Whether to apply filter when items are clicked'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'toggle_polygons',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Multiple filtering'),\n              renderTrigger: true,\n              default: true,\n              description: t(\n                'Allow sending multiple polygons as a filter event',\n              ),\n            },\n          },\n        ],\n        [legendPosition],\n        [legendFormat],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n  controlOverrides: {\n    metric: {\n      validators: [],\n    },\n    time_grain_sqla: timeGrainSqlaAnimationOverrides,\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'Visualizes geographic areas from your data as polygons on a Mapbox rendered map. Polygons can be colored using a metric.',\n  ),\n  name: t('deck.gl Polygon'),\n  thumbnail,\n  exampleGallery: [{ url: example }],\n  useLegacyApi: true,\n  tags: [\n    t('deckGL'),\n    t('3D'),\n    t('Multi-Dimensions'),\n    t('Geo'),\n    t('Experimental'),\n  ],\n});\n\nexport default class PolygonChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Polygon'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport timeGrainSqlaAnimationOverrides from '../../utilities/controls';\nimport {\n  filterNulls,\n  autozoom,\n  dimension,\n  jsColumns,\n  jsDataMutator,\n  jsTooltip,\n  jsOnclickHref,\n  legendFormat,\n  legendPosition,\n  viewport,\n  spatial,\n  pointRadiusFixed,\n  multiplier,\n  mapboxStyle,\n} from '../../utilities/Shared_DeckGL';\n\nconst config: ControlPanelConfig = {\n  onInit: controlState => ({\n    ...controlState,\n    time_grain_sqla: {\n      ...controlState.time_grain_sqla,\n      value: null,\n    },\n    granularity: {\n      ...controlState.granularity,\n      value: null,\n    },\n  }),\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [spatial, null],\n        ['row_limit', filterNulls],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Map'),\n      expanded: true,\n      controlSetRows: [[mapboxStyle], [autozoom, viewport]],\n    },\n    {\n      label: t('Point Size'),\n      controlSetRows: [\n        [pointRadiusFixed],\n        [\n          {\n            name: 'point_unit',\n            config: {\n              type: 'SelectControl',\n              label: t('Point Unit'),\n              default: 'square_m',\n              clearable: false,\n              choices: [\n                ['square_m', t('Square meters')],\n                ['square_km', t('Square kilometers')],\n                ['square_miles', t('Square miles')],\n                ['radius_m', t('Radius in meters')],\n                ['radius_km', t('Radius in kilometers')],\n                ['radius_miles', t('Radius in miles')],\n              ],\n              description: t(\n                'The unit of measure for the specified point radius',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'min_radius',\n            config: {\n              type: 'TextControl',\n              label: t('Minimum Radius'),\n              isFloat: true,\n              validators: [validateNonEmpty],\n              renderTrigger: true,\n              default: 2,\n              description: t(\n                'Minimum radius size of the circle, in pixels. As the zoom level changes, this ' +\n                  'insures that the circle respects this minimum radius.',\n              ),\n            },\n          },\n          {\n            name: 'max_radius',\n            config: {\n              type: 'TextControl',\n              label: t('Maximum Radius'),\n              isFloat: true,\n              validators: [validateNonEmpty],\n              renderTrigger: true,\n              default: 250,\n              description: t(\n                'Maximum radius size of the circle, in pixels. As the zoom level changes, this ' +\n                  'insures that the circle respects this maximum radius.',\n              ),\n            },\n          },\n        ],\n        [multiplier, null],\n      ],\n    },\n    {\n      label: t('Point Color'),\n      controlSetRows: [\n        ['color_picker'],\n        [legendPosition],\n        [legendFormat],\n        [\n          {\n            name: dimension.name,\n            config: {\n              ...dimension.config,\n              label: t('Categorical Color'),\n              description: t(\n                'Pick a dimension from which categorical colors are defined',\n              ),\n            },\n          },\n        ],\n        ['color_scheme'],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n  controlOverrides: {\n    size: {\n      validators: [],\n    },\n    time_grain_sqla: timeGrainSqlaAnimationOverrides,\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'A map that takes rendering circles with a variable radius at latitude/longitude coordinates',\n  ),\n  name: t('deck.gl Scatterplot'),\n  thumbnail,\n  exampleGallery: [{ url: example }],\n  useLegacyApi: true,\n  tags: [\n    t('deckGL'),\n    t('Comparison'),\n    t('Scatter'),\n    t('2D'),\n    t('Geo'),\n    t('Intensity'),\n    t('Density'),\n  ],\n});\n\nexport default class ScatterChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Scatter'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport timeGrainSqlaAnimationOverrides from '../../utilities/controls';\nimport {\n  filterNulls,\n  autozoom,\n  jsColumns,\n  jsDataMutator,\n  jsTooltip,\n  jsOnclickHref,\n  gridSize,\n  viewport,\n  spatial,\n  mapboxStyle,\n} from '../../utilities/Shared_DeckGL';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [spatial],\n        ['size'],\n        ['row_limit'],\n        [filterNulls],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Map'),\n      controlSetRows: [[mapboxStyle], [autozoom, viewport]],\n    },\n    {\n      label: t('Grid'),\n      expanded: true,\n      controlSetRows: [[gridSize, 'color_picker']],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n  controlOverrides: {\n    size: {\n      label: t('Weight'),\n      description: t(\"Metric used as a weight for the grid's coloring\"),\n      validators: [validateNonEmpty],\n    },\n    time_grain_sqla: timeGrainSqlaAnimationOverrides,\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    size: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'Aggregates data within the boundary of grid cells and maps the aggregated values to a dynamic color scale',\n  ),\n  name: t('deck.gl Screen Grid'),\n  thumbnail,\n  exampleGallery: [{ url: example }],\n  useLegacyApi: true,\n  tags: [\n    t('deckGL'),\n    t('Comparison'),\n    t('Intensity'),\n    t('Experimental'),\n    t('Density'),\n  ],\n});\n\nexport default class ScreengridChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Screengrid'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  autozoom,\n  filterNulls,\n  jsColumns,\n  jsDataMutator,\n  jsOnclickHref,\n  jsTooltip,\n  mapboxStyle,\n  spatial,\n  viewport,\n} from '../../utilities/Shared_DeckGL';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [spatial],\n        ['row_limit'],\n        ['size'],\n        [filterNulls],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Map'),\n      expanded: true,\n      controlSetRows: [\n        [mapboxStyle],\n        [autozoom, viewport],\n        [\n          {\n            name: 'cellSize',\n            config: {\n              type: 'TextControl',\n              label: t('Cell Size'),\n              default: 300,\n              isInt: true,\n              description: t('The size of each cell in meters'),\n              renderTrigger: true,\n              clearable: false,\n            },\n          },\n        ],\n        [\n          {\n            name: 'aggregation',\n            config: {\n              type: 'SelectControl',\n              label: t('Aggregation'),\n              description: t(\n                'The function to use when aggregating points into groups',\n              ),\n              default: 'sum',\n              clearable: false,\n              renderTrigger: true,\n              choices: [\n                ['sum', t('sum')],\n                ['min', t('min')],\n                ['max', t('max')],\n                ['mean', t('mean')],\n              ],\n            },\n          },\n        ],\n        [\n          {\n            name: 'contours',\n            config: {\n              type: 'ContourControl',\n              label: t('Contours'),\n              renderTrigger: true,\n              description: t(\n                'Define contour layers. Isolines represent a collection of line segments that ' +\n                  'serparate the area above and below a given threshold. Isobands represent a ' +\n                  'collection of polygons that fill the are containing values in a given ' +\n                  'threshold range.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Advanced'),\n      controlSetRows: [\n        [jsColumns],\n        [jsDataMutator],\n        [jsTooltip],\n        [jsOnclickHref],\n      ],\n    },\n  ],\n  controlOverrides: {\n    size: {\n      label: t('Weight'),\n      description: t(\"Metric used as a weight for the grid's coloring\"),\n      validators: [validateNonEmpty],\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    size: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from '../../transformProps';\nimport controlPanel from './controlPanel';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.png';\n\nconst metadata = new ChartMetadata({\n  category: t('Map'),\n  credits: ['https://uber.github.io/deck.gl'],\n  description: t(\n    'Uses Gaussian Kernel Density Estimation to visualize spatial distribution of data',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('deck.gl Contour'),\n  thumbnail,\n  useLegacyApi: true,\n  tags: [t('deckGL'), t('Spatial'), t('Comparison'), t('Experimental')],\n});\n\nexport default class ContourChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      loadChart: () => import('./Contour'),\n      controlPanel,\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Preset } from '@superset-ui/core';\nimport ArcChartPlugin from './layers/Arc';\nimport GeoJsonChartPlugin from './layers/Geojson';\nimport GridChartPlugin from './layers/Grid';\nimport HexChartPlugin from './layers/Hex';\nimport HeatmapChartPlugin from './layers/Heatmap';\nimport MultiChartPlugin from './Multi';\nimport PathChartPlugin from './layers/Path';\nimport PolygonChartPlugin from './layers/Polygon';\nimport ScatterChartPlugin from './layers/Scatter';\nimport ScreengridChartPlugin from './layers/Screengrid';\nimport ContourChartPlugin from './layers/Contour';\n\nexport default class DeckGLChartPreset extends Preset {\n  constructor() {\n    super({\n      name: 'deck.gl charts',\n      plugins: [\n        new ArcChartPlugin().configure({ key: 'deck_arc' }),\n        new GeoJsonChartPlugin().configure({ key: 'deck_geojson' }),\n        new GridChartPlugin().configure({ key: 'deck_grid' }),\n        new HexChartPlugin().configure({ key: 'deck_hex' }),\n        new HeatmapChartPlugin().configure({ key: 'deck_heatmap' }),\n        new MultiChartPlugin().configure({ key: 'deck_multi' }),\n        new PathChartPlugin().configure({ key: 'deck_path' }),\n        new PolygonChartPlugin().configure({ key: 'deck_polygon' }),\n        new ScatterChartPlugin().configure({ key: 'deck_scatter' }),\n        new ScreengridChartPlugin().configure({ key: 'deck_screengrid' }),\n        new ContourChartPlugin().configure({ key: 'deck_contour' }),\n      ],\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n// These are control configurations that are shared ONLY within the BigNumberWithTrendline viz plugin repo.\nimport { t } from '@superset-ui/core';\nimport { CustomControlItem } from '@superset-ui/chart-controls';\n\nexport const headerFontSize: CustomControlItem = {\n  name: 'header_font_size',\n  config: {\n    type: 'SelectControl',\n    label: t('Big Number Font Size'),\n    renderTrigger: true,\n    clearable: false,\n    default: 0.4,\n    // Values represent the percentage of space a header should take\n    options: [\n      {\n        label: t('Tiny'),\n        value: 0.2,\n      },\n      {\n        label: t('Small'),\n        value: 0.3,\n      },\n      {\n        label: t('Normal'),\n        value: 0.4,\n      },\n      {\n        label: t('Large'),\n        value: 0.5,\n      },\n      {\n        label: t('Huge'),\n        value: 0.6,\n      },\n    ],\n  },\n};\n\nexport const subheaderFontSize: CustomControlItem = {\n  name: 'subheader_font_size',\n  config: {\n    type: 'SelectControl',\n    label: t('Subheader Font Size'),\n    renderTrigger: true,\n    clearable: false,\n    default: 0.15,\n    // Values represent the percentage of space a subheader should take\n    options: [\n      {\n        label: t('Tiny'),\n        value: 0.125,\n      },\n      {\n        label: t('Small'),\n        value: 0.15,\n      },\n      {\n        label: t('Normal'),\n        value: 0.2,\n      },\n      {\n        label: t('Large'),\n        value: 0.3,\n      },\n      {\n        label: t('Huge'),\n        value: 0.4,\n      },\n    ],\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { smartDateFormatter, t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  D3_FORMAT_DOCS,\n  D3_TIME_FORMAT_OPTIONS,\n  getStandardizedControls,\n  temporalColumnMixin,\n} from '@superset-ui/chart-controls';\nimport React from 'react';\nimport { headerFontSize, subheaderFontSize } from '../sharedControls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['x_axis'],\n        ['time_grain_sqla'],\n        ['metric'],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Options'),\n      tabOverride: 'data',\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'compare_lag',\n            config: {\n              type: 'TextControl',\n              label: t('Comparison Period Lag'),\n              isInt: true,\n              description: t(\n                'Based on granularity, number of time periods to compare against',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'compare_suffix',\n            config: {\n              type: 'TextControl',\n              label: t('Comparison suffix'),\n              description: t('Suffix to apply after the percentage display'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_timestamp',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Timestamp'),\n              renderTrigger: true,\n              default: false,\n              description: t('Whether to display the timestamp'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_trend_line',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Trend Line'),\n              renderTrigger: true,\n              default: true,\n              description: t('Whether to display the trend line'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'start_y_axis_at_zero',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Start y-axis at 0'),\n              renderTrigger: true,\n              default: true,\n              description: t(\n                'Start y-axis at zero. Uncheck to start y-axis at minimum value in the data.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'time_range_fixed',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Fix to selected Time Range'),\n              description: t(\n                'Fix the trend line to the full time range specified in case filtered results do not include the start or end dates',\n              ),\n              renderTrigger: true,\n              visibility(props) {\n                const { time_range: timeRange } = props.form_data;\n                // only display this option when a time range is selected\n                return !!timeRange && timeRange !== 'No filter';\n              },\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_picker', null],\n        [headerFontSize],\n        [subheaderFontSize],\n        ['y_axis_format'],\n        ['currency_format'],\n        [\n          {\n            name: 'time_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date format'),\n              renderTrigger: true,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              description: D3_FORMAT_DOCS,\n              default: smartDateFormatter.id,\n            },\n          },\n        ],\n        [\n          {\n            name: 'force_timestamp_formatting',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Force date format'),\n              renderTrigger: true,\n              default: false,\n              description: t(\n                'Use date formatting even when metric value is not a timestamp',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Advanced Analytics'),\n      expanded: false,\n      controlSetRows: [\n        // eslint-disable-next-line react/jsx-key\n        [\n          <ControlSubSectionHeader>\n            {t('Rolling Window')}\n          </ControlSubSectionHeader>,\n        ],\n        [\n          {\n            name: 'rolling_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Rolling Function'),\n              default: 'None',\n              choices: [\n                ['None', t('None')],\n                ['mean', t('mean')],\n                ['sum', t('sum')],\n                ['std', t('std')],\n                ['cumsum', t('cumsum')],\n              ],\n              description: t(\n                'Defines a rolling window function to apply, works along ' +\n                  'with the [Periods] text box',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'rolling_periods',\n            config: {\n              type: 'TextControl',\n              label: t('Periods'),\n              isInt: true,\n              description: t(\n                'Defines the size of the rolling window function, ' +\n                  'relative to the time granularity selected',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'min_periods',\n            config: {\n              type: 'TextControl',\n              label: t('Min Periods'),\n              isInt: true,\n              description: t(\n                'The minimum number of rolling periods required to show ' +\n                  'a value. For instance if you do a cumulative sum on 7 days ' +\n                  'you may want your \"Min Period\" to be 7, so that all data points ' +\n                  'shown are the total of 7 periods. This will hide the \"ramp up\" ' +\n                  'taking place over the first 7 periods',\n              ),\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('Resample')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'resample_rule',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Rule'),\n              default: null,\n              choices: [\n                ['1T', t('1 minutely frequency')],\n                ['1H', t('1 hourly frequency')],\n                ['1D', t('1 calendar day frequency')],\n                ['7D', t('7 calendar day frequency')],\n                ['1MS', t('1 month start frequency')],\n                ['1M', t('1 month end frequency')],\n                ['1AS', t('1 year start frequency')],\n                ['1A', t('1 year end frequency')],\n              ],\n              description: t('Pandas resample rule'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'resample_method',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Fill method'),\n              default: null,\n              choices: [\n                ['asfreq', t('Null imputation')],\n                ['zerofill', t('Zero imputation')],\n                ['linear', t('Linear interpolation')],\n                ['ffill', t('Forward values')],\n                ['bfill', t('Backward values')],\n                ['median', t('Median values')],\n                ['mean', t('Mean values')],\n                ['sum', t('Sum values')],\n              ],\n              description: t('Pandas resample method'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    y_axis_format: {\n      label: t('Number format'),\n    },\n    x_axis: {\n      label: t('TEMPORAL X-AXIS'),\n      ...temporalColumnMixin,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport moment from 'moment';\nimport {\n  getTimeFormatter,\n  getTimeFormatterForGranularity,\n  smartDateFormatter,\n  TimeGranularity,\n} from '@superset-ui/core';\n\nexport const parseMetricValue = (metricValue: number | string | null) => {\n  if (typeof metricValue === 'string') {\n    const dateObject = moment.utc(metricValue, moment.ISO_8601, true);\n    if (dateObject.isValid()) {\n      return dateObject.valueOf();\n    }\n    return null;\n  }\n  return metricValue;\n};\n\nexport const getDateFormatter = (\n  timeFormat: string,\n  granularity?: TimeGranularity,\n  fallbackFormat?: string | null,\n) =>\n  timeFormat === smartDateFormatter.id\n    ? getTimeFormatterForGranularity(granularity)\n    : getTimeFormatter(timeFormat ?? fallbackFormat);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { CallbackDataParams } from 'echarts/types/src/util/types';\nimport { TOOLTIP_OVERFLOW_MARGIN, TOOLTIP_POINTER_MARGIN } from '../constants';\nimport { Refs } from '../types';\n\nexport function getDefaultTooltip(refs: Refs) {\n  return {\n    appendToBody: true,\n    position: (\n      canvasMousePos: [number, number],\n      params: CallbackDataParams,\n      tooltipDom: HTMLDivElement | null,\n      rect: any,\n      sizes: { contentSize: [number, number]; viewSize: [number, number] },\n    ) => {\n      // algorithm partially based on this snippet:\n      // https://github.com/apache/echarts/issues/5004#issuecomment-559668309\n\n      // The chart canvas position\n      const divRect = refs.divRef?.current?.getBoundingClientRect();\n\n      // The mouse coordinates relative to the whole window\n      // The first parameter to the position function is the mouse position relative to the canvas\n      const mouseX = canvasMousePos[0] + (divRect?.x || 0);\n      const mouseY = canvasMousePos[1] + (divRect?.y || 0);\n\n      // The width and height of the tooltip dom element\n      const tooltipWidth = sizes.contentSize[0];\n      const tooltipHeight = sizes.contentSize[1];\n\n      // Start by placing the tooltip top and right relative to the mouse position\n      let xPos = mouseX + TOOLTIP_POINTER_MARGIN;\n      let yPos = mouseY - TOOLTIP_POINTER_MARGIN - tooltipHeight;\n\n      // The tooltip is overflowing past the right edge of the window\n      if (xPos + tooltipWidth >= document.documentElement.clientWidth) {\n        // Attempt to place the tooltip to the left of the mouse position\n        xPos = mouseX - TOOLTIP_POINTER_MARGIN - tooltipWidth;\n\n        // The tooltip is overflowing past the left edge of the window\n        if (xPos <= 0)\n          // Place the tooltip a fixed distance from the left edge of the window\n          xPos = TOOLTIP_OVERFLOW_MARGIN;\n      }\n\n      // The tooltip is overflowing past the top edge of the window\n      if (yPos <= 0) {\n        // Attempt to place the tooltip to the bottom of the mouse position\n        yPos = mouseY + TOOLTIP_POINTER_MARGIN;\n\n        // The tooltip is overflowing past the bottom edge of the window\n        if (yPos + tooltipHeight >= document.documentElement.clientHeight)\n          // Place the tooltip a fixed distance from the top edge of the window\n          yPos = TOOLTIP_OVERFLOW_MARGIN;\n      }\n\n      // Return the position (converted back to a relative position on the canvas)\n      return [xPos - (divRect?.x || 0), yPos - (divRect?.y || 0)];\n    },\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  extractTimegrain,\n  getNumberFormatter,\n  NumberFormats,\n  GenericDataType,\n  getMetricLabel,\n  t,\n  smartDateVerboseFormatter,\n  TimeFormatter,\n  getXAxisLabel,\n  Metric,\n  ValueFormatter,\n  getValueFormatter,\n} from '@superset-ui/core';\nimport { EChartsCoreOption, graphic } from 'echarts';\nimport {\n  BigNumberVizProps,\n  BigNumberDatum,\n  BigNumberWithTrendlineChartProps,\n  TimeSeriesDatum,\n} from '../types';\nimport { getDateFormatter, parseMetricValue } from '../utils';\nimport { getDefaultTooltip } from '../../utils/tooltip';\nimport { Refs } from '../../types';\n\nconst defaultNumberFormatter = getNumberFormatter();\nexport function renderTooltipFactory(\n  formatDate: TimeFormatter = smartDateVerboseFormatter,\n  formatValue: ValueFormatter | TimeFormatter = defaultNumberFormatter,\n) {\n  return function renderTooltip(params: { data: TimeSeriesDatum }[]) {\n    return `\n      ${formatDate(params[0].data[0])}\n      <br />\n      <strong>\n        ${\n          params[0].data[1] === null ? t('N/A') : formatValue(params[0].data[1])\n        }\n      </strong>\n    `;\n  };\n}\n\nconst formatPercentChange = getNumberFormatter(\n  NumberFormats.PERCENT_SIGNED_1_POINT,\n);\n\nexport default function transformProps(\n  chartProps: BigNumberWithTrendlineChartProps,\n): BigNumberVizProps {\n  const {\n    width,\n    height,\n    queriesData,\n    formData,\n    rawFormData,\n    theme,\n    hooks,\n    inContextMenu,\n    datasource: { currencyFormats = {}, columnFormats = {} },\n  } = chartProps;\n  const {\n    colorPicker,\n    compareLag: compareLag_,\n    compareSuffix = '',\n    timeFormat,\n    headerFontSize,\n    metric = 'value',\n    showTimestamp,\n    showTrendLine,\n    startYAxisAtZero,\n    subheader = '',\n    subheaderFontSize,\n    forceTimestampFormatting,\n    yAxisFormat,\n    currencyFormat,\n    timeRangeFixed,\n  } = formData;\n  const granularity = extractTimegrain(rawFormData);\n  const {\n    data = [],\n    colnames = [],\n    coltypes = [],\n    from_dttm: fromDatetime,\n    to_dttm: toDatetime,\n  } = queriesData[0];\n  const refs: Refs = {};\n  const metricName = getMetricLabel(metric);\n  const compareLag = Number(compareLag_) || 0;\n  let formattedSubheader = subheader;\n\n  const { r, g, b } = colorPicker;\n  const mainColor = `rgb(${r}, ${g}, ${b})`;\n\n  const xAxisLabel = getXAxisLabel(rawFormData) as string;\n  let trendLineData: TimeSeriesDatum[] | undefined;\n  let percentChange = 0;\n  let bigNumber = data.length === 0 ? null : data[0][metricName];\n  let timestamp = data.length === 0 ? null : data[0][xAxisLabel];\n  let bigNumberFallback;\n\n  const metricColtypeIndex = colnames.findIndex(name => name === metricName);\n  const metricColtype =\n    metricColtypeIndex > -1 ? coltypes[metricColtypeIndex] : null;\n\n  if (data.length > 0) {\n    const sortedData = (data as BigNumberDatum[])\n      .map(d => [d[xAxisLabel], parseMetricValue(d[metricName])])\n      // sort in time descending order\n      .sort((a, b) => (a[0] !== null && b[0] !== null ? b[0] - a[0] : 0));\n\n    bigNumber = sortedData[0][1];\n    timestamp = sortedData[0][0];\n\n    if (bigNumber === null) {\n      bigNumberFallback = sortedData.find(d => d[1] !== null);\n      bigNumber = bigNumberFallback ? bigNumberFallback[1] : null;\n      timestamp = bigNumberFallback ? bigNumberFallback[0] : null;\n    }\n\n    if (compareLag > 0) {\n      const compareIndex = compareLag;\n      if (compareIndex < sortedData.length) {\n        const compareValue = sortedData[compareIndex][1];\n        // compare values must both be non-nulls\n        if (bigNumber !== null && compareValue !== null) {\n          percentChange = compareValue\n            ? (bigNumber - compareValue) / Math.abs(compareValue)\n            : 0;\n          formattedSubheader = `${formatPercentChange(\n            percentChange,\n          )} ${compareSuffix}`;\n        }\n      }\n    }\n    sortedData.reverse();\n    // @ts-ignore\n    trendLineData = showTrendLine ? sortedData : undefined;\n  }\n\n  let className = '';\n  if (percentChange > 0) {\n    className = 'positive';\n  } else if (percentChange < 0) {\n    className = 'negative';\n  }\n\n  let metricEntry: Metric | undefined;\n  if (chartProps.datasource?.metrics) {\n    metricEntry = chartProps.datasource.metrics.find(\n      metricEntry => metricEntry.metric_name === metric,\n    );\n  }\n\n  const formatTime = getDateFormatter(\n    timeFormat,\n    granularity,\n    metricEntry?.d3format,\n  );\n\n  const numberFormatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    yAxisFormat,\n    currencyFormat,\n  );\n\n  const headerFormatter =\n    metricColtype === GenericDataType.Temporal ||\n    metricColtype === GenericDataType.String ||\n    forceTimestampFormatting\n      ? formatTime\n      : numberFormatter;\n\n  if (trendLineData && timeRangeFixed && fromDatetime) {\n    const toDatetimeOrToday = toDatetime ?? Date.now();\n    if (!trendLineData[0][0] || trendLineData[0][0] > fromDatetime) {\n      trendLineData.unshift([fromDatetime, null]);\n    }\n    if (\n      !trendLineData[trendLineData.length - 1][0] ||\n      trendLineData[trendLineData.length - 1][0]! < toDatetimeOrToday\n    ) {\n      trendLineData.push([toDatetimeOrToday, null]);\n    }\n  }\n\n  const echartOptions: EChartsCoreOption = trendLineData\n    ? {\n        series: [\n          {\n            data: trendLineData,\n            type: 'line',\n            smooth: true,\n            symbol: 'circle',\n            symbolSize: 10,\n            showSymbol: false,\n            color: mainColor,\n            areaStyle: {\n              color: new graphic.LinearGradient(0, 0, 0, 1, [\n                {\n                  offset: 0,\n                  color: mainColor,\n                },\n                {\n                  offset: 1,\n                  color: theme.colors.grayscale.light5,\n                },\n              ]),\n            },\n          },\n        ],\n        xAxis: {\n          min: trendLineData[0][0],\n          max: trendLineData[trendLineData.length - 1][0],\n          show: false,\n          type: 'value',\n        },\n        yAxis: {\n          scale: !startYAxisAtZero,\n          show: false,\n        },\n        grid: {\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0,\n        },\n        tooltip: {\n          ...getDefaultTooltip(refs),\n          show: !inContextMenu,\n          trigger: 'axis',\n          formatter: renderTooltipFactory(formatTime, headerFormatter),\n        },\n        aria: {\n          enabled: true,\n          label: {\n            description: `Big number visualization ${subheader}`,\n          },\n        },\n      }\n    : {};\n\n  const { onContextMenu } = hooks;\n\n  return {\n    width,\n    height,\n    bigNumber,\n    // @ts-ignore\n    bigNumberFallback,\n    className,\n    headerFormatter,\n    formatTime,\n    formData,\n    headerFontSize,\n    subheaderFontSize,\n    mainColor,\n    showTimestamp,\n    showTrendLine,\n    startYAxisAtZero,\n    subheader: formattedSubheader,\n    timestamp,\n    trendLineData,\n    echartOptions,\n    onContextMenu,\n    xValueFormatter: formatTime,\n    refs,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  ensureIsArray,\n  getXAxisColumn,\n  isXAxisSet,\n  QueryFormData,\n} from '@superset-ui/core';\nimport {\n  flattenOperator,\n  pivotOperator,\n  resampleOperator,\n  rollingWindowOperator,\n} from '@superset-ui/chart-controls';\n\nexport default function buildQuery(formData: QueryFormData) {\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      columns: [\n        ...(isXAxisSet(formData)\n          ? ensureIsArray(getXAxisColumn(formData))\n          : []),\n      ],\n      ...(isXAxisSet(formData) ? {} : { is_timeseries: true }),\n      post_processing: [\n        pivotOperator(formData, baseQueryObject),\n        rollingWindowOperator(formData, baseQueryObject),\n        resampleOperator(formData, baseQueryObject),\n        flattenOperator(formData, baseQueryObject),\n      ],\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, Behavior } from '@superset-ui/core';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport buildQuery from './buildQuery';\nimport example from './images/Big_Number_Trendline.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport {\n  BigNumberWithTrendlineChartProps,\n  BigNumberWithTrendlineFormData,\n} from '../types';\nimport { EchartsChartPlugin } from '../../types';\n\nconst metadata = {\n  category: t('KPI'),\n  description: t(\n    'Showcases a single number accompanied by a simple line chart, to call attention to an important metric along with its change over time or other dimension.',\n  ),\n  exampleGallery: [{ url: example }],\n  name: t('Big Number with Trendline'),\n  tags: [\n    t('Advanced-Analytics'),\n    t('Line'),\n    t('Percentages'),\n    t('Popular'),\n    t('Report'),\n    t('Description'),\n    t('Trend'),\n  ],\n  thumbnail,\n  behaviors: [Behavior.DrillToDetail],\n};\n\nexport default class BigNumberWithTrendlineChartPlugin extends EchartsChartPlugin<\n  BigNumberWithTrendlineFormData,\n  BigNumberWithTrendlineChartProps\n> {\n  constructor() {\n    super({\n      loadChart: () => import('../BigNumberViz'),\n      metadata,\n      buildQuery,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { GenericDataType, smartDateFormatter, t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  D3_FORMAT_DOCS,\n  D3_TIME_FORMAT_OPTIONS,\n  Dataset,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { headerFontSize, subheaderFontSize } from '../sharedControls';\n\nexport default {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [['metric'], ['adhoc_filters']],\n    },\n    {\n      label: t('Display settings'),\n      expanded: true,\n      tabOverride: 'data',\n      controlSetRows: [\n        [\n          {\n            name: 'subheader',\n            config: {\n              type: 'TextControl',\n              label: t('Subheader'),\n              renderTrigger: true,\n              description: t(\n                'Description text that shows up below your Big Number',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        [headerFontSize],\n        [subheaderFontSize],\n        ['y_axis_format'],\n        ['currency_format'],\n        [\n          {\n            name: 'time_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date format'),\n              renderTrigger: true,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              description: D3_FORMAT_DOCS,\n              default: smartDateFormatter.id,\n            },\n          },\n        ],\n        [\n          {\n            name: 'force_timestamp_formatting',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Force date format'),\n              renderTrigger: true,\n              default: false,\n              description: t(\n                'Use date formatting even when metric value is not a timestamp',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'conditional_formatting',\n            config: {\n              type: 'ConditionalFormattingControl',\n              renderTrigger: true,\n              label: t('Conditional Formatting'),\n              description: t('Apply conditional color formatting to metric'),\n              shouldMapStateToProps() {\n                return true;\n              },\n              mapStateToProps(explore, _, chart) {\n                const verboseMap = explore?.datasource?.hasOwnProperty(\n                  'verbose_map',\n                )\n                  ? (explore?.datasource as Dataset)?.verbose_map\n                  : explore?.datasource?.columns ?? {};\n                const { colnames, coltypes } =\n                  chart?.queriesResponse?.[0] ?? {};\n                const numericColumns =\n                  Array.isArray(colnames) && Array.isArray(coltypes)\n                    ? colnames\n                        .filter(\n                          (colname: string, index: number) =>\n                            coltypes[index] === GenericDataType.Numeric,\n                        )\n                        .map(colname => ({\n                          value: colname,\n                          label: verboseMap[colname] ?? colname,\n                        }))\n                    : [];\n                return {\n                  columnOptions: numericColumns,\n                  verboseMap,\n                };\n              },\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    y_axis_format: {\n      label: t('Number format'),\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n} as ControlPanelConfig;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ColorFormatters,\n  getColorFormatters,\n  Metric,\n} from '@superset-ui/chart-controls';\nimport {\n  GenericDataType,\n  getMetricLabel,\n  extractTimegrain,\n  QueryFormData,\n  getValueFormatter,\n} from '@superset-ui/core';\nimport { BigNumberTotalChartProps, BigNumberVizProps } from '../types';\nimport { getDateFormatter, parseMetricValue } from '../utils';\nimport { Refs } from '../../types';\n\nexport default function transformProps(\n  chartProps: BigNumberTotalChartProps,\n): BigNumberVizProps {\n  const {\n    width,\n    height,\n    queriesData,\n    formData,\n    rawFormData,\n    hooks,\n    datasource: { currencyFormats = {}, columnFormats = {} },\n  } = chartProps;\n  const {\n    headerFontSize,\n    metric = 'value',\n    subheader = '',\n    subheaderFontSize,\n    forceTimestampFormatting,\n    timeFormat,\n    yAxisFormat,\n    conditionalFormatting,\n    currencyFormat,\n  } = formData;\n  const refs: Refs = {};\n  const { data = [], coltypes = [] } = queriesData[0];\n  const granularity = extractTimegrain(rawFormData as QueryFormData);\n  const metricName = getMetricLabel(metric);\n  const formattedSubheader = subheader;\n  const bigNumber =\n    data.length === 0 ? null : parseMetricValue(data[0][metricName]);\n\n  let metricEntry: Metric | undefined;\n  if (chartProps.datasource?.metrics) {\n    metricEntry = chartProps.datasource.metrics.find(\n      metricItem => metricItem.metric_name === metric,\n    );\n  }\n\n  const formatTime = getDateFormatter(\n    timeFormat,\n    granularity,\n    metricEntry?.d3format,\n  );\n\n  const numberFormatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    yAxisFormat,\n    currencyFormat,\n  );\n\n  const headerFormatter =\n    coltypes[0] === GenericDataType.Temporal ||\n    coltypes[0] === GenericDataType.String ||\n    forceTimestampFormatting\n      ? formatTime\n      : numberFormatter;\n\n  const { onContextMenu } = hooks;\n\n  const defaultColorFormatters = [] as ColorFormatters;\n\n  const colorThresholdFormatters =\n    getColorFormatters(conditionalFormatting, data, false) ??\n    defaultColorFormatters;\n\n  return {\n    width,\n    height,\n    bigNumber,\n    headerFormatter,\n    headerFontSize,\n    subheaderFontSize,\n    subheader: formattedSubheader,\n    onContextMenu,\n    refs,\n    colorThresholdFormatters,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  return buildQueryContext(formData, baseQueryObject => [baseQueryObject]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, Behavior } from '@superset-ui/core';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport buildQuery from './buildQuery';\nimport example1 from './images/BigNumber.jpg';\nimport example2 from './images/BigNumber2.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport { BigNumberTotalChartProps, BigNumberTotalFormData } from '../types';\nimport { EchartsChartPlugin } from '../../types';\n\nconst metadata = {\n  category: t('KPI'),\n  description: t(\n    'Showcases a single metric front-and-center. Big number is best used to call attention to a KPI or the one thing you want your audience to focus on.',\n  ),\n  exampleGallery: [\n    { url: example1, caption: t('A Big Number') },\n    { url: example2, caption: t('With a subheader') },\n  ],\n  name: t('Big Number'),\n  tags: [\n    t('Additive'),\n    t('Business'),\n    t('Legacy'),\n    t('Percentages'),\n    t('Popular'),\n    t('Report'),\n    t('Description'),\n  ],\n  thumbnail,\n  behaviors: [Behavior.DrillToDetail],\n};\n\nexport default class BigNumberTotalChartPlugin extends EchartsChartPlugin<\n  BigNumberTotalFormData,\n  BigNumberTotalChartProps\n> {\n  constructor() {\n    super({\n      loadChart: () => import('../BigNumberViz'),\n      metadata,\n      buildQuery,\n      transformProps,\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AdhocColumn,\n  buildQueryContext,\n  ensureIsArray,\n  isPhysicalColumn,\n} from '@superset-ui/core';\nimport { boxplotOperator } from '@superset-ui/chart-controls';\nimport { BoxPlotQueryFormData } from './types';\n\nexport default function buildQuery(formData: BoxPlotQueryFormData) {\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      columns: [\n        ...(ensureIsArray(formData.columns).length === 0 &&\n        formData.granularity_sqla\n          ? [formData.granularity_sqla] // for backwards compatible: if columns control is empty and granularity_sqla was set, the time columns is default distributed column.\n          : ensureIsArray(formData.columns)\n        ).map(col => {\n          if (\n            isPhysicalColumn(col) &&\n            formData.time_grain_sqla &&\n            formData?.temporal_columns_lookup?.[col]\n          ) {\n            return {\n              timeGrain: formData.time_grain_sqla,\n              columnType: 'BASE_AXIS',\n              sqlExpression: col,\n              label: col,\n              expressionType: 'SQL',\n            } as AdhocColumn;\n          }\n          return col;\n        }),\n        ...ensureIsArray(formData.groupby),\n      ],\n      series_columns: formData.groupby,\n      post_processing: [boxplotOperator(formData, baseQueryObject)],\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ensureIsArray,\n  isAdhocColumn,\n  isPhysicalColumn,\n  t,\n  validateNonEmpty,\n} from '@superset-ui/core';\nimport {\n  D3_FORMAT_DOCS,\n  D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT,\n  D3_FORMAT_OPTIONS,\n  D3_TIME_FORMAT_OPTIONS,\n  sections,\n  ControlPanelConfig,\n  getStandardizedControls,\n  ControlState,\n  ControlPanelState,\n  getTemporalColumns,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['columns'],\n        [\n          {\n            name: 'time_grain_sqla',\n            config: {\n              ...sharedControls.time_grain_sqla,\n              visibility: ({ controls }) => {\n                const dttmLookup = Object.fromEntries(\n                  ensureIsArray(controls?.columns?.options).map(option => [\n                    option.column_name,\n                    option.is_dttm,\n                  ]),\n                );\n\n                return ensureIsArray(controls?.columns.value)\n                  .map(selection => {\n                    if (isAdhocColumn(selection)) {\n                      return true;\n                    }\n                    if (isPhysicalColumn(selection)) {\n                      return !!dttmLookup[selection];\n                    }\n                    return false;\n                  })\n                  .some(Boolean);\n              },\n            },\n          },\n          'temporal_columns_lookup',\n        ],\n        ['groupby'],\n        ['metrics'],\n        ['adhoc_filters'],\n        ['series_limit'],\n        ['series_limit_metric'],\n        [\n          {\n            name: 'whiskerOptions',\n            config: {\n              clearable: false,\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Whisker/outlier options'),\n              default: 'Tukey',\n              description: t(\n                'Determines how whiskers and outliers are calculated.',\n              ),\n              choices: [\n                ['Tukey', t('Tukey')],\n                ['Min/max (no outliers)', t('Min/max (no outliers)')],\n                ['2/98 percentiles', t('2/98 percentiles')],\n                ['9/91 percentiles', t('9/91 percentiles')],\n              ],\n            },\n          },\n        ],\n      ],\n    },\n    sections.titleControls,\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        [\n          {\n            name: 'x_ticks_layout',\n            config: {\n              type: 'SelectControl',\n              label: t('X Tick Layout'),\n              choices: [\n                ['auto', t('auto')],\n                ['flat', t('flat')],\n                ['45', '45'],\n                ['90', '90'],\n                ['staggered', t('staggered')],\n              ],\n              default: 'auto',\n              clearable: false,\n              renderTrigger: true,\n              description: t('The way the ticks are laid out on the X-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: 'SMART_NUMBER',\n              choices: D3_FORMAT_OPTIONS,\n              description: `${D3_FORMAT_DOCS} ${D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT}`,\n            },\n          },\n        ],\n        [\n          {\n            name: 'date_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date format'),\n              renderTrigger: true,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              default: 'smart_date',\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    groupby: {\n      label: t('Dimensions'),\n      description: t('Categories to group by on the x-axis.'),\n    },\n    columns: {\n      label: t('Distribute across'),\n      multi: true,\n      description: t('Columns to calculate distribution across.'),\n      initialValue: (\n        control: ControlState,\n        state: ControlPanelState | null,\n      ) => {\n        if (\n          state &&\n          (!control?.value ||\n            (Array.isArray(control?.value) && control.value.length === 0))\n        ) {\n          return [getTemporalColumns(state.datasource).defaultTemporalColumn];\n        }\n        return control.value;\n      },\n      validators: [validateNonEmpty],\n    },\n  },\n  formDataOverrides: formData => {\n    const groupby = getStandardizedControls().controls.columns.filter(\n      col => !ensureIsArray(formData.columns).includes(col),\n    );\n    getStandardizedControls().controls.columns =\n      getStandardizedControls().controls.columns.filter(\n        col => !groupby.includes(col),\n      );\n\n    return {\n      ...formData,\n      metrics: getStandardizedControls().popAllMetrics(),\n      groupby,\n    };\n  },\n};\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport const convertInteger = (value: string | number) => {\n  if (typeof value !== 'number') return parseInt(value, 10) || 0;\n  return value;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { isNumber } from 'lodash';\nimport { DataRecord, DTTM_ALIAS, ValueFormatter } from '@superset-ui/core';\nimport { OptionName } from 'echarts/types/src/util/types';\nimport { TooltipMarker } from 'echarts/types/src/util/format';\nimport {\n  ForecastSeriesContext,\n  ForecastSeriesEnum,\n  ForecastValue,\n} from '../types';\nimport { sanitizeHtml } from './series';\n\nconst seriesTypeRegex = new RegExp(\n  `(.+)(${ForecastSeriesEnum.ForecastLower}|${ForecastSeriesEnum.ForecastTrend}|${ForecastSeriesEnum.ForecastUpper})$`,\n);\nexport const extractForecastSeriesContext = (\n  seriesName: OptionName,\n): ForecastSeriesContext => {\n  const name = seriesName as string;\n  const regexMatch = seriesTypeRegex.exec(name);\n  if (!regexMatch) return { name, type: ForecastSeriesEnum.Observation };\n  return {\n    name: regexMatch[1],\n    type: regexMatch[2] as ForecastSeriesEnum,\n  };\n};\n\nexport const extractForecastSeriesContexts = (\n  seriesNames: string[],\n): { [key: string]: ForecastSeriesEnum[] } =>\n  seriesNames.reduce(\n    (agg, name) => {\n      const context = extractForecastSeriesContext(name);\n      const currentContexts = agg[context.name] || [];\n      currentContexts.push(context.type);\n      return { ...agg, [context.name]: currentContexts };\n    },\n    {} as { [key: string]: ForecastSeriesEnum[] },\n  );\n\nexport const extractForecastValuesFromTooltipParams = (\n  params: any[],\n  isHorizontal = false,\n): Record<string, ForecastValue> => {\n  const values: Record<string, ForecastValue> = {};\n  params.forEach(param => {\n    const { marker, seriesId, value } = param;\n    const context = extractForecastSeriesContext(seriesId);\n    const numericValue = isHorizontal ? value[0] : value[1];\n    if (isNumber(numericValue)) {\n      if (!(context.name in values))\n        values[context.name] = {\n          marker: marker || '',\n        };\n      const forecastValues = values[context.name];\n      if (context.type === ForecastSeriesEnum.Observation)\n        forecastValues.observation = numericValue;\n      if (context.type === ForecastSeriesEnum.ForecastTrend)\n        forecastValues.forecastTrend = numericValue;\n      if (context.type === ForecastSeriesEnum.ForecastLower)\n        forecastValues.forecastLower = numericValue;\n      if (context.type === ForecastSeriesEnum.ForecastUpper)\n        forecastValues.forecastUpper = numericValue;\n    }\n  });\n  return values;\n};\n\nexport const formatForecastTooltipSeries = ({\n  seriesName,\n  observation,\n  forecastTrend,\n  forecastLower,\n  forecastUpper,\n  marker,\n  formatter,\n}: ForecastValue & {\n  seriesName: string;\n  marker: TooltipMarker;\n  formatter: ValueFormatter;\n}): string => {\n  let row = `${marker}${sanitizeHtml(seriesName)}: `;\n  let isObservation = false;\n  if (isNumber(observation)) {\n    isObservation = true;\n    row += `${formatter(observation)}`;\n  }\n  if (forecastTrend) {\n    if (isObservation) row += ', ';\n    row += ` = ${formatter(forecastTrend)}`;\n  }\n  if (forecastLower && forecastUpper)\n    // the lower bound needs to be added to the upper bound\n    row = `${row.trim()} (${formatter(forecastLower)}, ${formatter(\n      forecastLower + forecastUpper,\n    )})`;\n  return `${row.trim()}`;\n};\n\nexport function rebaseForecastDatum(\n  data: DataRecord[],\n  verboseMap: Record<string, string> = {},\n) {\n  const keys = data.length ? Object.keys(data[0]) : [];\n\n  return data.map(row => {\n    const newRow: DataRecord = {};\n    keys.forEach(key => {\n      const forecastContext = extractForecastSeriesContext(key);\n      const verboseKey =\n        key !== DTTM_ALIAS && verboseMap[forecastContext.name]\n          ? `${verboseMap[forecastContext.name]}${forecastContext.type}`\n          : key;\n\n      // check if key is equal to lower confidence level. If so, extract it\n      // from the upper bound\n      const lowerForecastKey = `${forecastContext.name}${ForecastSeriesEnum.ForecastLower}`;\n      let value = row[key] as number | null;\n      if (\n        forecastContext.type === ForecastSeriesEnum.ForecastUpper &&\n        keys.includes(lowerForecastKey) &&\n        value !== null &&\n        row[lowerForecastKey] !== null\n      ) {\n        value -= row[lowerForecastKey] as number;\n      }\n      newRow[verboseKey] = value;\n    });\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return newRow;\n  });\n}\n","/* eslint-disable no-underscore-dangle */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { isEmpty } from 'lodash';\n\nimport {\n  Annotation,\n  AnnotationData,\n  AnnotationLayer,\n  AnnotationOpacity,\n  AnnotationType,\n  AxisType,\n  DataRecord,\n  evalExpression,\n  FormulaAnnotationLayer,\n  isRecordAnnotationResult,\n  isTableAnnotationLayer,\n  isTimeseriesAnnotationResult,\n} from '@superset-ui/core';\nimport { EchartsTimeseriesChartProps } from '../types';\nimport { EchartsMixedTimeseriesProps } from '../MixedTimeseries/types';\n\nexport function evalFormula(\n  formula: FormulaAnnotationLayer,\n  data: DataRecord[],\n  xAxis: string,\n  xAxisType: AxisType,\n): [any, number][] {\n  const { value: expression } = formula;\n\n  return data.map(row => {\n    let value = row[xAxis];\n    if (xAxisType === AxisType.Time) {\n      value = new Date(value as string).getTime();\n    }\n    return [value, evalExpression(expression, (value || 0) as number)];\n  });\n}\n\nexport function parseAnnotationOpacity(opacity?: AnnotationOpacity): number {\n  switch (opacity) {\n    case AnnotationOpacity.Low:\n      return 0.2;\n    case AnnotationOpacity.Medium:\n      return 0.5;\n    case AnnotationOpacity.High:\n      return 0.8;\n    default:\n      return 1;\n  }\n}\n\nconst NATIVE_COLUMN_NAMES = {\n  descriptionColumns: ['long_descr'],\n  intervalEndColumn: 'end_dttm',\n  timeColumn: 'start_dttm',\n  titleColumn: 'short_descr',\n};\n\nexport function extractRecordAnnotations(\n  annotationLayer: AnnotationLayer,\n  annotationData: AnnotationData,\n): Annotation[] {\n  const { name } = annotationLayer;\n  const result = annotationData[name];\n  if (isRecordAnnotationResult(result)) {\n    const { records } = result;\n    const {\n      descriptionColumns = [],\n      intervalEndColumn = '',\n      timeColumn = '',\n      titleColumn = '',\n    } = isTableAnnotationLayer(annotationLayer)\n      ? annotationLayer\n      : NATIVE_COLUMN_NAMES;\n\n    return records.map(record => ({\n      descriptions: descriptionColumns.map(\n        column => (record[column] || '') as string,\n      ) as string[],\n      intervalEnd: (record[intervalEndColumn] || '') as string,\n      time: (record[timeColumn] || '') as string,\n      title: (record[titleColumn] || '') as string,\n    }));\n  }\n  throw new Error('Please rerun the query.');\n}\n\nexport function formatAnnotationLabel(\n  name?: string,\n  title?: string,\n  descriptions: string[] = [],\n): string {\n  const labels: string[] = [];\n  const titleLabels: string[] = [];\n  const filteredDescriptions = descriptions.filter(\n    description => !!description,\n  );\n  if (name) titleLabels.push(name);\n  if (title) titleLabels.push(title);\n  if (titleLabels.length > 0) labels.push(titleLabels.join(' - '));\n  if (filteredDescriptions.length > 0)\n    labels.push(filteredDescriptions.join('\\n'));\n  return labels.join('\\n\\n');\n}\n\nexport function extractAnnotationLabels(\n  layers: AnnotationLayer[],\n  data: AnnotationData,\n): string[] {\n  const formulaAnnotationLabels = layers\n    .filter(anno => anno.annotationType === AnnotationType.Formula && anno.show)\n    .map(anno => anno.name);\n  const timeseriesAnnotationLabels = layers\n    .filter(\n      anno => anno.annotationType === AnnotationType.Timeseries && anno.show,\n    )\n    .flatMap(anno => {\n      const result = data[anno.name];\n      return isTimeseriesAnnotationResult(result)\n        ? result.map(annoSeries => annoSeries.key)\n        : [];\n    });\n\n  return formulaAnnotationLabels.concat(timeseriesAnnotationLabels);\n}\n\nexport function getAnnotationData(\n  chartProps: EchartsTimeseriesChartProps | EchartsMixedTimeseriesProps,\n): AnnotationData {\n  const data = chartProps?.queriesData[0]?.annotation_data as AnnotationData;\n  if (!isEmpty(data)) {\n    return data;\n  }\n  return {};\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AnnotationData,\n  AnnotationOpacity,\n  AxisType,\n  CategoricalColorScale,\n  EventAnnotationLayer,\n  FilterState,\n  FormulaAnnotationLayer,\n  IntervalAnnotationLayer,\n  isTimeseriesAnnotationResult,\n  LegendState,\n  SupersetTheme,\n  TimeseriesAnnotationLayer,\n  TimeseriesDataRecord,\n  ValueFormatter,\n} from '@superset-ui/core';\nimport { SeriesOption } from 'echarts';\nimport {\n  CallbackDataParams,\n  DefaultStatesMixin,\n  ItemStyleOption,\n  LineStyleOption,\n  OptionName,\n  SeriesLabelOption,\n  SeriesLineLabelOption,\n  ZRLineType,\n} from 'echarts/types/src/util/types';\nimport {\n  MarkArea1DDataItemOption,\n  MarkArea2DDataItemOption,\n} from 'echarts/types/src/component/marker/MarkAreaModel';\nimport { MarkLine1DDataItemOption } from 'echarts/types/src/component/marker/MarkLineModel';\nimport { extractForecastSeriesContext } from '../utils/forecast';\nimport {\n  EchartsTimeseriesSeriesType,\n  ForecastSeriesEnum,\n  LegendOrientation,\n  StackType,\n} from '../types';\n\nimport {\n  evalFormula,\n  extractRecordAnnotations,\n  formatAnnotationLabel,\n  parseAnnotationOpacity,\n} from '../utils/annotation';\nimport { getChartPadding } from '../utils/series';\nimport {\n  OpacityEnum,\n  StackControlsValue,\n  TIMESERIES_CONSTANTS,\n} from '../constants';\n\n// based on weighted wiggle algorithm\n// source: https://ieeexplore.ieee.org/document/4658136\nexport const getBaselineSeriesForStream = (\n  series: [string | number, number][][],\n  seriesType: EchartsTimeseriesSeriesType,\n) => {\n  const seriesLength = series[0].length;\n  const baselineSeriesDelta = new Array(seriesLength).fill([0, 0]);\n  const getVal = (value: number | null) => value ?? 0;\n  for (let i = 0; i < seriesLength; i += 1) {\n    let seriesSum = 0;\n    let weightedSeriesSum = 0;\n    for (let j = 0; j < series.length; j += 1) {\n      const delta =\n        i > 0\n          ? getVal(series[j][i][1]) - getVal(series[j][i - 1][1])\n          : getVal(series[j][i][1]);\n      let deltaPrev = 0;\n      for (let k = 1; k < j - 1; k += 1) {\n        deltaPrev +=\n          i > 0\n            ? getVal(series[k][i][1]) - getVal(series[k][i - 1][1])\n            : getVal(series[k][i][1]);\n      }\n      weightedSeriesSum += (0.5 * delta + deltaPrev) * getVal(series[j][i][1]);\n      seriesSum += getVal(series[j][i][1]);\n    }\n    baselineSeriesDelta[i] = [series[0][i][0], -weightedSeriesSum / seriesSum];\n  }\n  const baselineSeries = baselineSeriesDelta.reduce((acc, curr, i) => {\n    if (i === 0) {\n      acc.push(curr);\n    } else {\n      acc.push([curr[0], acc[i - 1][1] + curr[1]]);\n    }\n    return acc;\n  }, []);\n  return {\n    data: baselineSeries,\n    name: 'baseline',\n    stack: 'obs',\n    stackStrategy: 'all' as const,\n    type: 'line' as const,\n    lineStyle: {\n      opacity: 0,\n    },\n    tooltip: {\n      show: false,\n    },\n    silent: true,\n    showSymbol: false,\n    areaStyle: {\n      opacity: 0,\n    },\n    step: [\n      EchartsTimeseriesSeriesType.Start,\n      EchartsTimeseriesSeriesType.Middle,\n      EchartsTimeseriesSeriesType.End,\n    ].includes(seriesType)\n      ? (seriesType as\n          | EchartsTimeseriesSeriesType.Start\n          | EchartsTimeseriesSeriesType.Middle\n          | EchartsTimeseriesSeriesType.End)\n      : undefined,\n    smooth: seriesType === EchartsTimeseriesSeriesType.Smooth,\n  };\n};\n\nexport function transformSeries(\n  series: SeriesOption,\n  colorScale: CategoricalColorScale,\n  colorScaleKey: string,\n  opts: {\n    area?: boolean;\n    connectNulls?: boolean;\n    filterState?: FilterState;\n    seriesContexts?: { [key: string]: ForecastSeriesEnum[] };\n    markerEnabled?: boolean;\n    markerSize?: number;\n    areaOpacity?: number;\n    seriesType?: EchartsTimeseriesSeriesType;\n    stack?: StackType;\n    stackIdSuffix?: string;\n    yAxisIndex?: number;\n    showValue?: boolean;\n    onlyTotal?: boolean;\n    legendState?: LegendState;\n    formatter?: ValueFormatter;\n    totalStackedValues?: number[];\n    showValueIndexes?: number[];\n    thresholdValues?: number[];\n    richTooltip?: boolean;\n    seriesKey?: OptionName;\n    sliceId?: number;\n    isHorizontal?: boolean;\n    lineStyle?: LineStyleOption;\n    queryIndex?: number;\n  },\n): SeriesOption | undefined {\n  const { name } = series;\n  const {\n    area,\n    connectNulls,\n    filterState,\n    seriesContexts = {},\n    markerEnabled,\n    markerSize,\n    areaOpacity = 1,\n    seriesType,\n    stack,\n    stackIdSuffix,\n    yAxisIndex = 0,\n    showValue,\n    onlyTotal,\n    formatter,\n    legendState,\n    totalStackedValues = [],\n    showValueIndexes = [],\n    thresholdValues = [],\n    richTooltip,\n    sliceId,\n    isHorizontal = false,\n    queryIndex = 0,\n  } = opts;\n  const contexts = seriesContexts[name || ''] || [];\n  const hasForecast =\n    contexts.includes(ForecastSeriesEnum.ForecastTrend) ||\n    contexts.includes(ForecastSeriesEnum.ForecastLower) ||\n    contexts.includes(ForecastSeriesEnum.ForecastUpper);\n\n  const forecastSeries = extractForecastSeriesContext(name || '');\n  const isConfidenceBand =\n    forecastSeries.type === ForecastSeriesEnum.ForecastLower ||\n    forecastSeries.type === ForecastSeriesEnum.ForecastUpper;\n  const isFiltered =\n    filterState?.selectedValues && !filterState?.selectedValues.includes(name);\n  const opacity = isFiltered\n    ? OpacityEnum.SemiTransparent\n    : OpacityEnum.NonTransparent;\n\n  // don't create a series if doing a stack or area chart and the result\n  // is a confidence band\n  if ((stack || area) && isConfidenceBand) return undefined;\n\n  const isObservation = forecastSeries.type === ForecastSeriesEnum.Observation;\n  const isTrend = forecastSeries.type === ForecastSeriesEnum.ForecastTrend;\n  let stackId;\n  if (isConfidenceBand) {\n    stackId = forecastSeries.name;\n  } else if (stack && isObservation) {\n    // the suffix of the observation series is '' (falsy), which disables\n    // stacking. Therefore we need to set something that is truthy.\n    stackId = 'obs';\n  } else if (stack && isTrend) {\n    stackId = forecastSeries.type;\n  }\n  if (stackId && stackIdSuffix) {\n    stackId += stackIdSuffix;\n  }\n  let plotType;\n  if (\n    !isConfidenceBand &&\n    (seriesType === 'scatter' || (hasForecast && isObservation))\n  ) {\n    plotType = 'scatter';\n  } else if (isConfidenceBand) {\n    plotType = 'line';\n  } else {\n    plotType = seriesType === 'bar' ? 'bar' : 'line';\n  }\n  // forcing the colorScale to return a different color for same metrics across different queries\n  const itemStyle = {\n    color: colorScale(colorScaleKey, sliceId),\n    opacity,\n  };\n  let emphasis = {};\n  let showSymbol = false;\n  if (!isConfidenceBand) {\n    if (plotType === 'scatter') {\n      showSymbol = true;\n    } else if (hasForecast && isObservation) {\n      showSymbol = true;\n    } else if (plotType === 'line' && showValue) {\n      showSymbol = true;\n    } else if (plotType === 'line' && !richTooltip && !markerEnabled) {\n      // this is hack to make timeseries line chart clickable when tooltip trigger is 'item'\n      // so that the chart can emit cross-filtering\n      showSymbol = true;\n      itemStyle.opacity = 0;\n      emphasis = {\n        itemStyle: {\n          opacity: 1,\n        },\n      };\n    } else if (markerEnabled) {\n      showSymbol = true;\n    }\n  }\n  const lineStyle =\n    isConfidenceBand || (stack === StackControlsValue.Stream && area)\n      ? { ...opts.lineStyle, opacity: OpacityEnum.Transparent }\n      : { ...opts.lineStyle, opacity };\n  return {\n    ...series,\n    connectNulls,\n    queryIndex,\n    yAxisIndex,\n    name: forecastSeries.name,\n    itemStyle,\n    // @ts-ignore\n    type: plotType,\n    smooth: seriesType === 'smooth',\n    triggerLineEvent: true,\n    // @ts-ignore\n    step: ['start', 'middle', 'end'].includes(seriesType as string)\n      ? seriesType\n      : undefined,\n    stack: stackId,\n    stackStrategy:\n      isConfidenceBand || stack === StackControlsValue.Stream\n        ? 'all'\n        : 'samesign',\n    lineStyle,\n    areaStyle:\n      area || forecastSeries.type === ForecastSeriesEnum.ForecastUpper\n        ? {\n            opacity: opacity * areaOpacity,\n          }\n        : undefined,\n    emphasis: {\n      // bold on hover as required since 5.3.0 to retain backwards feature parity:\n      // https://apache.github.io/echarts-handbook/en/basics/release-note/5-3-0/#removing-the-default-bolding-emphasis-effect-in-the-line-chart\n      // TODO: should consider only adding emphasis to currently hovered series\n      lineStyle: {\n        width: 'bolder',\n      },\n      ...emphasis,\n    },\n    showSymbol,\n    symbolSize: markerSize,\n    label: {\n      show: !!showValue,\n      position: isHorizontal ? 'right' : 'top',\n      formatter: (params: any) => {\n        const { value, dataIndex, seriesIndex, seriesName } = params;\n        const numericValue = isHorizontal ? value[0] : value[1];\n        const isSelectedLegend = !legendState || legendState[seriesName];\n        const isAreaExpand = stack === StackControlsValue.Expand;\n        if (!formatter) {\n          return numericValue;\n        }\n        if (!stack && isSelectedLegend) {\n          return formatter(numericValue);\n        }\n        if (!onlyTotal) {\n          if (\n            numericValue >=\n            (thresholdValues[dataIndex] || Number.MIN_SAFE_INTEGER)\n          ) {\n            return formatter(numericValue);\n          }\n          return '';\n        }\n        if (seriesIndex === showValueIndexes[dataIndex]) {\n          return formatter(isAreaExpand ? 1 : totalStackedValues[dataIndex]);\n        }\n        return '';\n      },\n    },\n  };\n}\n\nexport function transformFormulaAnnotation(\n  layer: FormulaAnnotationLayer,\n  data: TimeseriesDataRecord[],\n  xAxisCol: string,\n  xAxisType: AxisType,\n  colorScale: CategoricalColorScale,\n  sliceId?: number,\n): SeriesOption {\n  const { name, color, opacity, width, style } = layer;\n  return {\n    name,\n    id: name,\n    itemStyle: {\n      color: color || colorScale(name, sliceId),\n    },\n    lineStyle: {\n      opacity: parseAnnotationOpacity(opacity),\n      type: style as ZRLineType,\n      width,\n    },\n    type: 'line',\n    smooth: true,\n    data: evalFormula(layer, data, xAxisCol, xAxisType),\n    symbolSize: 0,\n  };\n}\n\nexport function transformIntervalAnnotation(\n  layer: IntervalAnnotationLayer,\n  data: TimeseriesDataRecord[],\n  annotationData: AnnotationData,\n  colorScale: CategoricalColorScale,\n  theme: SupersetTheme,\n  sliceId?: number,\n): SeriesOption[] {\n  const series: SeriesOption[] = [];\n  const annotations = extractRecordAnnotations(layer, annotationData);\n  annotations.forEach(annotation => {\n    const { name, color, opacity, showLabel } = layer;\n    const { descriptions, intervalEnd, time, title } = annotation;\n    const label = formatAnnotationLabel(name, title, descriptions);\n    const intervalData: (\n      | MarkArea1DDataItemOption\n      | MarkArea2DDataItemOption\n    )[] = [\n      [\n        {\n          name: label,\n          xAxis: time,\n        },\n        {\n          xAxis: intervalEnd,\n        },\n      ],\n    ];\n    const intervalLabel: SeriesLabelOption = showLabel\n      ? {\n          show: true,\n          color: theme.colors.grayscale.dark2,\n          position: 'insideTop',\n          verticalAlign: 'top',\n          fontWeight: 'bold',\n          // @ts-ignore\n          emphasis: {\n            position: 'insideTop',\n            verticalAlign: 'top',\n            backgroundColor: theme.colors.grayscale.light5,\n          },\n        }\n      : {\n          show: false,\n          color: theme.colors.grayscale.dark2,\n          // @ts-ignore\n          emphasis: {\n            fontWeight: 'bold',\n            show: true,\n            position: 'insideTop',\n            verticalAlign: 'top',\n            backgroundColor: theme.colors.grayscale.light5,\n          },\n        };\n    series.push({\n      id: `Interval - ${label}`,\n      type: 'line',\n      animation: false,\n      markArea: {\n        silent: false,\n        itemStyle: {\n          color: color || colorScale(name, sliceId),\n          opacity: parseAnnotationOpacity(opacity || AnnotationOpacity.Medium),\n          emphasis: {\n            opacity: 0.8,\n          },\n        } as ItemStyleOption,\n        label: intervalLabel,\n        data: intervalData,\n      },\n    });\n  });\n  return series;\n}\n\nexport function transformEventAnnotation(\n  layer: EventAnnotationLayer,\n  data: TimeseriesDataRecord[],\n  annotationData: AnnotationData,\n  colorScale: CategoricalColorScale,\n  theme: SupersetTheme,\n  sliceId?: number,\n): SeriesOption[] {\n  const series: SeriesOption[] = [];\n  const annotations = extractRecordAnnotations(layer, annotationData);\n  annotations.forEach(annotation => {\n    const { name, color, opacity, style, width, showLabel } = layer;\n    const { descriptions, time, title } = annotation;\n    const label = formatAnnotationLabel(name, title, descriptions);\n    const eventData: MarkLine1DDataItemOption[] = [\n      {\n        name: label,\n        xAxis: time,\n      },\n    ];\n\n    const lineStyle: LineStyleOption & DefaultStatesMixin['emphasis'] = {\n      width,\n      type: style as ZRLineType,\n      color: color || colorScale(name, sliceId),\n      opacity: parseAnnotationOpacity(opacity),\n      emphasis: {\n        width: width ? width + 1 : width,\n        opacity: 1,\n      },\n    };\n\n    const eventLabel: SeriesLineLabelOption = showLabel\n      ? {\n          show: true,\n          color: theme.colors.grayscale.dark2,\n          position: 'insideEndTop',\n          fontWeight: 'bold',\n          formatter: (params: CallbackDataParams) => params.name,\n          // @ts-ignore\n          emphasis: {\n            backgroundColor: theme.colors.grayscale.light5,\n          },\n        }\n      : {\n          show: false,\n          color: theme.colors.grayscale.dark2,\n          position: 'insideEndTop',\n          // @ts-ignore\n          emphasis: {\n            formatter: (params: CallbackDataParams) => params.name,\n            fontWeight: 'bold',\n            show: true,\n            backgroundColor: theme.colors.grayscale.light5,\n          },\n        };\n\n    series.push({\n      id: `Event - ${label}`,\n      type: 'line',\n      animation: false,\n      markLine: {\n        silent: false,\n        symbol: 'none',\n        lineStyle,\n        label: eventLabel,\n        data: eventData,\n      },\n    });\n  });\n  return series;\n}\n\nexport function transformTimeseriesAnnotation(\n  layer: TimeseriesAnnotationLayer,\n  markerSize: number,\n  data: TimeseriesDataRecord[],\n  annotationData: AnnotationData,\n  colorScale: CategoricalColorScale,\n  sliceId?: number,\n): SeriesOption[] {\n  const series: SeriesOption[] = [];\n  const { hideLine, name, opacity, showMarkers, style, width, color } = layer;\n  const result = annotationData[name];\n  if (isTimeseriesAnnotationResult(result)) {\n    result.forEach(annotation => {\n      const { key, values } = annotation;\n      series.push({\n        type: 'line',\n        id: key,\n        name: key,\n        data: values.map(row => [row.x, row.y] as [OptionName, number]),\n        symbolSize: showMarkers ? markerSize : 0,\n        lineStyle: {\n          opacity: parseAnnotationOpacity(opacity),\n          type: style as ZRLineType,\n          width: hideLine ? 0 : width,\n          color: color || colorScale(name, sliceId),\n        },\n      });\n    });\n  }\n  return series;\n}\n\nexport function getPadding(\n  showLegend: boolean,\n  legendOrientation: LegendOrientation,\n  addYAxisTitleOffset: boolean,\n  zoomable: boolean,\n  margin?: string | number | null,\n  addXAxisTitleOffset?: boolean,\n  yAxisTitlePosition?: string,\n  yAxisTitleMargin?: number,\n  xAxisTitleMargin?: number,\n  isHorizontal?: boolean,\n): {\n  bottom: number;\n  left: number;\n  right: number;\n  top: number;\n} {\n  const yAxisOffset = addYAxisTitleOffset\n    ? TIMESERIES_CONSTANTS.yAxisLabelTopOffset\n    : 0;\n  const xAxisOffset = addXAxisTitleOffset ? Number(xAxisTitleMargin) || 0 : 0;\n\n  return getChartPadding(\n    showLegend,\n    legendOrientation,\n    margin,\n    {\n      top:\n        yAxisTitlePosition && yAxisTitlePosition === 'Top'\n          ? TIMESERIES_CONSTANTS.gridOffsetTop + (Number(yAxisTitleMargin) || 0)\n          : TIMESERIES_CONSTANTS.gridOffsetTop + yAxisOffset,\n      bottom:\n        zoomable && !isHorizontal\n          ? TIMESERIES_CONSTANTS.gridOffsetBottomZoomable + xAxisOffset\n          : TIMESERIES_CONSTANTS.gridOffsetBottom + xAxisOffset,\n      left:\n        yAxisTitlePosition === 'Left'\n          ? TIMESERIES_CONSTANTS.gridOffsetLeft +\n            (Number(yAxisTitleMargin) || 0)\n          : TIMESERIES_CONSTANTS.gridOffsetLeft,\n      right:\n        showLegend && legendOrientation === LegendOrientation.Right\n          ? 0\n          : TIMESERIES_CONSTANTS.gridOffsetRight,\n    },\n    isHorizontal,\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CategoricalColorNamespace,\n  getColumnLabel,\n  getMetricLabel,\n  getNumberFormatter,\n  getTimeFormatter,\n} from '@superset-ui/core';\nimport { EChartsCoreOption, BoxplotSeriesOption } from 'echarts';\nimport { CallbackDataParams } from 'echarts/types/src/util/types';\nimport {\n  BoxPlotChartTransformedProps,\n  BoxPlotQueryFormData,\n  EchartsBoxPlotChartProps,\n} from './types';\nimport {\n  extractGroupbyLabel,\n  getColtypesMapping,\n  sanitizeHtml,\n} from '../utils/series';\nimport { convertInteger } from '../utils/convertInteger';\nimport { defaultGrid, defaultYAxis } from '../defaults';\nimport { getPadding } from '../Timeseries/transformers';\nimport { OpacityEnum } from '../constants';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport { Refs } from '../types';\n\nexport default function transformProps(\n  chartProps: EchartsBoxPlotChartProps,\n): BoxPlotChartTransformedProps {\n  const {\n    width,\n    height,\n    formData,\n    hooks,\n    filterState,\n    queriesData,\n    inContextMenu,\n    emitCrossFilters,\n  } = chartProps;\n  const { data = [] } = queriesData[0];\n  const { setDataMask = () => {}, onContextMenu } = hooks;\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n  const {\n    colorScheme,\n    groupby = [],\n    metrics = [],\n    numberFormat,\n    dateFormat,\n    xTicksLayout,\n    legendOrientation = 'top',\n    xAxisTitle,\n    yAxisTitle,\n    xAxisTitleMargin,\n    yAxisTitleMargin,\n    yAxisTitlePosition,\n    sliceId,\n  } = formData as BoxPlotQueryFormData;\n  const refs: Refs = {};\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme as string);\n  const numberFormatter = getNumberFormatter(numberFormat);\n  const metricLabels = metrics.map(getMetricLabel);\n  const groupbyLabels = groupby.map(getColumnLabel);\n\n  const transformedData = data\n    .map((datum: any) => {\n      const groupbyLabel = extractGroupbyLabel({\n        datum,\n        groupby: groupbyLabels,\n        coltypeMapping,\n        timeFormatter: getTimeFormatter(dateFormat),\n      });\n      return metricLabels.map(metric => {\n        const name =\n          metricLabels.length === 1\n            ? groupbyLabel\n            : `${groupbyLabel}, ${metric}`;\n        const isFiltered =\n          filterState.selectedValues &&\n          !filterState.selectedValues.includes(name);\n        return {\n          name,\n          value: [\n            datum[`${metric}__min`],\n            datum[`${metric}__q1`],\n            datum[`${metric}__median`],\n            datum[`${metric}__q3`],\n            datum[`${metric}__max`],\n            datum[`${metric}__mean`],\n            datum[`${metric}__count`],\n            datum[`${metric}__outliers`],\n          ],\n          itemStyle: {\n            color: colorFn(groupbyLabel, sliceId),\n            opacity: isFiltered ? OpacityEnum.SemiTransparent : 0.6,\n            borderColor: colorFn(groupbyLabel, sliceId),\n          },\n        };\n      });\n    })\n    .flatMap(row => row);\n  const outlierData = data\n    .map(datum =>\n      metricLabels.map(metric => {\n        const groupbyLabel = extractGroupbyLabel({\n          datum,\n          groupby: groupbyLabels,\n          coltypeMapping,\n          timeFormatter: getTimeFormatter(dateFormat),\n        });\n        const name =\n          metricLabels.length === 1\n            ? groupbyLabel\n            : `${groupbyLabel}, ${metric}`;\n        // Outlier data is a nested array of numbers (uncommon, therefore no need to add to DataRecordValue)\n        const outlierDatum = (datum[`${metric}__outliers`] || []) as number[];\n        const isFiltered =\n          filterState.selectedValues &&\n          !filterState.selectedValues.includes(name);\n        return {\n          name: 'outlier',\n          type: 'scatter',\n          data: outlierDatum.map(val => [name, val]),\n          tooltip: {\n            ...getDefaultTooltip(refs),\n            formatter: (param: { data: [string, number] }) => {\n              const [outlierName, stats] = param.data;\n              const headline = groupbyLabels.length\n                ? `<p><strong>${sanitizeHtml(outlierName)}</strong></p>`\n                : '';\n              return `${headline}${numberFormatter(stats)}`;\n            },\n          },\n          itemStyle: {\n            color: colorFn(groupbyLabel, sliceId),\n            opacity: isFiltered\n              ? OpacityEnum.SemiTransparent\n              : OpacityEnum.NonTransparent,\n          },\n        };\n      }),\n    )\n    .flat(2);\n\n  const labelMap = data.reduce((acc: Record<string, string[]>, datum) => {\n    const label = extractGroupbyLabel({\n      datum,\n      groupby: groupbyLabels,\n      coltypeMapping,\n      timeFormatter: getTimeFormatter(dateFormat),\n    });\n    return {\n      ...acc,\n      [label]: groupbyLabels.map(col => datum[col] as string),\n    };\n  }, {});\n\n  const selectedValues = (filterState.selectedValues || []).reduce(\n    (acc: Record<string, number>, selectedValue: string) => {\n      const index = transformedData.findIndex(\n        ({ name }) => name === selectedValue,\n      );\n      return {\n        ...acc,\n        [index]: selectedValue,\n      };\n    },\n    {},\n  );\n\n  let axisLabel;\n  if (xTicksLayout === '45') axisLabel = { rotate: -45 };\n  else if (xTicksLayout === '90') axisLabel = { rotate: -90 };\n  else if (xTicksLayout === 'flat') axisLabel = { rotate: 0 };\n  else if (xTicksLayout === 'staggered') axisLabel = { rotate: -45 };\n  else axisLabel = { show: true };\n\n  const series: BoxplotSeriesOption[] = [\n    {\n      name: 'boxplot',\n      type: 'boxplot',\n      data: transformedData,\n      tooltip: {\n        ...getDefaultTooltip(refs),\n        formatter: (param: CallbackDataParams) => {\n          // @ts-ignore\n          const {\n            value,\n            name,\n          }: {\n            value: [\n              number,\n              number,\n              number,\n              number,\n              number,\n              number,\n              number,\n              number,\n              number[],\n            ];\n            name: string;\n          } = param;\n          const headline = name\n            ? `<p><strong>${sanitizeHtml(name)}</strong></p>`\n            : '';\n          const stats = [\n            `Max: ${numberFormatter(value[5])}`,\n            `3rd Quartile: ${numberFormatter(value[4])}`,\n            `Mean: ${numberFormatter(value[6])}`,\n            `Median: ${numberFormatter(value[3])}`,\n            `1st Quartile: ${numberFormatter(value[2])}`,\n            `Min: ${numberFormatter(value[1])}`,\n            `# Observations: ${numberFormatter(value[7])}`,\n          ];\n          if (value[8].length > 0) {\n            stats.push(`# Outliers: ${numberFormatter(value[8].length)}`);\n          }\n          return headline + stats.join('<br/>');\n        },\n      },\n    },\n    // @ts-ignore\n    ...outlierData,\n  ];\n  const addYAxisTitleOffset = !!yAxisTitle;\n  const addXAxisTitleOffset = !!xAxisTitle;\n  const chartPadding = getPadding(\n    true,\n    legendOrientation,\n    addYAxisTitleOffset,\n    false,\n    null,\n    addXAxisTitleOffset,\n    yAxisTitlePosition,\n    convertInteger(yAxisTitleMargin),\n    convertInteger(xAxisTitleMargin),\n  );\n  const echartOptions: EChartsCoreOption = {\n    grid: {\n      ...defaultGrid,\n      ...chartPadding,\n    },\n    xAxis: {\n      type: 'category',\n      data: transformedData.map(row => row.name),\n      axisLabel,\n      name: xAxisTitle,\n      nameGap: convertInteger(xAxisTitleMargin),\n      nameLocation: 'middle',\n    },\n    yAxis: {\n      ...defaultYAxis,\n      type: 'value',\n      axisLabel: { formatter: numberFormatter },\n      name: yAxisTitle,\n      nameGap: convertInteger(yAxisTitleMargin),\n      nameLocation: yAxisTitlePosition === 'Left' ? 'middle' : 'end',\n    },\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu,\n      trigger: 'item',\n      axisPointer: {\n        type: 'shadow',\n      },\n    },\n    series,\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    setDataMask,\n    emitCrossFilters,\n    labelMap,\n    groupby,\n    selectedValues,\n    onContextMenu,\n    refs,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { QueryFormData } from '@superset-ui/core';\nimport {\n  BaseChartProps,\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  CrossFilterTransformedProps,\n  LegendFormData,\n  LegendOrientation,\n  LegendType,\n} from '../types';\nimport { DEFAULT_LEGEND_FORM_DATA } from '../constants';\n\nexport type EchartsFunnelFormData = QueryFormData &\n  LegendFormData & {\n    colorScheme?: string;\n    groupby: QueryFormData[];\n    labelLine: boolean;\n    labelType: EchartsFunnelLabelTypeType;\n    tooltipLabelType: EchartsFunnelLabelTypeType;\n    metric?: string;\n    showLabels: boolean;\n    showTooltipLabels: boolean;\n    numberFormat: string;\n    gap: number;\n    sort: 'descending' | 'ascending' | 'none' | undefined;\n    orient: 'vertical' | 'horizontal' | undefined;\n    percentCalculationType: PercentCalcType;\n  };\n\nexport enum EchartsFunnelLabelTypeType {\n  Key,\n  Value,\n  Percent,\n  KeyValue,\n  KeyPercent,\n  KeyValuePercent,\n  ValuePercent,\n}\n\nexport interface EchartsFunnelChartProps\n  extends BaseChartProps<EchartsFunnelFormData> {\n  formData: EchartsFunnelFormData;\n}\n\n// @ts-ignore\nexport const DEFAULT_FORM_DATA: EchartsFunnelFormData = {\n  ...DEFAULT_LEGEND_FORM_DATA,\n  groupby: [],\n  labelLine: false,\n  labelType: EchartsFunnelLabelTypeType.Key,\n  defaultTooltipLabel: EchartsFunnelLabelTypeType.KeyValuePercent,\n  legendOrientation: LegendOrientation.Top,\n  legendType: LegendType.Scroll,\n  numberFormat: 'SMART_NUMBER',\n  showLabels: true,\n  sort: 'descending',\n  orient: 'vertical',\n  gap: 0,\n};\n\nexport type FunnelChartTransformedProps =\n  BaseTransformedProps<EchartsFunnelFormData> &\n    CrossFilterTransformedProps &\n    ContextMenuTransformedProps;\n\nexport enum PercentCalcType {\n  Total = 'total',\n  PreviousStep = 'prev_step',\n  FirstStep = 'first_step',\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport example from './images/BoxPlot.jpg';\nimport thumbnail from './images/thumbnail.png';\nimport { BoxPlotQueryFormData, EchartsBoxPlotChartProps } from './types';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsBoxPlotChartPlugin extends EchartsChartPlugin<\n  BoxPlotQueryFormData,\n  EchartsBoxPlotChartProps\n> {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsBoxPlot'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Distribution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Also known as a box and whisker plot, this visualization compares the distributions of a related metric across multiple groups. The box in the middle emphasizes the mean, median, and inner 2 quartiles. The whiskers around each box visualize the min, max, range, and outer 2 quartiles.',\n        ),\n        exampleGallery: [{ url: example }],\n        name: t('Box Plot'),\n        tags: [t('ECharts'), t('Range'), t('Statistical')],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const { metric, sort_by_metric } = formData;\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      ...(sort_by_metric && { orderby: [[metric, false]] }),\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DEFAULT_SORT_SERIES_DATA,\n  sections,\n} from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport { LegendOrientation, LegendType } from '../types';\nimport {\n  OrientationType,\n  EchartsTimeseriesSeriesType,\n  EchartsTimeseriesFormData,\n} from './types';\n// import {\n//   DEFAULT_LEGEND_FORM_DATA,\n//   DEFAULT_TITLE_FORM_DATA,\n// } from '../constants';\nimport { defaultXAxis } from '../defaults';\n\n// @ts-ignore\nexport const DEFAULT_FORM_DATA: EchartsTimeseriesFormData = {\n  // ...DEFAULT_LEGEND_FORM_DATA, // TODO: figure out why these break things for stories (e.g. Bubble Chart)\n  // Here are the contents of DEFAULT_LEGEND_FORM_DATA:\n  legendMargin: null,\n  legendOrientation: LegendOrientation.Top,\n  legendType: LegendType.Scroll,\n  showLegend: true,\n  // ...DEFAULT_TITLE_FORM_DATA, // TODO: figure out why these break things for stories (e.g. Bubble Chart)\n  // here are the contents of DEFAULT_TITLE_FORM_DATA:\n  xAxisTitle: '',\n  xAxisTitleMargin: 0,\n  yAxisTitle: '',\n  yAxisTitleMargin: 0,\n  yAxisTitlePosition: 'Top',\n  // Now that the weird bug workaround is over, here's the rest...\n  ...DEFAULT_SORT_SERIES_DATA,\n  annotationLayers: sections.annotationLayers,\n  area: false,\n  forecastEnabled: sections.FORECAST_DEFAULT_DATA.forecastEnabled,\n  forecastInterval: sections.FORECAST_DEFAULT_DATA.forecastInterval,\n  forecastPeriods: sections.FORECAST_DEFAULT_DATA.forecastPeriods,\n  forecastSeasonalityDaily:\n    sections.FORECAST_DEFAULT_DATA.forecastSeasonalityDaily,\n  forecastSeasonalityWeekly:\n    sections.FORECAST_DEFAULT_DATA.forecastSeasonalityWeekly,\n  forecastSeasonalityYearly:\n    sections.FORECAST_DEFAULT_DATA.forecastSeasonalityYearly,\n  logAxis: false,\n  markerEnabled: false,\n  markerSize: 6,\n  minorSplitLine: false,\n  opacity: 0.2,\n  orderDesc: true,\n  rowLimit: 10000,\n  seriesType: EchartsTimeseriesSeriesType.Line,\n  stack: false,\n  tooltipTimeFormat: 'smart_date',\n  truncateXAxis: true,\n  truncateYAxis: false,\n  yAxisBounds: [null, null],\n  zoomable: false,\n  richTooltip: true,\n  xAxisForceCategorical: false,\n  xAxisLabelRotation: defaultXAxis.xAxisLabelRotation,\n  groupby: [],\n  showValue: false,\n  onlyTotal: false,\n  percentageThreshold: 0,\n  orientation: OrientationType.Vertical,\n  sort_series_type: 'sum',\n  sort_series_ascending: false,\n};\n\nexport const TIME_SERIES_DESCRIPTION_TEXT: string = t(\n  'When using other than adaptive formatting, labels may overlap',\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelsContainerProps,\n  ControlSetItem,\n  ControlSetRow,\n  ControlSubSectionHeader,\n  DEFAULT_SORT_SERIES_DATA,\n  SORT_SERIES_CHOICES,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_LEGEND_FORM_DATA, StackControlOptions } from './constants';\nimport { DEFAULT_FORM_DATA } from './Timeseries/constants';\nimport { defaultXAxis } from './defaults';\n\nconst { legendMargin, legendOrientation, legendType, showLegend } =\n  DEFAULT_LEGEND_FORM_DATA;\n\nconst showLegendControl: ControlSetItem = {\n  name: 'show_legend',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Show legend'),\n    renderTrigger: true,\n    default: showLegend,\n    description: t('Whether to display a legend for the chart'),\n  },\n};\n\nconst legendMarginControl: ControlSetItem = {\n  name: 'legendMargin',\n  config: {\n    type: 'TextControl',\n    label: t('Margin'),\n    renderTrigger: true,\n    isInt: true,\n    default: legendMargin,\n    description: t('Additional padding for legend.'),\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      Boolean(controls?.show_legend?.value),\n  },\n};\n\nconst legendTypeControl: ControlSetItem = {\n  name: 'legendType',\n  config: {\n    type: 'SelectControl',\n    freeForm: false,\n    label: t('Type'),\n    choices: [\n      ['scroll', t('Scroll')],\n      ['plain', t('Plain')],\n    ],\n    default: legendType,\n    renderTrigger: true,\n    description: t('Legend type'),\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      Boolean(controls?.show_legend?.value),\n  },\n};\n\nconst legendOrientationControl: ControlSetItem = {\n  name: 'legendOrientation',\n  config: {\n    type: 'SelectControl',\n    freeForm: false,\n    label: t('Orientation'),\n    choices: [\n      ['top', t('Top')],\n      ['bottom', t('Bottom')],\n      ['left', t('Left')],\n      ['right', t('Right')],\n    ],\n    default: legendOrientation,\n    renderTrigger: true,\n    description: t('Legend Orientation'),\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      Boolean(controls?.show_legend?.value),\n  },\n};\n\nexport const legendSection: ControlSetRow[] = [\n  [<ControlSubSectionHeader>{t('Legend')}</ControlSubSectionHeader>],\n  [showLegendControl],\n  [legendTypeControl],\n  [legendOrientationControl],\n  [legendMarginControl],\n];\n\nexport const showValueControl: ControlSetItem = {\n  name: 'show_value',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Show Value'),\n    default: false,\n    renderTrigger: true,\n    description: t('Show series values on the chart'),\n  },\n};\n\nexport const stackControl: ControlSetItem = {\n  name: 'stack',\n  config: {\n    type: 'SelectControl',\n    label: t('Stacked Style'),\n    renderTrigger: true,\n    choices: StackControlOptions,\n    default: null,\n    description: t('Stack series on top of each other'),\n  },\n};\n\nexport const onlyTotalControl: ControlSetItem = {\n  name: 'only_total',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Only Total'),\n    default: true,\n    renderTrigger: true,\n    description: t(\n      'Only show the total value on the stacked chart, and not show on the selected category',\n    ),\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      Boolean(controls?.show_value?.value) && Boolean(controls?.stack?.value),\n  },\n};\n\nexport const percentageThresholdControl: ControlSetItem = {\n  name: 'percentage_threshold',\n  config: {\n    type: 'TextControl',\n    label: t('Percentage threshold'),\n    renderTrigger: true,\n    isFloat: true,\n    default: DEFAULT_FORM_DATA.percentageThreshold,\n    description: t(\n      'Minimum threshold in percentage points for showing labels.',\n    ),\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      Boolean(controls?.show_value?.value) &&\n      Boolean(controls?.stack?.value) &&\n      Boolean(!controls?.only_total?.value),\n  },\n};\n\nexport const showValueSection: ControlSetRow[] = [\n  [showValueControl],\n  [stackControl],\n  [onlyTotalControl],\n  [percentageThresholdControl],\n];\n\nexport const showValueSectionWithoutStack: ControlSetRow[] = [\n  [showValueControl],\n  [onlyTotalControl],\n];\n\nconst richTooltipControl: ControlSetItem = {\n  name: 'rich_tooltip',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Rich tooltip'),\n    renderTrigger: true,\n    default: true,\n    description: t(\n      'Shows a list of all series available at that point in time',\n    ),\n  },\n};\n\nconst tooltipTimeFormatControl: ControlSetItem = {\n  name: 'tooltipTimeFormat',\n  config: {\n    ...sharedControls.x_axis_time_format,\n    label: t('Tooltip time format'),\n    default: 'smart_date',\n    clearable: false,\n  },\n};\n\nconst tooltipSortByMetricControl: ControlSetItem = {\n  name: 'tooltipSortByMetric',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Tooltip sort by metric'),\n    renderTrigger: true,\n    default: false,\n    description: t(\n      'Whether to sort tooltip by the selected metric in descending order.',\n    ),\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      Boolean(controls?.rich_tooltip?.value),\n  },\n};\n\nexport const richTooltipSection: ControlSetRow[] = [\n  [<ControlSubSectionHeader>{t('Tooltip')}</ControlSubSectionHeader>],\n  [richTooltipControl],\n  [tooltipSortByMetricControl],\n  [tooltipTimeFormatControl],\n];\n\nconst sortSeriesType: ControlSetItem = {\n  name: 'sort_series_type',\n  config: {\n    type: 'SelectControl',\n    freeForm: false,\n    label: t('Sort Series By'),\n    choices: SORT_SERIES_CHOICES,\n    default: DEFAULT_SORT_SERIES_DATA.sort_series_type,\n    renderTrigger: true,\n    description: t(\n      'Based on what should series be ordered on the chart and legend',\n    ),\n  },\n};\n\nconst sortSeriesAscending: ControlSetItem = {\n  name: 'sort_series_ascending',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Sort Series Ascending'),\n    default: DEFAULT_SORT_SERIES_DATA.sort_series_ascending,\n    renderTrigger: true,\n    description: t('Sort series in ascending order'),\n  },\n};\n\nexport const xAxisLabelRotation = {\n  name: 'xAxisLabelRotation',\n  config: {\n    type: 'SelectControl',\n    freeForm: true,\n    clearable: false,\n    label: t('Rotate x axis label'),\n    choices: [\n      [0, '0'],\n      [45, '45'],\n      [90, '90'],\n    ],\n    default: defaultXAxis.xAxisLabelRotation,\n    renderTrigger: true,\n    description: t('Input field supports custom rotation. e.g. 30 for 30'),\n  },\n};\n\nexport const seriesOrderSection: ControlSetRow[] = [\n  [<ControlSubSectionHeader>{t('Series Order')}</ControlSubSectionHeader>],\n  [sortSeriesType],\n  [sortSeriesAscending],\n];\n\nexport const truncateXAxis: ControlSetItem = {\n  name: 'truncateXAxis',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Truncate X Axis'),\n    default: DEFAULT_FORM_DATA.truncateXAxis,\n    renderTrigger: true,\n    description: t(\n      'Truncate X Axis. Can be overridden by specifying a min or max bound. Only applicable for numercal X axis.',\n    ),\n  },\n};\n\nexport const xAxisBounds: ControlSetItem = {\n  name: 'xAxisBounds',\n  config: {\n    type: 'BoundsControl',\n    label: t('X Axis Bounds'),\n    renderTrigger: true,\n    default: DEFAULT_FORM_DATA.xAxisBounds,\n    description: t(\n      'Bounds for numerical X axis. Not applicable for temporal or categorical axes. ' +\n        'When left empty, the bounds are dynamically defined based on the min/max of the data. ' +\n        \"Note that this feature will only expand the axis range. It won't \" +\n        \"narrow the data's extent.\",\n    ),\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      Boolean(controls?.truncateXAxis?.value),\n  },\n};\n\nexport const minorTicks: ControlSetItem = {\n  name: 'minorTicks',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Minor ticks'),\n    default: false,\n    renderTrigger: true,\n    description: t('Show minor ticks on axes.'),\n  },\n};\n\nexport const forceCategorical: ControlSetItem = {\n  name: 'forceCategorical',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Force categorical'),\n    default: false,\n    renderTrigger: true,\n    description: t('Make the x-axis categorical'),\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlStateMapping,\n  ControlSubSectionHeader,\n  D3_FORMAT_DOCS,\n  D3_FORMAT_OPTIONS,\n  D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT,\n  getStandardizedControls,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport {\n  DEFAULT_FORM_DATA,\n  EchartsFunnelLabelTypeType,\n  PercentCalcType,\n} from './types';\nimport { legendSection } from '../controls';\n\nconst { labelType, numberFormat, showLabels, defaultTooltipLabel } =\n  DEFAULT_FORM_DATA;\n\nconst funnelLegendSection = [...legendSection];\nfunnelLegendSection.splice(2, 1);\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['groupby'],\n        ['metric'],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'row_limit',\n            config: {\n              ...sharedControls.row_limit,\n              default: 10,\n            },\n          },\n        ],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              default: true,\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'percent_calculation_type',\n            config: {\n              type: 'SelectControl',\n              label: t('% calculation'),\n              description: t(\n                'Display percents in the label and tooltip as the percent of the total value, from the first step of the funnel, or from the previous step in the funnel.',\n              ),\n              choices: [\n                [PercentCalcType.FirstStep, t('Calculate from first step')],\n                [\n                  PercentCalcType.PreviousStep,\n                  t('Calculate from previous step'),\n                ],\n                [PercentCalcType.Total, t('Percent of total')],\n              ],\n              default: PercentCalcType.FirstStep,\n              renderTrigger: true,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        ...funnelLegendSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Labels')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'label_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Label Contents'),\n              default: labelType,\n              renderTrigger: true,\n              choices: [\n                [EchartsFunnelLabelTypeType.Key, t('Category Name')],\n                [EchartsFunnelLabelTypeType.Value, t('Value')],\n                [EchartsFunnelLabelTypeType.Percent, t('Percentage')],\n                [EchartsFunnelLabelTypeType.KeyValue, t('Category and Value')],\n                [\n                  EchartsFunnelLabelTypeType.KeyPercent,\n                  t('Category and Percentage'),\n                ],\n                [\n                  EchartsFunnelLabelTypeType.KeyValuePercent,\n                  t('Category, Value and Percentage'),\n                ],\n                [\n                  EchartsFunnelLabelTypeType.ValuePercent,\n                  t('Value and Percentage'),\n                ],\n              ],\n              description: t('What should be shown as the label'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'tooltip_label_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Tooltip Contents'),\n              default: defaultTooltipLabel,\n              renderTrigger: true,\n              choices: [\n                [EchartsFunnelLabelTypeType.Key, t('Category Name')],\n                [EchartsFunnelLabelTypeType.Value, t('Value')],\n                [EchartsFunnelLabelTypeType.Percent, t('Percentage')],\n                [EchartsFunnelLabelTypeType.KeyValue, t('Category and Value')],\n                [\n                  EchartsFunnelLabelTypeType.KeyPercent,\n                  t('Category and Percentage'),\n                ],\n                [\n                  EchartsFunnelLabelTypeType.KeyValuePercent,\n                  t('Category, Value and Percentage'),\n                ],\n              ],\n              description: t('What should be shown as the tooltip label'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: numberFormat,\n              choices: D3_FORMAT_OPTIONS,\n              description: `${D3_FORMAT_DOCS} ${D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT}`,\n            },\n          },\n        ],\n        ['currency_format'],\n        [\n          {\n            name: 'show_labels',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Labels'),\n              renderTrigger: true,\n              default: showLabels,\n              description: t('Whether to display the labels.'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_tooltip_labels',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Tooltip Labels'),\n              renderTrigger: true,\n              default: showLabels,\n              description: t('Whether to display the tooltip labels.'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  onInit(state: ControlStateMapping) {\n    return {\n      ...state,\n      row_limit: {\n        ...state.row_limit,\n        value: state.row_limit.default,\n      },\n    };\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CategoricalColorNamespace,\n  DataRecord,\n  getColumnLabel,\n  getMetricLabel,\n  getNumberFormatter,\n  getValueFormatter,\n  NumberFormats,\n  ValueFormatter,\n} from '@superset-ui/core';\nimport { CallbackDataParams } from 'echarts/types/src/util/types';\nimport { EChartsCoreOption, FunnelSeriesOption } from 'echarts';\nimport {\n  DEFAULT_FORM_DATA as DEFAULT_FUNNEL_FORM_DATA,\n  EchartsFunnelChartProps,\n  EchartsFunnelFormData,\n  EchartsFunnelLabelTypeType,\n  FunnelChartTransformedProps,\n  PercentCalcType,\n} from './types';\nimport {\n  extractGroupbyLabel,\n  getChartPadding,\n  getColtypesMapping,\n  getLegendProps,\n  sanitizeHtml,\n} from '../utils/series';\nimport { defaultGrid } from '../defaults';\nimport { DEFAULT_LEGEND_FORM_DATA, OpacityEnum } from '../constants';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport { Refs } from '../types';\n\nconst percentFormatter = getNumberFormatter(NumberFormats.PERCENT_2_POINT);\n\nexport function formatFunnelLabel({\n  params,\n  labelType,\n  numberFormatter,\n  percentCalculationType = PercentCalcType.FirstStep,\n  sanitizeName = false,\n}: {\n  params: Pick<CallbackDataParams, 'name' | 'value' | 'percent' | 'data'>;\n  labelType: EchartsFunnelLabelTypeType;\n  numberFormatter: ValueFormatter;\n  percentCalculationType?: PercentCalcType;\n  sanitizeName?: boolean;\n}): string {\n  const { name: rawName = '', value, percent: totalPercent, data } = params;\n  const name = sanitizeName ? sanitizeHtml(rawName) : rawName;\n  const formattedValue = numberFormatter(value as number);\n  const { firstStepPercent, prevStepPercent } = data as {\n    firstStepPercent: number;\n    prevStepPercent: number;\n  };\n  let percent;\n\n  if (percentCalculationType === PercentCalcType.Total) {\n    percent = (totalPercent ?? 0) / 100;\n  } else if (percentCalculationType === PercentCalcType.PreviousStep) {\n    percent = prevStepPercent ?? 0;\n  } else {\n    percent = firstStepPercent ?? 0;\n  }\n  const formattedPercent = percentFormatter(percent);\n\n  switch (labelType) {\n    case EchartsFunnelLabelTypeType.Key:\n      return name;\n    case EchartsFunnelLabelTypeType.Value:\n      return formattedValue;\n    case EchartsFunnelLabelTypeType.Percent:\n      return formattedPercent;\n    case EchartsFunnelLabelTypeType.KeyValue:\n      return `${name}: ${formattedValue}`;\n    case EchartsFunnelLabelTypeType.KeyValuePercent:\n      return `${name}: ${formattedValue} (${formattedPercent})`;\n    case EchartsFunnelLabelTypeType.KeyPercent:\n      return `${name}: ${formattedPercent}`;\n    case EchartsFunnelLabelTypeType.ValuePercent:\n      return `${formattedValue} (${formattedPercent})`;\n    default:\n      return name;\n  }\n}\n\nexport default function transformProps(\n  chartProps: EchartsFunnelChartProps,\n): FunnelChartTransformedProps {\n  const {\n    formData,\n    height,\n    hooks,\n    filterState,\n    queriesData,\n    width,\n    theme,\n    emitCrossFilters,\n    datasource,\n  } = chartProps;\n  const data: DataRecord[] = queriesData[0].data || [];\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n  const {\n    colorScheme,\n    groupby,\n    orient,\n    sort,\n    gap,\n    labelLine,\n    labelType,\n    tooltipLabelType,\n    legendMargin,\n    legendOrientation,\n    legendType,\n    metric = '',\n    numberFormat,\n    currencyFormat,\n    showLabels,\n    inContextMenu,\n    showTooltipLabels,\n    showLegend,\n    sliceId,\n    percentCalculationType,\n  }: EchartsFunnelFormData = {\n    ...DEFAULT_LEGEND_FORM_DATA,\n    ...DEFAULT_FUNNEL_FORM_DATA,\n    ...formData,\n  };\n  const { currencyFormats = {}, columnFormats = {} } = datasource;\n  const refs: Refs = {};\n  const metricLabel = getMetricLabel(metric);\n  const groupbyLabels = groupby.map(getColumnLabel);\n  const keys = data.map(datum =>\n    extractGroupbyLabel({ datum, groupby: groupbyLabels, coltypeMapping: {} }),\n  );\n  const labelMap = data.reduce((acc: Record<string, string[]>, datum) => {\n    const label = extractGroupbyLabel({\n      datum,\n      groupby: groupbyLabels,\n      coltypeMapping: {},\n    });\n    return {\n      ...acc,\n      [label]: groupbyLabels.map(col => datum[col] as string),\n    };\n  }, {});\n\n  const { setDataMask = () => {}, onContextMenu } = hooks;\n\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme as string);\n  const numberFormatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    numberFormat,\n    currencyFormat,\n  );\n\n  const transformedData: {\n    value: number;\n    name: string;\n    itemStyle: { color: string; opacity: OpacityEnum };\n  }[] = data.map((datum, index) => {\n    const name = extractGroupbyLabel({\n      datum,\n      groupby: groupbyLabels,\n      coltypeMapping: {},\n    });\n    const value = datum[metricLabel] as number;\n    const isFiltered =\n      filterState.selectedValues && !filterState.selectedValues.includes(name);\n    const firstStepPercent = value / (data[0][metricLabel] as number);\n    const prevStepPercent =\n      index === 0 ? 1 : value / (data[index - 1][metricLabel] as number);\n    return {\n      value,\n      name,\n      itemStyle: {\n        color: colorFn(name, sliceId),\n        opacity: isFiltered\n          ? OpacityEnum.SemiTransparent\n          : OpacityEnum.NonTransparent,\n      },\n      firstStepPercent,\n      prevStepPercent,\n    };\n  });\n\n  const selectedValues = (filterState.selectedValues || []).reduce(\n    (acc: Record<string, number>, selectedValue: string) => {\n      const index = transformedData.findIndex(\n        ({ name }) => name === selectedValue,\n      );\n      return {\n        ...acc,\n        [index]: selectedValue,\n      };\n    },\n    {},\n  );\n\n  const formatter = (params: CallbackDataParams) =>\n    formatFunnelLabel({\n      params,\n      numberFormatter,\n      labelType,\n      percentCalculationType,\n    });\n\n  const defaultLabel = {\n    formatter,\n    show: showLabels,\n    color: theme.colors.grayscale.dark2,\n  };\n\n  const series: FunnelSeriesOption[] = [\n    {\n      type: 'funnel',\n      ...getChartPadding(showLegend, legendOrientation, legendMargin),\n      animation: true,\n      minSize: '0%',\n      maxSize: '100%',\n      sort,\n      orient,\n      gap,\n      funnelAlign: 'center',\n      labelLine: { show: !!labelLine },\n      label: {\n        ...defaultLabel,\n        position: labelLine ? 'outer' : 'inner',\n        textBorderColor: 'transparent',\n      },\n      emphasis: {\n        label: {\n          show: true,\n          fontWeight: 'bold',\n        },\n      },\n      // @ts-ignore\n      data: transformedData,\n    },\n  ];\n\n  const echartOptions: EChartsCoreOption = {\n    grid: {\n      ...defaultGrid,\n    },\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu && showTooltipLabels,\n      trigger: 'item',\n      formatter: (params: any) =>\n        formatFunnelLabel({\n          params,\n          numberFormatter,\n          labelType: tooltipLabelType,\n          percentCalculationType,\n        }),\n    },\n    legend: {\n      ...getLegendProps(legendType, legendOrientation, showLegend, theme),\n      data: keys,\n    },\n    series,\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    setDataMask,\n    emitCrossFilters,\n    labelMap,\n    groupby,\n    selectedValues,\n    onContextMenu,\n    refs,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.jpg';\nimport { EchartsFunnelChartProps, EchartsFunnelFormData } from './types';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsFunnelChartPlugin extends EchartsChartPlugin<\n  EchartsFunnelFormData,\n  EchartsFunnelChartProps\n> {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsFunnel'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('KPI'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Showcases how a metric changes as the funnel progresses. This classic chart is useful for visualizing drop-off between stages in a pipeline or lifecycle.',\n        ),\n        exampleGallery: [{ url: example }],\n        name: t('Funnel Chart'),\n        tags: [\n          t('Business'),\n          t('ECharts'),\n          t('Progressive'),\n          t('Report'),\n          t('Sequential'),\n          t('Trend'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const { metric, sort_by_metric } = formData;\n\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      ...(sort_by_metric && { orderby: [[metric, false]] }),\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ChartDataResponseResult,\n  ChartProps,\n  QueryFormColumn,\n  QueryFormData,\n  QueryFormMetric,\n} from '@superset-ui/core';\nimport { CallbackDataParams } from 'echarts/types/src/util/types';\nimport {\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  CrossFilterTransformedProps,\n  LabelPositionEnum,\n  TreePathInfo,\n} from '../types';\n\nexport type EchartsTreemapFormData = QueryFormData & {\n  colorScheme?: string;\n  groupby: QueryFormColumn[];\n  metric?: QueryFormMetric;\n  labelType: EchartsTreemapLabelType;\n  labelPosition: LabelPositionEnum;\n  showLabels: boolean;\n  showUpperLabels: boolean;\n  numberFormat: string;\n  dateFormat: string;\n  dashboardId?: number;\n};\n\nexport enum EchartsTreemapLabelType {\n  Key = 'key',\n  Value = 'value',\n  KeyValue = 'key_value',\n}\n\nexport interface EchartsTreemapChartProps\n  extends ChartProps<EchartsTreemapFormData> {\n  formData: EchartsTreemapFormData;\n  queriesData: ChartDataResponseResult[];\n}\n\nexport const DEFAULT_FORM_DATA: Partial<EchartsTreemapFormData> = {\n  groupby: [],\n  labelType: EchartsTreemapLabelType.KeyValue,\n  labelPosition: LabelPositionEnum.InsideTopLeft,\n  numberFormat: 'SMART_NUMBER',\n  showLabels: true,\n  showUpperLabels: true,\n  dateFormat: 'smart_date',\n};\nexport interface TreemapSeriesCallbackDataParams extends CallbackDataParams {\n  treePathInfo?: TreePathInfo[];\n}\n\nexport type TreemapTransformedProps =\n  BaseTransformedProps<EchartsTreemapFormData> &\n    ContextMenuTransformedProps &\n    CrossFilterTransformedProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  D3_FORMAT_DOCS,\n  D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT,\n  D3_FORMAT_OPTIONS,\n  D3_TIME_FORMAT_OPTIONS,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './types';\n\nconst { labelType, numberFormat, showLabels, showUpperLabels, dateFormat } =\n  DEFAULT_FORM_DATA;\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['groupby'],\n        ['metric'],\n        ['row_limit'],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        [<ControlSubSectionHeader>{t('Labels')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'show_labels',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Labels'),\n              renderTrigger: true,\n              default: showLabels,\n              description: t('Whether to display the labels.'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_upper_labels',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Upper Labels'),\n              renderTrigger: true,\n              default: showUpperLabels,\n              description: t('Show labels when the node has children.'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'label_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Label Type'),\n              default: labelType,\n              renderTrigger: true,\n              choices: [\n                ['Key', t('Key')],\n                ['value', t('Value')],\n                ['key_value', t('Category and Value')],\n              ],\n              description: t('What should be shown on the label?'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: numberFormat,\n              choices: D3_FORMAT_OPTIONS,\n              description: `${D3_FORMAT_DOCS} ${D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT}`,\n            },\n          },\n        ],\n        ['currency_format'],\n        [\n          {\n            name: 'date_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date format'),\n              renderTrigger: true,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              default: dateFormat,\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { DataRecord, DataRecordValue } from '@superset-ui/core';\nimport { groupBy as _groupBy, isNumber, transform } from 'lodash';\n\nexport type TreeNode = {\n  name: DataRecordValue;\n  value: number;\n  secondaryValue: number;\n  groupBy: string;\n  children?: TreeNode[];\n};\n\nfunction getMetricValue(datum: DataRecord, metric: string) {\n  return isNumber(datum[metric]) ? (datum[metric] as number) : 0;\n}\n\nexport function treeBuilder(\n  data: DataRecord[],\n  groupBy: string[],\n  metric: string,\n  secondaryMetric?: string,\n): TreeNode[] {\n  const [curGroupBy, ...restGroupby] = groupBy;\n  const curData = _groupBy(data, curGroupBy);\n  return transform(\n    curData,\n    (result, value, key) => {\n      const name = curData[key][0][curGroupBy]!;\n      if (!restGroupby.length) {\n        (value ?? []).forEach(datum => {\n          const metricValue = getMetricValue(datum, metric);\n          const secondaryValue = secondaryMetric\n            ? getMetricValue(datum, secondaryMetric)\n            : metricValue;\n          const item = {\n            name,\n            value: metricValue,\n            secondaryValue,\n            groupBy: curGroupBy,\n          };\n          result.push(item);\n        });\n      } else {\n        const children = treeBuilder(\n          value,\n          restGroupby,\n          metric,\n          secondaryMetric,\n        );\n        const metricValue = children.reduce(\n          (prev, cur) => prev + (cur.value as number),\n          0,\n        );\n        const secondaryValue = secondaryMetric\n          ? children.reduce(\n              (prev, cur) => prev + (cur.secondaryValue as number),\n              0,\n            )\n          : metricValue;\n        result.push({\n          name,\n          children,\n          value: metricValue,\n          secondaryValue,\n          groupBy: curGroupBy,\n        });\n      }\n    },\n    [] as TreeNode[],\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CategoricalColorNamespace,\n  getColumnLabel,\n  getMetricLabel,\n  getNumberFormatter,\n  getTimeFormatter,\n  NumberFormats,\n  ValueFormatter,\n  getValueFormatter,\n} from '@superset-ui/core';\nimport { TreemapSeriesNodeItemOption } from 'echarts/types/src/chart/treemap/TreemapSeries';\nimport { EChartsCoreOption, TreemapSeriesOption } from 'echarts';\nimport {\n  DEFAULT_FORM_DATA as DEFAULT_TREEMAP_FORM_DATA,\n  EchartsTreemapChartProps,\n  EchartsTreemapFormData,\n  EchartsTreemapLabelType,\n  TreemapSeriesCallbackDataParams,\n  TreemapTransformedProps,\n} from './types';\nimport { formatSeriesName, getColtypesMapping } from '../utils/series';\nimport {\n  COLOR_SATURATION,\n  BORDER_WIDTH,\n  GAP_WIDTH,\n  LABEL_FONTSIZE,\n  extractTreePathInfo,\n  BORDER_COLOR,\n} from './constants';\nimport { OpacityEnum } from '../constants';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport { Refs } from '../types';\nimport { treeBuilder, TreeNode } from '../utils/treeBuilder';\n\nexport function formatLabel({\n  params,\n  labelType,\n  numberFormatter,\n}: {\n  params: TreemapSeriesCallbackDataParams;\n  labelType: EchartsTreemapLabelType;\n  numberFormatter: ValueFormatter;\n}): string {\n  const { name = '', value } = params;\n  const formattedValue = numberFormatter(value as number);\n\n  switch (labelType) {\n    case EchartsTreemapLabelType.Key:\n      return name;\n    case EchartsTreemapLabelType.Value:\n      return formattedValue;\n    case EchartsTreemapLabelType.KeyValue:\n      return `${name}: ${formattedValue}`;\n    default:\n      return name;\n  }\n}\n\nexport function formatTooltip({\n  params,\n  numberFormatter,\n}: {\n  params: TreemapSeriesCallbackDataParams;\n  numberFormatter: ValueFormatter;\n}): string {\n  const { value, treePathInfo = [] } = params;\n  const formattedValue = numberFormatter(value as number);\n  const { metricLabel, treePath } = extractTreePathInfo(treePathInfo);\n  const percentFormatter = getNumberFormatter(NumberFormats.PERCENT_2_POINT);\n\n  let formattedPercent = '';\n  // the last item is current node, here we should find the parent node\n  const currentNode = treePathInfo[treePathInfo.length - 1];\n  const parentNode = treePathInfo[treePathInfo.length - 2];\n  if (parentNode) {\n    const percent: number = parentNode.value\n      ? (currentNode.value as number) / (parentNode.value as number)\n      : 0;\n    formattedPercent = percentFormatter(percent);\n  }\n\n  // groupby1/groupby2/...\n  // metric: value (percent of parent)\n  return [\n    `<div>${treePath.join('  ')}</div>`,\n    `${metricLabel}: ${formattedValue}`,\n    formattedPercent ? ` (${formattedPercent})` : '',\n  ].join('');\n}\n\nexport default function transformProps(\n  chartProps: EchartsTreemapChartProps,\n): TreemapTransformedProps {\n  const {\n    formData,\n    height,\n    queriesData,\n    width,\n    hooks,\n    filterState,\n    theme,\n    inContextMenu,\n    emitCrossFilters,\n    datasource,\n  } = chartProps;\n  const { data = [] } = queriesData[0];\n  const { columnFormats = {}, currencyFormats = {} } = datasource;\n  const { setDataMask = () => {}, onContextMenu } = hooks;\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n\n  const {\n    colorScheme,\n    groupby = [],\n    metric = '',\n    labelType,\n    labelPosition,\n    numberFormat,\n    currencyFormat,\n    dateFormat,\n    showLabels,\n    showUpperLabels,\n    dashboardId,\n    sliceId,\n  }: EchartsTreemapFormData = {\n    ...DEFAULT_TREEMAP_FORM_DATA,\n    ...formData,\n  };\n  const refs: Refs = {};\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme as string);\n  const numberFormatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    numberFormat,\n    currencyFormat,\n  );\n\n  const formatter = (params: TreemapSeriesCallbackDataParams) =>\n    formatLabel({\n      params,\n      numberFormatter,\n      labelType,\n    });\n\n  const columnsLabelMap = new Map<string, string[]>();\n  const metricLabel = getMetricLabel(metric);\n  const groupbyLabels = groupby.map(getColumnLabel);\n  const treeData = treeBuilder(data, groupbyLabels, metricLabel);\n  const traverse = (treeNodes: TreeNode[], path: string[]) =>\n    treeNodes.map(treeNode => {\n      const { name: nodeName, value, groupBy } = treeNode;\n      const name = formatSeriesName(nodeName, {\n        timeFormatter: getTimeFormatter(dateFormat),\n        ...(coltypeMapping[groupBy] && {\n          coltype: coltypeMapping[groupBy],\n        }),\n      });\n      const newPath = path.concat(name);\n      let item: TreemapSeriesNodeItemOption = {\n        name,\n        value,\n      };\n      if (treeNode.children?.length) {\n        item = {\n          ...item,\n          children: traverse(treeNode.children, newPath),\n          colorSaturation: COLOR_SATURATION,\n          itemStyle: {\n            borderColor: BORDER_COLOR,\n            color: colorFn(name, sliceId),\n            borderWidth: BORDER_WIDTH,\n            gapWidth: GAP_WIDTH,\n          },\n        };\n      } else {\n        const joinedName = newPath.join(',');\n        // map(joined_name: [columnLabel_1, columnLabel_2, ...])\n        columnsLabelMap.set(joinedName, newPath);\n        if (\n          filterState.selectedValues &&\n          !filterState.selectedValues.includes(joinedName)\n        ) {\n          item = {\n            ...item,\n            itemStyle: {\n              colorAlpha: OpacityEnum.SemiTransparent,\n            },\n            label: {\n              color: `rgba(0, 0, 0, ${OpacityEnum.SemiTransparent})`,\n            },\n          };\n        }\n      }\n      return item;\n    });\n\n  const transformedData: TreemapSeriesNodeItemOption[] = [\n    {\n      name: metricLabel,\n      colorSaturation: COLOR_SATURATION,\n      itemStyle: {\n        borderColor: BORDER_COLOR,\n        color: colorFn(`${metricLabel}`, sliceId),\n        borderWidth: BORDER_WIDTH,\n        gapWidth: GAP_WIDTH,\n      },\n      upperLabel: {\n        show: false,\n      },\n      children: traverse(treeData, []),\n    },\n  ];\n\n  // set a default color when metric values are 0 over all.\n  const levels = [\n    {\n      upperLabel: {\n        show: false,\n      },\n      label: {\n        show: false,\n      },\n      itemStyle: {\n        color: theme.colors.primary.base,\n      },\n    },\n  ];\n\n  const series: TreemapSeriesOption[] = [\n    {\n      type: 'treemap',\n      width: '100%',\n      height: '100%',\n      nodeClick: undefined,\n      roam: !dashboardId,\n      breadcrumb: {\n        show: false,\n        emptyItemWidth: 25,\n      },\n      emphasis: {\n        label: {\n          show: true,\n        },\n      },\n      levels,\n      label: {\n        show: showLabels,\n        position: labelPosition,\n        formatter,\n        color: theme.colors.grayscale.dark2,\n        fontSize: LABEL_FONTSIZE,\n      },\n      upperLabel: {\n        show: showUpperLabels,\n        formatter,\n        textBorderColor: 'transparent',\n        fontSize: LABEL_FONTSIZE,\n      },\n      data: transformedData,\n    },\n  ];\n\n  const echartOptions: EChartsCoreOption = {\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu,\n      trigger: 'item',\n      formatter: (params: any) =>\n        formatTooltip({\n          params,\n          numberFormatter,\n        }),\n    },\n    series,\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    setDataMask,\n    emitCrossFilters,\n    labelMap: Object.fromEntries(columnsLabelMap),\n    groupby,\n    selectedValues: filterState.selectedValues || [],\n    onContextMenu,\n    refs,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding\n * g copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/treemap_v2_1.png';\nimport example2 from './images/treemap_v2_2.jpg';\nimport { EchartsTreemapChartProps, EchartsTreemapFormData } from './types';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsTreemapChartPlugin extends EchartsChartPlugin<\n  EchartsTreemapFormData,\n  EchartsTreemapChartProps\n> {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsTreemap'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Part of a Whole'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Show hierarchical relationships of data, with the value represented by area, showing proportion and contribution to the whole.',\n        ),\n        exampleGallery: [{ url: example1 }, { url: example2 }],\n        name: t('Treemap'),\n        tags: [\n          t('Aesthetic'),\n          t('Categorical'),\n          t('Comparison'),\n          t('ECharts'),\n          t('Multi-Levels'),\n          t('Percentages'),\n          t('Proportional'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { QueryFormColumn, QueryFormData } from '@superset-ui/core';\nimport {\n  BaseChartProps,\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  CrossFilterTransformedProps,\n} from '../types';\nimport { DEFAULT_LEGEND_FORM_DATA } from '../constants';\n\nexport type AxisTickLineStyle = {\n  width: number;\n  color: string;\n};\n\nexport type EchartsGaugeFormData = QueryFormData & {\n  colorScheme?: string;\n  groupby: QueryFormColumn[];\n  metric?: string;\n  rowLimit: number;\n  minVal: number | null;\n  maxVal: number | null;\n  fontSize: number;\n  numberFormat: string;\n  animation: boolean;\n  showProgress: boolean;\n  overlap: boolean;\n  roundCap: boolean;\n  showAxisTick: boolean;\n  showSplitLine: boolean;\n  splitNumber: number;\n  startAngle: number;\n  endAngle: number;\n  showPointer: boolean;\n  intervals: string;\n  intervalColorIndices: string;\n  valueFormatter: string;\n};\n\nexport const DEFAULT_FORM_DATA: Partial<EchartsGaugeFormData> = {\n  ...DEFAULT_LEGEND_FORM_DATA,\n  groupby: [],\n  rowLimit: 10,\n  minVal: null,\n  maxVal: null,\n  fontSize: 15,\n  numberFormat: 'SMART_NUMBER',\n  animation: true,\n  showProgress: true,\n  overlap: true,\n  roundCap: false,\n  showAxisTick: false,\n  showSplitLine: false,\n  splitNumber: 10,\n  startAngle: 225,\n  endAngle: -45,\n  showPointer: true,\n  intervals: '',\n  intervalColorIndices: '',\n  valueFormatter: '{value}',\n};\n\nexport interface EchartsGaugeChartProps\n  extends BaseChartProps<EchartsGaugeFormData> {\n  formData: EchartsGaugeFormData;\n}\n\nexport type GaugeChartTransformedProps =\n  BaseTransformedProps<EchartsGaugeFormData> &\n    ContextMenuTransformedProps &\n    CrossFilterTransformedProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  sharedControls,\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  D3_FORMAT_OPTIONS,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './types';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'groupby',\n            config: {\n              ...sharedControls.groupby,\n              description: t('Columns to group by'),\n            },\n          },\n        ],\n        ['metric'],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'row_limit',\n            config: {\n              ...sharedControls.row_limit,\n              choices: [...Array(10).keys()].map(n => n + 1),\n              default: DEFAULT_FORM_DATA.rowLimit,\n            },\n          },\n        ],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        [<ControlSubSectionHeader>{t('General')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'min_val',\n            config: {\n              type: 'TextControl',\n              isInt: true,\n              default: DEFAULT_FORM_DATA.minVal,\n              renderTrigger: true,\n              label: t('Min'),\n              description: t('Minimum value on the gauge axis'),\n            },\n          },\n          {\n            name: 'max_val',\n            config: {\n              type: 'TextControl',\n              isInt: true,\n              default: DEFAULT_FORM_DATA.maxVal,\n              renderTrigger: true,\n              label: t('Max'),\n              description: t('Maximum value on the gauge axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'start_angle',\n            config: {\n              type: 'TextControl',\n              label: t('Start angle'),\n              description: t('Angle at which to start progress axis'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.startAngle,\n            },\n          },\n          {\n            name: 'end_angle',\n            config: {\n              type: 'TextControl',\n              label: t('End angle'),\n              description: t('Angle at which to end progress axis'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.endAngle,\n            },\n          },\n        ],\n        ['color_scheme'],\n        [\n          {\n            name: 'font_size',\n            config: {\n              type: 'SliderControl',\n              label: t('Font size'),\n              description: t(\n                'Font size for axis labels, detail value and other text elements',\n              ),\n              renderTrigger: true,\n              min: 10,\n              max: 20,\n              default: DEFAULT_FORM_DATA.fontSize,\n            },\n          },\n        ],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              label: t('Number format'),\n              description: t(\n                'D3 format syntax: https://github.com/d3/d3-format',\n              ),\n              freeForm: true,\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.numberFormat,\n              choices: D3_FORMAT_OPTIONS,\n            },\n          },\n        ],\n        ['currency_format'],\n        [\n          {\n            name: 'value_formatter',\n            config: {\n              type: 'TextControl',\n              label: t('Value format'),\n              description: t(\n                'Additional text to add before or after the value, e.g. unit',\n              ),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.valueFormatter,\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_pointer',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show pointer'),\n              description: t('Whether to show the pointer'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.showPointer,\n            },\n          },\n        ],\n        [\n          {\n            name: 'animation',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Animation'),\n              description: t(\n                'Whether to animate the progress and the value or just display them',\n              ),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.animation,\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'show_axis_tick',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show axis line ticks'),\n              description: t('Whether to show minor ticks on the axis'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.showAxisTick,\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_split_line',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show split lines'),\n              description: t('Whether to show the split lines on the axis'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.showSplitLine,\n            },\n          },\n        ],\n        [\n          {\n            name: 'split_number',\n            config: {\n              type: 'SliderControl',\n              label: t('Split number'),\n              description: t('Number of split segments on the axis'),\n              renderTrigger: true,\n              min: 3,\n              max: 30,\n              default: DEFAULT_FORM_DATA.splitNumber,\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('Progress')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'show_progress',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show progress'),\n              description: t('Whether to show the progress of gauge chart'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.showProgress,\n            },\n          },\n        ],\n        [\n          {\n            name: 'overlap',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Overlap'),\n              description: t(\n                'Whether the progress bar overlaps when there are multiple groups of data',\n              ),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.overlap,\n            },\n          },\n        ],\n        [\n          {\n            name: 'round_cap',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Round cap'),\n              description: t(\n                'Style the ends of the progress bar with a round cap',\n              ),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.roundCap,\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('Intervals')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'intervals',\n            config: {\n              type: 'TextControl',\n              label: t('Interval bounds'),\n              description: t(\n                'Comma-separated interval bounds, e.g. 2,4,5 for intervals 0-2, 2-4 and 4-5. Last number should match the value provided for MAX.',\n              ),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.intervals,\n            },\n          },\n        ],\n        [\n          {\n            name: 'interval_color_indices',\n            config: {\n              type: 'TextControl',\n              label: t('Interval colors'),\n              description: t(\n                'Comma-separated color picks for the intervals, e.g. 1,2,4. Integers denote colors from the chosen color scheme and are 1-indexed. Length must be matching that of interval bounds.',\n              ),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.intervalColorIndices,\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { validateNumber } from '@superset-ui/core';\n\nexport function parseAxisBound(\n  bound?: string | number | null,\n): number | undefined {\n  if (bound === undefined || bound === null || Number.isNaN(Number(bound))) {\n    return undefined;\n  }\n  return Number(bound);\n}\n\nexport function parseNumbersList(value: string, delim = ';') {\n  if (!value?.trim()) return [];\n  return value.split(delim).map(num => {\n    if (validateNumber(num)) throw new Error('All values must be numeric');\n    return Number(num);\n  });\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { SupersetTheme } from '@superset-ui/core';\nimport { GaugeSeriesOption } from 'echarts';\n\nexport const defaultGaugeSeriesOption = (\n  theme: SupersetTheme,\n): GaugeSeriesOption => ({\n  splitLine: {\n    lineStyle: {\n      color: theme.colors.primary.base,\n    },\n  },\n  axisLine: {\n    lineStyle: {\n      color: [[1, theme.colors.primary.light4]],\n    },\n  },\n  axisLabel: {\n    color: theme.colors.grayscale.dark1,\n  },\n  axisTick: {\n    lineStyle: {\n      width: 2,\n      color: theme.colors.primary.base,\n    },\n  },\n  detail: {\n    color: 'auto',\n  },\n});\n\nexport const INTERVAL_GAUGE_SERIES_OPTION: GaugeSeriesOption = {\n  splitLine: {\n    lineStyle: {\n      color: 'auto',\n    },\n  },\n  axisTick: {\n    lineStyle: {\n      color: 'auto',\n    },\n  },\n  axisLabel: {\n    color: 'auto',\n  },\n  pointer: {\n    itemStyle: {\n      color: 'auto',\n    },\n  },\n};\n\nexport const OFFSETS = {\n  ticksFromLine: 10,\n  titleFromCenter: 20,\n};\n\nexport const FONT_SIZE_MULTIPLIERS = {\n  axisTickLength: 0.25,\n  axisLabelDistance: 1.5,\n  axisLabelLength: 0.35,\n  splitLineLength: 1,\n  splitLineWidth: 0.25,\n  titleOffsetFromTitle: 2,\n  detailOffsetFromTitle: 0.9,\n  detailFontSize: 1.2,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  QueryFormMetric,\n  CategoricalColorNamespace,\n  CategoricalColorScale,\n  DataRecord,\n  getMetricLabel,\n  getColumnLabel,\n  getValueFormatter,\n} from '@superset-ui/core';\nimport { EChartsCoreOption, GaugeSeriesOption } from 'echarts';\nimport { GaugeDataItemOption } from 'echarts/types/src/chart/gauge/GaugeSeries';\nimport { CallbackDataParams } from 'echarts/types/src/util/types';\nimport { range } from 'lodash';\nimport { parseNumbersList } from '../utils/controls';\nimport {\n  DEFAULT_FORM_DATA as DEFAULT_GAUGE_FORM_DATA,\n  EchartsGaugeFormData,\n  AxisTickLineStyle,\n  GaugeChartTransformedProps,\n  EchartsGaugeChartProps,\n} from './types';\nimport {\n  defaultGaugeSeriesOption,\n  INTERVAL_GAUGE_SERIES_OPTION,\n  OFFSETS,\n  FONT_SIZE_MULTIPLIERS,\n} from './constants';\nimport { OpacityEnum } from '../constants';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport { Refs } from '../types';\nimport { getColtypesMapping } from '../utils/series';\n\nexport const getIntervalBoundsAndColors = (\n  intervals: string,\n  intervalColorIndices: string,\n  colorFn: CategoricalColorScale,\n  min: number,\n  max: number,\n): Array<[number, string]> => {\n  let intervalBoundsNonNormalized;\n  let intervalColorIndicesArray;\n  try {\n    intervalBoundsNonNormalized = parseNumbersList(intervals, ',');\n    intervalColorIndicesArray = parseNumbersList(intervalColorIndices, ',');\n  } catch (error) {\n    intervalBoundsNonNormalized = [] as number[];\n    intervalColorIndicesArray = [] as number[];\n  }\n\n  const intervalBounds = intervalBoundsNonNormalized.map(\n    bound => (bound - min) / (max - min),\n  );\n  const intervalColors = intervalColorIndicesArray.map(\n    ind => colorFn.colors[(ind - 1) % colorFn.colors.length],\n  );\n\n  return intervalBounds.map((val, idx) => {\n    const color = intervalColors[idx];\n    return [val, color || colorFn.colors[idx]];\n  });\n};\n\nconst calculateAxisLineWidth = (\n  data: DataRecord[],\n  fontSize: number,\n  overlap: boolean,\n): number => (overlap ? fontSize : data.length * fontSize);\n\nconst calculateMin = (data: GaugeDataItemOption[]) =>\n  2 * Math.min(...data.map(d => d.value as number).concat([0]));\n\nconst calculateMax = (data: GaugeDataItemOption[]) =>\n  2 * Math.max(...data.map(d => d.value as number).concat([0]));\n\nexport default function transformProps(\n  chartProps: EchartsGaugeChartProps,\n): GaugeChartTransformedProps {\n  const {\n    width,\n    height,\n    formData,\n    queriesData,\n    hooks,\n    filterState,\n    theme,\n    emitCrossFilters,\n    datasource,\n  } = chartProps;\n\n  const gaugeSeriesOptions = defaultGaugeSeriesOption(theme);\n  const {\n    verboseMap = {},\n    currencyFormats = {},\n    columnFormats = {},\n  } = datasource;\n  const {\n    groupby,\n    metric,\n    minVal,\n    maxVal,\n    colorScheme,\n    fontSize,\n    numberFormat,\n    currencyFormat,\n    animation,\n    showProgress,\n    overlap,\n    roundCap,\n    showAxisTick,\n    showSplitLine,\n    splitNumber,\n    startAngle,\n    endAngle,\n    showPointer,\n    intervals,\n    intervalColorIndices,\n    valueFormatter,\n    sliceId,\n  }: EchartsGaugeFormData = { ...DEFAULT_GAUGE_FORM_DATA, ...formData };\n  const refs: Refs = {};\n  const data = (queriesData[0]?.data || []) as DataRecord[];\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n  const numberFormatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    numberFormat,\n    currencyFormat,\n  );\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme as string);\n  const axisLineWidth = calculateAxisLineWidth(data, fontSize, overlap);\n  const groupbyLabels = groupby.map(getColumnLabel);\n  const formatValue = (value: number) =>\n    valueFormatter.replace('{value}', numberFormatter(value));\n  const axisTickLength = FONT_SIZE_MULTIPLIERS.axisTickLength * fontSize;\n  const splitLineLength = FONT_SIZE_MULTIPLIERS.splitLineLength * fontSize;\n  const titleOffsetFromTitle =\n    FONT_SIZE_MULTIPLIERS.titleOffsetFromTitle * fontSize;\n  const detailOffsetFromTitle =\n    FONT_SIZE_MULTIPLIERS.detailOffsetFromTitle * fontSize;\n  const columnsLabelMap = new Map<string, string[]>();\n\n  const transformedData: GaugeDataItemOption[] = data.map(\n    (data_point, index) => {\n      const name = groupbyLabels\n        .map(column => `${verboseMap[column] || column}: ${data_point[column]}`)\n        .join(', ');\n      columnsLabelMap.set(\n        name,\n        groupbyLabels.map(col => data_point[col] as string),\n      );\n      let item: GaugeDataItemOption = {\n        value: data_point[getMetricLabel(metric as QueryFormMetric)] as number,\n        name,\n        itemStyle: {\n          color: colorFn(index, sliceId),\n        },\n        title: {\n          offsetCenter: [\n            '0%',\n            `${index * titleOffsetFromTitle + OFFSETS.titleFromCenter}%`,\n          ],\n          fontSize,\n        },\n        detail: {\n          offsetCenter: [\n            '0%',\n            `${\n              index * titleOffsetFromTitle +\n              OFFSETS.titleFromCenter +\n              detailOffsetFromTitle\n            }%`,\n          ],\n          fontSize: FONT_SIZE_MULTIPLIERS.detailFontSize * fontSize,\n        },\n      };\n      if (\n        filterState.selectedValues &&\n        !filterState.selectedValues.includes(name)\n      ) {\n        item = {\n          ...item,\n          itemStyle: {\n            color: colorFn(index, sliceId),\n            opacity: OpacityEnum.SemiTransparent,\n          },\n          detail: {\n            show: false,\n          },\n          title: {\n            show: false,\n          },\n        };\n      }\n      return item;\n    },\n  );\n\n  const { setDataMask = () => {}, onContextMenu } = hooks;\n\n  const min = minVal ?? calculateMin(transformedData);\n  const max = maxVal ?? calculateMax(transformedData);\n  const axisLabels = range(min, max, (max - min) / splitNumber);\n  const axisLabelLength = Math.max(\n    ...axisLabels.map(label => numberFormatter(label).length).concat([1]),\n  );\n  const intervalBoundsAndColors = getIntervalBoundsAndColors(\n    intervals,\n    intervalColorIndices,\n    colorFn,\n    min,\n    max,\n  );\n  const splitLineDistance =\n    axisLineWidth + splitLineLength + OFFSETS.ticksFromLine;\n  const axisLabelDistance =\n    FONT_SIZE_MULTIPLIERS.axisLabelDistance *\n      fontSize *\n      FONT_SIZE_MULTIPLIERS.axisLabelLength *\n      axisLabelLength +\n    (showSplitLine ? splitLineLength : 0) +\n    (showAxisTick ? axisTickLength : 0) +\n    OFFSETS.ticksFromLine -\n    axisLineWidth;\n  const axisTickDistance =\n    axisLineWidth + axisTickLength + OFFSETS.ticksFromLine;\n\n  const progress = {\n    show: showProgress,\n    overlap,\n    roundCap,\n    width: fontSize,\n  };\n  const splitLine = {\n    show: showSplitLine,\n    distance: -splitLineDistance,\n    length: splitLineLength,\n    lineStyle: {\n      width: FONT_SIZE_MULTIPLIERS.splitLineWidth * fontSize,\n      color: gaugeSeriesOptions.splitLine?.lineStyle?.color,\n    },\n  };\n  const axisLine = {\n    roundCap,\n    lineStyle: {\n      width: axisLineWidth,\n      color: gaugeSeriesOptions.axisLine?.lineStyle?.color,\n    },\n  };\n  const axisLabel = {\n    distance: -axisLabelDistance,\n    fontSize,\n    formatter: numberFormatter,\n    color: gaugeSeriesOptions.axisLabel?.color,\n  };\n  const axisTick = {\n    show: showAxisTick,\n    distance: -axisTickDistance,\n    length: axisTickLength,\n    lineStyle: gaugeSeriesOptions.axisTick?.lineStyle as AxisTickLineStyle,\n  };\n  const detail = {\n    valueAnimation: animation,\n    formatter: (value: number) => formatValue(value),\n    color: gaugeSeriesOptions.detail?.color,\n  };\n  const tooltip = {\n    ...getDefaultTooltip(refs),\n    formatter: (params: CallbackDataParams) => {\n      const { name, value } = params;\n      return `${name} : ${formatValue(value as number)}`;\n    },\n  };\n\n  let pointer;\n  if (intervalBoundsAndColors.length) {\n    splitLine.lineStyle.color =\n      INTERVAL_GAUGE_SERIES_OPTION.splitLine?.lineStyle?.color;\n    axisTick.lineStyle.color = INTERVAL_GAUGE_SERIES_OPTION?.axisTick?.lineStyle\n      ?.color as string;\n    axisLabel.color = INTERVAL_GAUGE_SERIES_OPTION.axisLabel?.color;\n    axisLine.lineStyle.color = intervalBoundsAndColors;\n    pointer = {\n      show: showPointer,\n      showAbove: false,\n      itemStyle: INTERVAL_GAUGE_SERIES_OPTION.pointer?.itemStyle,\n    };\n  } else {\n    pointer = {\n      show: showPointer,\n      showAbove: false,\n    };\n  }\n\n  const series: GaugeSeriesOption[] = [\n    {\n      type: 'gauge',\n      startAngle,\n      endAngle,\n      min,\n      max,\n      progress,\n      animation,\n      axisLine: axisLine as GaugeSeriesOption['axisLine'],\n      splitLine,\n      splitNumber,\n      axisLabel,\n      axisTick,\n      pointer,\n      detail,\n      // @ts-ignore\n      tooltip,\n      radius:\n        Math.min(width, height) / 2 - axisLabelDistance - axisTickDistance,\n      center: ['50%', '55%'],\n      data: transformedData,\n    },\n  ];\n\n  const echartOptions: EChartsCoreOption = {\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      trigger: 'item',\n    },\n    series,\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    setDataMask,\n    emitCrossFilters,\n    labelMap: Object.fromEntries(columnsLabelMap),\n    groupby,\n    selectedValues: filterState.selectedValues || [],\n    onContextMenu,\n    refs,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const { metric, sort_by_metric } = formData;\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      ...(sort_by_metric && { orderby: [[metric, false]] }),\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, Behavior } from '@superset-ui/core';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/example1.jpg';\nimport example2 from './images/example2.jpg';\nimport buildQuery from './buildQuery';\nimport { EchartsGaugeChartProps, EchartsGaugeFormData } from './types';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsGaugeChartPlugin extends EchartsChartPlugin<\n  EchartsGaugeFormData,\n  EchartsGaugeChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsGauge'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('KPI'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Uses a gauge to showcase progress of a metric towards a target. The position of the dial represents the progress and the terminal value in the gauge represents the target value.',\n        ),\n        exampleGallery: [{ url: example1 }, { url: example2 }],\n        name: t('Gauge Chart'),\n        tags: [\n          t('Multi-Variables'),\n          t('Business'),\n          t('Comparison'),\n          t('ECharts'),\n          t('Report'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { QueryFormData } from '@superset-ui/core';\nimport { GraphNodeItemOption } from 'echarts/types/src/chart/graph/GraphSeries';\nimport { SeriesTooltipOption } from 'echarts/types/src/util/types';\nimport {\n  BaseChartProps,\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  LegendFormData,\n  LegendOrientation,\n  LegendType,\n} from '../types';\nimport { DEFAULT_LEGEND_FORM_DATA } from '../constants';\n\nexport type EdgeSymbol = 'none' | 'circle' | 'arrow';\n\nexport type EchartsGraphFormData = QueryFormData &\n  LegendFormData & {\n    source: string;\n    target: string;\n    sourceCategory?: string;\n    targetCategory?: string;\n    colorScheme?: string;\n    metric?: string;\n    layout?: 'none' | 'circular' | 'force';\n    roam: boolean | 'scale' | 'move';\n    draggable: boolean;\n    selectedMode?: boolean | 'multiple' | 'single';\n    showSymbolThreshold: number;\n    repulsion: number;\n    gravity: number;\n    baseNodeSize: number;\n    baseEdgeWidth: number;\n    edgeLength: number;\n    edgeSymbol: string;\n    friction: number;\n  };\n\nexport type EChartGraphNode = Omit<GraphNodeItemOption, 'value'> & {\n  value: number;\n  col: string;\n  tooltip?: Pick<SeriesTooltipOption, 'formatter'>;\n};\n\n// @ts-ignore\nexport const DEFAULT_FORM_DATA: EchartsGraphFormData = {\n  ...DEFAULT_LEGEND_FORM_DATA,\n  source: '',\n  target: '',\n  layout: 'force',\n  roam: true,\n  draggable: false,\n  selectedMode: 'single',\n  showSymbolThreshold: 0,\n  repulsion: 1000,\n  gravity: 0.3,\n  edgeSymbol: 'none,arrow',\n  edgeLength: 400,\n  baseEdgeWidth: 3,\n  baseNodeSize: 20,\n  friction: 0.2,\n  legendOrientation: LegendOrientation.Top,\n  legendType: LegendType.Scroll,\n};\n\nexport type tooltipFormatParams = {\n  data: { [name: string]: string };\n};\n\nexport interface EchartsGraphChartProps\n  extends BaseChartProps<EchartsGraphFormData> {\n  formData: EchartsGraphFormData;\n}\n\nexport type GraphChartTransformedProps =\n  BaseTransformedProps<EchartsGraphFormData> & ContextMenuTransformedProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  getStandardizedControls,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './types';\nimport { legendSection } from '../controls';\n\nconst requiredEntity = {\n  ...sharedControls.entity,\n  clearable: false,\n};\n\nconst optionalEntity = {\n  ...sharedControls.entity,\n  clearable: true,\n  validators: [],\n};\n\nconst controlPanel: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'source',\n            config: {\n              ...requiredEntity,\n              label: t('Source'),\n              description: t('Name of the source nodes'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'target',\n            config: {\n              ...requiredEntity,\n              label: t('Target'),\n              description: t('Name of the target nodes'),\n            },\n          },\n        ],\n        ['metric'],\n        [\n          {\n            name: 'source_category',\n            config: {\n              ...optionalEntity,\n              label: t('Source category'),\n              description: t(\n                'The category of source nodes used to assign colors. ' +\n                  'If a node is associated with more than one category, only the first will be used.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'target_category',\n            config: {\n              ...optionalEntity,\n              label: t('Target category'),\n              description: t('Category of target nodes'),\n            },\n          },\n        ],\n        ['adhoc_filters'],\n        ['row_limit'],\n      ],\n    },\n    {\n      label: t('Chart options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('Layout')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'layout',\n            config: {\n              type: 'RadioButtonControl',\n              renderTrigger: true,\n              label: t('Graph layout'),\n              default: DEFAULT_FORM_DATA.layout,\n              options: [\n                ['force', t('Force')],\n                ['circular', t('Circular')],\n              ],\n              description: t('Layout type of graph'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'edgeSymbol',\n            config: {\n              type: 'SelectControl',\n              renderTrigger: true,\n              label: t('Edge symbols'),\n              description: t('Symbol of two ends of edge line'),\n              default: DEFAULT_FORM_DATA.edgeSymbol,\n              choices: [\n                ['none,none', t('None -> None')],\n                ['none,arrow', t('None -> Arrow')],\n                ['circle,arrow', t('Circle -> Arrow')],\n                ['circle,circle', t('Circle -> Circle')],\n              ],\n            },\n          },\n        ],\n        [\n          {\n            name: 'draggable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Enable node dragging'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.draggable,\n              description: t(\n                'Whether to enable node dragging in force layout mode.',\n              ),\n              visibility({ form_data: { layout } }) {\n                return (\n                  layout === 'force' ||\n                  (!layout && DEFAULT_FORM_DATA.layout === 'force')\n                );\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'roam',\n            config: {\n              type: 'SelectControl',\n              label: t('Enable graph roaming'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.roam,\n              choices: [\n                [false, t('Disabled')],\n                ['scale', t('Scale only')],\n                ['move', t('Move only')],\n                [true, t('Scale and Move')],\n              ],\n              description: t(\n                'Whether to enable changing graph position and scaling.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'selectedMode',\n            config: {\n              type: 'SelectControl',\n              renderTrigger: true,\n              label: t('Node select mode'),\n              default: DEFAULT_FORM_DATA.selectedMode,\n              choices: [\n                [false, t('Disabled')],\n                ['single', t('Single')],\n                ['multiple', t('Multiple')],\n              ],\n              description: t('Allow node selections'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'showSymbolThreshold',\n            config: {\n              type: 'TextControl',\n              label: t('Label threshold'),\n              renderTrigger: true,\n              isInt: true,\n              default: DEFAULT_FORM_DATA.showSymbolThreshold,\n              description: t(\n                'Minimum value for label to be displayed on graph.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'baseNodeSize',\n            config: {\n              type: 'TextControl',\n              label: t('Node size'),\n              renderTrigger: true,\n              isFloat: true,\n              default: DEFAULT_FORM_DATA.baseNodeSize,\n              description: t(\n                'Median node size, the largest node will be 4 times larger than the smallest',\n              ),\n            },\n          },\n          {\n            name: 'baseEdgeWidth',\n            config: {\n              type: 'TextControl',\n              label: t('Edge width'),\n              renderTrigger: true,\n              isFloat: true,\n              default: DEFAULT_FORM_DATA.baseEdgeWidth,\n              description: t(\n                'Median edge width, the thickest edge will be 4 times thicker than the thinnest.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'edgeLength',\n            config: {\n              type: 'SliderControl',\n              label: t('Edge length'),\n              renderTrigger: true,\n              min: 100,\n              max: 1000,\n              step: 50,\n              default: DEFAULT_FORM_DATA.edgeLength,\n              description: t('Edge length between nodes'),\n              visibility({ form_data: { layout } }) {\n                return (\n                  layout === 'force' ||\n                  (!layout && DEFAULT_FORM_DATA.layout === 'force')\n                );\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'gravity',\n            config: {\n              type: 'SliderControl',\n              label: t('Gravity'),\n              renderTrigger: true,\n              min: 0.1,\n              max: 1,\n              step: 0.1,\n              default: DEFAULT_FORM_DATA.gravity,\n              description: t('Strength to pull the graph toward center'),\n              visibility({ form_data: { layout } }) {\n                return (\n                  layout === 'force' ||\n                  (!layout && DEFAULT_FORM_DATA.layout === 'force')\n                );\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'repulsion',\n            config: {\n              type: 'SliderControl',\n              label: t('Repulsion'),\n              renderTrigger: true,\n              min: 100,\n              max: 3000,\n              step: 50,\n              default: DEFAULT_FORM_DATA.repulsion,\n              description: t('Repulsion strength between nodes'),\n              visibility({ form_data: { layout } }) {\n                return (\n                  layout === 'force' ||\n                  (!layout && DEFAULT_FORM_DATA.layout === 'force')\n                );\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'friction',\n            config: {\n              type: 'SliderControl',\n              label: t('Friction'),\n              renderTrigger: true,\n              min: 0.1,\n              max: 1,\n              step: 0.1,\n              default: DEFAULT_FORM_DATA.friction,\n              description: t('Friction between nodes'),\n              visibility({ form_data: { layout } }) {\n                return (\n                  layout === 'force' ||\n                  (!layout && DEFAULT_FORM_DATA.layout === 'force')\n                );\n              },\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().popAllMetrics(),\n  }),\n};\n\nexport default controlPanel;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { GraphSeriesOption } from 'echarts';\n\nexport const DEFAULT_GRAPH_SERIES_OPTION: GraphSeriesOption = {\n  zoom: 0.7,\n  circular: { rotateLabel: true },\n  force: {\n    initLayout: 'circular',\n    layoutAnimation: true,\n  },\n  label: {\n    show: true,\n    position: 'right',\n    distance: 5,\n    rotate: 0,\n    offset: [0, 0],\n    fontStyle: 'normal',\n    fontWeight: 'normal',\n    fontFamily: 'sans-serif',\n    fontSize: 12,\n    padding: [0, 0, 0, 0],\n    overflow: 'truncate',\n    formatter: '{b}',\n  },\n  emphasis: {\n    focus: 'adjacency',\n  },\n  animation: true,\n  animationDuration: 500,\n  animationEasing: 'cubicOut',\n  lineStyle: { color: 'source', curveness: 0.1 },\n  select: {\n    itemStyle: { borderWidth: 3, opacity: 1 },\n    label: { fontWeight: 'bolder' },\n  },\n  // Ref: https://echarts.apache.org/en/option.html#series-graph.data.tooltip.formatter\n  //   - b: data name\n  //   - c: data value\n  tooltip: { formatter: '{b}: {c}' },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CategoricalColorNamespace,\n  getMetricLabel,\n  DataRecord,\n  DataRecordValue,\n} from '@superset-ui/core';\nimport { EChartsCoreOption, GraphSeriesOption } from 'echarts';\nimport { extent as d3Extent } from 'd3-array';\nimport { GraphEdgeItemOption } from 'echarts/types/src/chart/graph/GraphSeries';\nimport {\n  EchartsGraphFormData,\n  EChartGraphNode,\n  DEFAULT_FORM_DATA as DEFAULT_GRAPH_FORM_DATA,\n  EdgeSymbol,\n  GraphChartTransformedProps,\n  EchartsGraphChartProps,\n} from './types';\nimport { DEFAULT_GRAPH_SERIES_OPTION } from './constants';\nimport {\n  getChartPadding,\n  getColtypesMapping,\n  getLegendProps,\n  sanitizeHtml,\n} from '../utils/series';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport { Refs } from '../types';\n\ntype EdgeWithStyles = GraphEdgeItemOption & {\n  lineStyle: Exclude<GraphEdgeItemOption['lineStyle'], undefined>;\n  emphasis: Exclude<GraphEdgeItemOption['emphasis'], undefined>;\n  select: Exclude<GraphEdgeItemOption['select'], undefined>;\n};\n\nfunction verifyEdgeSymbol(symbol: string): EdgeSymbol {\n  if (symbol === 'none' || symbol === 'circle' || symbol === 'arrow') {\n    return symbol;\n  }\n  return 'none';\n}\n\nfunction parseEdgeSymbol(symbols?: string | null): [EdgeSymbol, EdgeSymbol] {\n  const [start, end] = (symbols || '').split(',');\n  return [verifyEdgeSymbol(start), verifyEdgeSymbol(end)];\n}\n\n/**\n * Emphasized edge width with a min and max.\n */\nfunction getEmphasizedEdgeWidth(width: number) {\n  return Math.max(5, Math.min(width * 2, 20));\n}\n\n/**\n * Normalize node size, edge width, and apply label visibility thresholds.\n */\nfunction normalizeStyles(\n  nodes: EChartGraphNode[],\n  links: EdgeWithStyles[],\n  {\n    baseNodeSize,\n    baseEdgeWidth,\n    showSymbolThreshold,\n  }: {\n    baseNodeSize: number;\n    baseEdgeWidth: number;\n    showSymbolThreshold?: number;\n  },\n) {\n  const minNodeSize = baseNodeSize * 0.5;\n  const maxNodeSize = baseNodeSize * 2;\n  const minEdgeWidth = baseEdgeWidth * 0.5;\n  const maxEdgeWidth = baseEdgeWidth * 2;\n  const [nodeMinValue, nodeMaxValue] = d3Extent(nodes, x => x.value) as [\n    number,\n    number,\n  ];\n\n  const nodeSpread = nodeMaxValue - nodeMinValue;\n  nodes.forEach(node => {\n    // eslint-disable-next-line no-param-reassign\n    node.symbolSize =\n      (((node.value - nodeMinValue) / nodeSpread) * maxNodeSize || 0) +\n      minNodeSize;\n    // eslint-disable-next-line no-param-reassign\n    node.label = {\n      ...node.label,\n      show: showSymbolThreshold ? node.value > showSymbolThreshold : true,\n    };\n  });\n\n  const [linkMinValue, linkMaxValue] = d3Extent(links, x => x.value) as [\n    number,\n    number,\n  ];\n  const linkSpread = linkMaxValue - linkMinValue;\n  links.forEach(link => {\n    const lineWidth =\n      ((link.value! - linkMinValue) / linkSpread) * maxEdgeWidth ||\n      0 + minEdgeWidth;\n    // eslint-disable-next-line no-param-reassign\n    link.lineStyle.width = lineWidth;\n    // eslint-disable-next-line no-param-reassign\n    link.emphasis.lineStyle = {\n      ...link.emphasis.lineStyle,\n      width: getEmphasizedEdgeWidth(lineWidth),\n    };\n    // eslint-disable-next-line no-param-reassign\n    link.select.lineStyle = {\n      ...link.select.lineStyle,\n      width: getEmphasizedEdgeWidth(lineWidth * 0.8),\n      opacity: 1,\n    };\n  });\n}\n\nfunction getKeyByValue(\n  object: { [name: string]: number },\n  value: number,\n): string {\n  return Object.keys(object).find(key => object[key] === value) as string;\n}\n\nfunction edgeFormatter(\n  sourceIndex: string,\n  targetIndex: string,\n  value: number,\n  nodes: { [name: string]: number },\n): string {\n  const source = Number(sourceIndex);\n  const target = Number(targetIndex);\n  return `${sanitizeHtml(getKeyByValue(nodes, source))} > ${sanitizeHtml(\n    getKeyByValue(nodes, target),\n  )} : ${value}`;\n}\n\nfunction getCategoryName(columnName: string, name?: DataRecordValue) {\n  if (name === false) {\n    return `${columnName}: false`;\n  }\n  if (name === true) {\n    return `${columnName}: true`;\n  }\n  if (name == null) {\n    return 'N/A';\n  }\n  return String(name);\n}\n\nexport default function transformProps(\n  chartProps: EchartsGraphChartProps,\n): GraphChartTransformedProps {\n  const {\n    width,\n    height,\n    formData,\n    queriesData,\n    hooks,\n    inContextMenu,\n    filterState,\n    emitCrossFilters,\n    theme,\n  } = chartProps;\n  const data: DataRecord[] = queriesData[0].data || [];\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n  const {\n    source,\n    target,\n    sourceCategory,\n    targetCategory,\n    colorScheme,\n    metric = '',\n    layout,\n    roam,\n    draggable,\n    selectedMode,\n    showSymbolThreshold,\n    edgeLength,\n    gravity,\n    repulsion,\n    friction,\n    legendMargin,\n    legendOrientation,\n    legendType,\n    showLegend,\n    baseEdgeWidth,\n    baseNodeSize,\n    edgeSymbol,\n    sliceId,\n  }: EchartsGraphFormData = { ...DEFAULT_GRAPH_FORM_DATA, ...formData };\n\n  const refs: Refs = {};\n  const metricLabel = getMetricLabel(metric);\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme as string);\n  const nodes: { [name: string]: number } = {};\n  const categories: Set<string> = new Set();\n  const echartNodes: EChartGraphNode[] = [];\n  const echartLinks: EdgeWithStyles[] = [];\n\n  /**\n   * Get the node id of an existing node,\n   * or create a new node if it doesn't exist.\n   */\n  function getOrCreateNode(name: string, col: string, category?: string) {\n    if (!(name in nodes)) {\n      nodes[name] = echartNodes.length;\n      echartNodes.push({\n        id: String(nodes[name]),\n        name,\n        col,\n        value: 0,\n        category,\n        select: DEFAULT_GRAPH_SERIES_OPTION.select,\n        tooltip: {\n          ...getDefaultTooltip(refs),\n          ...DEFAULT_GRAPH_SERIES_OPTION.tooltip,\n        },\n      });\n    }\n    const node = echartNodes[nodes[name]];\n    if (category) {\n      categories.add(category);\n      // category may be empty when one of `sourceCategory`\n      // or `targetCategory` is not set.\n      if (!node.category) {\n        node.category = category;\n      }\n    }\n    return node;\n  }\n\n  data.forEach(link => {\n    const value = link[metricLabel] as number;\n    if (!value) {\n      return;\n    }\n    const sourceName = link[source] as string;\n    const targetName = link[target] as string;\n    const sourceCategoryName = sourceCategory\n      ? getCategoryName(sourceCategory, link[sourceCategory])\n      : undefined;\n    const targetCategoryName = targetCategory\n      ? getCategoryName(targetCategory, link[targetCategory])\n      : undefined;\n    const sourceNode = getOrCreateNode(sourceName, source, sourceCategoryName);\n    const targetNode = getOrCreateNode(targetName, target, targetCategoryName);\n\n    sourceNode.value += value;\n    targetNode.value += value;\n\n    echartLinks.push({\n      source: sourceNode.id,\n      target: targetNode.id,\n      value,\n      lineStyle: {},\n      emphasis: {},\n      select: {},\n    });\n  });\n\n  normalizeStyles(echartNodes, echartLinks, {\n    showSymbolThreshold,\n    baseEdgeWidth,\n    baseNodeSize,\n  });\n\n  const categoryList = [...categories];\n\n  const series: GraphSeriesOption[] = [\n    {\n      zoom: DEFAULT_GRAPH_SERIES_OPTION.zoom,\n      type: 'graph',\n      categories: categoryList.map(c => ({\n        name: c,\n        itemStyle: { color: colorFn(c, sliceId) },\n      })),\n      layout,\n      force: {\n        ...DEFAULT_GRAPH_SERIES_OPTION.force,\n        edgeLength,\n        gravity,\n        repulsion,\n        friction,\n      },\n      circular: DEFAULT_GRAPH_SERIES_OPTION.circular,\n      data: echartNodes,\n      links: echartLinks,\n      roam,\n      draggable,\n      edgeSymbol: parseEdgeSymbol(edgeSymbol),\n      edgeSymbolSize: baseEdgeWidth * 2,\n      selectedMode,\n      ...getChartPadding(showLegend, legendOrientation, legendMargin),\n      animation: DEFAULT_GRAPH_SERIES_OPTION.animation,\n      label: DEFAULT_GRAPH_SERIES_OPTION.label,\n      lineStyle: DEFAULT_GRAPH_SERIES_OPTION.lineStyle,\n      emphasis: DEFAULT_GRAPH_SERIES_OPTION.emphasis,\n    },\n  ];\n\n  const echartOptions: EChartsCoreOption = {\n    animationDuration: DEFAULT_GRAPH_SERIES_OPTION.animationDuration,\n    animationEasing: DEFAULT_GRAPH_SERIES_OPTION.animationEasing,\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu,\n      formatter: (params: any): string =>\n        edgeFormatter(\n          params.data.source,\n          params.data.target,\n          params.value,\n          nodes,\n        ),\n    },\n    legend: {\n      ...getLegendProps(legendType, legendOrientation, showLegend, theme),\n      data: categoryList,\n    },\n    series,\n  };\n\n  const { onContextMenu, setDataMask } = hooks;\n\n  return {\n    width,\n    height,\n    formData,\n    echartOptions,\n    onContextMenu,\n    setDataMask,\n    filterState,\n    refs,\n    emitCrossFilters,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  return buildQueryContext(formData, {\n    queryFields: {\n      source: 'columns',\n      target: 'columns',\n      source_category: 'columns',\n      target_category: 'columns',\n    },\n  });\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, t } from '@superset-ui/core';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.jpg';\nimport buildQuery from './buildQuery';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsGraphChartPlugin extends EchartsChartPlugin {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsGraph'),\n      metadata: {\n        category: t('Flow'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Displays connections between entities in a graph structure. Useful for mapping relationships and showing which nodes are important in a network. Graph charts can be configured to be force-directed or circulate. If your data has a geospatial component, try the deck.gl Arc chart.',\n        ),\n        exampleGallery: [{ url: example }],\n        name: t('Graph Chart'),\n        tags: [\n          t('Aesthetic'),\n          t('Circular'),\n          t('Comparison'),\n          t('Directional'),\n          t('ECharts'),\n          t('Relational'),\n          t('Structural'),\n          t('Transformable'),\n        ],\n        thumbnail,\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  QueryFormData,\n  ensureIsArray,\n} from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const { series_limit_metric } = formData;\n  const sortByMetric = ensureIsArray(series_limit_metric)[0];\n\n  return buildQueryContext(formData, baseQueryObject => {\n    let { metrics, orderby = [] } = baseQueryObject;\n    metrics = metrics || [];\n    // override orderby with timeseries metric\n    if (sortByMetric) {\n      orderby = [[sortByMetric, false]];\n    } else if (metrics?.length > 0) {\n      // default to ordering by first metric in descending order\n      // when no \"sort by\" metric is set (regardless if \"SORT DESC\" is set to true)\n      orderby = [[metrics[0], false]];\n    }\n    return [\n      {\n        ...baseQueryObject,\n        orderby,\n      },\n    ];\n  });\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  QueryFormColumn,\n  QueryFormData,\n  QueryFormMetric,\n} from '@superset-ui/core';\nimport {\n  BaseChartProps,\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  CrossFilterTransformedProps,\n  LegendFormData,\n  LabelPositionEnum,\n  LegendOrientation,\n  LegendType,\n} from '../types';\nimport { DEFAULT_LEGEND_FORM_DATA } from '../constants';\n\ntype RadarColumnConfig = Record<string, { radarMetricMaxValue?: number }>;\n\nexport type EchartsRadarFormData = QueryFormData &\n  LegendFormData & {\n    colorScheme?: string;\n    columnConfig?: RadarColumnConfig;\n    currentOwnValue?: string[] | null;\n    currentValue?: string[] | null;\n    defaultValue?: string[] | null;\n    groupby: QueryFormColumn[];\n    labelType: EchartsRadarLabelType;\n    labelPosition: LabelPositionEnum;\n    metrics: QueryFormMetric[];\n    showLabels: boolean;\n    isCircle: boolean;\n    numberFormat: string;\n    dateFormat: string;\n  };\n\nexport enum EchartsRadarLabelType {\n  Value = 'value',\n  KeyValue = 'key_value',\n}\n\nexport interface EchartsRadarChartProps\n  extends BaseChartProps<EchartsRadarFormData> {\n  formData: EchartsRadarFormData;\n}\n\n// @ts-ignore\nexport const DEFAULT_FORM_DATA: EchartsRadarFormData = {\n  ...DEFAULT_LEGEND_FORM_DATA,\n  groupby: [],\n  labelType: EchartsRadarLabelType.Value,\n  labelPosition: LabelPositionEnum.Top,\n  legendOrientation: LegendOrientation.Top,\n  legendType: LegendType.Scroll,\n  numberFormat: 'SMART_NUMBER',\n  showLabels: true,\n  dateFormat: 'smart_date',\n  isCircle: false,\n};\n\nexport type RadarChartTransformedProps =\n  BaseTransformedProps<EchartsRadarFormData> &\n    ContextMenuTransformedProps &\n    CrossFilterTransformedProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport {\n  ChartDataResponseResult,\n  GenericDataType,\n  QueryFormMetric,\n  t,\n  validateNumber,\n} from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  D3_FORMAT_DOCS,\n  D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT,\n  D3_FORMAT_OPTIONS,\n  D3_TIME_FORMAT_OPTIONS,\n  sharedControls,\n  ControlFormItemSpec,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './types';\nimport { LABEL_POSITION } from '../constants';\nimport { legendSection } from '../controls';\n\nconst { labelType, labelPosition, numberFormat, showLabels, isCircle } =\n  DEFAULT_FORM_DATA;\n\nconst radarMetricMaxValue: { name: string; config: ControlFormItemSpec } = {\n  name: 'radarMetricMaxValue',\n  config: {\n    controlType: 'InputNumber',\n    label: t('Max'),\n    description: t(\n      'The maximum value of metrics. It is an optional configuration',\n    ),\n    width: 120,\n    placeholder: t('auto'),\n    debounceDelay: 400,\n    validators: [validateNumber],\n  },\n};\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['groupby'],\n        ['metrics'],\n        ['timeseries_limit_metric'],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'row_limit',\n            config: {\n              ...sharedControls.row_limit,\n              default: 10,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('Labels')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'show_labels',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Labels'),\n              renderTrigger: true,\n              default: showLabels,\n              description: t('Whether to display the labels.'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'label_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Label Type'),\n              default: labelType,\n              renderTrigger: true,\n              choices: [\n                ['value', t('Value')],\n                ['key_value', t('Category and Value')],\n              ],\n              description: t('What should be shown on the label?'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'label_position',\n            config: {\n              type: 'SelectControl',\n              freeForm: false,\n              label: t('Label position'),\n              renderTrigger: true,\n              choices: LABEL_POSITION,\n              default: labelPosition,\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: numberFormat,\n              choices: D3_FORMAT_OPTIONS,\n              description: `${D3_FORMAT_DOCS} ${D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT}`,\n            },\n          },\n        ],\n        [\n          {\n            name: 'date_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date format'),\n              renderTrigger: true,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              default: 'smart_date',\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('Radar')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'column_config',\n            config: {\n              type: 'ColumnConfigControl',\n              label: t('Customize Metrics'),\n              description: t('Further customize how to display each metric'),\n              renderTrigger: true,\n              configFormLayout: {\n                [GenericDataType.Numeric]: [[radarMetricMaxValue]],\n              },\n              shouldMapStateToProps() {\n                return true;\n              },\n              mapStateToProps(explore, _, chart) {\n                const values =\n                  (explore?.controls?.metrics?.value as QueryFormMetric[]) ??\n                  [];\n                const metricColumn = values.map(value => {\n                  if (typeof value === 'string') {\n                    return value;\n                  }\n                  return value.label;\n                });\n                return {\n                  queryResponse: chart?.queriesResponse?.[0] as\n                    | ChartDataResponseResult\n                    | undefined,\n                  appliedColumnNames: metricColumn,\n                };\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'is_circle',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Circle radar shape'),\n              renderTrigger: true,\n              default: isCircle,\n              description: t(\n                \"Radar render type, whether to display 'circle' shape.\",\n              ),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CategoricalColorNamespace,\n  ensureIsInt,\n  getColumnLabel,\n  getMetricLabel,\n  getNumberFormatter,\n  getTimeFormatter,\n  NumberFormatter,\n} from '@superset-ui/core';\nimport { CallbackDataParams } from 'echarts/types/src/util/types';\nimport { RadarSeriesDataItemOption } from 'echarts/types/src/chart/radar/RadarSeries';\nimport { EChartsCoreOption, RadarSeriesOption } from 'echarts';\nimport {\n  DEFAULT_FORM_DATA as DEFAULT_RADAR_FORM_DATA,\n  EchartsRadarChartProps,\n  EchartsRadarFormData,\n  EchartsRadarLabelType,\n  RadarChartTransformedProps,\n} from './types';\nimport { DEFAULT_LEGEND_FORM_DATA, OpacityEnum } from '../constants';\nimport {\n  extractGroupbyLabel,\n  getChartPadding,\n  getColtypesMapping,\n  getLegendProps,\n} from '../utils/series';\nimport { defaultGrid } from '../defaults';\nimport { Refs } from '../types';\nimport { getDefaultTooltip } from '../utils/tooltip';\n\nexport function formatLabel({\n  params,\n  labelType,\n  numberFormatter,\n}: {\n  params: CallbackDataParams;\n  labelType: EchartsRadarLabelType;\n  numberFormatter: NumberFormatter;\n}): string {\n  const { name = '', value } = params;\n  const formattedValue = numberFormatter(value as number);\n\n  switch (labelType) {\n    case EchartsRadarLabelType.Value:\n      return formattedValue;\n    case EchartsRadarLabelType.KeyValue:\n      return `${name}: ${formattedValue}`;\n    default:\n      return name;\n  }\n}\n\nexport default function transformProps(\n  chartProps: EchartsRadarChartProps,\n): RadarChartTransformedProps {\n  const {\n    formData,\n    height,\n    hooks,\n    filterState,\n    queriesData,\n    width,\n    theme,\n    inContextMenu,\n    emitCrossFilters,\n  } = chartProps;\n  const refs: Refs = {};\n  const { data = [] } = queriesData[0];\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n\n  const {\n    colorScheme,\n    groupby,\n    labelType,\n    labelPosition,\n    legendOrientation,\n    legendType,\n    legendMargin,\n    metrics = [],\n    numberFormat,\n    dateFormat,\n    showLabels,\n    showLegend,\n    isCircle,\n    columnConfig,\n    sliceId,\n  }: EchartsRadarFormData = {\n    ...DEFAULT_LEGEND_FORM_DATA,\n    ...DEFAULT_RADAR_FORM_DATA,\n    ...formData,\n  };\n  const { setDataMask = () => {}, onContextMenu } = hooks;\n\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme as string);\n  const numberFormatter = getNumberFormatter(numberFormat);\n  const formatter = (params: CallbackDataParams) =>\n    formatLabel({\n      params,\n      numberFormatter,\n      labelType,\n    });\n\n  const metricLabels = metrics.map(getMetricLabel);\n  const groupbyLabels = groupby.map(getColumnLabel);\n\n  const metricLabelAndMaxValueMap = new Map<string, number>();\n  const columnsLabelMap = new Map<string, string[]>();\n  const transformedData: RadarSeriesDataItemOption[] = [];\n  data.forEach(datum => {\n    const joinedName = extractGroupbyLabel({\n      datum,\n      groupby: groupbyLabels,\n      coltypeMapping,\n      timeFormatter: getTimeFormatter(dateFormat),\n    });\n    // map(joined_name: [columnLabel_1, columnLabel_2, ...])\n    columnsLabelMap.set(\n      joinedName,\n      groupbyLabels.map(col => datum[col] as string),\n    );\n\n    // put max value of series into metricLabelAndMaxValueMap\n    // eslint-disable-next-line no-restricted-syntax\n    for (const [metricLabel, value] of Object.entries(datum)) {\n      if (metricLabelAndMaxValueMap.has(metricLabel)) {\n        metricLabelAndMaxValueMap.set(\n          metricLabel,\n          Math.max(\n            value as number,\n            ensureIsInt(\n              metricLabelAndMaxValueMap.get(metricLabel),\n              Number.MIN_SAFE_INTEGER,\n            ),\n          ),\n        );\n      } else {\n        metricLabelAndMaxValueMap.set(metricLabel, value as number);\n      }\n    }\n\n    const isFiltered =\n      filterState.selectedValues &&\n      !filterState.selectedValues.includes(joinedName);\n\n    // generate transformedData\n    transformedData.push({\n      value: metricLabels.map(metricLabel => datum[metricLabel]),\n      name: joinedName,\n      itemStyle: {\n        color: colorFn(joinedName, sliceId),\n        opacity: isFiltered\n          ? OpacityEnum.Transparent\n          : OpacityEnum.NonTransparent,\n      },\n      lineStyle: {\n        opacity: isFiltered\n          ? OpacityEnum.SemiTransparent\n          : OpacityEnum.NonTransparent,\n      },\n      label: {\n        show: showLabels,\n        position: labelPosition,\n        formatter,\n      },\n    } as RadarSeriesDataItemOption);\n  });\n\n  const selectedValues = (filterState.selectedValues || []).reduce(\n    (acc: Record<string, number>, selectedValue: string) => {\n      const index = transformedData.findIndex(\n        ({ name }) => name === selectedValue,\n      );\n      return {\n        ...acc,\n        [index]: selectedValue,\n      };\n    },\n    {},\n  );\n\n  const indicator = metricLabels.map(metricLabel => {\n    const maxValueInControl = columnConfig?.[metricLabel]?.radarMetricMaxValue;\n    // Ensure that 0 is at the center of the polar coordinates\n    const metricValueAsMax =\n      metricLabelAndMaxValueMap.get(metricLabel) === 0\n        ? Number.MAX_SAFE_INTEGER\n        : metricLabelAndMaxValueMap.get(metricLabel);\n    const max =\n      maxValueInControl === null ? metricValueAsMax : maxValueInControl;\n    return {\n      name: metricLabel,\n      max,\n    };\n  });\n\n  const series: RadarSeriesOption[] = [\n    {\n      type: 'radar',\n      ...getChartPadding(showLegend, legendOrientation, legendMargin),\n      animation: false,\n      emphasis: {\n        label: {\n          show: true,\n          fontWeight: 'bold',\n          backgroundColor: theme.colors.grayscale.light5,\n        },\n      },\n      data: transformedData,\n    },\n  ];\n\n  const echartOptions: EChartsCoreOption = {\n    grid: {\n      ...defaultGrid,\n    },\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu,\n      trigger: 'item',\n    },\n    legend: {\n      ...getLegendProps(legendType, legendOrientation, showLegend, theme),\n      data: Array.from(columnsLabelMap.keys()),\n    },\n    series,\n    radar: {\n      shape: isCircle ? 'circle' : 'polygon',\n      indicator,\n    },\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    emitCrossFilters,\n    setDataMask,\n    labelMap: Object.fromEntries(columnsLabelMap),\n    groupby,\n    selectedValues,\n    onContextMenu,\n    refs,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding\n * g copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/example1.jpg';\nimport example2 from './images/example2.jpg';\nimport { EchartsRadarChartProps, EchartsRadarFormData } from './types';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsRadarChartPlugin extends EchartsChartPlugin<\n  EchartsRadarFormData,\n  EchartsRadarChartProps\n> {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsRadar'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Ranking'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Visualize a parallel set of metrics across multiple groups. Each group is visualized using its own line of points and each metric is represented as an edge in the chart.',\n        ),\n        exampleGallery: [{ url: example1 }, { url: example2 }],\n        name: t('Radar Chart'),\n        tags: [\n          t('Business'),\n          t('Comparison'),\n          t('Coordinates'),\n          t('Multi-Variables'),\n          t('Report'),\n          t('Web'),\n          t('ECharts'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  ensureIsArray,\n  normalizeOrderBy,\n  PostProcessingPivot,\n  QueryFormData,\n  QueryObject,\n  isXAxisSet,\n  getXAxisColumn,\n} from '@superset-ui/core';\nimport {\n  pivotOperator,\n  renameOperator,\n  flattenOperator,\n  isTimeComparison,\n  timeComparePivotOperator,\n  rollingWindowOperator,\n  timeCompareOperator,\n  resampleOperator,\n} from '@superset-ui/chart-controls';\nimport {\n  retainFormDataSuffix,\n  removeFormDataSuffix,\n} from '../utils/formDataSuffix';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const baseFormData = {\n    ...formData,\n  };\n\n  const formData1 = removeFormDataSuffix(baseFormData, '_b');\n  const formData2 = retainFormDataSuffix(baseFormData, '_b');\n\n  const queryContexts = [formData1, formData2].map(fd =>\n    buildQueryContext(fd, baseQueryObject => {\n      const queryObject = {\n        ...baseQueryObject,\n        columns: [\n          ...(isXAxisSet(formData)\n            ? ensureIsArray(getXAxisColumn(formData))\n            : []),\n          ...ensureIsArray(fd.groupby),\n        ],\n        series_columns: fd.groupby,\n        ...(isXAxisSet(formData) ? {} : { is_timeseries: true }),\n      };\n\n      const pivotOperatorInRuntime: PostProcessingPivot = isTimeComparison(\n        fd,\n        queryObject,\n      )\n        ? timeComparePivotOperator(fd, queryObject)\n        : pivotOperator(fd, queryObject);\n\n      const tmpQueryObject = {\n        ...queryObject,\n        time_offsets: isTimeComparison(fd, queryObject) ? fd.time_compare : [],\n        post_processing: [\n          pivotOperatorInRuntime,\n          rollingWindowOperator(fd, queryObject),\n          timeCompareOperator(fd, queryObject),\n          resampleOperator(fd, queryObject),\n          renameOperator(fd, queryObject),\n          flattenOperator(fd, queryObject),\n        ],\n      } as QueryObject;\n      return [normalizeOrderBy(tmpQueryObject)];\n    }),\n  );\n\n  return {\n    ...queryContexts[0],\n    queries: [...queryContexts[0].queries, ...queryContexts[1].queries],\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { QueryFormData } from '@superset-ui/core';\n\nexport const retainFormDataSuffix = (\n  formData: QueryFormData,\n  controlSuffix: string,\n): QueryFormData => {\n  /*\n   * retain controls by suffix and return a new formData\n   * eg:\n   * > const fd = { metrics: ['foo', 'bar'], metrics_b: ['zee'], limit: 100, ... }\n   * > removeFormDataSuffix(fd, '_b')\n   * { metrics: ['zee'], limit: 100, ... }\n   * */\n  const newFormData = {};\n\n  Object.entries(formData)\n    .sort(([a], [b]) => {\n      // items contained suffix before others\n      const weight_a = a.endsWith(controlSuffix) ? 1 : 0;\n      const weight_b = b.endsWith(controlSuffix) ? 1 : 0;\n      return weight_b - weight_a;\n    })\n    .forEach(([key, value]) => {\n      if (key.endsWith(controlSuffix)) {\n        newFormData[key.slice(0, -controlSuffix.length)] = value;\n      }\n\n      if (!key.endsWith(controlSuffix) && !(key in newFormData)) {\n        // ignore duplication\n        newFormData[key] = value;\n      }\n    });\n\n  return newFormData as QueryFormData;\n};\n\nexport const removeFormDataSuffix = (\n  formData: QueryFormData,\n  controlSuffix: string,\n): QueryFormData => {\n  /*\n   * remove unused controls by suffix and return a new formData\n   * eg:\n   * > const fd = { metrics: ['foo', 'bar'], metrics_b: ['zee'], limit: 100, ... }\n   * > removeUnusedFormData(fd, '_b')\n   * { metrics: ['foo', 'bar'], limit: 100, ... }\n   * */\n  const newFormData = {};\n  Object.entries(formData).forEach(([key, value]) => {\n    if (!key.endsWith(controlSuffix)) {\n      newFormData[key] = value;\n    }\n  });\n\n  return newFormData as QueryFormData;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AnnotationLayer,\n  TimeGranularity,\n  QueryFormData,\n  QueryFormColumn,\n  ContributionType,\n  TimeFormatter,\n  AxisType,\n} from '@superset-ui/core';\nimport {\n  BaseChartProps,\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  CrossFilterTransformedProps,\n  EchartsTimeseriesSeriesType,\n  LegendFormData,\n  StackType,\n  TitleFormData,\n} from '../types';\nimport {\n  DEFAULT_LEGEND_FORM_DATA,\n  DEFAULT_TITLE_FORM_DATA,\n  DEFAULT_FORM_DATA as TIMESERIES_DEFAULTS,\n} from '../constants';\n\nexport type EchartsMixedTimeseriesFormData = QueryFormData & {\n  annotationLayers: AnnotationLayer[];\n  // shared properties\n  minorSplitLine: boolean;\n  minorTicks: boolean;\n  logAxis: boolean;\n  logAxisSecondary: boolean;\n  yAxisFormat?: string;\n  yAxisFormatSecondary?: string;\n  yAxisTitleSecondary: string;\n  yAxisBounds: [number | undefined | null, number | undefined | null];\n  yAxisBoundsSecondary: [number | undefined | null, number | undefined | null];\n  xAxisTimeFormat?: string;\n  truncateYAxis: boolean;\n  truncateYAxisSecondary: boolean;\n  timeGrainSqla?: TimeGranularity;\n  tooltipTimeFormat?: string;\n  zoomable: boolean;\n  richTooltip: boolean;\n  xAxisLabelRotation: number;\n  colorScheme?: string;\n  // types specific to Query A and Query B\n  area: boolean;\n  areaB: boolean;\n  contributionMode?: ContributionType;\n  contributionModeB?: ContributionType;\n  markerEnabled: boolean;\n  markerEnabledB: boolean;\n  markerSize: number;\n  markerSizeB: number;\n  opacity: number;\n  opacityB: number;\n  orderDesc: boolean;\n  orderDescB: boolean;\n  rowLimit: number;\n  rowLimitB: number;\n  seriesType: EchartsTimeseriesSeriesType;\n  seriesTypeB: EchartsTimeseriesSeriesType;\n  showValue: boolean;\n  showValueB: boolean;\n  stack: StackType;\n  stackB: StackType;\n  yAxisIndex?: number;\n  yAxisIndexB?: number;\n  groupby: QueryFormColumn[];\n  groupbyB: QueryFormColumn[];\n} & LegendFormData &\n  TitleFormData;\n\n// @ts-ignore\nexport const DEFAULT_FORM_DATA: EchartsMixedTimeseriesFormData = {\n  ...DEFAULT_LEGEND_FORM_DATA,\n  annotationLayers: [],\n  minorSplitLine: TIMESERIES_DEFAULTS.minorSplitLine,\n  truncateYAxis: TIMESERIES_DEFAULTS.truncateYAxis,\n  truncateYAxisSecondary: TIMESERIES_DEFAULTS.truncateYAxis,\n  logAxis: TIMESERIES_DEFAULTS.logAxis,\n  logAxisSecondary: TIMESERIES_DEFAULTS.logAxis,\n  yAxisBounds: TIMESERIES_DEFAULTS.yAxisBounds,\n  yAxisBoundsSecondary: TIMESERIES_DEFAULTS.yAxisBounds,\n  yAxisFormat: TIMESERIES_DEFAULTS.yAxisFormat,\n  yAxisFormatSecondary: TIMESERIES_DEFAULTS.yAxisFormat,\n  yAxisTitleSecondary: DEFAULT_TITLE_FORM_DATA.yAxisTitle,\n  tooltipTimeFormat: TIMESERIES_DEFAULTS.tooltipTimeFormat,\n  xAxisBounds: TIMESERIES_DEFAULTS.xAxisBounds,\n  xAxisForceCategorical: TIMESERIES_DEFAULTS.xAxisForceCategorical,\n  xAxisTimeFormat: TIMESERIES_DEFAULTS.xAxisTimeFormat,\n  area: TIMESERIES_DEFAULTS.area,\n  areaB: TIMESERIES_DEFAULTS.area,\n  markerEnabled: TIMESERIES_DEFAULTS.markerEnabled,\n  markerEnabledB: TIMESERIES_DEFAULTS.markerEnabled,\n  markerSize: TIMESERIES_DEFAULTS.markerSize,\n  markerSizeB: TIMESERIES_DEFAULTS.markerSize,\n  opacity: TIMESERIES_DEFAULTS.opacity,\n  opacityB: TIMESERIES_DEFAULTS.opacity,\n  orderDesc: TIMESERIES_DEFAULTS.orderDesc,\n  orderDescB: TIMESERIES_DEFAULTS.orderDesc,\n  rowLimit: TIMESERIES_DEFAULTS.rowLimit,\n  rowLimitB: TIMESERIES_DEFAULTS.rowLimit,\n  seriesType: TIMESERIES_DEFAULTS.seriesType,\n  seriesTypeB: TIMESERIES_DEFAULTS.seriesType,\n  showValue: TIMESERIES_DEFAULTS.showValue,\n  showValueB: TIMESERIES_DEFAULTS.showValue,\n  stack: TIMESERIES_DEFAULTS.stack,\n  stackB: TIMESERIES_DEFAULTS.stack,\n  yAxisIndex: 0,\n  yAxisIndexB: 0,\n  groupby: [],\n  groupbyB: [],\n  zoomable: TIMESERIES_DEFAULTS.zoomable,\n  richTooltip: TIMESERIES_DEFAULTS.richTooltip,\n  xAxisLabelRotation: TIMESERIES_DEFAULTS.xAxisLabelRotation,\n  ...DEFAULT_TITLE_FORM_DATA,\n};\n\nexport interface EchartsMixedTimeseriesProps\n  extends BaseChartProps<EchartsMixedTimeseriesFormData> {\n  formData: EchartsMixedTimeseriesFormData;\n}\n\nexport type EchartsMixedTimeseriesChartTransformedProps =\n  BaseTransformedProps<EchartsMixedTimeseriesFormData> &\n    ContextMenuTransformedProps &\n    CrossFilterTransformedProps & {\n      groupbyB: QueryFormColumn[];\n      labelMapB: Record<string, string[]>;\n      seriesBreakdown: number;\n      xValueFormatter: TimeFormatter | StringConstructor;\n      xAxis: {\n        label: string;\n        type: AxisType;\n      };\n      onFocusedSeries: (series: string | null) => void;\n    };\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { ensureIsArray, t } from '@superset-ui/core';\nimport { cloneDeep } from 'lodash';\nimport {\n  ControlPanelConfig,\n  ControlPanelSectionConfig,\n  ControlSetRow,\n  ControlSubSectionHeader,\n  CustomControlItem,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nimport { DEFAULT_FORM_DATA } from './types';\nimport { EchartsTimeseriesSeriesType } from '../Timeseries/types';\nimport {\n  legendSection,\n  minorTicks,\n  richTooltipSection,\n  truncateXAxis,\n  xAxisBounds,\n  xAxisLabelRotation,\n} from '../controls';\n\nconst {\n  area,\n  logAxis,\n  markerEnabled,\n  markerSize,\n  minorSplitLine,\n  opacity,\n  orderDesc,\n  rowLimit,\n  seriesType,\n  showValues,\n  stack,\n  truncateYAxis,\n  yAxisBounds,\n  zoomable,\n  yAxisIndex,\n} = DEFAULT_FORM_DATA;\n\nfunction createQuerySection(\n  label: string,\n  controlSuffix: string,\n): ControlPanelSectionConfig {\n  return {\n    label,\n    expanded: true,\n    controlSetRows: [\n      [\n        {\n          name: `metrics${controlSuffix}`,\n          config: sharedControls.metrics,\n        },\n      ],\n      [\n        {\n          name: `groupby${controlSuffix}`,\n          config: sharedControls.groupby,\n        },\n      ],\n      [\n        {\n          name: `adhoc_filters${controlSuffix}`,\n          config: sharedControls.adhoc_filters,\n        },\n      ],\n      [\n        {\n          name: `limit${controlSuffix}`,\n          config: sharedControls.limit,\n        },\n      ],\n      [\n        {\n          name: `timeseries_limit_metric${controlSuffix}`,\n          config: sharedControls.timeseries_limit_metric,\n        },\n      ],\n      [\n        {\n          name: `order_desc${controlSuffix}`,\n          config: {\n            type: 'CheckboxControl',\n            label: t('Sort Descending'),\n            default: orderDesc,\n            description: t('Whether to sort descending or ascending'),\n          },\n        },\n      ],\n      [\n        {\n          name: `row_limit${controlSuffix}`,\n          config: {\n            ...sharedControls.row_limit,\n            default: rowLimit,\n          },\n        },\n      ],\n      [\n        {\n          name: `truncate_metric${controlSuffix}`,\n          config: {\n            ...sharedControls.truncate_metric,\n            default: sharedControls.truncate_metric.default,\n          },\n        },\n      ],\n    ],\n  };\n}\n\nfunction createCustomizeSection(\n  label: string,\n  controlSuffix: string,\n): ControlSetRow[] {\n  return [\n    [<ControlSubSectionHeader>{label}</ControlSubSectionHeader>],\n    [\n      {\n        name: `seriesType${controlSuffix}`,\n        config: {\n          type: 'SelectControl',\n          label: t('Series type'),\n          renderTrigger: true,\n          default: seriesType,\n          choices: [\n            [EchartsTimeseriesSeriesType.Line, t('Line')],\n            [EchartsTimeseriesSeriesType.Scatter, t('Scatter')],\n            [EchartsTimeseriesSeriesType.Smooth, t('Smooth Line')],\n            [EchartsTimeseriesSeriesType.Bar, t('Bar')],\n            [EchartsTimeseriesSeriesType.Start, t('Step - start')],\n            [EchartsTimeseriesSeriesType.Middle, t('Step - middle')],\n            [EchartsTimeseriesSeriesType.End, t('Step - end')],\n          ],\n          description: t('Series chart type (line, bar etc)'),\n        },\n      },\n    ],\n    [\n      {\n        name: `stack${controlSuffix}`,\n        config: {\n          type: 'CheckboxControl',\n          label: t('Stack series'),\n          renderTrigger: true,\n          default: stack,\n          description: t('Stack series on top of each other'),\n        },\n      },\n    ],\n    [\n      {\n        name: `area${controlSuffix}`,\n        config: {\n          type: 'CheckboxControl',\n          label: t('Area chart'),\n          renderTrigger: true,\n          default: area,\n          description: t(\n            'Draw area under curves. Only applicable for line types.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: `show_value${controlSuffix}`,\n        config: {\n          type: 'CheckboxControl',\n          label: t('Show Values'),\n          renderTrigger: true,\n          default: showValues,\n          description: t(\n            'Whether to display the numerical values within the cells',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: `opacity${controlSuffix}`,\n        config: {\n          type: 'SliderControl',\n          label: t('Opacity'),\n          renderTrigger: true,\n          min: 0,\n          max: 1,\n          step: 0.1,\n          default: opacity,\n          description: t('Opacity of area chart.'),\n        },\n      },\n    ],\n    [\n      {\n        name: `markerEnabled${controlSuffix}`,\n        config: {\n          type: 'CheckboxControl',\n          label: t('Marker'),\n          renderTrigger: true,\n          default: markerEnabled,\n          description: t(\n            'Draw a marker on data points. Only applicable for line types.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: `markerSize${controlSuffix}`,\n        config: {\n          type: 'SliderControl',\n          label: t('Marker size'),\n          renderTrigger: true,\n          min: 0,\n          max: 100,\n          default: markerSize,\n          description: t(\n            'Size of marker. Also applies to forecast observations.',\n          ),\n        },\n      },\n    ],\n    [\n      {\n        name: `yAxisIndex${controlSuffix}`,\n        config: {\n          type: 'SelectControl',\n          label: t('Y Axis'),\n          choices: [\n            [0, t('Primary')],\n            [1, t('Secondary')],\n          ],\n          default: yAxisIndex,\n          clearable: false,\n          renderTrigger: true,\n          description: t('Primary or secondary y-axis'),\n        },\n      },\n    ],\n  ];\n}\n\nfunction createAdvancedAnalyticsSection(\n  label: string,\n  controlSuffix: string,\n): ControlPanelSectionConfig {\n  const aaWithSuffix = cloneDeep(sections.advancedAnalyticsControls);\n  aaWithSuffix.label = label;\n  if (!controlSuffix) {\n    return aaWithSuffix;\n  }\n  aaWithSuffix.controlSetRows.forEach(row =>\n    row.forEach((control: CustomControlItem) => {\n      if (control?.name) {\n        // eslint-disable-next-line no-param-reassign\n        control.name = `${control.name}${controlSuffix}`;\n      }\n    }),\n  );\n  return aaWithSuffix;\n}\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Shared query fields'),\n      expanded: true,\n      controlSetRows: [['x_axis'], ['time_grain_sqla']],\n    },\n    createQuerySection(t('Query A'), ''),\n    createAdvancedAnalyticsSection(t('Advanced analytics Query A'), ''),\n    createQuerySection(t('Query B'), '_b'),\n    createAdvancedAnalyticsSection(t('Advanced analytics Query B'), '_b'),\n    sections.annotationsAndLayersControls,\n    sections.titleControls,\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        ...createCustomizeSection(t('Query A'), ''),\n        ...createCustomizeSection(t('Query B'), 'B'),\n        [\n          {\n            name: 'zoomable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Zoom'),\n              default: zoomable,\n              renderTrigger: true,\n              description: t('Enable data zooming controls'),\n            },\n          },\n        ],\n        [minorTicks],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        ['x_axis_time_format'],\n        [xAxisLabelRotation],\n        ...richTooltipSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'minorSplitLine',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Minor Split Line'),\n              renderTrigger: true,\n              default: minorSplitLine,\n              description: t('Draw split lines for minor y-axis ticks'),\n            },\n          },\n        ],\n        [truncateXAxis],\n        [xAxisBounds],\n        [\n          {\n            name: 'truncateYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Truncate Y Axis'),\n              default: truncateYAxis,\n              renderTrigger: true,\n              description: t(\n                'Truncate Y Axis. Can be overridden by specifying a min or max bound.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Primary y-axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                'Bounds for the primary Y-axis. When left empty, the bounds are ' +\n                  'dynamically defined based on the min/max of the data. Note that ' +\n                  \"this feature will only expand the axis range. It won't \" +\n                  \"narrow the data's extent.\",\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: `y_axis_format`,\n            config: {\n              ...sharedControls.y_axis_format,\n              label: t('Primary y-axis format'),\n            },\n          },\n        ],\n        ['currency_format'],\n        [\n          {\n            name: 'logAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic scale on primary y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds_secondary',\n            config: {\n              type: 'BoundsControl',\n              label: t('Secondary y-axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                `Bounds for the secondary Y-axis. Only works when Independent Y-axis\n                bounds are enabled. When left empty, the bounds are dynamically defined\n                based on the min/max of the data. Note that this feature will only expand\n                the axis range. It won't narrow the data's extent.`,\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: `y_axis_format_secondary`,\n            config: {\n              ...sharedControls.y_axis_format,\n              label: t('Secondary y-axis format'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'currency_format_secondary',\n            config: {\n              ...sharedControls.currency_format,\n              label: t('Secondary currency format'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'yAxisTitleSecondary',\n            config: {\n              type: 'TextControl',\n              label: t('Secondary y-axis title'),\n              renderTrigger: true,\n              default: '',\n              description: t('Logarithmic y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'logAxisSecondary',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic scale on secondary y-axis'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => {\n    const groupby = getStandardizedControls().controls.columns.filter(\n      col => !ensureIsArray(formData.groupby_b).includes(col),\n    );\n    getStandardizedControls().controls.columns =\n      getStandardizedControls().controls.columns.filter(\n        col => !groupby.includes(col),\n      );\n\n    const metrics = getStandardizedControls().controls.metrics.filter(\n      metric => !ensureIsArray(formData.metrics_b).includes(metric),\n    );\n    getStandardizedControls().controls.metrics =\n      getStandardizedControls().controls.metrics.filter(\n        col => !metrics.includes(col),\n      );\n\n    return {\n      ...formData,\n      metrics,\n      groupby,\n    };\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport {\n  CurrencyFormatter,\n  ensureIsArray,\n  getNumberFormatter,\n  getTimeFormatter,\n  isSavedMetric,\n  NumberFormats,\n  QueryFormMetric,\n  smartDateDetailedFormatter,\n  smartDateFormatter,\n  TimeFormatter,\n  ValueFormatter,\n} from '@superset-ui/core';\n\nexport const getPercentFormatter = (format?: string) =>\n  getNumberFormatter(\n    !format || format === NumberFormats.SMART_NUMBER\n      ? NumberFormats.PERCENT\n      : format,\n  );\n\nexport const getYAxisFormatter = (\n  metrics: QueryFormMetric[],\n  forcePercentFormatter: boolean,\n  customFormatters: Record<string, ValueFormatter>,\n  defaultFormatter: ValueFormatter,\n  format?: string,\n) => {\n  if (forcePercentFormatter) {\n    return getPercentFormatter(format);\n  }\n  const metricsArray = ensureIsArray(metrics);\n  if (\n    metricsArray.every(isSavedMetric) &&\n    metricsArray\n      .map(metric => customFormatters[metric])\n      .every(\n        (formatter, _, formatters) =>\n          formatter instanceof CurrencyFormatter &&\n          (formatter as CurrencyFormatter)?.currency?.symbol ===\n            (formatters[0] as CurrencyFormatter)?.currency?.symbol,\n      )\n  ) {\n    return customFormatters[metricsArray[0]];\n  }\n  return defaultFormatter ?? getNumberFormatter();\n};\n\nexport function getTooltipTimeFormatter(\n  format?: string,\n): TimeFormatter | StringConstructor {\n  if (format === smartDateFormatter.id) {\n    return smartDateDetailedFormatter;\n  }\n  if (format) {\n    return getTimeFormatter(format);\n  }\n  return String;\n}\n\nexport function getXAxisFormatter(\n  format?: string,\n): TimeFormatter | StringConstructor | undefined {\n  if (format === smartDateFormatter.id || !format) {\n    return undefined;\n  }\n  if (format) {\n    return getTimeFormatter(format);\n  }\n  return String;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable camelcase */\nimport { invert } from 'lodash';\nimport {\n  AnnotationLayer,\n  AxisType,\n  buildCustomFormatters,\n  CategoricalColorNamespace,\n  CurrencyFormatter,\n  ensureIsArray,\n  GenericDataType,\n  getCustomFormatter,\n  getNumberFormatter,\n  getXAxisLabel,\n  isDefined,\n  isEventAnnotationLayer,\n  isFormulaAnnotationLayer,\n  isIntervalAnnotationLayer,\n  isPhysicalColumn,\n  isTimeseriesAnnotationLayer,\n  QueryFormData,\n  QueryFormMetric,\n  TimeseriesChartDataResponseResult,\n  TimeseriesDataRecord,\n  ValueFormatter,\n} from '@superset-ui/core';\nimport { getOriginalSeries } from '@superset-ui/chart-controls';\nimport { EChartsCoreOption, SeriesOption } from 'echarts';\nimport {\n  DEFAULT_FORM_DATA,\n  EchartsMixedTimeseriesChartTransformedProps,\n  EchartsMixedTimeseriesFormData,\n  EchartsMixedTimeseriesProps,\n} from './types';\nimport {\n  EchartsTimeseriesSeriesType,\n  ForecastSeriesEnum,\n  Refs,\n} from '../types';\nimport { parseAxisBound } from '../utils/controls';\nimport {\n  dedupSeries,\n  extractDataTotalValues,\n  extractSeries,\n  extractShowValueIndexes,\n  getAxisType,\n  getColtypesMapping,\n  getLegendProps,\n  getMinAndMaxFromBounds,\n  getOverMaxHiddenFormatter,\n} from '../utils/series';\nimport {\n  extractAnnotationLabels,\n  getAnnotationData,\n} from '../utils/annotation';\nimport {\n  extractForecastSeriesContext,\n  extractForecastValuesFromTooltipParams,\n  formatForecastTooltipSeries,\n  rebaseForecastDatum,\n} from '../utils/forecast';\nimport { convertInteger } from '../utils/convertInteger';\nimport { defaultGrid, defaultYAxis } from '../defaults';\nimport {\n  getPadding,\n  transformEventAnnotation,\n  transformFormulaAnnotation,\n  transformIntervalAnnotation,\n  transformSeries,\n  transformTimeseriesAnnotation,\n} from '../Timeseries/transformers';\nimport { TIMEGRAIN_TO_TIMESTAMP, TIMESERIES_CONSTANTS } from '../constants';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport {\n  getTooltipTimeFormatter,\n  getXAxisFormatter,\n  getYAxisFormatter,\n} from '../utils/formatters';\n\nconst getFormatter = (\n  customFormatters: Record<string, ValueFormatter>,\n  defaultFormatter: ValueFormatter,\n  metrics: QueryFormMetric[],\n  formatterKey: string,\n  forcePercentFormat: boolean,\n) => {\n  if (forcePercentFormat) {\n    return getNumberFormatter(',.0%');\n  }\n  return (\n    getCustomFormatter(customFormatters, metrics, formatterKey) ??\n    defaultFormatter\n  );\n};\n\nexport default function transformProps(\n  chartProps: EchartsMixedTimeseriesProps,\n): EchartsMixedTimeseriesChartTransformedProps {\n  const {\n    width,\n    height,\n    formData,\n    queriesData,\n    hooks,\n    filterState,\n    datasource,\n    theme,\n    inContextMenu,\n    emitCrossFilters,\n  } = chartProps;\n\n  let focusedSeries: string | null = null;\n\n  const {\n    verboseMap = {},\n    currencyFormats = {},\n    columnFormats = {},\n  } = datasource;\n  const { label_map: labelMap } =\n    queriesData[0] as TimeseriesChartDataResponseResult;\n  const { label_map: labelMapB } =\n    queriesData[1] as TimeseriesChartDataResponseResult;\n  const data1 = (queriesData[0].data || []) as TimeseriesDataRecord[];\n  const data2 = (queriesData[1].data || []) as TimeseriesDataRecord[];\n  const annotationData = getAnnotationData(chartProps);\n  const coltypeMapping = {\n    ...getColtypesMapping(queriesData[0]),\n    ...getColtypesMapping(queriesData[1]),\n  };\n  const {\n    area,\n    areaB,\n    annotationLayers,\n    colorScheme,\n    contributionMode,\n    legendOrientation,\n    legendType,\n    logAxis,\n    logAxisSecondary,\n    markerEnabled,\n    markerEnabledB,\n    markerSize,\n    markerSizeB,\n    opacity,\n    opacityB,\n    minorSplitLine,\n    minorTicks,\n    seriesType,\n    seriesTypeB,\n    showLegend,\n    showValue,\n    showValueB,\n    stack,\n    stackB,\n    truncateXAxis,\n    truncateYAxis,\n    tooltipTimeFormat,\n    yAxisFormat,\n    currencyFormat,\n    yAxisFormatSecondary,\n    currencyFormatSecondary,\n    xAxisTimeFormat,\n    yAxisBounds,\n    yAxisBoundsSecondary,\n    yAxisIndex,\n    yAxisIndexB,\n    yAxisTitleSecondary,\n    zoomable,\n    richTooltip,\n    tooltipSortByMetric,\n    xAxisBounds,\n    xAxisLabelRotation,\n    groupby,\n    groupbyB,\n    xAxis: xAxisOrig,\n    xAxisForceCategorical,\n    xAxisTitle,\n    yAxisTitle,\n    xAxisTitleMargin,\n    yAxisTitleMargin,\n    yAxisTitlePosition,\n    sliceId,\n    timeGrainSqla,\n    percentageThreshold,\n    metrics = [],\n    metricsB = [],\n  }: EchartsMixedTimeseriesFormData = { ...DEFAULT_FORM_DATA, ...formData };\n\n  const refs: Refs = {};\n  const colorScale = CategoricalColorNamespace.getScale(colorScheme as string);\n\n  let xAxisLabel = getXAxisLabel(\n    chartProps.rawFormData as QueryFormData,\n  ) as string;\n  if (\n    isPhysicalColumn(chartProps.rawFormData?.x_axis) &&\n    isDefined(verboseMap[xAxisLabel])\n  ) {\n    xAxisLabel = verboseMap[xAxisLabel];\n  }\n\n  const rebasedDataA = rebaseForecastDatum(data1, verboseMap);\n  const [rawSeriesA] = extractSeries(rebasedDataA, {\n    fillNeighborValue: stack ? 0 : undefined,\n    xAxis: xAxisLabel,\n  });\n  const rebasedDataB = rebaseForecastDatum(data2, verboseMap);\n  const [rawSeriesB] = extractSeries(rebasedDataB, {\n    fillNeighborValue: stackB ? 0 : undefined,\n    xAxis: xAxisLabel,\n  });\n\n  const dataTypes = getColtypesMapping(queriesData[0]);\n  const xAxisDataType = dataTypes?.[xAxisLabel] ?? dataTypes?.[xAxisOrig];\n  const xAxisType = getAxisType(stack, xAxisForceCategorical, xAxisDataType);\n  const series: SeriesOption[] = [];\n  const formatter = contributionMode\n    ? getNumberFormatter(',.0%')\n    : currencyFormat?.symbol\n      ? new CurrencyFormatter({\n          d3Format: yAxisFormat,\n          currency: currencyFormat,\n        })\n      : getNumberFormatter(yAxisFormat);\n  const formatterSecondary = contributionMode\n    ? getNumberFormatter(',.0%')\n    : currencyFormatSecondary?.symbol\n      ? new CurrencyFormatter({\n          d3Format: yAxisFormatSecondary,\n          currency: currencyFormatSecondary,\n        })\n      : getNumberFormatter(yAxisFormatSecondary);\n  const customFormatters = buildCustomFormatters(\n    [...ensureIsArray(metrics), ...ensureIsArray(metricsB)],\n    currencyFormats,\n    columnFormats,\n    yAxisFormat,\n    currencyFormat,\n  );\n  const customFormattersSecondary = buildCustomFormatters(\n    [...ensureIsArray(metrics), ...ensureIsArray(metricsB)],\n    currencyFormats,\n    columnFormats,\n    yAxisFormatSecondary,\n    currencyFormatSecondary,\n  );\n\n  const primarySeries = new Set<string>();\n  const secondarySeries = new Set<string>();\n  const mapSeriesIdToAxis = (\n    seriesOption: SeriesOption,\n    index?: number,\n  ): void => {\n    if (index === 1) {\n      secondarySeries.add(seriesOption.id as string);\n    } else {\n      primarySeries.add(seriesOption.id as string);\n    }\n  };\n  rawSeriesA.forEach(seriesOption =>\n    mapSeriesIdToAxis(seriesOption, yAxisIndex),\n  );\n  rawSeriesB.forEach(seriesOption =>\n    mapSeriesIdToAxis(seriesOption, yAxisIndexB),\n  );\n  const showValueIndexesA = extractShowValueIndexes(rawSeriesA, {\n    stack,\n  });\n  const showValueIndexesB = extractShowValueIndexes(rawSeriesB, {\n    stack,\n  });\n  const { totalStackedValues, thresholdValues } = extractDataTotalValues(\n    rebasedDataA,\n    {\n      stack,\n      percentageThreshold,\n      xAxisCol: xAxisLabel,\n    },\n  );\n  const {\n    totalStackedValues: totalStackedValuesB,\n    thresholdValues: thresholdValuesB,\n  } = extractDataTotalValues(rebasedDataB, {\n    stack: Boolean(stackB),\n    percentageThreshold,\n    xAxisCol: xAxisLabel,\n  });\n\n  annotationLayers\n    .filter((layer: AnnotationLayer) => layer.show)\n    .forEach((layer: AnnotationLayer) => {\n      if (isFormulaAnnotationLayer(layer))\n        series.push(\n          transformFormulaAnnotation(\n            layer,\n            data1,\n            xAxisLabel,\n            xAxisType,\n            colorScale,\n            sliceId,\n          ),\n        );\n      else if (isIntervalAnnotationLayer(layer)) {\n        series.push(\n          ...transformIntervalAnnotation(\n            layer,\n            data1,\n            annotationData,\n            colorScale,\n            theme,\n            sliceId,\n          ),\n        );\n      } else if (isEventAnnotationLayer(layer)) {\n        series.push(\n          ...transformEventAnnotation(\n            layer,\n            data1,\n            annotationData,\n            colorScale,\n            theme,\n            sliceId,\n          ),\n        );\n      } else if (isTimeseriesAnnotationLayer(layer)) {\n        series.push(\n          ...transformTimeseriesAnnotation(\n            layer,\n            markerSize,\n            data1,\n            annotationData,\n            colorScale,\n            sliceId,\n          ),\n        );\n      }\n    });\n\n  // yAxisBounds need to be parsed to replace incompatible values with undefined\n  const [xAxisMin, xAxisMax] = (xAxisBounds || []).map(parseAxisBound);\n  let [yAxisMin, yAxisMax] = (yAxisBounds || []).map(parseAxisBound);\n  let [minSecondary, maxSecondary] = (yAxisBoundsSecondary || []).map(\n    parseAxisBound,\n  );\n\n  const array = ensureIsArray(chartProps.rawFormData?.time_compare);\n  const inverted = invert(verboseMap);\n\n  rawSeriesA.forEach(entry => {\n    const entryName = String(entry.name || '');\n    const seriesName = inverted[entryName] || entryName;\n    const colorScaleKey = getOriginalSeries(seriesName, array);\n\n    const seriesFormatter = getFormatter(\n      customFormatters,\n      formatter,\n      metrics,\n      labelMap?.[seriesName]?.[0],\n      !!contributionMode,\n    );\n\n    const transformedSeries = transformSeries(\n      entry,\n      colorScale,\n      colorScaleKey,\n      {\n        area,\n        markerEnabled,\n        markerSize,\n        areaOpacity: opacity,\n        seriesType,\n        showValue,\n        stack: Boolean(stack),\n        stackIdSuffix: '\\na',\n        yAxisIndex,\n        filterState,\n        seriesKey: entry.name,\n        sliceId,\n        queryIndex: 0,\n        formatter:\n          seriesType === EchartsTimeseriesSeriesType.Bar\n            ? getOverMaxHiddenFormatter({\n                max: yAxisMax,\n                formatter: seriesFormatter,\n              })\n            : seriesFormatter,\n        showValueIndexes: showValueIndexesA,\n        totalStackedValues,\n        thresholdValues,\n      },\n    );\n    if (transformedSeries) series.push(transformedSeries);\n  });\n\n  rawSeriesB.forEach(entry => {\n    const entryName = String(entry.name || '');\n    const seriesEntry = inverted[entryName] || entryName;\n    const seriesName = `${seriesEntry} (1)`;\n    const colorScaleKey = getOriginalSeries(seriesEntry, array);\n\n    const seriesFormatter = getFormatter(\n      customFormattersSecondary,\n      formatterSecondary,\n      metricsB,\n      labelMapB?.[seriesName]?.[0],\n      !!contributionMode,\n    );\n\n    const transformedSeries = transformSeries(\n      entry,\n      colorScale,\n      colorScaleKey,\n      {\n        area: areaB,\n        markerEnabled: markerEnabledB,\n        markerSize: markerSizeB,\n        areaOpacity: opacityB,\n        seriesType: seriesTypeB,\n        showValue: showValueB,\n        stack: Boolean(stackB),\n        stackIdSuffix: '\\nb',\n        yAxisIndex: yAxisIndexB,\n        filterState,\n        seriesKey: primarySeries.has(entry.name as string)\n          ? `${entry.name} (1)`\n          : entry.name,\n        sliceId,\n        queryIndex: 1,\n        formatter:\n          seriesTypeB === EchartsTimeseriesSeriesType.Bar\n            ? getOverMaxHiddenFormatter({\n                max: maxSecondary,\n                formatter: seriesFormatter,\n              })\n            : seriesFormatter,\n        showValueIndexes: showValueIndexesB,\n        totalStackedValues: totalStackedValuesB,\n        thresholdValues: thresholdValuesB,\n      },\n    );\n    if (transformedSeries) series.push(transformedSeries);\n  });\n\n  // default to 0-100% range when doing row-level contribution chart\n  if (contributionMode === 'row' && stack) {\n    if (yAxisMin === undefined) yAxisMin = 0;\n    if (yAxisMax === undefined) yAxisMax = 1;\n    if (minSecondary === undefined) minSecondary = 0;\n    if (maxSecondary === undefined) maxSecondary = 1;\n  }\n\n  const tooltipFormatter =\n    xAxisDataType === GenericDataType.Temporal\n      ? getTooltipTimeFormatter(tooltipTimeFormat)\n      : String;\n  const xAxisFormatter =\n    xAxisDataType === GenericDataType.Temporal\n      ? getXAxisFormatter(xAxisTimeFormat)\n      : String;\n\n  const addYAxisTitleOffset = !!(yAxisTitle || yAxisTitleSecondary);\n  const addXAxisTitleOffset = !!xAxisTitle;\n\n  const chartPadding = getPadding(\n    showLegend,\n    legendOrientation,\n    addYAxisTitleOffset,\n    zoomable,\n    null,\n    addXAxisTitleOffset,\n    yAxisTitlePosition,\n    convertInteger(yAxisTitleMargin),\n    convertInteger(xAxisTitleMargin),\n  );\n\n  const { setDataMask = () => {}, onContextMenu } = hooks;\n  const alignTicks = yAxisIndex !== yAxisIndexB;\n\n  const echartOptions: EChartsCoreOption = {\n    useUTC: true,\n    grid: {\n      ...defaultGrid,\n      ...chartPadding,\n    },\n    xAxis: {\n      type: xAxisType,\n      name: xAxisTitle,\n      nameGap: convertInteger(xAxisTitleMargin),\n      nameLocation: 'middle',\n      axisLabel: {\n        formatter: xAxisFormatter,\n        rotate: xAxisLabelRotation,\n      },\n      minorTick: { show: minorTicks },\n      minInterval:\n        xAxisType === AxisType.Time && timeGrainSqla\n          ? TIMEGRAIN_TO_TIMESTAMP[timeGrainSqla]\n          : 0,\n      ...getMinAndMaxFromBounds(\n        xAxisType,\n        truncateXAxis,\n        xAxisMin,\n        xAxisMax,\n        seriesType === EchartsTimeseriesSeriesType.Bar ||\n          seriesTypeB === EchartsTimeseriesSeriesType.Bar\n          ? EchartsTimeseriesSeriesType.Bar\n          : undefined,\n      ),\n    },\n    yAxis: [\n      {\n        ...defaultYAxis,\n        type: logAxis ? 'log' : 'value',\n        min: yAxisMin,\n        max: yAxisMax,\n        minorTick: { show: minorTicks },\n        minorSplitLine: { show: minorSplitLine },\n        axisLabel: {\n          formatter: getYAxisFormatter(\n            metrics,\n            !!contributionMode,\n            customFormatters,\n            formatter,\n            yAxisFormat,\n          ),\n        },\n        scale: truncateYAxis,\n        name: yAxisTitle,\n        nameGap: convertInteger(yAxisTitleMargin),\n        nameLocation: yAxisTitlePosition === 'Left' ? 'middle' : 'end',\n        alignTicks,\n      },\n      {\n        ...defaultYAxis,\n        type: logAxisSecondary ? 'log' : 'value',\n        min: minSecondary,\n        max: maxSecondary,\n        minorTick: { show: minorTicks },\n        splitLine: { show: false },\n        minorSplitLine: { show: minorSplitLine },\n        axisLabel: {\n          formatter: getYAxisFormatter(\n            metricsB,\n            !!contributionMode,\n            customFormattersSecondary,\n            formatterSecondary,\n            yAxisFormatSecondary,\n          ),\n        },\n        scale: truncateYAxis,\n        name: yAxisTitleSecondary,\n        alignTicks,\n      },\n    ],\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu,\n      trigger: richTooltip ? 'axis' : 'item',\n      formatter: (params: any) => {\n        const xValue: number = richTooltip\n          ? params[0].value[0]\n          : params.value[0];\n        const forecastValue: any[] = richTooltip ? params : [params];\n\n        if (richTooltip && tooltipSortByMetric) {\n          forecastValue.sort((a, b) => b.data[1] - a.data[1]);\n        }\n\n        const rows: Array<string> = [`${tooltipFormatter(xValue)}`];\n        const forecastValues =\n          extractForecastValuesFromTooltipParams(forecastValue);\n\n        Object.keys(forecastValues).forEach(key => {\n          const value = forecastValues[key];\n          // if there are no dimensions, key is a verbose name of a metric,\n          // otherwise it is a comma separated string where the first part is metric name\n          let formatterKey;\n          if (primarySeries.has(key)) {\n            formatterKey =\n              groupby.length === 0 ? inverted[key] : labelMap[key]?.[0];\n          } else {\n            formatterKey =\n              groupbyB.length === 0 ? inverted[key] : labelMapB[key]?.[0];\n          }\n          const tooltipFormatter = getFormatter(\n            customFormatters,\n            formatter,\n            metrics,\n            formatterKey,\n            !!contributionMode,\n          );\n          const tooltipFormatterSecondary = getFormatter(\n            customFormattersSecondary,\n            formatterSecondary,\n            metricsB,\n            formatterKey,\n            !!contributionMode,\n          );\n          const content = formatForecastTooltipSeries({\n            ...value,\n            seriesName: key,\n            formatter: primarySeries.has(key)\n              ? tooltipFormatter\n              : tooltipFormatterSecondary,\n          });\n          const contentStyle =\n            key === focusedSeries ? 'font-weight: 700' : 'opacity: 0.7';\n          rows.push(`<span style=\"${contentStyle}\">${content}</span>`);\n        });\n        return rows.join('<br />');\n      },\n    },\n    legend: {\n      ...getLegendProps(\n        legendType,\n        legendOrientation,\n        showLegend,\n        theme,\n        zoomable,\n      ),\n      // @ts-ignore\n      data: rawSeriesA\n        .concat(rawSeriesB)\n        .filter(\n          entry =>\n            extractForecastSeriesContext((entry.name || '') as string).type ===\n            ForecastSeriesEnum.Observation,\n        )\n        .map(entry => entry.name || '')\n        .concat(extractAnnotationLabels(annotationLayers, annotationData)),\n    },\n    series: dedupSeries(series),\n    toolbox: {\n      show: zoomable,\n      top: TIMESERIES_CONSTANTS.toolboxTop,\n      right: TIMESERIES_CONSTANTS.toolboxRight,\n      feature: {\n        dataZoom: {\n          yAxisIndex: false,\n          title: {\n            zoom: 'zoom area',\n            back: 'restore zoom',\n          },\n        },\n      },\n    },\n    dataZoom: zoomable\n      ? [\n          {\n            type: 'slider',\n            start: TIMESERIES_CONSTANTS.dataZoomStart,\n            end: TIMESERIES_CONSTANTS.dataZoomEnd,\n            bottom: TIMESERIES_CONSTANTS.zoomBottom,\n          },\n        ]\n      : [],\n  };\n\n  const onFocusedSeries = (seriesName: string | null) => {\n    focusedSeries = seriesName;\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    setDataMask,\n    emitCrossFilters,\n    labelMap,\n    labelMapB,\n    groupby,\n    groupbyB,\n    seriesBreakdown: rawSeriesA.length,\n    selectedValues: filterState.selectedValues || [],\n    onContextMenu,\n    onFocusedSeries,\n    xValueFormatter: tooltipFormatter,\n    xAxis: {\n      label: xAxisLabel,\n      type: xAxisType,\n    },\n    refs,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { AnnotationType, Behavior, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.jpg';\nimport {\n  EchartsMixedTimeseriesFormData,\n  EchartsMixedTimeseriesProps,\n} from './types';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsTimeseriesChartPlugin extends EchartsChartPlugin<\n  EchartsMixedTimeseriesFormData,\n  EchartsMixedTimeseriesProps\n> {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsMixedTimeseries'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Evolution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Visualize two different series using the same x-axis. Note that both series can be visualized with a different chart type (e.g. 1 using bars and 1 using a line).',\n        ),\n        supportedAnnotationTypes: [\n          AnnotationType.Event,\n          AnnotationType.Formula,\n          AnnotationType.Interval,\n          AnnotationType.Timeseries,\n        ],\n        exampleGallery: [{ url: example }],\n        name: t('Mixed Chart'),\n        thumbnail,\n        tags: [\n          t('Advanced-Analytics'),\n          t('Aesthetic'),\n          t('ECharts'),\n          t('Experimental'),\n          t('Line'),\n          t('Multi-Variables'),\n          t('Time'),\n          t('Transformable'),\n        ],\n        queryObjectCount: 2,\n      },\n      // @ts-ignore\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const { metric, sort_by_metric } = formData;\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      ...(sort_by_metric && { orderby: [[metric, false]] }),\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { QueryFormColumn, QueryFormData } from '@superset-ui/core';\nimport {\n  BaseChartProps,\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  CrossFilterTransformedProps,\n  LegendFormData,\n  LegendOrientation,\n  LegendType,\n} from '../types';\nimport { DEFAULT_LEGEND_FORM_DATA } from '../constants';\n\nexport type EchartsPieFormData = QueryFormData &\n  LegendFormData & {\n    colorScheme?: string;\n    currentOwnValue?: string[] | null;\n    donut: boolean;\n    defaultValue?: string[] | null;\n    groupby: QueryFormColumn[];\n    innerRadius: number;\n    labelLine: boolean;\n    labelType: EchartsPieLabelType;\n    labelsOutside: boolean;\n    metric?: string;\n    outerRadius: number;\n    showLabels: boolean;\n    numberFormat: string;\n    dateFormat: string;\n    showLabelsThreshold: number;\n  };\n\nexport enum EchartsPieLabelType {\n  Key = 'key',\n  Value = 'value',\n  Percent = 'percent',\n  KeyValue = 'key_value',\n  KeyPercent = 'key_percent',\n  KeyValuePercent = 'key_value_percent',\n  ValuePercent = 'value_percent',\n}\n\nexport interface EchartsPieChartProps\n  extends BaseChartProps<EchartsPieFormData> {\n  formData: EchartsPieFormData;\n}\n\n// @ts-ignore\nexport const DEFAULT_FORM_DATA: EchartsPieFormData = {\n  ...DEFAULT_LEGEND_FORM_DATA,\n  donut: false,\n  groupby: [],\n  innerRadius: 30,\n  labelLine: false,\n  labelType: EchartsPieLabelType.Key,\n  legendOrientation: LegendOrientation.Top,\n  legendType: LegendType.Scroll,\n  numberFormat: 'SMART_NUMBER',\n  outerRadius: 70,\n  showLabels: true,\n  labelsOutside: true,\n  showLabelsThreshold: 5,\n  dateFormat: 'smart_date',\n};\n\nexport type PieChartTransformedProps =\n  BaseTransformedProps<EchartsPieFormData> &\n    ContextMenuTransformedProps &\n    CrossFilterTransformedProps;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { ensureIsInt, t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlSubSectionHeader,\n  D3_FORMAT_DOCS,\n  D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT,\n  D3_FORMAT_OPTIONS,\n  D3_TIME_FORMAT_OPTIONS,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './types';\nimport { legendSection } from '../controls';\n\nconst {\n  donut,\n  innerRadius,\n  labelsOutside,\n  labelType,\n  labelLine,\n  outerRadius,\n  numberFormat,\n  showLabels,\n} = DEFAULT_FORM_DATA;\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['groupby'],\n        ['metric'],\n        ['adhoc_filters'],\n        ['row_limit'],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              default: true,\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        [\n          {\n            name: 'show_labels_threshold',\n            config: {\n              type: 'TextControl',\n              label: t('Percentage threshold'),\n              renderTrigger: true,\n              isFloat: true,\n              default: 5,\n              description: t(\n                'Minimum threshold in percentage points for showing labels.',\n              ),\n            },\n          },\n        ],\n        ...legendSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Labels')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'label_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Label Type'),\n              default: labelType,\n              renderTrigger: true,\n              choices: [\n                ['key', t('Category Name')],\n                ['value', t('Value')],\n                ['percent', t('Percentage')],\n                ['key_value', t('Category and Value')],\n                ['key_percent', t('Category and Percentage')],\n                ['key_value_percent', t('Category, Value and Percentage')],\n                ['value_percent', t('Value and Percentage')],\n              ],\n              description: t('What should be shown on the label?'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: numberFormat,\n              choices: D3_FORMAT_OPTIONS,\n              description: `${D3_FORMAT_DOCS} ${D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT}`,\n              tokenSeparators: ['\\n', '\\t', ';'],\n            },\n          },\n        ],\n        ['currency_format'],\n        [\n          {\n            name: 'date_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date format'),\n              renderTrigger: true,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              default: 'smart_date',\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_labels',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Labels'),\n              renderTrigger: true,\n              default: showLabels,\n              description: t('Whether to display the labels.'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'labels_outside',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Put labels outside'),\n              default: labelsOutside,\n              renderTrigger: true,\n              description: t('Put the labels outside of the pie?'),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.show_labels?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'label_line',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Label Line'),\n              default: labelLine,\n              renderTrigger: true,\n              description: t(\n                'Draw line from Pie to label when labels outside?',\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.show_labels?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_total',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Total'),\n              default: false,\n              renderTrigger: true,\n              description: t('Whether to display the aggregate count'),\n            },\n          },\n        ],\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Pie shape')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'outerRadius',\n            config: {\n              type: 'SliderControl',\n              label: t('Outer Radius'),\n              renderTrigger: true,\n              min: 10,\n              max: 100,\n              step: 1,\n              default: outerRadius,\n              description: t('Outer edge of Pie chart'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'donut',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Donut'),\n              default: donut,\n              renderTrigger: true,\n              description: t('Do you want a donut or a pie?'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'innerRadius',\n            config: {\n              type: 'SliderControl',\n              label: t('Inner Radius'),\n              renderTrigger: true,\n              min: 0,\n              max: 100,\n              step: 1,\n              default: innerRadius,\n              description: t('Inner radius of donut hole'),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.donut?.value),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    series: {\n      validators: [validateNonEmpty],\n      clearable: false,\n    },\n    row_limit: {\n      default: 100,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n    groupby: getStandardizedControls().popAllColumns(),\n    row_limit:\n      ensureIsInt(formData.row_limit, 100) >= 100 ? 100 : formData.row_limit,\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CategoricalColorNamespace,\n  getColumnLabel,\n  getMetricLabel,\n  getNumberFormatter,\n  getTimeFormatter,\n  NumberFormats,\n  t,\n  ValueFormatter,\n  getValueFormatter,\n} from '@superset-ui/core';\nimport { CallbackDataParams } from 'echarts/types/src/util/types';\nimport { EChartsCoreOption, PieSeriesOption } from 'echarts';\nimport {\n  DEFAULT_FORM_DATA as DEFAULT_PIE_FORM_DATA,\n  EchartsPieChartProps,\n  EchartsPieFormData,\n  EchartsPieLabelType,\n  PieChartTransformedProps,\n} from './types';\nimport { DEFAULT_LEGEND_FORM_DATA, OpacityEnum } from '../constants';\nimport {\n  extractGroupbyLabel,\n  getChartPadding,\n  getColtypesMapping,\n  getLegendProps,\n  sanitizeHtml,\n} from '../utils/series';\nimport { defaultGrid } from '../defaults';\nimport { convertInteger } from '../utils/convertInteger';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport { Refs } from '../types';\n\nconst percentFormatter = getNumberFormatter(NumberFormats.PERCENT_2_POINT);\n\nexport function formatPieLabel({\n  params,\n  labelType,\n  numberFormatter,\n  sanitizeName = false,\n}: {\n  params: Pick<CallbackDataParams, 'name' | 'value' | 'percent'>;\n  labelType: EchartsPieLabelType;\n  numberFormatter: ValueFormatter;\n  sanitizeName?: boolean;\n}): string {\n  const { name: rawName = '', value, percent } = params;\n  const name = sanitizeName ? sanitizeHtml(rawName) : rawName;\n  const formattedValue = numberFormatter(value as number);\n  const formattedPercent = percentFormatter((percent as number) / 100);\n\n  switch (labelType) {\n    case EchartsPieLabelType.Key:\n      return name;\n    case EchartsPieLabelType.Value:\n      return formattedValue;\n    case EchartsPieLabelType.Percent:\n      return formattedPercent;\n    case EchartsPieLabelType.KeyValue:\n      return `${name}: ${formattedValue}`;\n    case EchartsPieLabelType.KeyValuePercent:\n      return `${name}: ${formattedValue} (${formattedPercent})`;\n    case EchartsPieLabelType.KeyPercent:\n      return `${name}: ${formattedPercent}`;\n    case EchartsPieLabelType.ValuePercent:\n      return `${formattedValue} (${formattedPercent})`;\n    default:\n      return name;\n  }\n}\n\nfunction getTotalValuePadding({\n  chartPadding,\n  donut,\n  width,\n  height,\n}: {\n  chartPadding: {\n    bottom: number;\n    left: number;\n    right: number;\n    top: number;\n  };\n  donut: boolean;\n  width: number;\n  height: number;\n}) {\n  const padding: {\n    left?: string;\n    top?: string;\n  } = {\n    top: donut ? 'middle' : '0',\n    left: 'center',\n  };\n  const LEGEND_HEIGHT = 15;\n  const LEGEND_WIDTH = 215;\n  if (chartPadding.top) {\n    padding.top = donut\n      ? `${50 + ((chartPadding.top - LEGEND_HEIGHT) / height / 2) * 100}%`\n      : `${((chartPadding.top + LEGEND_HEIGHT) / height) * 100}%`;\n  }\n  if (chartPadding.bottom) {\n    padding.top = donut\n      ? `${50 - ((chartPadding.bottom + LEGEND_HEIGHT) / height / 2) * 100}%`\n      : '0';\n  }\n  if (chartPadding.left) {\n    padding.left = `${\n      50 + ((chartPadding.left - LEGEND_WIDTH) / width / 2) * 100\n    }%`;\n  }\n  if (chartPadding.right) {\n    padding.left = `${\n      50 - ((chartPadding.right + LEGEND_WIDTH) / width / 2) * 100\n    }%`;\n  }\n  return padding;\n}\n\nexport default function transformProps(\n  chartProps: EchartsPieChartProps,\n): PieChartTransformedProps {\n  const {\n    formData,\n    height,\n    hooks,\n    filterState,\n    queriesData,\n    width,\n    theme,\n    inContextMenu,\n    emitCrossFilters,\n    datasource,\n  } = chartProps;\n  const { columnFormats = {}, currencyFormats = {} } = datasource;\n  const { data = [] } = queriesData[0];\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n\n  const {\n    colorScheme,\n    donut,\n    groupby,\n    innerRadius,\n    labelsOutside,\n    labelLine,\n    labelType,\n    legendMargin,\n    legendOrientation,\n    legendType,\n    metric = '',\n    numberFormat,\n    currencyFormat,\n    dateFormat,\n    outerRadius,\n    showLabels,\n    showLegend,\n    showLabelsThreshold,\n    sliceId,\n    showTotal,\n  }: EchartsPieFormData = {\n    ...DEFAULT_LEGEND_FORM_DATA,\n    ...DEFAULT_PIE_FORM_DATA,\n    ...formData,\n  };\n  const refs: Refs = {};\n  const metricLabel = getMetricLabel(metric);\n  const groupbyLabels = groupby.map(getColumnLabel);\n  const minShowLabelAngle = (showLabelsThreshold || 0) * 3.6;\n\n  const keys = data.map(datum =>\n    extractGroupbyLabel({\n      datum,\n      groupby: groupbyLabels,\n      coltypeMapping,\n      timeFormatter: getTimeFormatter(dateFormat),\n    }),\n  );\n  const labelMap = data.reduce((acc: Record<string, string[]>, datum) => {\n    const label = extractGroupbyLabel({\n      datum,\n      groupby: groupbyLabels,\n      coltypeMapping,\n      timeFormatter: getTimeFormatter(dateFormat),\n    });\n    return {\n      ...acc,\n      [label]: groupbyLabels.map(col => datum[col] as string),\n    };\n  }, {});\n\n  const { setDataMask = () => {}, onContextMenu } = hooks;\n\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme as string);\n  const numberFormatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    numberFormat,\n    currencyFormat,\n  );\n\n  let totalValue = 0;\n\n  const transformedData: PieSeriesOption[] = data.map(datum => {\n    const name = extractGroupbyLabel({\n      datum,\n      groupby: groupbyLabels,\n      coltypeMapping,\n      timeFormatter: getTimeFormatter(dateFormat),\n    });\n\n    const isFiltered =\n      filterState.selectedValues && !filterState.selectedValues.includes(name);\n    const value = datum[metricLabel];\n\n    if (typeof value === 'number' || typeof value === 'string') {\n      totalValue += convertInteger(value);\n    }\n\n    return {\n      value,\n      name,\n      itemStyle: {\n        color: colorFn(name, sliceId),\n        opacity: isFiltered\n          ? OpacityEnum.SemiTransparent\n          : OpacityEnum.NonTransparent,\n      },\n    };\n  });\n\n  const selectedValues = (filterState.selectedValues || []).reduce(\n    (acc: Record<string, number>, selectedValue: string) => {\n      const index = transformedData.findIndex(\n        ({ name }) => name === selectedValue,\n      );\n      return {\n        ...acc,\n        [index]: selectedValue,\n      };\n    },\n    {},\n  );\n\n  const formatter = (params: CallbackDataParams) =>\n    formatPieLabel({\n      params,\n      numberFormatter,\n      labelType,\n    });\n\n  const defaultLabel = {\n    formatter,\n    show: showLabels,\n    color: theme.colors.grayscale.dark2,\n  };\n\n  const chartPadding = getChartPadding(\n    showLegend,\n    legendOrientation,\n    legendMargin,\n  );\n\n  const series: PieSeriesOption[] = [\n    {\n      type: 'pie',\n      ...chartPadding,\n      animation: false,\n      radius: [`${donut ? innerRadius : 0}%`, `${outerRadius}%`],\n      center: ['50%', '50%'],\n      avoidLabelOverlap: true,\n      labelLine: labelsOutside && labelLine ? { show: true } : { show: false },\n      minShowLabelAngle,\n      label: labelsOutside\n        ? {\n            ...defaultLabel,\n            position: 'outer',\n            alignTo: 'none',\n            bleedMargin: 5,\n          }\n        : {\n            ...defaultLabel,\n            position: 'inner',\n          },\n      emphasis: {\n        label: {\n          show: true,\n          fontWeight: 'bold',\n          backgroundColor: theme.colors.grayscale.light5,\n        },\n      },\n      data: transformedData,\n    },\n  ];\n\n  const echartOptions: EChartsCoreOption = {\n    grid: {\n      ...defaultGrid,\n    },\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu,\n      trigger: 'item',\n      formatter: (params: any) =>\n        formatPieLabel({\n          params,\n          numberFormatter,\n          labelType: EchartsPieLabelType.KeyValuePercent,\n          sanitizeName: true,\n        }),\n    },\n    legend: {\n      ...getLegendProps(legendType, legendOrientation, showLegend, theme),\n      data: keys,\n    },\n    graphic: showTotal\n      ? {\n          type: 'text',\n          ...getTotalValuePadding({ chartPadding, donut, width, height }),\n          style: {\n            text: t('Total: %s', numberFormatter(totalValue)),\n            fontSize: 16,\n            fontWeight: 'bold',\n          },\n          z: 10,\n        }\n      : null,\n    series,\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    setDataMask,\n    labelMap,\n    groupby,\n    selectedValues,\n    onContextMenu,\n    refs,\n    emitCrossFilters,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Pie1.jpg';\nimport example2 from './images/Pie2.jpg';\nimport example3 from './images/Pie3.jpg';\nimport example4 from './images/Pie4.jpg';\nimport { EchartsPieChartProps, EchartsPieFormData } from './types';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsPieChartPlugin extends EchartsChartPlugin<\n  EchartsPieFormData,\n  EchartsPieChartProps\n> {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsPie'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Part of a Whole'),\n        credits: ['https://echarts.apache.org'],\n        description:\n          t(`The classic. Great for showing how much of a company each investor gets, what demographics follow your blog, or what portion of the budget goes to the military industrial complex.\n\n        Pie charts can be difficult to interpret precisely. If clarity of relative proportion is important, consider using a bar or other chart type instead.`),\n        exampleGallery: [\n          { url: example1 },\n          { url: example2 },\n          { url: example3 },\n          { url: example4 },\n        ],\n        name: t('Pie Chart'),\n        tags: [\n          t('Aesthetic'),\n          t('Categorical'),\n          t('Circular'),\n          t('Comparison'),\n          t('Percentages'),\n          t('Popular'),\n          t('Proportional'),\n          t('ECharts'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  ensureIsArray,\n  getXAxisColumn,\n  isXAxisSet,\n  normalizeOrderBy,\n  PostProcessingPivot,\n  QueryFormData,\n} from '@superset-ui/core';\nimport {\n  contributionOperator,\n  extractExtraMetrics,\n  flattenOperator,\n  isTimeComparison,\n  pivotOperator,\n  prophetOperator,\n  renameOperator,\n  resampleOperator,\n  rollingWindowOperator,\n  sortOperator,\n  timeComparePivotOperator,\n  timeCompareOperator,\n} from '@superset-ui/chart-controls';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const { groupby } = formData;\n  return buildQueryContext(formData, baseQueryObject => {\n    /* the `pivotOperatorInRuntime` determines how to pivot the dataframe returned from the raw query.\n       1. If it's a time compared query, there will return a pivoted dataframe that append time compared metrics. for instance:\n\n                            MAX(value) MAX(value)__1 year ago MIN(value) MIN(value)__1 year ago\n          city               LA                     LA         LA                     LA\n          __timestamp\n          2015-01-01      568.0                  671.0        5.0                    6.0\n          2015-02-01      407.0                  649.0        4.0                    3.0\n          2015-03-01      318.0                  465.0        0.0                    3.0\n\n       2. If it's a normal query, there will return a pivoted dataframe.\n\n                     MAX(value)  MIN(value)\n          city               LA          LA\n          __timestamp\n          2015-01-01      568.0         5.0\n          2015-02-01      407.0         4.0\n          2015-03-01      318.0         0.0\n\n     */\n    // only add series limit metric if it's explicitly needed e.g. for sorting\n    const extra_metrics = extractExtraMetrics(formData);\n\n    const pivotOperatorInRuntime: PostProcessingPivot = isTimeComparison(\n      formData,\n      baseQueryObject,\n    )\n      ? timeComparePivotOperator(formData, baseQueryObject)\n      : pivotOperator(formData, baseQueryObject);\n\n    const columns = [\n      ...(isXAxisSet(formData) ? ensureIsArray(getXAxisColumn(formData)) : []),\n      ...ensureIsArray(groupby),\n    ];\n\n    const time_offsets = isTimeComparison(formData, baseQueryObject)\n      ? formData.time_compare\n      : [];\n\n    return [\n      {\n        ...baseQueryObject,\n        metrics: [...(baseQueryObject.metrics || []), ...extra_metrics],\n        columns,\n        series_columns: groupby,\n        ...(isXAxisSet(formData) ? {} : { is_timeseries: true }),\n        // todo: move `normalizeOrderBy to extractQueryFields`\n        orderby: normalizeOrderBy(baseQueryObject).orderby,\n        time_offsets,\n        /* Note that:\n          1. The resample, rolling, cum, timeCompare operators should be after pivot.\n          2. the flatOperator makes multiIndex Dataframe into flat Dataframe\n        */\n        post_processing: [\n          pivotOperatorInRuntime,\n          rollingWindowOperator(formData, baseQueryObject),\n          timeCompareOperator(formData, baseQueryObject),\n          resampleOperator(formData, baseQueryObject),\n          renameOperator(formData, baseQueryObject),\n          contributionOperator(formData, baseQueryObject, time_offsets),\n          sortOperator(formData, baseQueryObject),\n          flattenOperator(formData, baseQueryObject),\n          // todo: move prophet before flatten\n          prophetOperator(formData, baseQueryObject),\n        ],\n      },\n    ];\n  });\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlSubSectionHeader,\n  D3_TIME_FORMAT_DOCS,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nimport { EchartsTimeseriesSeriesType } from '../types';\nimport { DEFAULT_FORM_DATA, TIME_SERIES_DESCRIPTION_TEXT } from '../constants';\nimport {\n  legendSection,\n  onlyTotalControl,\n  showValueControl,\n  richTooltipSection,\n  seriesOrderSection,\n  percentageThresholdControl,\n  xAxisLabelRotation,\n  truncateXAxis,\n  xAxisBounds,\n  minorTicks,\n} from '../../controls';\nimport { AreaChartStackControlOptions } from '../../constants';\n\nconst {\n  logAxis,\n  markerEnabled,\n  markerSize,\n  minorSplitLine,\n  opacity,\n  rowLimit,\n  seriesType,\n  truncateYAxis,\n  yAxisBounds,\n  zoomable,\n} = DEFAULT_FORM_DATA;\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.echartsTimeSeriesQueryWithXAxisSort,\n    sections.advancedAnalyticsControls,\n    sections.annotationsAndLayersControls,\n    sections.forecastIntervalControls,\n    sections.titleControls,\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ...seriesOrderSection,\n        ['color_scheme'],\n        [\n          {\n            name: 'seriesType',\n            config: {\n              type: 'SelectControl',\n              label: t('Series Style'),\n              renderTrigger: true,\n              default: seriesType,\n              choices: [\n                [EchartsTimeseriesSeriesType.Line, t('Line')],\n                [EchartsTimeseriesSeriesType.Smooth, t('Smooth Line')],\n                [EchartsTimeseriesSeriesType.Start, t('Step - start')],\n                [EchartsTimeseriesSeriesType.Middle, t('Step - middle')],\n                [EchartsTimeseriesSeriesType.End, t('Step - end')],\n              ],\n              description: t('Series chart type (line, bar etc)'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'opacity',\n            config: {\n              type: 'SliderControl',\n              label: t('Area chart opacity'),\n              renderTrigger: true,\n              min: 0,\n              max: 1,\n              step: 0.1,\n              default: opacity,\n              description: t(\n                'Opacity of Area Chart. Also applies to confidence band.',\n              ),\n            },\n          },\n        ],\n        [showValueControl],\n        [\n          {\n            name: 'stack',\n            config: {\n              type: 'SelectControl',\n              label: t('Stacked Style'),\n              renderTrigger: true,\n              choices: AreaChartStackControlOptions,\n              default: null,\n              description: t('Stack series on top of each other'),\n            },\n          },\n        ],\n        [onlyTotalControl],\n        [percentageThresholdControl],\n        [\n          {\n            name: 'show_extra_controls',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Extra Controls'),\n              renderTrigger: true,\n              default: false,\n              description: t(\n                'Whether to show extra controls or not. Extra controls ' +\n                  'include things like making mulitBar charts stacked ' +\n                  'or side by side.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markerEnabled',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Marker'),\n              renderTrigger: true,\n              default: markerEnabled,\n              description: t(\n                'Draw a marker on data points. Only applicable for line types.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markerSize',\n            config: {\n              type: 'SliderControl',\n              label: t('Marker Size'),\n              renderTrigger: true,\n              min: 0,\n              max: 20,\n              default: markerSize,\n              description: t(\n                'Size of marker. Also applies to forecast observations.',\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.markerEnabled?.value),\n            },\n          },\n        ],\n        [minorTicks],\n        [\n          {\n            name: 'zoomable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Zoom'),\n              default: zoomable,\n              renderTrigger: true,\n              description: t('Enable data zooming controls'),\n            },\n          },\n        ],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'x_axis_time_format',\n            config: {\n              ...sharedControls.x_axis_time_format,\n              default: 'smart_date',\n              description: `${D3_TIME_FORMAT_DOCS}. ${TIME_SERIES_DESCRIPTION_TEXT}`,\n            },\n          },\n        ],\n        [xAxisLabelRotation],\n        ...richTooltipSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        ['y_axis_format'],\n        ['currency_format'],\n        [\n          {\n            name: 'logAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'minorSplitLine',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Minor Split Line'),\n              renderTrigger: true,\n              default: minorSplitLine,\n              description: t('Draw split lines for minor y-axis ticks'),\n            },\n          },\n        ],\n        [truncateXAxis],\n        [xAxisBounds],\n        [\n          {\n            name: 'truncateYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Truncate Y Axis'),\n              default: truncateYAxis,\n              renderTrigger: true,\n              description: t(\n                'Truncate Y Axis. Can be overridden by specifying a min or max bound.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Y Axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                'Bounds for the Y-axis. When left empty, the bounds are ' +\n                  'dynamically defined based on the min/max of the data. Note that ' +\n                  \"this feature will only expand the axis range. It won't \" +\n                  \"narrow the data's extent.\",\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.truncateYAxis?.value),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    row_limit: {\n      default: rowLimit,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-disable camelcase */\nimport { invert } from 'lodash';\nimport {\n  AnnotationLayer,\n  AxisType,\n  buildCustomFormatters,\n  CategoricalColorNamespace,\n  CurrencyFormatter,\n  ensureIsArray,\n  GenericDataType,\n  getCustomFormatter,\n  getMetricLabel,\n  getNumberFormatter,\n  getXAxisLabel,\n  isDefined,\n  isEventAnnotationLayer,\n  isFormulaAnnotationLayer,\n  isIntervalAnnotationLayer,\n  isPhysicalColumn,\n  isTimeseriesAnnotationLayer,\n  t,\n  TimeseriesChartDataResponseResult,\n} from '@superset-ui/core';\nimport {\n  extractExtraMetrics,\n  getOriginalSeries,\n  isDerivedSeries,\n  getTimeOffset,\n} from '@superset-ui/chart-controls';\nimport { EChartsCoreOption, SeriesOption } from 'echarts';\nimport { LineStyleOption } from 'echarts/types/src/util/types';\nimport {\n  EchartsTimeseriesChartProps,\n  EchartsTimeseriesFormData,\n  OrientationType,\n  TimeseriesChartTransformedProps,\n} from './types';\nimport { DEFAULT_FORM_DATA } from './constants';\nimport { ForecastSeriesEnum, ForecastValue, Refs } from '../types';\nimport { parseAxisBound } from '../utils/controls';\nimport {\n  calculateLowerLogTick,\n  dedupSeries,\n  extractDataTotalValues,\n  extractSeries,\n  extractShowValueIndexes,\n  getAxisType,\n  getColtypesMapping,\n  getLegendProps,\n  getMinAndMaxFromBounds,\n} from '../utils/series';\nimport {\n  extractAnnotationLabels,\n  getAnnotationData,\n} from '../utils/annotation';\nimport {\n  extractForecastSeriesContext,\n  extractForecastSeriesContexts,\n  extractForecastValuesFromTooltipParams,\n  formatForecastTooltipSeries,\n  rebaseForecastDatum,\n} from '../utils/forecast';\nimport { convertInteger } from '../utils/convertInteger';\nimport { defaultGrid, defaultYAxis } from '../defaults';\nimport {\n  getBaselineSeriesForStream,\n  getPadding,\n  transformEventAnnotation,\n  transformFormulaAnnotation,\n  transformIntervalAnnotation,\n  transformSeries,\n  transformTimeseriesAnnotation,\n} from './transformers';\nimport {\n  StackControlsValue,\n  TIMEGRAIN_TO_TIMESTAMP,\n  TIMESERIES_CONSTANTS,\n} from '../constants';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport {\n  getPercentFormatter,\n  getTooltipTimeFormatter,\n  getXAxisFormatter,\n  getYAxisFormatter,\n} from '../utils/formatters';\n\nexport default function transformProps(\n  chartProps: EchartsTimeseriesChartProps,\n): TimeseriesChartTransformedProps {\n  const {\n    width,\n    height,\n    filterState,\n    legendState,\n    formData,\n    hooks,\n    queriesData,\n    datasource,\n    theme,\n    inContextMenu,\n    emitCrossFilters,\n  } = chartProps;\n\n  let focusedSeries: string | null = null;\n\n  const {\n    verboseMap = {},\n    columnFormats = {},\n    currencyFormats = {},\n  } = datasource;\n  const [queryData] = queriesData;\n  const { data = [], label_map = {} } =\n    queryData as TimeseriesChartDataResponseResult;\n\n  const dataTypes = getColtypesMapping(queryData);\n  const annotationData = getAnnotationData(chartProps);\n\n  const {\n    area,\n    annotationLayers,\n    colorScheme,\n    contributionMode,\n    forecastEnabled,\n    groupby,\n    legendOrientation,\n    legendType,\n    legendMargin,\n    logAxis,\n    markerEnabled,\n    markerSize,\n    metrics,\n    minorSplitLine,\n    minorTicks,\n    onlyTotal,\n    opacity,\n    orientation,\n    percentageThreshold,\n    richTooltip,\n    seriesType,\n    showLegend,\n    showValue,\n    sliceId,\n    sortSeriesType,\n    sortSeriesAscending,\n    timeGrainSqla,\n    timeCompare,\n    stack,\n    tooltipTimeFormat,\n    tooltipSortByMetric,\n    truncateXAxis,\n    truncateYAxis,\n    xAxis: xAxisOrig,\n    xAxisBounds,\n    xAxisForceCategorical,\n    xAxisLabelRotation,\n    xAxisSortSeries,\n    xAxisSortSeriesAscending,\n    xAxisTimeFormat,\n    xAxisTitle,\n    xAxisTitleMargin,\n    yAxisBounds,\n    yAxisFormat,\n    currencyFormat,\n    yAxisTitle,\n    yAxisTitleMargin,\n    yAxisTitlePosition,\n    zoomable,\n  }: EchartsTimeseriesFormData = { ...DEFAULT_FORM_DATA, ...formData };\n  const refs: Refs = {};\n  const groupBy = ensureIsArray(groupby);\n  const labelMap = Object.entries(label_map).reduce((acc, entry) => {\n    if (\n      entry[1].length > groupBy.length &&\n      Array.isArray(timeCompare) &&\n      timeCompare.includes(entry[1][0])\n    ) {\n      entry[1].shift();\n    }\n    return { ...acc, [entry[0]]: entry[1] };\n  }, {});\n\n  const colorScale = CategoricalColorNamespace.getScale(colorScheme as string);\n  const rebasedData = rebaseForecastDatum(data, verboseMap);\n  let xAxisLabel = getXAxisLabel(chartProps.rawFormData) as string;\n  if (\n    isPhysicalColumn(chartProps.rawFormData?.x_axis) &&\n    isDefined(verboseMap[xAxisLabel])\n  ) {\n    xAxisLabel = verboseMap[xAxisLabel];\n  }\n  const isHorizontal = orientation === OrientationType.Horizontal;\n  const { totalStackedValues, thresholdValues } = extractDataTotalValues(\n    rebasedData,\n    {\n      stack,\n      percentageThreshold,\n      xAxisCol: xAxisLabel,\n      legendState,\n    },\n  );\n  const extraMetricLabels = extractExtraMetrics(chartProps.rawFormData).map(\n    getMetricLabel,\n  );\n\n  const isMultiSeries = groupBy.length || metrics?.length > 1;\n\n  const [rawSeries, sortedTotalValues, minPositiveValue] = extractSeries(\n    rebasedData,\n    {\n      fillNeighborValue: stack && !forecastEnabled ? 0 : undefined,\n      xAxis: xAxisLabel,\n      extraMetricLabels,\n      stack,\n      totalStackedValues,\n      isHorizontal,\n      sortSeriesType,\n      sortSeriesAscending,\n      xAxisSortSeries: isMultiSeries ? xAxisSortSeries : undefined,\n      xAxisSortSeriesAscending: isMultiSeries\n        ? xAxisSortSeriesAscending\n        : undefined,\n    },\n  );\n  const showValueIndexes = extractShowValueIndexes(rawSeries, {\n    stack,\n    onlyTotal,\n    isHorizontal,\n    legendState,\n  });\n  const seriesContexts = extractForecastSeriesContexts(\n    Object.values(rawSeries).map(series => series.name as string),\n  );\n  const isAreaExpand = stack === StackControlsValue.Expand;\n  const xAxisDataType = dataTypes?.[xAxisLabel] ?? dataTypes?.[xAxisOrig];\n\n  const xAxisType = getAxisType(stack, xAxisForceCategorical, xAxisDataType);\n  const series: SeriesOption[] = [];\n\n  const forcePercentFormatter = Boolean(contributionMode || isAreaExpand);\n  const percentFormatter = getPercentFormatter(yAxisFormat);\n  const defaultFormatter = currencyFormat?.symbol\n    ? new CurrencyFormatter({ d3Format: yAxisFormat, currency: currencyFormat })\n    : getNumberFormatter(yAxisFormat);\n  const customFormatters = buildCustomFormatters(\n    metrics,\n    currencyFormats,\n    columnFormats,\n    yAxisFormat,\n    currencyFormat,\n  );\n\n  const array = ensureIsArray(chartProps.rawFormData?.time_compare);\n  const inverted = invert(verboseMap);\n\n  const offsetLineWidths = {};\n\n  rawSeries.forEach(entry => {\n    const derivedSeries = isDerivedSeries(entry, chartProps.rawFormData);\n    const lineStyle: LineStyleOption = {};\n    if (derivedSeries) {\n      const offset = getTimeOffset(\n        entry,\n        ensureIsArray(chartProps.rawFormData?.time_compare),\n      )!;\n      if (!offsetLineWidths[offset]) {\n        offsetLineWidths[offset] = Object.keys(offsetLineWidths).length + 1;\n      }\n      lineStyle.type = 'dashed';\n      lineStyle.width = offsetLineWidths[offset];\n    }\n\n    const entryName = String(entry.name || '');\n    const seriesName = inverted[entryName] || entryName;\n    const colorScaleKey = getOriginalSeries(seriesName, array);\n\n    const transformedSeries = transformSeries(\n      entry,\n      colorScale,\n      colorScaleKey,\n      {\n        area,\n        connectNulls: derivedSeries,\n        filterState,\n        seriesContexts,\n        markerEnabled,\n        markerSize,\n        areaOpacity: opacity,\n        seriesType,\n        legendState,\n        stack,\n        formatter: forcePercentFormatter\n          ? percentFormatter\n          : getCustomFormatter(\n              customFormatters,\n              metrics,\n              labelMap?.[seriesName]?.[0],\n            ) ?? defaultFormatter,\n        showValue,\n        onlyTotal,\n        totalStackedValues: sortedTotalValues,\n        showValueIndexes,\n        thresholdValues,\n        richTooltip,\n        sliceId,\n        isHorizontal,\n        lineStyle,\n      },\n    );\n    if (transformedSeries) {\n      if (stack === StackControlsValue.Stream) {\n        // bug in Echarts - `stackStrategy: 'all'` doesn't work with nulls, so we cast them to 0\n        series.push({\n          ...transformedSeries,\n          data: (transformedSeries.data as any).map(\n            (row: [string | number, number]) => [row[0], row[1] ?? 0],\n          ),\n        });\n      } else {\n        series.push(transformedSeries);\n      }\n    }\n  });\n\n  if (stack === StackControlsValue.Stream) {\n    const baselineSeries = getBaselineSeriesForStream(\n      series.map(entry => entry.data) as [string | number, number][][],\n      seriesType,\n    );\n\n    series.unshift(baselineSeries);\n  }\n  const selectedValues = (filterState.selectedValues || []).reduce(\n    (acc: Record<string, number>, selectedValue: string) => {\n      const index = series.findIndex(({ name }) => name === selectedValue);\n      return {\n        ...acc,\n        [index]: selectedValue,\n      };\n    },\n    {},\n  );\n\n  annotationLayers\n    .filter((layer: AnnotationLayer) => layer.show)\n    .forEach((layer: AnnotationLayer) => {\n      if (isFormulaAnnotationLayer(layer))\n        series.push(\n          transformFormulaAnnotation(\n            layer,\n            data,\n            xAxisLabel,\n            xAxisType,\n            colorScale,\n            sliceId,\n          ),\n        );\n      else if (isIntervalAnnotationLayer(layer)) {\n        series.push(\n          ...transformIntervalAnnotation(\n            layer,\n            data,\n            annotationData,\n            colorScale,\n            theme,\n            sliceId,\n          ),\n        );\n      } else if (isEventAnnotationLayer(layer)) {\n        series.push(\n          ...transformEventAnnotation(\n            layer,\n            data,\n            annotationData,\n            colorScale,\n            theme,\n            sliceId,\n          ),\n        );\n      } else if (isTimeseriesAnnotationLayer(layer)) {\n        series.push(\n          ...transformTimeseriesAnnotation(\n            layer,\n            markerSize,\n            data,\n            annotationData,\n            colorScale,\n            sliceId,\n          ),\n        );\n      }\n    });\n\n  // axis bounds need to be parsed to replace incompatible values with undefined\n  const [xAxisMin, xAxisMax] = (xAxisBounds || []).map(parseAxisBound);\n  let [yAxisMin, yAxisMax] = (yAxisBounds || []).map(parseAxisBound);\n\n  // default to 0-100% range when doing row-level contribution chart\n  if ((contributionMode === 'row' || isAreaExpand) && stack) {\n    if (yAxisMin === undefined) yAxisMin = 0;\n    if (yAxisMax === undefined) yAxisMax = 1;\n  } else if (\n    logAxis &&\n    yAxisMin === undefined &&\n    minPositiveValue !== undefined\n  ) {\n    yAxisMin = calculateLowerLogTick(minPositiveValue);\n  }\n\n  const tooltipFormatter =\n    xAxisDataType === GenericDataType.Temporal\n      ? getTooltipTimeFormatter(tooltipTimeFormat)\n      : String;\n  const xAxisFormatter =\n    xAxisDataType === GenericDataType.Temporal\n      ? getXAxisFormatter(xAxisTimeFormat)\n      : String;\n\n  const {\n    setDataMask = () => {},\n    setControlValue = () => {},\n    onContextMenu,\n    onLegendStateChanged,\n  } = hooks;\n\n  const addYAxisLabelOffset = !!yAxisTitle;\n  const addXAxisLabelOffset = !!xAxisTitle;\n  const padding = getPadding(\n    showLegend,\n    legendOrientation,\n    addYAxisLabelOffset,\n    zoomable,\n    legendMargin,\n    addXAxisLabelOffset,\n    yAxisTitlePosition,\n    convertInteger(yAxisTitleMargin),\n    convertInteger(xAxisTitleMargin),\n    isHorizontal,\n  );\n\n  const legendData = rawSeries\n    .filter(\n      entry =>\n        extractForecastSeriesContext(entry.name || '').type ===\n        ForecastSeriesEnum.Observation,\n    )\n    .map(entry => entry.name || '')\n    .concat(extractAnnotationLabels(annotationLayers, annotationData));\n\n  let xAxis: any = {\n    type: xAxisType,\n    name: xAxisTitle,\n    nameGap: convertInteger(xAxisTitleMargin),\n    nameLocation: 'middle',\n    axisLabel: {\n      hideOverlap: true,\n      formatter: xAxisFormatter,\n      rotate: xAxisLabelRotation,\n    },\n    minorTick: { show: minorTicks },\n    minInterval:\n      xAxisType === AxisType.Time && timeGrainSqla\n        ? TIMEGRAIN_TO_TIMESTAMP[timeGrainSqla]\n        : 0,\n    ...getMinAndMaxFromBounds(\n      xAxisType,\n      truncateXAxis,\n      xAxisMin,\n      xAxisMax,\n      seriesType,\n    ),\n  };\n\n  let yAxis: any = {\n    ...defaultYAxis,\n    type: logAxis ? AxisType.Log : AxisType.Value,\n    min: yAxisMin,\n    max: yAxisMax,\n    minorTick: { show: minorTicks },\n    minorSplitLine: { show: minorSplitLine },\n    axisLabel: {\n      formatter: getYAxisFormatter(\n        metrics,\n        forcePercentFormatter,\n        customFormatters,\n        defaultFormatter,\n        yAxisFormat,\n      ),\n    },\n    scale: truncateYAxis,\n    name: yAxisTitle,\n    nameGap: convertInteger(yAxisTitleMargin),\n    nameLocation: yAxisTitlePosition === 'Left' ? 'middle' : 'end',\n  };\n\n  if (isHorizontal) {\n    [xAxis, yAxis] = [yAxis, xAxis];\n    [padding.bottom, padding.left] = [padding.left, padding.bottom];\n  }\n\n  const echartOptions: EChartsCoreOption = {\n    useUTC: true,\n    grid: {\n      ...defaultGrid,\n      ...padding,\n    },\n    xAxis,\n    yAxis,\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu,\n      trigger: richTooltip ? 'axis' : 'item',\n      formatter: (params: any) => {\n        const [xIndex, yIndex] = isHorizontal ? [1, 0] : [0, 1];\n        const xValue: number = richTooltip\n          ? params[0].value[xIndex]\n          : params.value[xIndex];\n        const forecastValue: any[] = richTooltip ? params : [params];\n\n        if (richTooltip && tooltipSortByMetric) {\n          forecastValue.sort((a, b) => b.data[yIndex] - a.data[yIndex]);\n        }\n\n        const rows: string[] = [];\n        const forecastValues: Record<string, ForecastValue> =\n          extractForecastValuesFromTooltipParams(forecastValue, isHorizontal);\n\n        Object.keys(forecastValues).forEach(key => {\n          const value = forecastValues[key];\n          if (value.observation === 0 && stack) {\n            return;\n          }\n          // if there are no dimensions, key is a verbose name of a metric,\n          // otherwise it is a comma separated string where the first part is metric name\n          const formatterKey =\n            groupBy.length === 0 ? inverted[key] : labelMap[key]?.[0];\n          const content = formatForecastTooltipSeries({\n            ...value,\n            seriesName: key,\n            formatter: forcePercentFormatter\n              ? percentFormatter\n              : getCustomFormatter(customFormatters, metrics, formatterKey) ??\n                defaultFormatter,\n          });\n          const contentStyle =\n            key === focusedSeries ? 'font-weight: 700' : 'opacity: 0.7';\n          rows.push(`<span style=\"${contentStyle}\">${content}</span>`);\n        });\n        if (stack) {\n          rows.reverse();\n        }\n        rows.unshift(`${tooltipFormatter(xValue)}`);\n        return rows.join('<br />');\n      },\n    },\n    legend: {\n      ...getLegendProps(\n        legendType,\n        legendOrientation,\n        showLegend,\n        theme,\n        zoomable,\n        legendState,\n      ),\n      data: legendData as string[],\n    },\n    series: dedupSeries(series),\n    toolbox: {\n      show: zoomable,\n      top: TIMESERIES_CONSTANTS.toolboxTop,\n      right: TIMESERIES_CONSTANTS.toolboxRight,\n      feature: {\n        dataZoom: {\n          ...(stack ? { yAxisIndex: false } : {}), // disable y-axis zoom for stacked charts\n          title: {\n            zoom: t('zoom area'),\n            back: t('restore zoom'),\n          },\n        },\n      },\n    },\n    dataZoom: zoomable\n      ? [\n          {\n            type: 'slider',\n            start: TIMESERIES_CONSTANTS.dataZoomStart,\n            end: TIMESERIES_CONSTANTS.dataZoomEnd,\n            bottom: TIMESERIES_CONSTANTS.zoomBottom,\n            yAxisIndex: isHorizontal ? 0 : undefined,\n          },\n        ]\n      : [],\n  };\n\n  const onFocusedSeries = (seriesName: string | null) => {\n    focusedSeries = seriesName;\n  };\n\n  return {\n    echartOptions,\n    emitCrossFilters,\n    formData,\n    groupby: groupBy,\n    height,\n    labelMap,\n    selectedValues,\n    setDataMask,\n    setControlValue,\n    width,\n    legendData,\n    onContextMenu,\n    onLegendStateChanged,\n    onFocusedSeries,\n    xValueFormatter: tooltipFormatter,\n    xAxis: {\n      label: xAxisLabel,\n      type: xAxisType,\n    },\n    refs,\n    coltypeMapping: dataTypes,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, AnnotationType, Behavior } from '@superset-ui/core';\nimport buildQuery from '../buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from '../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport {\n  EchartsTimeseriesChartProps,\n  EchartsTimeseriesFormData,\n} from '../types';\nimport example1 from './images/Area1.png';\nimport { EchartsChartPlugin } from '../../types';\n\nconst areaTransformProps = (chartProps: EchartsTimeseriesChartProps) =>\n  transformProps({\n    ...chartProps,\n    formData: { ...chartProps.formData, area: true },\n  });\n\nexport default class EchartsAreaChartPlugin extends EchartsChartPlugin<\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../EchartsTimeseries'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Evolution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Area charts are similar to line charts in that they represent variables with the same scale, but area charts stack the metrics on top of each other.',\n        ),\n        exampleGallery: [{ url: example1 }],\n        supportedAnnotationTypes: [\n          AnnotationType.Event,\n          AnnotationType.Formula,\n          AnnotationType.Interval,\n          AnnotationType.Timeseries,\n        ],\n        name: t('Area Chart'),\n        tags: [\n          t('ECharts'),\n          t('Predictive'),\n          t('Advanced-Analytics'),\n          t('Aesthetic'),\n          t('Time'),\n          t('Line'),\n          t('Transformable'),\n          t('Stacked'),\n          t('Popular'),\n        ],\n        thumbnail,\n      },\n      transformProps: areaTransformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlSubSectionHeader,\n  D3_TIME_FORMAT_DOCS,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nimport { EchartsTimeseriesSeriesType } from '../../types';\nimport {\n  DEFAULT_FORM_DATA,\n  TIME_SERIES_DESCRIPTION_TEXT,\n} from '../../constants';\nimport {\n  legendSection,\n  minorTicks,\n  richTooltipSection,\n  seriesOrderSection,\n  showValueSection,\n  truncateXAxis,\n  xAxisBounds,\n  xAxisLabelRotation,\n} from '../../../controls';\n\nconst {\n  area,\n  logAxis,\n  markerEnabled,\n  markerSize,\n  minorSplitLine,\n  opacity,\n  rowLimit,\n  seriesType,\n  truncateYAxis,\n  yAxisBounds,\n  zoomable,\n} = DEFAULT_FORM_DATA;\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.echartsTimeSeriesQueryWithXAxisSort,\n    sections.advancedAnalyticsControls,\n    sections.annotationsAndLayersControls,\n    sections.forecastIntervalControls,\n    sections.titleControls,\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ...seriesOrderSection,\n        ['color_scheme'],\n        [\n          {\n            name: 'seriesType',\n            config: {\n              type: 'SelectControl',\n              label: t('Series Style'),\n              renderTrigger: true,\n              default: seriesType,\n              choices: [\n                [EchartsTimeseriesSeriesType.Line, t('Line')],\n                [EchartsTimeseriesSeriesType.Scatter, t('Scatter')],\n                [EchartsTimeseriesSeriesType.Smooth, t('Smooth Line')],\n                [EchartsTimeseriesSeriesType.Bar, t('Bar')],\n                [EchartsTimeseriesSeriesType.Start, t('Step - start')],\n                [EchartsTimeseriesSeriesType.Middle, t('Step - middle')],\n                [EchartsTimeseriesSeriesType.End, t('Step - end')],\n              ],\n              description: t('Series chart type (line, bar etc)'),\n            },\n          },\n        ],\n        ...showValueSection,\n        [\n          {\n            name: 'area',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Area Chart'),\n              renderTrigger: true,\n              default: area,\n              description: t(\n                'Draw area under curves. Only applicable for line types.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'opacity',\n            config: {\n              type: 'SliderControl',\n              label: t('Area chart opacity'),\n              renderTrigger: true,\n              min: 0,\n              max: 1,\n              step: 0.1,\n              default: opacity,\n              description: t(\n                'Opacity of Area Chart. Also applies to confidence band.',\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.area?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markerEnabled',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Marker'),\n              renderTrigger: true,\n              default: markerEnabled,\n              description: t(\n                'Draw a marker on data points. Only applicable for line types.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markerSize',\n            config: {\n              type: 'SliderControl',\n              label: t('Marker Size'),\n              renderTrigger: true,\n              min: 0,\n              max: 20,\n              default: markerSize,\n              description: t(\n                'Size of marker. Also applies to forecast observations.',\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.markerEnabled?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'zoomable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Zoom'),\n              default: zoomable,\n              renderTrigger: true,\n              description: t('Enable data zooming controls'),\n            },\n          },\n        ],\n        [minorTicks],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'x_axis_time_format',\n            config: {\n              ...sharedControls.x_axis_time_format,\n              default: 'smart_date',\n              description: `${D3_TIME_FORMAT_DOCS}. ${TIME_SERIES_DESCRIPTION_TEXT}`,\n            },\n          },\n        ],\n        [xAxisLabelRotation],\n        ...richTooltipSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        ['y_axis_format'],\n        ['currency_format'],\n        [\n          {\n            name: 'logAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'minorSplitLine',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Minor Split Line'),\n              renderTrigger: true,\n              default: minorSplitLine,\n              description: t('Draw split lines for minor y-axis ticks'),\n            },\n          },\n        ],\n        [truncateXAxis],\n        [xAxisBounds],\n        [\n          {\n            name: 'truncateYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Truncate Y Axis'),\n              default: truncateYAxis,\n              renderTrigger: true,\n              description: t(\n                'Truncate Y Axis. Can be overridden by specifying a min or max bound.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Y Axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                'Bounds for the Y-axis. When left empty, the bounds are ' +\n                  'dynamically defined based on the min/max of the data. Note that ' +\n                  \"this feature will only expand the axis range. It won't \" +\n                  \"narrow the data's extent.\",\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.truncateYAxis?.value),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    row_limit: {\n      default: rowLimit,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { AnnotationType, Behavior, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './Regular/Line/controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport {\n  EchartsTimeseriesChartProps,\n  EchartsTimeseriesFormData,\n} from './types';\nimport example from './images/Time-series_Chart.jpg';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsTimeseriesChartPlugin extends EchartsChartPlugin<\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsTimeseries'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Evolution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Swiss army knife for visualizing data. Choose between step, line, scatter, and bar charts. This viz type has many customization options as well.',\n        ),\n        exampleGallery: [{ url: example }],\n        supportedAnnotationTypes: [\n          AnnotationType.Event,\n          AnnotationType.Formula,\n          AnnotationType.Interval,\n          AnnotationType.Timeseries,\n        ],\n        name: t('Generic Chart'),\n        tags: [\n          t('Advanced-Analytics'),\n          t('Aesthetic'),\n          t('Line'),\n          t('Predictive'),\n          t('Time'),\n          t('Transformable'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlSetRow,\n  ControlStateMapping,\n  ControlSubSectionHeader,\n  D3_TIME_FORMAT_DOCS,\n  formatSelectOptions,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport {\n  legendSection,\n  minorTicks,\n  richTooltipSection,\n  seriesOrderSection,\n  showValueSection,\n  truncateXAxis,\n  xAxisBounds,\n  xAxisLabelRotation,\n} from '../../../controls';\n\nimport { OrientationType } from '../../types';\nimport {\n  DEFAULT_FORM_DATA,\n  TIME_SERIES_DESCRIPTION_TEXT,\n} from '../../constants';\n\nconst {\n  logAxis,\n  minorSplitLine,\n  truncateYAxis,\n  yAxisBounds,\n  zoomable,\n  orientation,\n} = DEFAULT_FORM_DATA;\n\nfunction createAxisTitleControl(axis: 'x' | 'y'): ControlSetRow[] {\n  const isXAxis = axis === 'x';\n  const isVertical = (controls: ControlStateMapping) =>\n    Boolean(controls?.orientation.value === OrientationType.Vertical);\n  const isHorizontal = (controls: ControlStateMapping) =>\n    Boolean(controls?.orientation.value === OrientationType.Horizontal);\n  return [\n    [\n      {\n        name: 'x_axis_title',\n        config: {\n          type: 'TextControl',\n          label: t('Axis Title'),\n          renderTrigger: true,\n          default: '',\n          description: t('Changing this control takes effect instantly'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isVertical(controls) : isHorizontal(controls),\n        },\n      },\n    ],\n    [\n      {\n        name: 'x_axis_title_margin',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          clearable: true,\n          label: t('AXIS TITLE MARGIN'),\n          renderTrigger: true,\n          default: sections.TITLE_MARGIN_OPTIONS[0],\n          choices: formatSelectOptions(sections.TITLE_MARGIN_OPTIONS),\n          description: t('Changing this control takes effect instantly'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isVertical(controls) : isHorizontal(controls),\n        },\n      },\n    ],\n    [\n      {\n        name: 'y_axis_title',\n        config: {\n          type: 'TextControl',\n          label: t('Axis Title'),\n          renderTrigger: true,\n          default: '',\n          description: t('Changing this control takes effect instantly'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isHorizontal(controls) : isVertical(controls),\n        },\n      },\n    ],\n    [\n      {\n        name: 'y_axis_title_margin',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          clearable: true,\n          label: t('AXIS TITLE MARGIN'),\n          renderTrigger: true,\n          default: sections.TITLE_MARGIN_OPTIONS[0],\n          choices: formatSelectOptions(sections.TITLE_MARGIN_OPTIONS),\n          description: t('Changing this control takes effect instantly'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isHorizontal(controls) : isVertical(controls),\n        },\n      },\n    ],\n    [\n      {\n        name: 'y_axis_title_position',\n        config: {\n          type: 'SelectControl',\n          freeForm: true,\n          clearable: false,\n          label: t('AXIS TITLE POSITION'),\n          renderTrigger: true,\n          default: sections.TITLE_POSITION_OPTIONS[0][0],\n          choices: sections.TITLE_POSITION_OPTIONS,\n          description: t('Changing this control takes effect instantly'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isHorizontal(controls) : isVertical(controls),\n        },\n      },\n    ],\n  ];\n}\n\nfunction createAxisControl(axis: 'x' | 'y'): ControlSetRow[] {\n  const isXAxis = axis === 'x';\n  const isVertical = (controls: ControlStateMapping) =>\n    Boolean(controls?.orientation.value === OrientationType.Vertical);\n  const isHorizontal = (controls: ControlStateMapping) =>\n    Boolean(controls?.orientation.value === OrientationType.Horizontal);\n  return [\n    [\n      {\n        name: 'x_axis_time_format',\n        config: {\n          ...sharedControls.x_axis_time_format,\n          default: 'smart_date',\n          description: `${D3_TIME_FORMAT_DOCS}. ${TIME_SERIES_DESCRIPTION_TEXT}`,\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isVertical(controls) : isHorizontal(controls),\n        },\n      },\n    ],\n    [\n      {\n        name: xAxisLabelRotation.name,\n        config: {\n          ...xAxisLabelRotation.config,\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isVertical(controls) : isHorizontal(controls),\n        },\n      },\n    ],\n    [\n      {\n        name: 'y_axis_format',\n        config: {\n          ...sharedControls.y_axis_format,\n          label: t('Axis Format'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isHorizontal(controls) : isVertical(controls),\n        },\n      },\n    ],\n    ['currency_format'],\n    [\n      {\n        name: 'logAxis',\n        config: {\n          type: 'CheckboxControl',\n          label: t('Logarithmic axis'),\n          renderTrigger: true,\n          default: logAxis,\n          description: t('Logarithmic axis'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isHorizontal(controls) : isVertical(controls),\n        },\n      },\n    ],\n    [\n      {\n        name: 'minorSplitLine',\n        config: {\n          type: 'CheckboxControl',\n          label: t('Minor Split Line'),\n          renderTrigger: true,\n          default: minorSplitLine,\n          description: t('Draw split lines for minor axis ticks'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isHorizontal(controls) : isVertical(controls),\n        },\n      },\n    ],\n    [truncateXAxis],\n    [xAxisBounds],\n    [\n      {\n        name: 'truncateYAxis',\n        config: {\n          type: 'CheckboxControl',\n          label: t('Truncate Axis'),\n          default: truncateYAxis,\n          renderTrigger: true,\n          description: t('Its not recommended to truncate axis in Bar chart.'),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            isXAxis ? isHorizontal(controls) : isVertical(controls),\n        },\n      },\n    ],\n    [\n      {\n        name: 'y_axis_bounds',\n        config: {\n          type: 'BoundsControl',\n          label: t('Axis Bounds'),\n          renderTrigger: true,\n          default: yAxisBounds,\n          description: t(\n            'Bounds for the axis. When left empty, the bounds are ' +\n              'dynamically defined based on the min/max of the data. Note that ' +\n              \"this feature will only expand the axis range. It won't \" +\n              \"narrow the data's extent.\",\n          ),\n          visibility: ({ controls }: ControlPanelsContainerProps) =>\n            Boolean(controls?.truncateYAxis?.value) &&\n            (isXAxis ? isHorizontal(controls) : isVertical(controls)),\n        },\n      },\n    ],\n  ];\n}\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.echartsTimeSeriesQueryWithXAxisSort,\n    sections.advancedAnalyticsControls,\n    sections.annotationsAndLayersControls,\n    sections.forecastIntervalControls,\n    {\n      label: t('Chart Orientation'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'orientation',\n            config: {\n              type: 'RadioButtonControl',\n              renderTrigger: true,\n              label: t('Bar orientation'),\n              default: orientation,\n              options: [\n                [OrientationType.Vertical, t('Vertical')],\n                [OrientationType.Horizontal, t('Horizontal')],\n              ],\n              description: t('Orientation of bar chart'),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Title'),\n      tabOverride: 'customize',\n      expanded: true,\n      controlSetRows: [\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        ...createAxisTitleControl('x'),\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        ...createAxisTitleControl('y'),\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ...seriesOrderSection,\n        ['color_scheme'],\n        ...showValueSection,\n        [minorTicks],\n        [\n          {\n            name: 'zoomable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Zoom'),\n              default: zoomable,\n              renderTrigger: true,\n              description: t('Enable data zooming controls'),\n            },\n          },\n        ],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        ...createAxisControl('x'),\n        ...richTooltipSection,\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        ...createAxisControl('y'),\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { AnnotationType, Behavior, t } from '@superset-ui/core';\nimport {\n  EchartsTimeseriesChartProps,\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesSeriesType,\n} from '../../types';\nimport { EchartsChartPlugin } from '../../../types';\nimport buildQuery from '../../buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from '../../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Bar1.png';\nimport example2 from './images/Bar2.png';\nimport example3 from './images/Bar3.png';\n\nconst barTransformProps = (chartProps: EchartsTimeseriesChartProps) =>\n  transformProps({\n    ...chartProps,\n    formData: {\n      ...chartProps.formData,\n      seriesType: EchartsTimeseriesSeriesType.Bar,\n    },\n  });\n\nexport default class EchartsTimeseriesBarChartPlugin extends EchartsChartPlugin<\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../../EchartsTimeseries'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Evolution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Bar Charts are used to show metrics as a series of bars.',\n        ),\n        exampleGallery: [\n          { url: example1 },\n          { url: example2 },\n          { url: example3 },\n        ],\n        supportedAnnotationTypes: [\n          AnnotationType.Event,\n          AnnotationType.Formula,\n          AnnotationType.Interval,\n          AnnotationType.Timeseries,\n        ],\n        name: t('Bar Chart'),\n        tags: [\n          t('ECharts'),\n          t('Predictive'),\n          t('Advanced-Analytics'),\n          t('Aesthetic'),\n          t('Time'),\n          t('Transformable'),\n          t('Stacked'),\n          t('Vertical'),\n          t('Bar'),\n          t('Popular'),\n        ],\n        thumbnail,\n      },\n      transformProps: barTransformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { AnnotationType, Behavior, t } from '@superset-ui/core';\nimport {\n  EchartsTimeseriesChartProps,\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesSeriesType,\n} from '../../types';\nimport buildQuery from '../../buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from '../../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Line1.png';\nimport example2 from './images/Line2.png';\nimport { EchartsChartPlugin } from '../../../types';\n\nconst lineTransformProps = (chartProps: EchartsTimeseriesChartProps) =>\n  transformProps({\n    ...chartProps,\n    formData: {\n      ...chartProps.formData,\n      seriesType: EchartsTimeseriesSeriesType.Line,\n    },\n  });\n\nexport default class EchartsTimeseriesLineChartPlugin extends EchartsChartPlugin<\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../../EchartsTimeseries'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Evolution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Line chart is used to visualize measurements taken over a given category. Line chart is a type of chart which displays information as a series of data points connected by straight line segments. It is a basic type of chart common in many fields.',\n        ),\n        exampleGallery: [{ url: example1 }, { url: example2 }],\n        supportedAnnotationTypes: [\n          AnnotationType.Event,\n          AnnotationType.Formula,\n          AnnotationType.Interval,\n          AnnotationType.Timeseries,\n        ],\n        name: t('Line Chart'),\n        tags: [\n          t('ECharts'),\n          t('Predictive'),\n          t('Advanced-Analytics'),\n          t('Aesthetic'),\n          t('Line'),\n          t('Popular'),\n        ],\n        thumbnail,\n      },\n      transformProps: lineTransformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlSubSectionHeader,\n  D3_TIME_FORMAT_DOCS,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nimport {\n  DEFAULT_FORM_DATA,\n  TIME_SERIES_DESCRIPTION_TEXT,\n} from '../../constants';\nimport {\n  legendSection,\n  minorTicks,\n  richTooltipSection,\n  seriesOrderSection,\n  showValueSectionWithoutStack,\n  truncateXAxis,\n  xAxisBounds,\n  xAxisLabelRotation,\n} from '../../../controls';\n\nconst {\n  logAxis,\n  markerEnabled,\n  markerSize,\n  minorSplitLine,\n  rowLimit,\n  truncateYAxis,\n  yAxisBounds,\n  zoomable,\n} = DEFAULT_FORM_DATA;\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.echartsTimeSeriesQueryWithXAxisSort,\n    sections.advancedAnalyticsControls,\n    sections.annotationsAndLayersControls,\n    sections.forecastIntervalControls,\n    sections.titleControls,\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ...seriesOrderSection,\n        ['color_scheme'],\n        ...showValueSectionWithoutStack,\n        [\n          {\n            name: 'markerEnabled',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Marker'),\n              renderTrigger: true,\n              default: markerEnabled,\n              description: t(\n                'Draw a marker on data points. Only applicable for line types.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markerSize',\n            config: {\n              type: 'SliderControl',\n              label: t('Marker Size'),\n              renderTrigger: true,\n              min: 0,\n              max: 20,\n              default: markerSize,\n              description: t(\n                'Size of marker. Also applies to forecast observations.',\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.markerEnabled?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'zoomable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Zoom'),\n              default: zoomable,\n              renderTrigger: true,\n              description: t('Enable data zooming controls'),\n            },\n          },\n        ],\n        [minorTicks],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'x_axis_time_format',\n            config: {\n              ...sharedControls.x_axis_time_format,\n              default: 'smart_date',\n              description: `${D3_TIME_FORMAT_DOCS}. ${TIME_SERIES_DESCRIPTION_TEXT}`,\n            },\n          },\n        ],\n        [xAxisLabelRotation],\n        // eslint-disable-next-line react/jsx-key\n        ...richTooltipSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n\n        ['y_axis_format'],\n        ['currency_format'],\n        [\n          {\n            name: 'logAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'minorSplitLine',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Minor Split Line'),\n              renderTrigger: true,\n              default: minorSplitLine,\n              description: t('Draw split lines for minor y-axis ticks'),\n            },\n          },\n        ],\n        [truncateXAxis],\n        [xAxisBounds],\n        [\n          {\n            name: 'truncateYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Truncate Y Axis'),\n              default: truncateYAxis,\n              renderTrigger: true,\n              description: t(\n                'Truncate Y Axis. Can be overridden by specifying a min or max bound.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Y Axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                'Bounds for the Y-axis. When left empty, the bounds are ' +\n                  'dynamically defined based on the min/max of the data. Note that ' +\n                  \"this feature will only expand the axis range. It won't \" +\n                  \"narrow the data's extent.\",\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.truncateYAxis?.value),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    row_limit: {\n      default: rowLimit,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { AnnotationType, Behavior, t } from '@superset-ui/core';\nimport {\n  EchartsTimeseriesChartProps,\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesSeriesType,\n} from '../../types';\nimport buildQuery from '../../buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from '../../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/SmoothLine1.png';\nimport { EchartsChartPlugin } from '../../../types';\n\nconst smoothTransformProps = (chartProps: EchartsTimeseriesChartProps) =>\n  transformProps({\n    ...chartProps,\n    formData: {\n      ...chartProps.formData,\n      seriesType: EchartsTimeseriesSeriesType.Smooth,\n    },\n  });\n\nexport default class EchartsTimeseriesSmoothLineChartPlugin extends EchartsChartPlugin<\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../../EchartsTimeseries'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Evolution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Smooth-line is a variation of the line chart. Without angles and hard edges, Smooth-line sometimes looks smarter and more professional.',\n        ),\n        exampleGallery: [{ url: example1 }],\n        supportedAnnotationTypes: [\n          AnnotationType.Event,\n          AnnotationType.Formula,\n          AnnotationType.Interval,\n          AnnotationType.Timeseries,\n        ],\n        name: t('Smooth Line'),\n        tags: [\n          t('ECharts'),\n          t('Predictive'),\n          t('Advanced-Analytics'),\n          t('Aesthetic'),\n          t('Time'),\n          t('Line'),\n          t('Transformable'),\n        ],\n        thumbnail,\n      },\n      transformProps: smoothTransformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlSubSectionHeader,\n  D3_TIME_FORMAT_DOCS,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nimport {\n  DEFAULT_FORM_DATA,\n  TIME_SERIES_DESCRIPTION_TEXT,\n} from '../../constants';\nimport {\n  legendSection,\n  minorTicks,\n  richTooltipSection,\n  seriesOrderSection,\n  showValueSection,\n  truncateXAxis,\n  xAxisBounds,\n  xAxisLabelRotation,\n} from '../../../controls';\n\nconst {\n  logAxis,\n  markerEnabled,\n  markerSize,\n  minorSplitLine,\n  rowLimit,\n  truncateYAxis,\n  yAxisBounds,\n  zoomable,\n} = DEFAULT_FORM_DATA;\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.echartsTimeSeriesQueryWithXAxisSort,\n    sections.advancedAnalyticsControls,\n    sections.annotationsAndLayersControls,\n    sections.forecastIntervalControls,\n    sections.titleControls,\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ...seriesOrderSection,\n        ['color_scheme'],\n        ...showValueSection,\n        [\n          {\n            name: 'markerEnabled',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Marker'),\n              renderTrigger: true,\n              default: markerEnabled,\n              description: t(\n                'Draw a marker on data points. Only applicable for line types.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markerSize',\n            config: {\n              type: 'SliderControl',\n              label: t('Marker Size'),\n              renderTrigger: true,\n              min: 0,\n              max: 100,\n              default: markerSize,\n              description: t(\n                'Size of marker. Also applies to forecast observations.',\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.markerEnabled?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'zoomable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Zoom'),\n              default: zoomable,\n              renderTrigger: true,\n              description: t('Enable data zooming controls'),\n            },\n          },\n        ],\n        [minorTicks],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n\n        [\n          {\n            name: 'x_axis_time_format',\n            config: {\n              ...sharedControls.x_axis_time_format,\n              default: 'smart_date',\n              description: `${D3_TIME_FORMAT_DOCS}. ${TIME_SERIES_DESCRIPTION_TEXT}`,\n            },\n          },\n        ],\n        [xAxisLabelRotation],\n        // eslint-disable-next-line react/jsx-key\n        ...richTooltipSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        ['y_axis_format'],\n        ['currency_format'],\n        [\n          {\n            name: 'logAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'minorSplitLine',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Minor Split Line'),\n              renderTrigger: true,\n              default: minorSplitLine,\n              description: t('Draw split lines for minor y-axis ticks'),\n            },\n          },\n        ],\n        [truncateXAxis],\n        [xAxisBounds],\n        [\n          {\n            name: 'truncateYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Truncate Y Axis'),\n              default: truncateYAxis,\n              renderTrigger: true,\n              description: t(\n                'Truncate Y Axis. Can be overridden by specifying a min or max bound.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Y Axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                'Bounds for the Y-axis. When left empty, the bounds are ' +\n                  'dynamically defined based on the min/max of the data. Note that ' +\n                  \"this feature will only expand the axis range. It won't \" +\n                  \"narrow the data's extent.\",\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.truncateYAxis?.value),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    row_limit: {\n      default: rowLimit,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { AnnotationType, Behavior, t } from '@superset-ui/core';\nimport {\n  EchartsTimeseriesChartProps,\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesSeriesType,\n} from '../../types';\nimport buildQuery from '../../buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from '../../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Scatter1.png';\nimport { EchartsChartPlugin } from '../../../types';\n\nconst scatterTransformProps = (chartProps: EchartsTimeseriesChartProps) =>\n  transformProps({\n    ...chartProps,\n    formData: {\n      ...chartProps.formData,\n      seriesType: EchartsTimeseriesSeriesType.Scatter,\n    },\n  });\n\nexport default class EchartsTimeseriesScatterChartPlugin extends EchartsChartPlugin<\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../../EchartsTimeseries'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Evolution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Scatter Plot has the horizontal axis in linear units, and the points are connected in order. It shows a statistical relationship between two variables.',\n        ),\n        exampleGallery: [{ url: example1 }],\n        supportedAnnotationTypes: [\n          AnnotationType.Event,\n          AnnotationType.Formula,\n          AnnotationType.Interval,\n          AnnotationType.Timeseries,\n        ],\n        name: t('Scatter Plot'),\n        tags: [\n          t('ECharts'),\n          t('Predictive'),\n          t('Advanced-Analytics'),\n          t('Aesthetic'),\n          t('Time'),\n          t('Transformable'),\n          t('Scatter'),\n          t('Popular'),\n        ],\n        thumbnail,\n      },\n      transformProps: scatterTransformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlSubSectionHeader,\n  D3_TIME_FORMAT_DOCS,\n  getStandardizedControls,\n  sections,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nimport { EchartsTimeseriesSeriesType } from '../../types';\nimport { DEFAULT_FORM_DATA, TIME_SERIES_DESCRIPTION_TEXT } from '../constants';\nimport {\n  legendSection,\n  minorTicks,\n  richTooltipSection,\n  seriesOrderSection,\n  showValueSection,\n  truncateXAxis,\n  xAxisBounds,\n  xAxisLabelRotation,\n} from '../../controls';\n\nconst {\n  area,\n  logAxis,\n  markerEnabled,\n  markerSize,\n  minorSplitLine,\n  opacity,\n  rowLimit,\n  truncateYAxis,\n  yAxisBounds,\n  zoomable,\n} = DEFAULT_FORM_DATA;\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    sections.echartsTimeSeriesQueryWithXAxisSort,\n    sections.advancedAnalyticsControls,\n    sections.annotationsAndLayersControls,\n    sections.forecastIntervalControls,\n    sections.titleControls,\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ...seriesOrderSection,\n        ['color_scheme'],\n        [\n          {\n            name: 'seriesType',\n            config: {\n              type: 'SelectControl',\n              label: t('Step type'),\n              renderTrigger: true,\n              default: EchartsTimeseriesSeriesType.Start,\n              choices: [\n                [EchartsTimeseriesSeriesType.Start, t('Start')],\n                [EchartsTimeseriesSeriesType.Middle, t('Middle')],\n                [EchartsTimeseriesSeriesType.End, t('End')],\n              ],\n              description: t(\n                'Defines whether the step should appear at the beginning, middle or end between two data points',\n              ),\n            },\n          },\n        ],\n        ...showValueSection,\n        [\n          {\n            name: 'area',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Area Chart'),\n              renderTrigger: true,\n              default: area,\n              description: t(\n                'Draw area under curves. Only applicable for line types.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'opacity',\n            config: {\n              type: 'SliderControl',\n              label: t('Area chart opacity'),\n              renderTrigger: true,\n              min: 0,\n              max: 1,\n              step: 0.1,\n              default: opacity,\n              description: t(\n                'Opacity of Area Chart. Also applies to confidence band.',\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.area?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markerEnabled',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Marker'),\n              renderTrigger: true,\n              default: markerEnabled,\n              description: t(\n                'Draw a marker on data points. Only applicable for line types.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'markerSize',\n            config: {\n              type: 'SliderControl',\n              label: t('Marker Size'),\n              renderTrigger: true,\n              min: 0,\n              max: 20,\n              default: markerSize,\n              description: t(\n                'Size of marker. Also applies to forecast observations.',\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.markerEnabled?.value),\n            },\n          },\n        ],\n        [\n          {\n            name: 'zoomable',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Data Zoom'),\n              default: zoomable,\n              renderTrigger: true,\n              description: t('Enable data zooming controls'),\n            },\n          },\n        ],\n        [minorTicks],\n        ...legendSection,\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'x_axis_time_format',\n            config: {\n              ...sharedControls.x_axis_time_format,\n              default: 'smart_date',\n              description: `${D3_TIME_FORMAT_DOCS}. ${TIME_SERIES_DESCRIPTION_TEXT}`,\n            },\n          },\n        ],\n        [xAxisLabelRotation],\n        ...richTooltipSection,\n        // eslint-disable-next-line react/jsx-key\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        ['y_axis_format'],\n        ['currency_format'],\n        [\n          {\n            name: 'logAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic y-axis'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'minorSplitLine',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Minor Split Line'),\n              renderTrigger: true,\n              default: minorSplitLine,\n              description: t('Draw split lines for minor y-axis ticks'),\n            },\n          },\n        ],\n        [truncateXAxis],\n        [xAxisBounds],\n        [\n          {\n            name: 'truncateYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Truncate Y Axis'),\n              default: truncateYAxis,\n              renderTrigger: true,\n              description: t(\n                'Truncate Y Axis. Can be overridden by specifying a min or max bound.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Y Axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                'Bounds for the Y-axis. When left empty, the bounds are ' +\n                  'dynamically defined based on the min/max of the data. Note that ' +\n                  \"this feature will only expand the axis range. It won't \" +\n                  \"narrow the data's extent.\",\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.truncateYAxis?.value),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    row_limit: {\n      default: rowLimit,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    metrics: getStandardizedControls().popAllMetrics(),\n    groupby: getStandardizedControls().popAllColumns(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { AnnotationType, Behavior, t } from '@superset-ui/core';\nimport {\n  EchartsTimeseriesChartProps,\n  EchartsTimeseriesFormData,\n} from '@superset-ui/plugin-chart-echarts';\nimport buildQuery from '../buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from '../transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/Step1.png';\nimport example2 from './images/Step2.png';\nimport { EchartsChartPlugin } from '../../types';\n\nexport default class EchartsTimeseriesStepChartPlugin extends EchartsChartPlugin<\n  EchartsTimeseriesFormData,\n  EchartsTimeseriesChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../EchartsTimeseries'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Evolution'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Stepped-line graph (also called step chart) is a variation of line chart but with the line forming a series of steps between data points. A step chart can be useful when you want to show the changes that occur at irregular intervals.',\n        ),\n        exampleGallery: [{ url: example1 }, { url: example2 }],\n        supportedAnnotationTypes: [\n          AnnotationType.Event,\n          AnnotationType.Formula,\n          AnnotationType.Interval,\n          AnnotationType.Timeseries,\n        ],\n        name: t('Stepped Line'),\n        tags: [\n          t('ECharts'),\n          t('Predictive'),\n          t('Advanced-Analytics'),\n          t('Aesthetic'),\n          t('Time'),\n          t('Transformable'),\n          t('Stacked'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  ensureIsArray,\n  QueryFormData,\n} from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const { x_axis, granularity_sqla, groupby } = formData;\n  const columns = [\n    ...ensureIsArray(x_axis || granularity_sqla),\n    ...ensureIsArray(groupby),\n  ];\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      columns,\n      orderby: columns?.map(column => [column, true]),\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  D3_TIME_FORMAT_DOCS,\n  DEFAULT_TIME_FORMAT,\n  formatSelectOptions,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { showValueControl } from '../controls';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['x_axis'],\n        ['time_grain_sqla'],\n        ['groupby'],\n        ['metric'],\n        ['adhoc_filters'],\n        ['row_limit'],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        [showValueControl],\n        [\n          {\n            name: 'show_legend',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show legend'),\n              renderTrigger: true,\n              default: false,\n              description: t('Whether to display a legend for the chart'),\n            },\n          },\n        ],\n        [\n          <ControlSubSectionHeader>\n            {t('Series colors')}\n          </ControlSubSectionHeader>,\n        ],\n        [\n          {\n            name: 'increase_color',\n            config: {\n              label: t('Increase'),\n              type: 'ColorPickerControl',\n              default: { r: 90, g: 193, b: 137, a: 1 },\n              renderTrigger: true,\n            },\n          },\n          {\n            name: 'decrease_color',\n            config: {\n              label: t('Decrease'),\n              type: 'ColorPickerControl',\n              default: { r: 224, g: 67, b: 85, a: 1 },\n              renderTrigger: true,\n            },\n          },\n          {\n            name: 'total_color',\n            config: {\n              label: t('Total'),\n              type: 'ColorPickerControl',\n              default: { r: 102, g: 102, b: 102, a: 1 },\n              renderTrigger: true,\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('X Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'x_axis_label',\n            config: {\n              type: 'TextControl',\n              label: t('X Axis Label'),\n              renderTrigger: true,\n              default: '',\n            },\n          },\n        ],\n        [\n          {\n            name: 'x_axis_time_format',\n            config: {\n              ...sharedControls.x_axis_time_format,\n              default: DEFAULT_TIME_FORMAT,\n              description: `${D3_TIME_FORMAT_DOCS}.`,\n            },\n          },\n        ],\n        [\n          {\n            name: 'x_ticks_layout',\n            config: {\n              type: 'SelectControl',\n              label: t('X Tick Layout'),\n              choices: formatSelectOptions([\n                'auto',\n                'flat',\n                '45',\n                '90',\n                'staggered',\n              ]),\n              default: 'auto',\n              clearable: false,\n              renderTrigger: true,\n              description: t('The way the ticks are laid out on the X-axis'),\n            },\n          },\n        ],\n        [<ControlSubSectionHeader>{t('Y Axis')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'y_axis_label',\n            config: {\n              type: 'TextControl',\n              label: t('Y Axis Label'),\n              renderTrigger: true,\n              default: '',\n            },\n          },\n        ],\n        ['y_axis_format'],\n        ['currency_format'],\n      ],\n    },\n  ],\n  controlOverrides: {\n    groupby: {\n      label: t('Breakdowns'),\n      description:\n        t(`Breaks down the series by the category specified in this control.\n      This can help viewers understand how each category affects the overall value.`),\n      multi: false,\n    },\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '@superset-ui/core';\n\nexport const TOTAL_MARK = t('Total');\nexport const ASSIST_MARK = t('Assist');\nexport const LEGEND = {\n  INCREASE: t('Increase'),\n  DECREASE: t('Decrease'),\n  TOTAL: t('Total'),\n};\nexport const TOKEN = '-';\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CurrencyFormatter,\n  DataRecord,\n  ensureIsArray,\n  GenericDataType,\n  getMetricLabel,\n  getNumberFormatter,\n  getTimeFormatter,\n  isAdhocColumn,\n  NumberFormatter,\n  rgbToHex,\n  SupersetTheme,\n} from '@superset-ui/core';\nimport { EChartsOption, BarSeriesOption } from 'echarts';\nimport {\n  EchartsWaterfallChartProps,\n  ISeriesData,\n  WaterfallChartTransformedProps,\n  ICallbackDataParams,\n} from './types';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport { defaultGrid, defaultYAxis } from '../defaults';\nimport { ASSIST_MARK, LEGEND, TOKEN, TOTAL_MARK } from './constants';\nimport { getColtypesMapping } from '../utils/series';\nimport { Refs } from '../types';\nimport { NULL_STRING } from '../constants';\n\nfunction formatTooltip({\n  theme,\n  params,\n  breakdownName,\n  defaultFormatter,\n  xAxisFormatter,\n}: {\n  theme: SupersetTheme;\n  params: ICallbackDataParams[];\n  breakdownName?: string;\n  defaultFormatter: NumberFormatter | CurrencyFormatter;\n  xAxisFormatter: (value: number | string, index: number) => string;\n}) {\n  const series = params.find(\n    param => param.seriesName !== ASSIST_MARK && param.data.value !== TOKEN,\n  );\n\n  // We may have no matching series depending on the legend state\n  if (!series) {\n    return '';\n  }\n\n  const isTotal = series?.seriesName === LEGEND.TOTAL;\n  if (!series) {\n    return NULL_STRING;\n  }\n\n  const createRow = (name: string, value: string) => `\n    <div>\n      <span style=\"\n        font-size:${theme.typography.sizes.m}px;\n        color:${theme.colors.grayscale.base};\n        font-weight:${theme.typography.weights.normal};\n        margin-left:${theme.gridUnit * 0.5}px;\"\n      >\n        ${name}:\n      </span>\n      <span style=\"\n        float:right;\n        margin-left:${theme.gridUnit * 5}px;\n        font-size:${theme.typography.sizes.m}px;\n        color:${theme.colors.grayscale.base};\n        font-weight:${theme.typography.weights.bold}\"\n      >\n        ${value}\n      </span>\n    </div>\n  `;\n\n  let result = '';\n  if (!isTotal || breakdownName) {\n    result = xAxisFormatter(series.name, series.dataIndex);\n  }\n  if (!isTotal) {\n    result += createRow(\n      series.seriesName!,\n      defaultFormatter(series.data.originalValue),\n    );\n  }\n  result += createRow(TOTAL_MARK, defaultFormatter(series.data.totalSum));\n  return result;\n}\n\nfunction transformer({\n  data,\n  xAxis,\n  metric,\n  breakdown,\n}: {\n  data: DataRecord[];\n  xAxis: string;\n  metric: string;\n  breakdown?: string;\n}) {\n  // Group by series (temporary map)\n  const groupedData = data.reduce((acc, cur) => {\n    const categoryLabel = cur[xAxis] as string;\n    const categoryData = acc.get(categoryLabel) || [];\n    categoryData.push(cur);\n    acc.set(categoryLabel, categoryData);\n    return acc;\n  }, new Map<string, DataRecord[]>());\n\n  const transformedData: DataRecord[] = [];\n\n  if (breakdown) {\n    groupedData.forEach((value, key) => {\n      const tempValue = value;\n      // Calc total per period\n      const sum = tempValue.reduce(\n        (acc, cur) => acc + ((cur[metric] as number) ?? 0),\n        0,\n      );\n      // Push total per period to the end of period values array\n      tempValue.push({\n        [xAxis]: key,\n        [breakdown]: TOTAL_MARK,\n        [metric]: sum,\n      });\n      transformedData.push(...tempValue);\n    });\n  } else {\n    let total = 0;\n    groupedData.forEach((value, key) => {\n      const sum = value.reduce(\n        (acc, cur) => acc + ((cur[metric] as number) ?? 0),\n        0,\n      );\n      transformedData.push({\n        [xAxis]: key,\n        [metric]: sum,\n      });\n      total += sum;\n    });\n    transformedData.push({\n      [xAxis]: TOTAL_MARK,\n      [metric]: total,\n    });\n  }\n\n  return transformedData;\n}\n\nexport default function transformProps(\n  chartProps: EchartsWaterfallChartProps,\n): WaterfallChartTransformedProps {\n  const {\n    width,\n    height,\n    formData,\n    legendState,\n    queriesData,\n    hooks,\n    theme,\n    inContextMenu,\n  } = chartProps;\n  const refs: Refs = {};\n  const { data = [] } = queriesData[0];\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n  const { setDataMask = () => {}, onContextMenu, onLegendStateChanged } = hooks;\n  const {\n    currencyFormat,\n    granularitySqla = '',\n    groupby,\n    increaseColor = { r: 90, g: 193, b: 137 },\n    decreaseColor = { r: 224, g: 67, b: 85 },\n    totalColor = { r: 102, g: 102, b: 102 },\n    metric = '',\n    xAxis,\n    xTicksLayout,\n    xAxisTimeFormat,\n    showLegend,\n    yAxisLabel,\n    xAxisLabel,\n    yAxisFormat,\n    showValue,\n  } = formData;\n  const defaultFormatter = currencyFormat?.symbol\n    ? new CurrencyFormatter({ d3Format: yAxisFormat, currency: currencyFormat })\n    : getNumberFormatter(yAxisFormat);\n\n  const seriesformatter = (params: ICallbackDataParams) => {\n    const { data } = params;\n    const { originalValue } = data;\n    return defaultFormatter(originalValue as number);\n  };\n  const groupbyArray = ensureIsArray(groupby);\n  const breakdownColumn = groupbyArray.length ? groupbyArray[0] : undefined;\n  const breakdownName = isAdhocColumn(breakdownColumn)\n    ? breakdownColumn.label!\n    : breakdownColumn;\n  const xAxisColumn = xAxis || granularitySqla;\n  const xAxisName = isAdhocColumn(xAxisColumn)\n    ? xAxisColumn.label!\n    : xAxisColumn;\n  const metricLabel = getMetricLabel(metric);\n\n  const transformedData = transformer({\n    data,\n    breakdown: breakdownName,\n    xAxis: xAxisName,\n    metric: metricLabel,\n  });\n\n  const assistData: ISeriesData[] = [];\n  const increaseData: ISeriesData[] = [];\n  const decreaseData: ISeriesData[] = [];\n  const totalData: ISeriesData[] = [];\n\n  let previousTotal = 0;\n\n  transformedData.forEach((datum, index, self) => {\n    const totalSum = self.slice(0, index + 1).reduce((prev, cur, i) => {\n      if (breakdownName) {\n        if (cur[breakdownName] !== TOTAL_MARK || i === 0) {\n          return prev + ((cur[metricLabel] as number) ?? 0);\n        }\n      } else if (cur[xAxisName] !== TOTAL_MARK) {\n        return prev + ((cur[metricLabel] as number) ?? 0);\n      }\n      return prev;\n    }, 0);\n\n    const isTotal =\n      (breakdownName && datum[breakdownName] === TOTAL_MARK) ||\n      datum[xAxisName] === TOTAL_MARK;\n\n    const originalValue = datum[metricLabel] as number;\n    let value = originalValue;\n    const oppositeSigns = Math.sign(previousTotal) !== Math.sign(totalSum);\n    if (oppositeSigns) {\n      value = Math.sign(value) * (Math.abs(value) - Math.abs(previousTotal));\n    }\n\n    if (isTotal) {\n      increaseData.push({ value: TOKEN });\n      decreaseData.push({ value: TOKEN });\n      totalData.push({\n        value: totalSum,\n        originalValue: totalSum,\n        totalSum,\n      });\n    } else if (value < 0) {\n      increaseData.push({ value: TOKEN });\n      decreaseData.push({\n        value: totalSum < 0 ? value : -value,\n        originalValue,\n        totalSum,\n      });\n      totalData.push({ value: TOKEN });\n    } else {\n      increaseData.push({\n        value: totalSum > 0 ? value : -value,\n        originalValue,\n        totalSum,\n      });\n      decreaseData.push({ value: TOKEN });\n      totalData.push({ value: TOKEN });\n    }\n\n    const color = oppositeSigns\n      ? value > 0\n        ? rgbToHex(increaseColor.r, increaseColor.g, increaseColor.b)\n        : rgbToHex(decreaseColor.r, decreaseColor.g, decreaseColor.b)\n      : 'transparent';\n\n    let opacity = 1;\n    if (legendState?.[LEGEND.INCREASE] === false && value > 0) {\n      opacity = 0;\n    } else if (legendState?.[LEGEND.DECREASE] === false && value < 0) {\n      opacity = 0;\n    }\n\n    if (isTotal) {\n      assistData.push({ value: TOKEN });\n    } else if (index === 0) {\n      assistData.push({\n        value: 0,\n      });\n    } else if (oppositeSigns || Math.abs(totalSum) > Math.abs(previousTotal)) {\n      assistData.push({\n        value: previousTotal,\n        itemStyle: { color, opacity },\n      });\n    } else {\n      assistData.push({\n        value: totalSum,\n        itemStyle: { color, opacity },\n      });\n    }\n\n    previousTotal = totalSum;\n  });\n\n  const xAxisColumns: string[] = [];\n  const xAxisData = transformedData.map(row => {\n    let column = xAxisName;\n    let value = row[xAxisName];\n    if (breakdownName && row[breakdownName] !== TOTAL_MARK) {\n      column = breakdownName;\n      value = row[breakdownName];\n    }\n    if (!value) {\n      value = NULL_STRING;\n    }\n    if (typeof value !== 'string' && typeof value !== 'number') {\n      value = String(value);\n    }\n    xAxisColumns.push(column);\n    return value;\n  });\n\n  const xAxisFormatter = (value: number | string, index: number) => {\n    if (value === TOTAL_MARK) {\n      return TOTAL_MARK;\n    }\n    if (coltypeMapping[xAxisColumns[index]] === GenericDataType.Temporal) {\n      if (typeof value === 'string') {\n        return getTimeFormatter(xAxisTimeFormat)(Number.parseInt(value, 10));\n      }\n      return getTimeFormatter(xAxisTimeFormat)(value);\n    }\n    return String(value);\n  };\n\n  let axisLabel: {\n    rotate?: number;\n    hideOverlap?: boolean;\n    show?: boolean;\n    formatter?: typeof xAxisFormatter;\n  };\n  if (xTicksLayout === '45') {\n    axisLabel = { rotate: -45 };\n  } else if (xTicksLayout === '90') {\n    axisLabel = { rotate: -90 };\n  } else if (xTicksLayout === 'flat') {\n    axisLabel = { rotate: 0 };\n  } else if (xTicksLayout === 'staggered') {\n    axisLabel = { rotate: -45 };\n  } else {\n    axisLabel = { show: true };\n  }\n  axisLabel.formatter = xAxisFormatter;\n  axisLabel.hideOverlap = false;\n\n  const seriesProps: Pick<BarSeriesOption, 'type' | 'stack' | 'emphasis'> = {\n    type: 'bar',\n    stack: 'stack',\n    emphasis: {\n      disabled: true,\n    },\n  };\n\n  const barSeries: BarSeriesOption[] = [\n    {\n      ...seriesProps,\n      name: ASSIST_MARK,\n      data: assistData,\n    },\n    {\n      ...seriesProps,\n      name: LEGEND.INCREASE,\n      label: {\n        show: showValue,\n        position: 'top',\n        formatter: seriesformatter,\n      },\n      itemStyle: {\n        color: rgbToHex(increaseColor.r, increaseColor.g, increaseColor.b),\n      },\n      data: increaseData,\n    },\n    {\n      ...seriesProps,\n      name: LEGEND.DECREASE,\n      label: {\n        show: showValue,\n        position: 'bottom',\n        formatter: seriesformatter,\n      },\n      itemStyle: {\n        color: rgbToHex(decreaseColor.r, decreaseColor.g, decreaseColor.b),\n      },\n      data: decreaseData,\n    },\n    {\n      ...seriesProps,\n      name: LEGEND.TOTAL,\n      label: {\n        show: showValue,\n        position: 'top',\n        formatter: seriesformatter,\n      },\n      itemStyle: {\n        color: rgbToHex(totalColor.r, totalColor.g, totalColor.b),\n      },\n      data: totalData,\n    },\n  ];\n\n  const echartOptions: EChartsOption = {\n    grid: {\n      ...defaultGrid,\n      top: theme.gridUnit * 7,\n      bottom: theme.gridUnit * 7,\n      left: theme.gridUnit * 5,\n      right: theme.gridUnit * 7,\n    },\n    legend: {\n      show: showLegend,\n      selected: legendState,\n      data: [LEGEND.INCREASE, LEGEND.DECREASE, LEGEND.TOTAL],\n    },\n    xAxis: {\n      data: xAxisData,\n      type: 'category',\n      name: xAxisLabel,\n      nameTextStyle: {\n        padding: [theme.gridUnit * 4, 0, 0, 0],\n      },\n      nameLocation: 'middle',\n      axisLabel,\n    },\n    yAxis: {\n      ...defaultYAxis,\n      type: 'value',\n      nameTextStyle: {\n        padding: [0, 0, theme.gridUnit * 5, 0],\n      },\n      nameLocation: 'middle',\n      name: yAxisLabel,\n      axisLabel: { formatter: defaultFormatter },\n    },\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      appendToBody: true,\n      trigger: 'axis',\n      show: !inContextMenu,\n      formatter: (params: any) =>\n        formatTooltip({\n          theme,\n          params,\n          breakdownName,\n          defaultFormatter,\n          xAxisFormatter,\n        }),\n    },\n    series: barSeries,\n  };\n\n  return {\n    refs,\n    formData,\n    width,\n    height,\n    echartOptions,\n    setDataMask,\n    onContextMenu,\n    onLegendStateChanged,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regardin\n * g copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example1 from './images/example1.png';\nimport example2 from './images/example2.png';\nimport example3 from './images/example3.png';\nimport { EchartsWaterfallChartProps, EchartsWaterfallFormData } from './types';\n\nexport default class EchartsWaterfallChartPlugin extends ChartPlugin<\n  EchartsWaterfallFormData,\n  EchartsWaterfallChartProps\n> {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsWaterfall'),\n      metadata: new ChartMetadata({\n        behaviors: [Behavior.InteractiveChart],\n        credits: ['https://echarts.apache.org'],\n        category: t('Evolution'),\n        description: t(\n          `A waterfall chart is a form of data visualization that helps in understanding\n          the cumulative effect of sequentially introduced positive or negative values.\n          These intermediate values can either be time based or category based.`,\n        ),\n        exampleGallery: [\n          { url: example1 },\n          { url: example2 },\n          { url: example3 },\n        ],\n        name: t('Waterfall Chart'),\n        tags: [t('Categorical'), t('Comparison'), t('ECharts'), t('Popular')],\n        thumbnail,\n      }),\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { TreeSeriesOption } from 'echarts';\nimport { EchartsTreeFormData } from './types';\n\nexport const DEFAULT_TREE_SERIES_OPTION: TreeSeriesOption = {\n  label: {\n    position: 'left',\n    fontSize: 15,\n  },\n  animation: true,\n  animationDuration: 500,\n  animationEasing: 'cubicOut',\n  lineStyle: { color: 'source', width: 1.5 },\n};\n\nexport const DEFAULT_FORM_DATA: Partial<EchartsTreeFormData> = {\n  id: '',\n  parent: '',\n  name: '',\n  rootNodeId: '',\n  layout: 'orthogonal',\n  orient: 'LR',\n  symbol: 'emptyCircle',\n  symbolSize: 7,\n  roam: true,\n  nodeLabelPosition: 'left',\n  childLabelPosition: 'bottom',\n  emphasis: 'descendant',\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlSubSectionHeader,\n  getStandardizedControls,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './constants';\n\nconst requiredEntity = {\n  ...sharedControls.entity,\n  clearable: false,\n};\nconst optionalEntity = {\n  ...sharedControls.entity,\n  clearable: true,\n  validators: [],\n};\n\nconst controlPanel: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'id',\n            config: {\n              ...requiredEntity,\n              label: t('Id'),\n              description: t('Name of the id column'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'parent',\n            config: {\n              ...requiredEntity,\n              label: t('Parent'),\n              description: t(\n                'Name of the column containing the id of the parent node',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'name',\n            config: {\n              ...optionalEntity,\n              label: t('Name'),\n              description: t('Optional name of the data column.'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'root_node_id',\n            config: {\n              ...optionalEntity,\n              renderTrigger: true,\n              type: 'TextControl',\n              label: t('Root node id'),\n              description: t('Id of root node of the tree.'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'metric',\n            config: {\n              ...optionalEntity,\n              type: 'DndMetricSelect',\n              label: t('Metric'),\n              description: t('Metric for node values'),\n            },\n          },\n        ],\n        ['adhoc_filters'],\n        ['row_limit'],\n      ],\n    },\n    {\n      label: t('Chart options'),\n      expanded: true,\n      controlSetRows: [\n        [<ControlSubSectionHeader>{t('Layout')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'layout',\n            config: {\n              type: 'RadioButtonControl',\n              renderTrigger: true,\n              label: t('Tree layout'),\n              default: DEFAULT_FORM_DATA.layout,\n              options: [\n                ['orthogonal', t('Orthogonal')],\n                ['radial', t('Radial')],\n              ],\n              description: t('Layout type of tree'),\n            },\n          },\n        ],\n\n        [\n          {\n            name: 'orient',\n            config: {\n              type: 'RadioButtonControl',\n              renderTrigger: true,\n              label: t('Tree orientation'),\n              default: DEFAULT_FORM_DATA.orient,\n              options: [\n                ['LR', t('Left to Right')],\n                ['RL', t('Right to Left')],\n                ['TB', t('Top to Bottom')],\n                ['BT', t('Bottom to Top')],\n              ],\n              description: t('Orientation of tree'),\n              visibility({ form_data: { layout } }) {\n                return (layout || DEFAULT_FORM_DATA.layout) === 'orthogonal';\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'node_label_position',\n            config: {\n              type: 'RadioButtonControl',\n              renderTrigger: true,\n              label: t('Node label position'),\n              default: DEFAULT_FORM_DATA.nodeLabelPosition,\n              options: [\n                ['left', t('left')],\n                ['top', t('top')],\n                ['right', t('right')],\n                ['bottom', t('bottom')],\n              ],\n              description: t('Position of intermediate node label on tree'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'child_label_position',\n            config: {\n              type: 'RadioButtonControl',\n              renderTrigger: true,\n              label: t('Child label position'),\n              default: DEFAULT_FORM_DATA.childLabelPosition,\n              options: [\n                ['left', t('left')],\n                ['top', t('top')],\n                ['right', t('right')],\n                ['bottom', t('bottom')],\n              ],\n              description: t('Position of child node label on tree'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'emphasis',\n            config: {\n              type: 'RadioButtonControl',\n              renderTrigger: true,\n              label: t('Emphasis'),\n              default: DEFAULT_FORM_DATA.emphasis,\n              options: [\n                ['ancestor', t('ancestor')],\n                ['descendant', t('descendant')],\n              ],\n              description: t('Which relatives to highlight on hover'),\n              visibility({ form_data: { layout } }) {\n                return (layout || DEFAULT_FORM_DATA.layout) === 'orthogonal';\n              },\n            },\n          },\n        ],\n        [\n          {\n            name: 'symbol',\n            config: {\n              type: 'SelectControl',\n              renderTrigger: true,\n              label: t('Symbol'),\n              default: DEFAULT_FORM_DATA.symbol,\n              options: [\n                {\n                  label: t('Empty circle'),\n                  value: 'emptyCircle',\n                },\n                {\n                  label: t('Circle'),\n                  value: 'circle',\n                },\n                {\n                  label: t('Rectangle'),\n                  value: 'rect',\n                },\n                {\n                  label: t('Triangle'),\n                  value: 'triangle',\n                },\n                {\n                  label: t('Diamond'),\n                  value: 'diamond',\n                },\n                {\n                  label: t('Pin'),\n                  value: 'pin',\n                },\n                {\n                  label: t('Arrow'),\n                  value: 'arrow',\n                },\n                {\n                  label: t('None'),\n                  value: 'none',\n                },\n              ],\n              description: t('Layout type of tree'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'symbolSize',\n            config: {\n              type: 'SliderControl',\n              label: t('Symbol size'),\n              renderTrigger: true,\n              min: 5,\n              max: 30,\n              step: 2,\n              default: DEFAULT_FORM_DATA.symbolSize,\n              description: t('Size of edge symbols'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'roam',\n            config: {\n              type: 'SelectControl',\n              label: t('Enable graph roaming'),\n              renderTrigger: true,\n              default: DEFAULT_FORM_DATA.roam,\n              choices: [\n                [false, t('Disabled')],\n                ['scale', t('Scale only')],\n                ['move', t('Move only')],\n                [true, t('Scale and Move')],\n              ],\n              description: t(\n                'Whether to enable changing graph position and scaling.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default controlPanel;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getMetricLabel, DataRecordValue } from '@superset-ui/core';\nimport { EChartsCoreOption, TreeSeriesOption } from 'echarts';\nimport {\n  TreeSeriesCallbackDataParams,\n  TreeSeriesNodeItemOption,\n} from 'echarts/types/src/chart/tree/TreeSeries';\nimport { OptionName } from 'echarts/types/src/util/types';\nimport {\n  EchartsTreeChartProps,\n  EchartsTreeFormData,\n  TreeDataRecord,\n  TreeTransformedProps,\n} from './types';\nimport { DEFAULT_FORM_DATA, DEFAULT_TREE_SERIES_OPTION } from './constants';\nimport { Refs } from '../types';\nimport { getDefaultTooltip } from '../utils/tooltip';\n\nexport function formatTooltip({\n  params,\n  metricLabel,\n}: {\n  params: TreeSeriesCallbackDataParams;\n  metricLabel: string;\n}): string {\n  const { value, treeAncestors } = params;\n  const treePath = (treeAncestors ?? [])\n    .map(pathInfo => pathInfo?.name || '')\n    .filter(path => path !== '');\n\n  return [\n    `<div>${treePath.join('  ')}</div>`,\n    value ? `${metricLabel}: ${value}` : '',\n  ].join('');\n}\n\nexport default function transformProps(\n  chartProps: EchartsTreeChartProps,\n): TreeTransformedProps {\n  const { width, height, formData, queriesData } = chartProps;\n  const refs: Refs = {};\n  const data: TreeDataRecord[] = queriesData[0].data || [];\n\n  const {\n    id,\n    parent,\n    name,\n    metric = '',\n    rootNodeId,\n    layout,\n    orient,\n    symbol,\n    symbolSize,\n    roam,\n    nodeLabelPosition,\n    childLabelPosition,\n    emphasis,\n  }: EchartsTreeFormData = { ...DEFAULT_FORM_DATA, ...formData };\n  const metricLabel = getMetricLabel(metric);\n\n  const nameColumn = name || id;\n\n  function findNodeName(rootNodeId: DataRecordValue): OptionName {\n    let nodeName: DataRecordValue = '';\n    data.some(node => {\n      if (node[id]!.toString() === rootNodeId) {\n        nodeName = node[nameColumn];\n        return true;\n      }\n      return false;\n    });\n    return nodeName;\n  }\n\n  function getTotalChildren(tree: TreeSeriesNodeItemOption) {\n    let totalChildren = 0;\n\n    function traverse(tree: TreeSeriesNodeItemOption) {\n      tree.children!.forEach(node => {\n        traverse(node);\n      });\n      totalChildren += 1;\n    }\n    traverse(tree);\n    return totalChildren;\n  }\n\n  function createTree(rootNodeId: DataRecordValue): TreeSeriesNodeItemOption {\n    const rootNodeName = findNodeName(rootNodeId);\n    const tree: TreeSeriesNodeItemOption = { name: rootNodeName, children: [] };\n    const children: TreeSeriesNodeItemOption[][] = [];\n    const indexMap: { [name: string]: number } = {};\n\n    if (!rootNodeName) {\n      return tree;\n    }\n\n    // index indexMap with node ids\n    for (let i = 0; i < data.length; i += 1) {\n      const nodeId = data[i][id] as number;\n      indexMap[nodeId] = i;\n      children[i] = [];\n    }\n\n    // generate tree\n    for (let i = 0; i < data.length; i += 1) {\n      const node = data[i];\n      if (node[parent]?.toString() === rootNodeId) {\n        tree.children?.push({\n          name: node[nameColumn],\n          children: children[i],\n          value: node[metricLabel],\n        });\n      } else {\n        const parentId = node[parent];\n        if (data[indexMap[parentId]]) {\n          const parentIndex = indexMap[parentId];\n          children[parentIndex].push({\n            name: node[nameColumn],\n            children: children[i],\n            value: node[metricLabel],\n          });\n        }\n      }\n    }\n\n    return tree;\n  }\n\n  let finalTree = {};\n\n  if (rootNodeId) {\n    finalTree = createTree(rootNodeId);\n  } else {\n    /*\n      to select root node,\n      1.find parent nodes with only 1 child.\n      2.build tree for each such child nodes as root\n      3.select tree with most children\n    */\n    // create map of parent:children\n    const parentChildMap: { [name: string]: { [name: string]: any } } = {};\n    data.forEach(node => {\n      const parentId = node[parent] as string;\n      if (parentId in parentChildMap) {\n        parentChildMap[parentId].push({ id: node[id] });\n      } else {\n        parentChildMap[parentId] = [{ id: node[id] }];\n      }\n    });\n\n    // for each parent node which has only 1 child,find tree and select node with max number of children.\n    let maxChildren = 0;\n    Object.keys(parentChildMap).forEach(key => {\n      if (parentChildMap[key].length === 1) {\n        const tree = createTree(parentChildMap[key][0].id);\n        const totalChildren = getTotalChildren(tree);\n        if (totalChildren > maxChildren) {\n          maxChildren = totalChildren;\n          finalTree = tree;\n        }\n      }\n    });\n  }\n\n  const series: TreeSeriesOption[] = [\n    {\n      type: 'tree',\n      data: [finalTree],\n      label: {\n        ...DEFAULT_TREE_SERIES_OPTION.label,\n        position: nodeLabelPosition,\n      },\n      emphasis: { focus: emphasis },\n      animation: DEFAULT_TREE_SERIES_OPTION.animation,\n      layout,\n      orient,\n      symbol,\n      roam,\n      symbolSize,\n      lineStyle: DEFAULT_TREE_SERIES_OPTION.lineStyle,\n      select: DEFAULT_TREE_SERIES_OPTION.select,\n      leaves: { label: { position: childLabelPosition } },\n    },\n  ];\n\n  const echartOptions: EChartsCoreOption = {\n    animationDuration: DEFAULT_TREE_SERIES_OPTION.animationDuration,\n    animationEasing: DEFAULT_TREE_SERIES_OPTION.animationEasing,\n    series,\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      trigger: 'item',\n      triggerOn: 'mousemove',\n      formatter: (params: any) =>\n        formatTooltip({\n          params,\n          metricLabel,\n        }),\n    },\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    refs,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  return buildQueryContext(formData, {\n    queryFields: {\n      id: 'columns',\n      parent: 'columns',\n      name: 'columns',\n    },\n  });\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/tree.png';\nimport buildQuery from './buildQuery';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsTreeChartPlugin extends EchartsChartPlugin {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsTree'),\n      metadata: {\n        category: t('Part of a Whole'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Visualize multiple levels of hierarchy using a familiar tree-like structure.',\n        ),\n        exampleGallery: [{ url: example }],\n        name: t('Tree Chart'),\n        tags: [\n          t('Categorical'),\n          t('ECharts'),\n          t('Multi-Levels'),\n          t('Relational'),\n          t('Structural'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport {\n  ChartDataResponseResult,\n  ChartProps,\n  DataRecordValue,\n  QueryFormColumn,\n  QueryFormData,\n  QueryFormMetric,\n} from '@superset-ui/core';\nimport { SunburstSeriesNodeItemOption } from 'echarts/types/src/chart/sunburst/SunburstSeries';\nimport {\n  BaseTransformedProps,\n  ContextMenuTransformedProps,\n  CrossFilterTransformedProps,\n} from '../types';\n\nexport type EchartsSunburstFormData = QueryFormData & {\n  groupby: QueryFormColumn[];\n  metric: QueryFormMetric;\n  secondaryMetric?: QueryFormMetric;\n  colorScheme?: string;\n  linearColorScheme?: string;\n};\n\nexport enum EchartsSunburstLabelType {\n  Key = 'key',\n  Value = 'value',\n  KeyValue = 'key_value',\n}\n\nexport const DEFAULT_FORM_DATA: Partial<EchartsSunburstFormData> = {\n  groupby: [],\n  numberFormat: 'SMART_NUMBER',\n  labelType: EchartsSunburstLabelType.Key,\n  showLabels: false,\n  dateFormat: 'smart_date',\n};\n\nexport interface EchartsSunburstChartProps\n  extends ChartProps<EchartsSunburstFormData> {\n  formData: EchartsSunburstFormData;\n  queriesData: ChartDataResponseResult[];\n}\n\nexport type SunburstTransformedProps =\n  BaseTransformedProps<EchartsSunburstFormData> &\n    ContextMenuTransformedProps &\n    CrossFilterTransformedProps;\n\nexport type NodeItemOption = SunburstSeriesNodeItemOption & {\n  records: DataRecordValue[];\n  secondaryValue: number;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  CategoricalColorNamespace,\n  DataRecordValue,\n  getColumnLabel,\n  getMetricLabel,\n  getNumberFormatter,\n  getSequentialSchemeRegistry,\n  getTimeFormatter,\n  getValueFormatter,\n  NumberFormats,\n  SupersetTheme,\n  t,\n  ValueFormatter,\n} from '@superset-ui/core';\nimport { EChartsCoreOption } from 'echarts';\nimport { CallbackDataParams } from 'echarts/types/src/util/types';\nimport { NULL_STRING, OpacityEnum } from '../constants';\nimport { defaultGrid } from '../defaults';\nimport { Refs } from '../types';\nimport { formatSeriesName, getColtypesMapping } from '../utils/series';\nimport { treeBuilder, TreeNode } from '../utils/treeBuilder';\nimport {\n  EchartsSunburstChartProps,\n  EchartsSunburstLabelType,\n  NodeItemOption,\n  SunburstTransformedProps,\n} from './types';\nimport { getDefaultTooltip } from '../utils/tooltip';\n\nexport function getLinearDomain(\n  treeData: TreeNode[],\n  callback: (treeNode: TreeNode) => number,\n) {\n  let min = 0;\n  let max = 0;\n  let temp = null;\n  function traverse(tree: TreeNode[]) {\n    tree.forEach(treeNode => {\n      if (treeNode.children?.length) {\n        traverse(treeNode.children);\n      }\n      temp = callback(treeNode);\n      if (temp !== null) {\n        if (min > temp) min = temp;\n        if (max < temp) max = temp;\n      }\n    });\n  }\n  traverse(treeData);\n  return [min, max];\n}\n\nexport function formatLabel({\n  params,\n  labelType,\n  numberFormatter,\n}: {\n  params: CallbackDataParams;\n  labelType: EchartsSunburstLabelType;\n  numberFormatter: ValueFormatter;\n}): string {\n  const { name = '', value } = params;\n  const formattedValue = numberFormatter(value as number);\n\n  switch (labelType) {\n    case EchartsSunburstLabelType.Key:\n      return name;\n    case EchartsSunburstLabelType.Value:\n      return formattedValue;\n    case EchartsSunburstLabelType.KeyValue:\n      return `${name}: ${formattedValue}`;\n    default:\n      return name;\n  }\n}\n\nexport function formatTooltip({\n  params,\n  primaryValueFormatter,\n  secondaryValueFormatter,\n  colorByCategory,\n  totalValue,\n  metricLabel,\n  secondaryMetricLabel,\n  theme,\n}: {\n  params: CallbackDataParams & {\n    treePathInfo: {\n      name: string;\n      dataIndex: number;\n      value: number;\n    }[];\n  };\n  primaryValueFormatter: ValueFormatter;\n  secondaryValueFormatter: ValueFormatter | undefined;\n  colorByCategory: boolean;\n  totalValue: number;\n  metricLabel: string;\n  secondaryMetricLabel?: string;\n  theme: SupersetTheme;\n}): string {\n  const { data, treePathInfo = [] } = params;\n  const node = data as TreeNode;\n  const formattedValue = primaryValueFormatter(node.value);\n  const formattedSecondaryValue = secondaryValueFormatter?.(\n    node.secondaryValue,\n  );\n\n  const percentFormatter = getNumberFormatter(NumberFormats.PERCENT_2_POINT);\n  const compareValuePercentage = percentFormatter(\n    node.secondaryValue / node.value,\n  );\n  const absolutePercentage = percentFormatter(node.value / totalValue);\n  const parentNode =\n    treePathInfo.length > 2 ? treePathInfo[treePathInfo.length - 2] : undefined;\n\n  const result = [\n    `<div style=\"\n      font-size: ${theme.typography.sizes.m}px;\n      color: ${theme.colors.grayscale.base}\"\n     >`,\n    `<div style=\"font-weight: ${theme.typography.weights.bold}\">\n      ${(node.name || NULL_STRING)\n        .toString()\n        .replaceAll('<', '&lt;')\n        .replaceAll('>', '&gt;')}\n     </div>`,\n    `<div\">\n      ${absolutePercentage} of total\n     </div>`,\n  ];\n  if (parentNode) {\n    const conditionalPercentage = percentFormatter(\n      node.value / parentNode.value,\n    );\n    result.push(`\n    <div>\n      ${conditionalPercentage} of ${parentNode.name}\n    </div>`);\n  }\n  result.push(\n    `<div>\n    ${metricLabel}: ${formattedValue}${\n      colorByCategory\n        ? ''\n        : `, ${secondaryMetricLabel}: ${formattedSecondaryValue}`\n    }\n     </div>`,\n    colorByCategory\n      ? ''\n      : `<div>${metricLabel}/${secondaryMetricLabel}: ${compareValuePercentage}</div>`,\n  );\n  result.push('</div>');\n  return result.join('\\n');\n}\n\nexport default function transformProps(\n  chartProps: EchartsSunburstChartProps,\n): SunburstTransformedProps {\n  const {\n    formData,\n    height,\n    hooks,\n    filterState,\n    queriesData,\n    width,\n    theme,\n    inContextMenu,\n    emitCrossFilters,\n    datasource,\n  } = chartProps;\n  const { data = [] } = queriesData[0];\n  const coltypeMapping = getColtypesMapping(queriesData[0]);\n  const {\n    groupby = [],\n    columns = [],\n    metric = '',\n    secondaryMetric = '',\n    colorScheme,\n    linearColorScheme,\n    labelType,\n    numberFormat,\n    currencyFormat,\n    dateFormat,\n    showLabels,\n    showLabelsThreshold,\n    showTotal,\n    sliceId,\n  } = formData;\n  const { currencyFormats = {}, columnFormats = {} } = datasource;\n  const refs: Refs = {};\n  const primaryValueFormatter = getValueFormatter(\n    metric,\n    currencyFormats,\n    columnFormats,\n    numberFormat,\n    currencyFormat,\n  );\n  const secondaryValueFormatter = secondaryMetric\n    ? getValueFormatter(\n        secondaryMetric,\n        currencyFormats,\n        columnFormats,\n        numberFormat,\n        currencyFormat,\n      )\n    : undefined;\n\n  const numberFormatter = getNumberFormatter(numberFormat);\n  const formatter = (params: CallbackDataParams) =>\n    formatLabel({\n      params,\n      numberFormatter: primaryValueFormatter,\n      labelType,\n    });\n  const minShowLabelAngle = (showLabelsThreshold || 0) * 3.6;\n  const padding = {\n    top: theme.gridUnit * 3,\n    right: theme.gridUnit,\n    bottom: theme.gridUnit * 3,\n    left: theme.gridUnit,\n  };\n  const containerWidth = width;\n  const containerHeight = height;\n  const visWidth = containerWidth - padding.left - padding.right;\n  const visHeight = containerHeight - padding.top - padding.bottom;\n  const radius = Math.min(visWidth, visHeight) / 2;\n  const { setDataMask = () => {}, onContextMenu } = hooks;\n  const columnsLabelMap = new Map<string, string[]>();\n  const metricLabel = getMetricLabel(metric);\n  const secondaryMetricLabel = secondaryMetric\n    ? getMetricLabel(secondaryMetric)\n    : undefined;\n  const columnLabels = columns.map(getColumnLabel);\n  const treeData = treeBuilder(\n    data,\n    columnLabels,\n    metricLabel,\n    secondaryMetricLabel,\n  );\n  const totalValue = treeData.reduce(\n    (result, treeNode) => result + treeNode.value,\n    0,\n  );\n  const totalSecondaryValue = treeData.reduce(\n    (result, treeNode) => result + treeNode.secondaryValue,\n    0,\n  );\n\n  const categoricalColorScale = CategoricalColorNamespace.getScale(\n    colorScheme as string,\n  );\n  let linearColorScale: any;\n  let colorByCategory = true;\n  if (secondaryMetric && metric !== secondaryMetric) {\n    const domain = getLinearDomain(\n      treeData,\n      node => node.secondaryValue / node.value,\n    );\n    colorByCategory = false;\n    linearColorScale = getSequentialSchemeRegistry()\n      ?.get(linearColorScheme)\n      ?.createLinearScale(domain);\n  }\n\n  // add a base color to keep feature parity\n  if (colorByCategory) {\n    categoricalColorScale(metricLabel, sliceId);\n  } else {\n    linearColorScale(totalSecondaryValue / totalValue);\n  }\n\n  const traverse = (\n    treeNodes: TreeNode[],\n    path: string[],\n    pathRecords?: DataRecordValue[],\n  ) =>\n    treeNodes.map(treeNode => {\n      const { name: nodeName, value, secondaryValue, groupBy } = treeNode;\n      const records = [...(pathRecords || []), nodeName];\n      let name = formatSeriesName(nodeName, {\n        numberFormatter,\n        timeFormatter: getTimeFormatter(dateFormat),\n        ...(coltypeMapping[groupBy] && {\n          coltype: coltypeMapping[groupBy],\n        }),\n      });\n      const newPath = path.concat(name);\n      let item: NodeItemOption = {\n        records,\n        name,\n        value,\n        secondaryValue,\n        itemStyle: {\n          color: colorByCategory\n            ? categoricalColorScale(name, sliceId)\n            : linearColorScale(secondaryValue / value),\n        },\n      };\n      if (treeNode.children?.length) {\n        item.children = traverse(treeNode.children, newPath, records);\n      } else {\n        name = newPath.join(',');\n      }\n      columnsLabelMap.set(name, newPath);\n      if (filterState.selectedValues?.[0]?.includes(name) === false) {\n        item = {\n          ...item,\n          itemStyle: {\n            ...item.itemStyle,\n            opacity: OpacityEnum.SemiTransparent,\n          },\n          label: {\n            color: `rgba(0, 0, 0, ${OpacityEnum.SemiTransparent})`,\n          },\n        };\n      }\n      return item;\n    });\n\n  const echartOptions: EChartsCoreOption = {\n    grid: {\n      ...defaultGrid,\n    },\n    tooltip: {\n      ...getDefaultTooltip(refs),\n      show: !inContextMenu,\n      trigger: 'item',\n      formatter: (params: any) =>\n        formatTooltip({\n          params,\n          primaryValueFormatter,\n          secondaryValueFormatter,\n          colorByCategory,\n          totalValue,\n          metricLabel,\n          secondaryMetricLabel,\n          theme,\n        }),\n    },\n    series: [\n      {\n        type: 'sunburst',\n        ...padding,\n        nodeClick: false,\n        emphasis: {\n          focus: 'ancestor',\n          label: {\n            show: showLabels,\n          },\n        },\n        label: {\n          width: (radius * 0.6) / (columns.length || 1),\n          show: showLabels,\n          formatter,\n          color: theme.colors.grayscale.dark2,\n          minAngle: minShowLabelAngle,\n          overflow: 'breakAll',\n        },\n        radius: [radius * 0.3, radius],\n        data: traverse(treeData, []),\n      },\n    ],\n    graphic: showTotal\n      ? {\n          type: 'text',\n          top: 'center',\n          left: 'center',\n          style: {\n            text: t('Total: %s', primaryValueFormatter(totalValue)),\n            fontSize: 16,\n            fontWeight: 'bold',\n          },\n          z: 10,\n        }\n      : null,\n  };\n\n  return {\n    formData,\n    width,\n    height,\n    echartOptions,\n    setDataMask,\n    emitCrossFilters,\n    labelMap: Object.fromEntries(columnsLabelMap),\n    groupby,\n    selectedValues: filterState.selectedValues || [],\n    onContextMenu,\n    refs,\n    coltypeMapping,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelsContainerProps,\n  ControlSubSectionHeader,\n  D3_FORMAT_DOCS,\n  D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT,\n  D3_FORMAT_OPTIONS,\n  D3_TIME_FORMAT_OPTIONS,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './types';\n\nconst { labelType, numberFormat, showLabels } = DEFAULT_FORM_DATA;\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['columns'],\n        ['metric'],\n        ['secondary_metric'],\n        ['adhoc_filters'],\n        ['row_limit'],\n        [\n          {\n            name: 'sort_by_metric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort by metric'),\n              description: t(\n                'Whether to sort results by the selected metric in descending order.',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['color_scheme'],\n        ['linear_color_scheme'],\n        [<ControlSubSectionHeader>{t('Labels')}</ControlSubSectionHeader>],\n        [\n          {\n            name: 'show_labels',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Labels'),\n              renderTrigger: true,\n              default: showLabels,\n              description: t('Whether to display the labels.'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_labels_threshold',\n            config: {\n              type: 'TextControl',\n              label: t('Percentage threshold'),\n              renderTrigger: true,\n              isFloat: true,\n              default: 5,\n              description: t(\n                'Minimum threshold in percentage points for showing labels.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'show_total',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show Total'),\n              default: false,\n              renderTrigger: true,\n              description: t('Whether to display the aggregate count'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'label_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Label Type'),\n              default: labelType,\n              renderTrigger: true,\n              choices: [\n                ['key', t('Category Name')],\n                ['value', t('Value')],\n                ['key_value', t('Category and Value')],\n              ],\n              description: t('What should be shown on the label?'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'number_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Number format'),\n              renderTrigger: true,\n              default: numberFormat,\n              choices: D3_FORMAT_OPTIONS,\n              description: `${D3_FORMAT_DOCS} ${D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT}`,\n            },\n          },\n        ],\n        ['currency_format'],\n        [\n          {\n            name: 'date_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date format'),\n              renderTrigger: true,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              default: 'smart_date',\n              description: D3_FORMAT_DOCS,\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    metric: {\n      label: t('Primary Metric'),\n      description: t(\n        'The primary metric is used to define the arc segment sizes',\n      ),\n    },\n    secondary_metric: {\n      label: t('Secondary Metric'),\n      default: null,\n      description: t(\n        '[optional] this secondary metric is used to ' +\n          'define the color as a ratio against the primary metric. ' +\n          'When omitted, the color is categorical and based on labels',\n      ),\n    },\n    color_scheme: {\n      description: t(\n        'When only a primary metric is provided, a categorical color scale is used.',\n      ),\n      visibility: ({ controls }: ControlPanelsContainerProps) =>\n        Boolean(\n          !controls?.secondary_metric?.value ||\n            controls?.secondary_metric?.value === controls?.metric.value,\n        ),\n    },\n    linear_color_scheme: {\n      description: t(\n        'When a secondary metric is provided, a linear color scale is used.',\n      ),\n      visibility: ({ controls }: ControlPanelsContainerProps) =>\n        Boolean(\n          controls?.secondary_metric?.value &&\n            controls?.secondary_metric?.value !== controls?.metric.value,\n        ),\n    },\n    columns: {\n      label: t('Hierarchy'),\n      description: t(`Sets the hierarchy levels of the chart. Each level is\n        represented by one ring with the innermost circle as the top of the hierarchy.`),\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n    metric: getStandardizedControls().shiftMetric(),\n    secondary_metric: getStandardizedControls().shiftMetric(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const { metric, sort_by_metric } = formData;\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      ...(sort_by_metric && { orderby: [[metric, false]] }),\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, t } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport controlPanel from './controlPanel';\nimport buildQuery from './buildQuery';\nimport example1 from './images/Sunburst1.png';\nimport example2 from './images/Sunburst2.png';\nimport { EchartsChartPlugin } from '../types';\n\nexport default class EchartsSunburstChartPlugin extends EchartsChartPlugin {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsSunburst'),\n      metadata: {\n        behaviors: [\n          Behavior.InteractiveChart,\n          Behavior.DrillToDetail,\n          Behavior.DrillBy,\n        ],\n        category: t('Part of a Whole'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Uses circles to visualize the flow of data through different stages of a system. Hover over individual paths in the visualization to understand the stages a value took. Useful for multi-stage, multi-group visualizing funnels and pipelines.',\n        ),\n        exampleGallery: [{ url: example1 }, { url: example2 }],\n        name: t('Sunburst Chart'),\n        tags: [\n          t('ECharts'),\n          t('Aesthetic'),\n          t('Multi-Levels'),\n          t('Proportional'),\n        ],\n        thumbnail,\n      },\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { DEFAULT_LEGEND_FORM_DATA } from '../constants';\nimport { defaultXAxis } from '../defaults';\nimport { EchartsBubbleFormData } from './types';\n\nexport const DEFAULT_FORM_DATA: Partial<EchartsBubbleFormData> = {\n  ...DEFAULT_LEGEND_FORM_DATA,\n  emitFilter: false,\n  logXAis: false,\n  logYAxis: false,\n  xAxisTitleMargin: 30,\n  yAxisTitleMargin: 30,\n  truncateXAxis: false,\n  truncateYAxis: false,\n  xAxisBounds: [null, null],\n  yAxisBounds: [null, null],\n  xAxisLabelRotation: defaultXAxis.xAxisLabelRotation,\n  opacity: 0.6,\n};\n\nexport const MINIMUM_BUBBLE_SIZE = 5;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { EChartsCoreOption, ScatterSeriesOption } from 'echarts';\nimport { extent } from 'd3-array';\nimport {\n  CategoricalColorNamespace,\n  getNumberFormatter,\n  AxisType,\n  getMetricLabel,\n  NumberFormatter,\n} from '@superset-ui/core';\nimport { EchartsBubbleChartProps, EchartsBubbleFormData } from './types';\nimport { DEFAULT_FORM_DATA, MINIMUM_BUBBLE_SIZE } from './constants';\nimport { defaultGrid } from '../defaults';\nimport { getLegendProps, getMinAndMaxFromBounds } from '../utils/series';\nimport { Refs } from '../types';\nimport { parseAxisBound } from '../utils/controls';\nimport { getDefaultTooltip } from '../utils/tooltip';\nimport { getPadding } from '../Timeseries/transformers';\nimport { convertInteger } from '../utils/convertInteger';\nimport { NULL_STRING } from '../constants';\n\nfunction normalizeSymbolSize(\n  nodes: ScatterSeriesOption[],\n  maxBubbleValue: number,\n) {\n  const [bubbleMinValue, bubbleMaxValue] = extent(nodes, x => x.data![0][2]);\n  const nodeSpread = bubbleMaxValue - bubbleMinValue;\n  nodes.forEach(node => {\n    // eslint-disable-next-line no-param-reassign\n    node.symbolSize =\n      (((node.data![0][2] - bubbleMinValue) / nodeSpread) *\n        (maxBubbleValue * 2) || 0) + MINIMUM_BUBBLE_SIZE;\n  });\n}\n\nexport function formatTooltip(\n  params: any,\n  xAxisLabel: string,\n  yAxisLabel: string,\n  sizeLabel: string,\n  xAxisFormatter: NumberFormatter,\n  yAxisFormatter: NumberFormatter,\n  tooltipSizeFormatter: NumberFormatter,\n) {\n  const title = params.data[4]\n    ? `${params.data[3]} </br> ${params.data[4]}`\n    : params.data[3];\n\n  return `<p>${title}</p>\n        ${xAxisLabel}: ${xAxisFormatter(params.data[0])} <br/>\n        ${yAxisLabel}: ${yAxisFormatter(params.data[1])} <br/>\n        ${sizeLabel}: ${tooltipSizeFormatter(params.data[2])}`;\n}\n\nexport default function transformProps(chartProps: EchartsBubbleChartProps) {\n  const { height, width, hooks, queriesData, formData, inContextMenu, theme } =\n    chartProps;\n\n  const { data = [] } = queriesData[0];\n  const {\n    x,\n    y,\n    size,\n    entity,\n    maxBubbleSize,\n    colorScheme,\n    series: bubbleSeries,\n    xAxisLabel: bubbleXAxisTitle,\n    yAxisLabel: bubbleYAxisTitle,\n    xAxisBounds,\n    xAxisFormat,\n    yAxisFormat,\n    yAxisBounds,\n    logXAxis,\n    logYAxis,\n    xAxisTitleMargin,\n    yAxisTitleMargin,\n    truncateXAxis,\n    truncateYAxis,\n    xAxisLabelRotation,\n    yAxisLabelRotation,\n    tooltipSizeFormat,\n    opacity,\n    showLegend,\n    legendOrientation,\n    legendMargin,\n    legendType,\n  }: EchartsBubbleFormData = { ...DEFAULT_FORM_DATA, ...formData };\n\n  const colorFn = CategoricalColorNamespace.getScale(colorScheme as string);\n\n  const legends = new Set<string>();\n  const series: ScatterSeriesOption[] = [];\n\n  const xAxisLabel: string = getMetricLabel(x);\n  const yAxisLabel: string = getMetricLabel(y);\n  const sizeLabel: string = getMetricLabel(size);\n\n  const refs: Refs = {};\n\n  data.forEach(datum => {\n    const dataName = bubbleSeries ? datum[bubbleSeries] : datum[entity];\n    const name = dataName ? String(dataName) : NULL_STRING;\n    const bubbleSeriesValue = bubbleSeries ? datum[bubbleSeries] : null;\n\n    series.push({\n      name,\n      data: [\n        [\n          datum[xAxisLabel],\n          datum[yAxisLabel],\n          datum[sizeLabel],\n          datum[entity],\n          bubbleSeriesValue as any,\n        ],\n      ],\n      type: 'scatter',\n      itemStyle: { color: colorFn(name), opacity },\n    });\n    legends.add(name);\n  });\n\n  normalizeSymbolSize(series, maxBubbleSize);\n\n  const xAxisFormatter = getNumberFormatter(xAxisFormat);\n  const yAxisFormatter = getNumberFormatter(yAxisFormat);\n  const tooltipSizeFormatter = getNumberFormatter(tooltipSizeFormat);\n\n  const [xAxisMin, xAxisMax] = (xAxisBounds || []).map(parseAxisBound);\n  const [yAxisMin, yAxisMax] = (yAxisBounds || []).map(parseAxisBound);\n\n  const padding = getPadding(\n    showLegend,\n    legendOrientation,\n    true,\n    false,\n    legendMargin,\n    true,\n    'Left',\n    convertInteger(yAxisTitleMargin),\n    convertInteger(xAxisTitleMargin),\n  );\n\n  const xAxisType = logXAxis ? AxisType.Log : AxisType.Value;\n  const echartOptions: EChartsCoreOption = {\n    series,\n    xAxis: {\n      axisLabel: { formatter: xAxisFormatter },\n      splitLine: {\n        lineStyle: {\n          type: 'dashed',\n        },\n      },\n      nameRotate: xAxisLabelRotation,\n      scale: true,\n      name: bubbleXAxisTitle,\n      nameLocation: 'middle',\n      nameTextStyle: {\n        fontWight: 'bolder',\n      },\n      nameGap: convertInteger(xAxisTitleMargin),\n      type: xAxisType,\n      ...getMinAndMaxFromBounds(xAxisType, truncateXAxis, xAxisMin, xAxisMax),\n    },\n    yAxis: {\n      axisLabel: { formatter: yAxisFormatter },\n      splitLine: {\n        lineStyle: {\n          type: 'dashed',\n        },\n      },\n      nameRotate: yAxisLabelRotation,\n      scale: truncateYAxis,\n      name: bubbleYAxisTitle,\n      nameLocation: 'middle',\n      nameTextStyle: {\n        fontWight: 'bolder',\n      },\n      nameGap: convertInteger(yAxisTitleMargin),\n      min: yAxisMin,\n      max: yAxisMax,\n      type: logYAxis ? AxisType.Log : AxisType.Value,\n    },\n    legend: {\n      ...getLegendProps(legendType, legendOrientation, showLegend, theme),\n      data: Array.from(legends),\n    },\n    tooltip: {\n      show: !inContextMenu,\n      ...getDefaultTooltip(refs),\n      formatter: (params: any): string =>\n        formatTooltip(\n          params,\n          xAxisLabel,\n          yAxisLabel,\n          sizeLabel,\n          xAxisFormatter,\n          yAxisFormatter,\n          tooltipSizeFormatter,\n        ),\n    },\n    grid: { ...defaultGrid, ...padding },\n  };\n\n  const { onContextMenu, setDataMask = () => {} } = hooks;\n\n  return {\n    refs,\n    height,\n    width,\n    echartOptions,\n    onContextMenu,\n    setDataMask,\n    formData,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  ensureIsArray,\n  QueryFormData,\n} from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  const columns = [\n    ...ensureIsArray(formData.entity),\n    ...ensureIsArray(formData.series),\n  ];\n\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      columns,\n      orderby: baseQueryObject.orderby\n        ? [[baseQueryObject.orderby[0], !baseQueryObject.order_desc]]\n        : undefined,\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  formatSelectOptions,\n  sections,\n  ControlPanelsContainerProps,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nimport { DEFAULT_FORM_DATA } from './constants';\nimport {\n  legendSection,\n  truncateXAxis,\n  xAxisBounds,\n  xAxisLabelRotation,\n} from '../controls';\nimport { defaultYAxis } from '../defaults';\n\nconst { logAxis, truncateYAxis, yAxisBounds, opacity } = DEFAULT_FORM_DATA;\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['series'],\n        ['entity'],\n        ['x'],\n        ['y'],\n        ['adhoc_filters'],\n        ['size'],\n        ['orderby'],\n        [\n          {\n            name: 'order_desc',\n            config: {\n              ...sharedControls.order_desc,\n              visibility: ({ controls }) => Boolean(controls.orderby.value),\n            },\n          },\n        ],\n        ['row_limit'],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      tabOverride: 'customize',\n      controlSetRows: [\n        ['color_scheme'],\n        ...legendSection,\n        [\n          {\n            name: 'max_bubble_size',\n            config: {\n              type: 'SelectControl',\n              renderTrigger: true,\n              freeForm: true,\n              label: t('Max Bubble Size'),\n              default: '25',\n              choices: formatSelectOptions([\n                '5',\n                '10',\n                '15',\n                '25',\n                '50',\n                '75',\n                '100',\n              ]),\n            },\n          },\n        ],\n        [\n          {\n            name: 'tooltipSizeFormat',\n            config: {\n              ...sharedControls.y_axis_format,\n              label: t('Bubble size number format'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'opacity',\n            config: {\n              type: 'SliderControl',\n              label: t('Bubble Opacity'),\n              renderTrigger: true,\n              min: 0,\n              max: 1,\n              step: 0.1,\n              default: opacity,\n              description: t(\n                'Opacity of bubbles, 0 means completely transparent, 1 means opaque',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('X Axis'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'x_axis_label',\n            config: {\n              type: 'TextControl',\n              label: t('X Axis Title'),\n              renderTrigger: true,\n              default: '',\n            },\n          },\n        ],\n        [xAxisLabelRotation],\n        [\n          {\n            name: 'x_axis_title_margin',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              clearable: true,\n              label: t('X AXIS TITLE MARGIN'),\n              renderTrigger: true,\n              default: sections.TITLE_MARGIN_OPTIONS[1],\n              choices: formatSelectOptions(sections.TITLE_MARGIN_OPTIONS),\n            },\n          },\n        ],\n        [\n          {\n            name: 'xAxisFormat',\n            config: {\n              ...sharedControls.y_axis_format,\n              label: t('X Axis Format'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'logXAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic x-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic x-axis'),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Y Axis'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'y_axis_label',\n            config: {\n              type: 'TextControl',\n              label: t('Y Axis Title'),\n              renderTrigger: true,\n              default: '',\n            },\n          },\n        ],\n        [\n          {\n            name: 'yAxisLabelRotation',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              clearable: false,\n              label: t('Rotate y axis label'),\n              choices: [\n                [0, '0'],\n                [45, '45'],\n              ],\n              default: defaultYAxis.yAxisLabelRotation,\n              renderTrigger: true,\n              description: t(\n                'Input field supports custom rotation. e.g. 30 for 30',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_title_margin',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              clearable: true,\n              label: t('Y AXIS TITLE MARGIN'),\n              renderTrigger: true,\n              default: sections.TITLE_MARGIN_OPTIONS[1],\n              choices: formatSelectOptions(sections.TITLE_MARGIN_OPTIONS),\n            },\n          },\n        ],\n        ['y_axis_format'],\n        [\n          {\n            name: 'logYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Logarithmic y-axis'),\n              renderTrigger: true,\n              default: logAxis,\n              description: t('Logarithmic y-axis'),\n            },\n          },\n        ],\n        [truncateXAxis],\n        [xAxisBounds],\n        [\n          {\n            name: 'truncateYAxis',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Truncate Y Axis'),\n              default: truncateYAxis,\n              renderTrigger: true,\n              description: t(\n                'Truncate Y Axis. Can be overridden by specifying a min or max bound.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'y_axis_bounds',\n            config: {\n              type: 'BoundsControl',\n              label: t('Y Axis Bounds'),\n              renderTrigger: true,\n              default: yAxisBounds,\n              description: t(\n                'Bounds for the Y-axis. When left empty, the bounds are ' +\n                  'dynamically defined based on the min/max of the data. Note that ' +\n                  \"this feature will only expand the axis range. It won't \" +\n                  \"narrow the data's extent.\",\n              ),\n              visibility: ({ controls }: ControlPanelsContainerProps) =>\n                Boolean(controls?.truncateYAxis?.value),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport thumbnail from './images/thumbnail.png';\nimport transformProps from './transformProps';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport example1 from './images/example1.png';\nimport example2 from './images/example2.png';\nimport { EchartsBubbleChartProps, EchartsBubbleFormData } from './types';\n\nexport default class EchartsBubbleChartPlugin extends ChartPlugin<\n  EchartsBubbleFormData,\n  EchartsBubbleChartProps\n> {\n  constructor() {\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./EchartsBubble'),\n      metadata: new ChartMetadata({\n        behaviors: [Behavior.InteractiveChart],\n        category: t('Correlation'),\n        credits: ['https://echarts.apache.org'],\n        description: t(\n          'Visualizes a metric across three dimensions of data in a single chart (X axis, Y axis, and bubble size). Bubbles from the same group can be showcased using bubble color.',\n        ),\n        exampleGallery: [{ url: example1 }, { url: example2 }],\n        name: t('Bubble Chart'),\n        tags: [\n          t('Multi-Dimensions'),\n          t('Aesthetic'),\n          t('Comparison'),\n          t('Scatter'),\n          t('Time'),\n          t('Trend'),\n          t('ECharts'),\n        ],\n        thumbnail,\n      }),\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AppSection,\n  Behavior,\n  ChartProps,\n  DataRecord,\n  FilterState,\n  GenericDataType,\n  QueryFormData,\n  ChartDataResponseResult,\n} from '@superset-ui/core';\nimport { RefObject } from 'react';\nimport { FilterBarOrientation } from 'src/dashboard/types';\nimport { PluginFilterHooks, PluginFilterStylesProps } from '../types';\n\nexport type SelectValue = (number | string | null)[] | null | undefined;\n\nexport interface PluginFilterSelectCustomizeProps {\n  defaultValue?: SelectValue;\n  enableEmptyFilter: boolean;\n  inverseSelection: boolean;\n  multiSelect: boolean;\n  defaultToFirstItem: boolean;\n  searchAllOptions: boolean;\n  sortAscending?: boolean;\n  sortMetric?: string;\n}\n\nexport type PluginFilterSelectQueryFormData = QueryFormData &\n  PluginFilterStylesProps &\n  PluginFilterSelectCustomizeProps;\n\nexport interface PluginFilterSelectChartProps extends ChartProps {\n  queriesData: ChartDataResponseResult[];\n}\n\nexport type PluginFilterSelectProps = PluginFilterStylesProps & {\n  coltypeMap: Record<string, GenericDataType>;\n  data: DataRecord[];\n  behaviors: Behavior[];\n  appSection: AppSection;\n  formData: PluginFilterSelectQueryFormData;\n  filterState: FilterState;\n  isRefreshing: boolean;\n  showOverflow: boolean;\n  parentRef?: RefObject<any>;\n  inputRef?: RefObject<any>;\n  filterBarOrientation?: FilterBarOrientation;\n  isOverflowingFilterBar?: boolean;\n} & PluginFilterHooks;\n\nexport const DEFAULT_FORM_DATA: PluginFilterSelectCustomizeProps = {\n  defaultValue: null,\n  enableEmptyFilter: false,\n  inverseSelection: false,\n  defaultToFirstItem: false,\n  multiSelect: true,\n  searchAllOptions: false,\n  sortAscending: true,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  GenericDataType,\n  getColumnLabel,\n  isPhysicalColumn,\n  QueryObject,\n  QueryObjectFilterClause,\n  BuildQuery,\n} from '@superset-ui/core';\nimport { DEFAULT_FORM_DATA, PluginFilterSelectQueryFormData } from './types';\n\nconst buildQuery: BuildQuery<PluginFilterSelectQueryFormData> = (\n  formData: PluginFilterSelectQueryFormData,\n  options,\n) => {\n  const { search, coltypeMap } = options?.ownState || {};\n  const { sortAscending, sortMetric } = { ...DEFAULT_FORM_DATA, ...formData };\n  return buildQueryContext(formData, baseQueryObject => {\n    const { columns = [], filters = [] } = baseQueryObject;\n    const extraFilters: QueryObjectFilterClause[] = [];\n    if (search) {\n      columns.filter(isPhysicalColumn).forEach(column => {\n        const label = getColumnLabel(column);\n        if (\n          coltypeMap[label] === GenericDataType.String ||\n          (coltypeMap[label] === GenericDataType.Numeric &&\n            !Number.isNaN(Number(search)))\n        ) {\n          extraFilters.push({\n            col: column,\n            op: 'ILIKE',\n            val: `%${search}%`,\n          });\n        }\n      });\n    }\n\n    const sortColumns = sortMetric ? [sortMetric] : columns;\n    const query: QueryObject[] = [\n      {\n        ...baseQueryObject,\n        columns,\n        metrics: sortMetric ? [sortMetric] : [],\n        filters: filters.concat(extraFilters),\n        orderby:\n          sortMetric || sortAscending !== undefined\n            ? sortColumns.map(column => [column, !!sortAscending])\n            : [],\n      },\n    ];\n    return query;\n  });\n};\n\nexport default buildQuery;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { DEFAULT_FORM_DATA } from './types';\n\nconst {\n  enableEmptyFilter,\n  inverseSelection,\n  multiSelect,\n  defaultToFirstItem,\n  searchAllOptions,\n  sortAscending,\n} = DEFAULT_FORM_DATA;\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'groupby',\n            config: {\n              ...sharedControls.groupby,\n              label: t('Column'),\n              required: true,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('UI Configuration'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'sortAscending',\n            config: {\n              type: 'CheckboxControl',\n              renderTrigger: true,\n              label: t('Sort ascending'),\n              default: sortAscending,\n              description: t('Check for sorting ascending'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'multiSelect',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Can select multiple values'),\n              default: multiSelect,\n              resetConfig: true,\n              affectsDataMask: true,\n              renderTrigger: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'enableEmptyFilter',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Filter value is required'),\n              default: enableEmptyFilter,\n              renderTrigger: true,\n              description: t(\n                'User must select a value before applying the filter',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'defaultToFirstItem',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Select first filter value by default'),\n              default: defaultToFirstItem,\n              resetConfig: true,\n              affectsDataMask: true,\n              renderTrigger: true,\n              requiredFirst: true,\n              description: t(\n                'When using this option, default value cant be set',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'inverseSelection',\n            config: {\n              type: 'CheckboxControl',\n              renderTrigger: true,\n              affectsDataMask: true,\n              label: t('Inverse selection'),\n              default: inverseSelection,\n              description: t('Exclude selected values'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'searchAllOptions',\n            config: {\n              type: 'CheckboxControl',\n              renderTrigger: true,\n              affectsDataMask: true,\n              label: t('Dynamically search all filter values'),\n              default: searchAllOptions,\n              description: t(\n                'By default, each filter loads at most 1000 choices at the initial page load. ' +\n                  'Check this box if you have more than 1000 filter values and want to enable dynamically ' +\n                  'searching that loads filter values as users type (may add stress to your database).',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    groupby: {\n      multi: false,\n      validators: [validateNonEmpty],\n    },\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { GenericDataType } from '@superset-ui/core';\nimport { noOp } from 'src/utils/common';\nimport { DEFAULT_FORM_DATA, PluginFilterSelectChartProps } from './types';\n\nexport default function transformProps(\n  chartProps: PluginFilterSelectChartProps,\n) {\n  const {\n    formData,\n    height,\n    hooks,\n    queriesData,\n    width,\n    displaySettings,\n    behaviors,\n    appSection,\n    filterState,\n    isRefreshing,\n    inputRef,\n  } = chartProps;\n  const newFormData = { ...DEFAULT_FORM_DATA, ...formData };\n  const {\n    setDataMask = noOp,\n    setHoveredFilter = noOp,\n    unsetHoveredFilter = noOp,\n    setFocusedFilter = noOp,\n    unsetFocusedFilter = noOp,\n    setFilterActive = noOp,\n  } = hooks;\n  const [queryData] = queriesData;\n  const { colnames = [], coltypes = [], data = [] } = queryData || {};\n  const coltypeMap: Record<string, GenericDataType> = colnames.reduce(\n    (accumulator, item, index) => ({ ...accumulator, [item]: coltypes[index] }),\n    {},\n  );\n\n  return {\n    filterState,\n    coltypeMap,\n    appSection,\n    width,\n    behaviors,\n    height,\n    data,\n    formData: newFormData,\n    isRefreshing,\n    setDataMask,\n    setHoveredFilter,\n    unsetHoveredFilter,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    setFilterActive,\n    inputRef,\n    filterBarOrientation: displaySettings?.filterBarOrientation,\n    isOverflowingFilterBar: displaySettings?.isOverflowingFilterBar,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\n\nexport default class FilterSelectPlugin extends ChartPlugin {\n  constructor() {\n    const metadata = new ChartMetadata({\n      name: t('Select filter'),\n      description: t('Select filter plugin using AntD'),\n      behaviors: [Behavior.InteractiveChart, Behavior.NativeFilter],\n      enableNoResults: false,\n      tags: [t('Experimental')],\n      thumbnail,\n    });\n\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./SelectFilterPlugin'),\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  GenericDataType,\n  QueryFormData,\n} from '@superset-ui/core';\n\n/**\n * The buildQuery function is used to create an instance of QueryContext that's\n * sent to the chart data endpoint. In addition to containing information of which\n * datasource to use, it specifies the type (e.g. full payload, samples, query) and\n * format (e.g. CSV or JSON) of the result and whether or not to force refresh the data from\n * the datasource as opposed to using a cached copy of the data, if available.\n *\n * More importantly though, QueryContext contains a property `queries`, which is an array of\n * QueryObjects specifying individual data requests to be made. A QueryObject specifies which\n * columns, metrics and filters, among others, to use during the query. Usually it will be enough\n * to specify just one query based on the baseQueryObject, but for some more advanced use cases\n * it is possible to define post processing operations in the QueryObject, or multiple queries\n * if a viz needs multiple different result sets.\n */\nexport default function buildQuery(formData: QueryFormData) {\n  const { groupby } = formData;\n  const [column = ''] = groupby || [];\n  // @ts-ignore (need update interface Column )\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      columns: [],\n      metrics: [\n        {\n          aggregate: 'MIN',\n          column: {\n            column_name: column,\n            id: 1,\n            type_generic: GenericDataType.Numeric,\n          },\n          expressionType: 'SIMPLE',\n          hasCustomLabel: true,\n          label: 'min',\n        },\n        {\n          aggregate: 'MAX',\n          column: {\n            column_name: column,\n            id: 2,\n            type_generic: GenericDataType.Numeric,\n          },\n          expressionType: 'SIMPLE',\n          hasCustomLabel: true,\n          label: 'max',\n        },\n      ],\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { SingleValueType } from './SingleValueType';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'groupby',\n            config: {\n              ...sharedControls.groupby,\n              label: t('Column'),\n              required: true,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('UI Configuration'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'enableEmptyFilter',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Filter value is required'),\n              default: false,\n              renderTrigger: true,\n              description: t(\n                'User must select a value before applying the filter',\n              ),\n            },\n          },\n          {\n            name: 'enableSingleValue',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Single value'),\n              default: SingleValueType.Exact,\n              renderTrigger: true,\n              description: t('Use only a single value.'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ChartProps } from '@superset-ui/core';\nimport { noOp } from 'src/utils/common';\n\nexport default function transformProps(chartProps: ChartProps) {\n  const {\n    formData,\n    height,\n    hooks,\n    queriesData,\n    width,\n    behaviors,\n    filterState,\n    inputRef,\n    displaySettings,\n  } = chartProps;\n  const {\n    setDataMask = noOp,\n    setFocusedFilter = noOp,\n    unsetFocusedFilter = noOp,\n    setHoveredFilter = noOp,\n    unsetHoveredFilter = noOp,\n    setFilterActive = noOp,\n  } = hooks;\n  const { data } = queriesData[0];\n\n  return {\n    data,\n    formData,\n    behaviors,\n    height,\n    setDataMask,\n    filterState,\n    width,\n    setHoveredFilter,\n    unsetHoveredFilter,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    setFilterActive,\n    inputRef,\n    isOverflowingFilterBar: displaySettings?.isOverflowingFilterBar,\n    filterBarOrientation: displaySettings?.filterBarOrientation,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\n\nexport default class RangeFilterPlugin extends ChartPlugin {\n  constructor() {\n    const metadata = new ChartMetadata({\n      name: t('Range filter'),\n      description: t('Range filter plugin using AntD'),\n      behaviors: [Behavior.InteractiveChart, Behavior.NativeFilter],\n      tags: [t('Experimental')],\n      thumbnail,\n    });\n\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./RangeFilterPlugin'),\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelConfig,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\n\nconst config: ControlPanelConfig = {\n  // For control input types, see: superset-frontend/src/explore/components/controls/index.js\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'groupby',\n            config: {\n              ...sharedControls.groupby,\n              label: t('Column'),\n              required: true,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('UI Configuration'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'enableEmptyFilter',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Filter value is required'),\n              default: false,\n              renderTrigger: true,\n              description: t(\n                'User must select a value before applying the filter',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { RefObject } from 'react';\nimport {\n  Behavior,\n  DataRecord,\n  FilterState,\n  QueryFormData,\n} from '@superset-ui/core';\nimport { PluginFilterHooks, PluginFilterStylesProps } from '../types';\n\ninterface PluginFilterTimeCustomizeProps {\n  defaultValue?: string | null;\n}\n\nexport type PluginFilterSelectQueryFormData = QueryFormData &\n  PluginFilterStylesProps &\n  PluginFilterTimeCustomizeProps;\n\nexport type PluginFilterTimeProps = PluginFilterStylesProps & {\n  behaviors: Behavior[];\n  data: DataRecord[];\n  formData: PluginFilterSelectQueryFormData;\n  filterState: FilterState;\n  inputRef: RefObject<HTMLInputElement>;\n  isOverflowingFilterBar?: boolean;\n} & PluginFilterHooks;\n\nexport const DEFAULT_FORM_DATA: PluginFilterTimeCustomizeProps = {\n  defaultValue: null,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ChartProps } from '@superset-ui/core';\nimport { noOp } from 'src/utils/common';\nimport { DEFAULT_FORM_DATA } from './types';\n\nexport default function transformProps(chartProps: ChartProps) {\n  const {\n    formData,\n    height,\n    hooks,\n    queriesData,\n    width,\n    behaviors,\n    filterState,\n    inputRef,\n    displaySettings,\n  } = chartProps;\n  const {\n    setDataMask = noOp,\n    setHoveredFilter = noOp,\n    unsetHoveredFilter = noOp,\n    setFocusedFilter = noOp,\n    unsetFocusedFilter = noOp,\n    setFilterActive = noOp,\n  } = hooks;\n  const { data } = queriesData[0];\n\n  return {\n    data,\n    filterState,\n    formData: {\n      ...DEFAULT_FORM_DATA,\n      ...formData,\n    },\n    height,\n    behaviors,\n    setDataMask,\n    setHoveredFilter,\n    unsetHoveredFilter,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    setFilterActive,\n    width,\n    inputRef,\n    filterBarOrientation: displaySettings?.filterBarOrientation,\n    isOverflowingFilterBar: displaySettings?.isOverflowingFilterBar,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\n\nexport default class TimeFilterPlugin extends ChartPlugin {\n  constructor() {\n    const metadata = new ChartMetadata({\n      name: t('Time filter'),\n      description: t('Custom time filter plugin'),\n      behaviors: [Behavior.InteractiveChart, Behavior.NativeFilter],\n      thumbnail,\n      tags: [t('Experimental')],\n      datasourceCount: 0,\n    });\n\n    super({\n      controlPanel,\n      loadChart: () => import('./TimeFilterPlugin'),\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\n/**\n * The buildQuery function is used to create an instance of QueryContext that's\n * sent to the chart data endpoint. In addition to containing information of which\n * datasource to use, it specifies the type (e.g. full payload, samples, query) and\n * format (e.g. CSV or JSON) of the result and whether or not to force refresh the data from\n * the datasource as opposed to using a cached copy of the data, if available.\n *\n * More importantly though, QueryContext contains a property `queries`, which is an array of\n * QueryObjects specifying individual data requests to be made. A QueryObject specifies which\n * columns, metrics and filters, among others, to use during the query. Usually it will be enough\n * to specify just one query based on the baseQueryObject, but for some more advanced use cases\n * it is possible to define post processing operations in the QueryObject, or multiple queries\n * if a viz needs multiple different result sets.\n */\nexport default function buildQuery(formData: QueryFormData) {\n  return buildQueryContext(formData, () => [\n    {\n      result_type: 'columns',\n      columns: [],\n      metrics: [],\n      orderby: [],\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('UI Configuration'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'enableEmptyFilter',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Filter value is required'),\n              default: false,\n              renderTrigger: true,\n              description: t(\n                'User must select a value before applying the filter',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  Behavior,\n  DataRecord,\n  FilterState,\n  QueryFormData,\n} from '@superset-ui/core';\nimport { RefObject } from 'react';\nimport { PluginFilterHooks, PluginFilterStylesProps } from '../types';\n\ninterface PluginFilterTimeColumnCustomizeProps {\n  defaultValue?: string[] | null;\n  inputRef?: RefObject<HTMLInputElement>;\n}\n\nexport type PluginFilterTimeColumnQueryFormData = QueryFormData &\n  PluginFilterStylesProps &\n  PluginFilterTimeColumnCustomizeProps;\n\nexport type PluginFilterTimeColumnProps = PluginFilterStylesProps & {\n  behaviors: Behavior[];\n  data: DataRecord[];\n  filterState: FilterState;\n  formData: PluginFilterTimeColumnQueryFormData;\n  inputRef: RefObject<HTMLInputElement>;\n} & PluginFilterHooks;\n\nexport const DEFAULT_FORM_DATA: PluginFilterTimeColumnCustomizeProps = {\n  defaultValue: null,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ChartProps } from '@superset-ui/core';\nimport { noOp } from 'src/utils/common';\nimport { DEFAULT_FORM_DATA } from './types';\n\nexport default function transformProps(chartProps: ChartProps) {\n  const {\n    behaviors,\n    formData,\n    height,\n    hooks,\n    queriesData,\n    width,\n    filterState,\n    inputRef,\n  } = chartProps;\n  const {\n    setDataMask = noOp,\n    setHoveredFilter = noOp,\n    unsetHoveredFilter = noOp,\n    setFocusedFilter = noOp,\n    unsetFocusedFilter = noOp,\n    setFilterActive = noOp,\n  } = hooks;\n\n  const { data } = queriesData[0];\n\n  return {\n    filterState,\n    behaviors,\n    width,\n    height,\n    data,\n    formData: { ...DEFAULT_FORM_DATA, ...formData },\n    setDataMask,\n    setHoveredFilter,\n    unsetHoveredFilter,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    setFilterActive,\n    inputRef,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\n\nexport default class FilterTimeColumnPlugin extends ChartPlugin {\n  constructor() {\n    const metadata = new ChartMetadata({\n      name: t('Time column'),\n      description: t('Time column filter plugin'),\n      behaviors: [Behavior.InteractiveChart, Behavior.NativeFilter],\n      tags: [t('Experimental')],\n      thumbnail,\n    });\n\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./TimeColumnFilterPlugin'),\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { buildQueryContext, QueryFormData } from '@superset-ui/core';\n\n/**\n * The buildQuery function is used to create an instance of QueryContext that's\n * sent to the chart data endpoint. In addition to containing information of which\n * datasource to use, it specifies the type (e.g. full payload, samples, query) and\n * format (e.g. CSV or JSON) of the result and whether or not to force refresh the data from\n * the datasource as opposed to using a cached copy of the data, if available.\n *\n * More importantly though, QueryContext contains a property `queries`, which is an array of\n * QueryObjects specifying individual data requests to be made. A QueryObject specifies which\n * columns, metrics and filters, among others, to use during the query. Usually it will be enough\n * to specify just one query based on the baseQueryObject, but for some more advanced use cases\n * it is possible to define post processing operations in the QueryObject, or multiple queries\n * if a viz needs multiple different result sets.\n */\nexport default function buildQuery(formData: QueryFormData) {\n  return buildQueryContext(formData, () => [\n    {\n      result_type: 'timegrains',\n      columns: [],\n      metrics: [],\n      orderby: [],\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlPanelConfig } from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('UI Configuration'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'enableEmptyFilter',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Filter value is required'),\n              default: false,\n              renderTrigger: true,\n              description: t(\n                'User must select a value before applying the filter',\n              ),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { FilterState, QueryFormData, DataRecord } from '@superset-ui/core';\nimport { RefObject } from 'react';\nimport { PluginFilterHooks, PluginFilterStylesProps } from '../types';\n\ninterface PluginFilterTimeGrainCustomizeProps {\n  defaultValue?: string[] | null;\n  inputRef?: RefObject<HTMLInputElement>;\n}\n\nexport type PluginFilterTimeGrainQueryFormData = QueryFormData &\n  PluginFilterStylesProps &\n  PluginFilterTimeGrainCustomizeProps;\n\nexport type PluginFilterTimeGrainProps = PluginFilterStylesProps & {\n  data: DataRecord[];\n  filterState: FilterState;\n  formData: PluginFilterTimeGrainQueryFormData;\n  inputRef: RefObject<HTMLInputElement>;\n} & PluginFilterHooks;\n\nexport const DEFAULT_FORM_DATA: PluginFilterTimeGrainCustomizeProps = {\n  defaultValue: null,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ChartProps } from '@superset-ui/core';\nimport { noOp } from 'src/utils/common';\nimport { DEFAULT_FORM_DATA } from './types';\n\nexport default function transformProps(chartProps: ChartProps) {\n  const { formData, height, hooks, queriesData, width, filterState, inputRef } =\n    chartProps;\n  const {\n    setDataMask = noOp,\n    setHoveredFilter = noOp,\n    unsetHoveredFilter = noOp,\n    setFocusedFilter = noOp,\n    unsetFocusedFilter = noOp,\n    setFilterActive = noOp,\n  } = hooks;\n\n  const { data } = queriesData[0];\n\n  return {\n    filterState,\n    width,\n    height,\n    data,\n    formData: { ...DEFAULT_FORM_DATA, ...formData },\n    setDataMask,\n    setHoveredFilter,\n    unsetHoveredFilter,\n    setFocusedFilter,\n    unsetFocusedFilter,\n    setFilterActive,\n    inputRef,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Behavior, ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\n\nexport default class FilterTimeGrainPlugin extends ChartPlugin {\n  constructor() {\n    const metadata = new ChartMetadata({\n      name: t('Time grain'),\n      description: t('Time grain filter plugin'),\n      behaviors: [Behavior.InteractiveChart, Behavior.NativeFilter],\n      tags: [t('Experimental')],\n      thumbnail,\n    });\n\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('./TimeGrainFilterPlugin'),\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AdhocColumn,\n  buildQueryContext,\n  ensureIsArray,\n  isPhysicalColumn,\n  QueryFormColumn,\n  QueryFormOrderBy,\n} from '@superset-ui/core';\nimport { PivotTableQueryFormData } from '../types';\n\nexport default function buildQuery(formData: PivotTableQueryFormData) {\n  const { groupbyColumns = [], groupbyRows = [], extra_form_data } = formData;\n  const time_grain_sqla =\n    extra_form_data?.time_grain_sqla || formData.time_grain_sqla;\n\n  // TODO: add deduping of AdhocColumns\n  const columns = Array.from(\n    new Set([\n      ...ensureIsArray<QueryFormColumn>(groupbyColumns),\n      ...ensureIsArray<QueryFormColumn>(groupbyRows),\n    ]),\n  ).map(col => {\n    if (\n      isPhysicalColumn(col) &&\n      time_grain_sqla &&\n      (formData?.temporal_columns_lookup?.[col] ||\n        formData.granularity_sqla === col)\n    ) {\n      return {\n        timeGrain: time_grain_sqla,\n        columnType: 'BASE_AXIS',\n        sqlExpression: col,\n        label: col,\n        expressionType: 'SQL',\n      } as AdhocColumn;\n    }\n    return col;\n  });\n\n  return buildQueryContext(formData, baseQueryObject => {\n    const { series_limit_metric, metrics, order_desc } = baseQueryObject;\n    let orderBy: QueryFormOrderBy[] | undefined;\n    if (series_limit_metric) {\n      orderBy = [[series_limit_metric, !order_desc]];\n    } else if (Array.isArray(metrics) && metrics[0]) {\n      orderBy = [[metrics[0], !order_desc]];\n    }\n    return [\n      {\n        ...baseQueryObject,\n        orderby: orderBy,\n        columns,\n      },\n    ];\n  });\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport {\n  ensureIsArray,\n  isAdhocColumn,\n  isPhysicalColumn,\n  QueryFormMetric,\n  smartDateFormatter,\n  t,\n  validateNonEmpty,\n} from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  D3_TIME_FORMAT_OPTIONS,\n  sharedControls,\n  Dataset,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { MetricsLayoutEnum } from '../types';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'groupbyColumns',\n            config: {\n              ...sharedControls.groupby,\n              label: t('Columns'),\n              description: t('Columns to group by on the columns'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'groupbyRows',\n            config: {\n              ...sharedControls.groupby,\n              label: t('Rows'),\n              description: t('Columns to group by on the rows'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'time_grain_sqla',\n            config: {\n              ...sharedControls.time_grain_sqla,\n              visibility: ({ controls }) => {\n                const dttmLookup = Object.fromEntries(\n                  ensureIsArray(controls?.groupbyColumns?.options).map(\n                    option => [option.column_name, option.is_dttm],\n                  ),\n                );\n\n                return [\n                  ...ensureIsArray(controls?.groupbyColumns.value),\n                  ...ensureIsArray(controls?.groupbyRows.value),\n                ]\n                  .map(selection => {\n                    if (isAdhocColumn(selection)) {\n                      return true;\n                    }\n                    if (isPhysicalColumn(selection)) {\n                      return !!dttmLookup[selection];\n                    }\n                    return false;\n                  })\n                  .some(Boolean);\n              },\n            },\n          },\n          'temporal_columns_lookup',\n        ],\n        [\n          {\n            name: 'metrics',\n            config: {\n              ...sharedControls.metrics,\n              validators: [validateNonEmpty],\n              rerender: ['conditional_formatting'],\n            },\n          },\n        ],\n        [\n          {\n            name: 'metricsLayout',\n            config: {\n              type: 'RadioButtonControl',\n              renderTrigger: true,\n              label: t('Apply metrics on'),\n              default: MetricsLayoutEnum.COLUMNS,\n              options: [\n                [MetricsLayoutEnum.COLUMNS, t('Columns')],\n                [MetricsLayoutEnum.ROWS, t('Rows')],\n              ],\n              description: t(\n                'Use metrics as a top level group for columns or for rows',\n              ),\n            },\n          },\n        ],\n        ['adhoc_filters'],\n        ['series_limit'],\n        [\n          {\n            name: 'row_limit',\n            config: {\n              ...sharedControls.row_limit,\n              label: t('Cell limit'),\n              description: t('Limits the number of cells that get retrieved.'),\n            },\n          },\n        ],\n        // TODO(kgabryje): add series_columns control after control panel is redesigned to avoid clutter\n        [\n          {\n            name: 'series_limit_metric',\n            config: {\n              ...sharedControls.series_limit_metric,\n              description: t(\n                'Metric used to define how the top series are sorted if a series or cell limit is present. ' +\n                  'If undefined reverts to the first metric (where appropriate).',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'order_desc',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Sort Descending'),\n              default: true,\n              description: t('Whether to sort descending or ascending'),\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Options'),\n      expanded: true,\n      tabOverride: 'data',\n      controlSetRows: [\n        [\n          {\n            name: 'aggregateFunction',\n            config: {\n              type: 'SelectControl',\n              label: t('Aggregation function'),\n              clearable: false,\n              choices: [\n                ['Count', t('Count')],\n                ['Count Unique Values', t('Count Unique Values')],\n                ['List Unique Values', t('List Unique Values')],\n                ['Sum', t('Sum')],\n                ['Average', t('Average')],\n                ['Median', t('Median')],\n                ['Sample Variance', t('Sample Variance')],\n                ['Sample Standard Deviation', t('Sample Standard Deviation')],\n                ['Minimum', t('Minimum')],\n                ['Maximum', t('Maximum')],\n                ['First', t('First')],\n                ['Last', t('Last')],\n                ['Sum as Fraction of Total', t('Sum as Fraction of Total')],\n                ['Sum as Fraction of Rows', t('Sum as Fraction of Rows')],\n                ['Sum as Fraction of Columns', t('Sum as Fraction of Columns')],\n                ['Count as Fraction of Total', t('Count as Fraction of Total')],\n                ['Count as Fraction of Rows', t('Count as Fraction of Rows')],\n                [\n                  'Count as Fraction of Columns',\n                  t('Count as Fraction of Columns'),\n                ],\n              ],\n              default: 'Sum',\n              description: t(\n                'Aggregate function to apply when pivoting and computing the total rows and columns',\n              ),\n              renderTrigger: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'rowTotals',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show rows total'),\n              default: false,\n              renderTrigger: true,\n              description: t('Display row level total'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'rowSubTotals',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show rows subtotal'),\n              default: false,\n              renderTrigger: true,\n              description: t('Display row level subtotal'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'colTotals',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show columns total'),\n              default: false,\n              renderTrigger: true,\n              description: t('Display column level total'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'colSubTotals',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Show columns subtotal'),\n              default: false,\n              renderTrigger: true,\n              description: t('Display column level subtotal'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'transposePivot',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Transpose pivot'),\n              default: false,\n              description: t('Swap rows and columns'),\n              renderTrigger: true,\n            },\n          },\n        ],\n        [\n          {\n            name: 'combineMetric',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Combine metrics'),\n              default: false,\n              description: t(\n                'Display metrics side by side within each column, as ' +\n                  'opposed to each column being displayed side by side for each metric.',\n              ),\n              renderTrigger: true,\n            },\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Options'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'valueFormat',\n            config: {\n              ...sharedControls.y_axis_format,\n              label: t('Value format'),\n            },\n          },\n        ],\n        ['currency_format'],\n        [\n          {\n            name: 'date_format',\n            config: {\n              type: 'SelectControl',\n              freeForm: true,\n              label: t('Date format'),\n              default: smartDateFormatter.id,\n              renderTrigger: true,\n              choices: D3_TIME_FORMAT_OPTIONS,\n              description: t('D3 time format for datetime columns'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'rowOrder',\n            config: {\n              type: 'SelectControl',\n              label: t('Sort rows by'),\n              default: 'key_a_to_z',\n              choices: [\n                // [value, label]\n                ['key_a_to_z', t('key a-z')],\n                ['key_z_to_a', t('key z-a')],\n                ['value_a_to_z', t('value ascending')],\n                ['value_z_to_a', t('value descending')],\n              ],\n              renderTrigger: true,\n              description: (\n                <>\n                  <div>{t('Change order of rows.')}</div>\n                  <div>{t('Available sorting modes:')}</div>\n                  <ul>\n                    <li>{t('By key: use row names as sorting key')}</li>\n                    <li>{t('By value: use metric values as sorting key')}</li>\n                  </ul>\n                </>\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'colOrder',\n            config: {\n              type: 'SelectControl',\n              label: t('Sort columns by'),\n              default: 'key_a_to_z',\n              choices: [\n                // [value, label]\n                ['key_a_to_z', t('key a-z')],\n                ['key_z_to_a', t('key z-a')],\n                ['value_a_to_z', t('value ascending')],\n                ['value_z_to_a', t('value descending')],\n              ],\n              renderTrigger: true,\n              description: (\n                <>\n                  <div>{t('Change order of columns.')}</div>\n                  <div>{t('Available sorting modes:')}</div>\n                  <ul>\n                    <li>{t('By key: use column names as sorting key')}</li>\n                    <li>{t('By value: use metric values as sorting key')}</li>\n                  </ul>\n                </>\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: 'rowSubtotalPosition',\n            config: {\n              type: 'SelectControl',\n              label: t('Rows subtotal position'),\n              default: false,\n              choices: [\n                // [value, label]\n                [true, t('Top')],\n                [false, t('Bottom')],\n              ],\n              renderTrigger: true,\n              description: t('Position of row level subtotal'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'colSubtotalPosition',\n            config: {\n              type: 'SelectControl',\n              label: t('Columns subtotal position'),\n              default: false,\n              choices: [\n                // [value, label]\n                [true, t('Left')],\n                [false, t('Right')],\n              ],\n              renderTrigger: true,\n              description: t('Position of column level subtotal'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'conditional_formatting',\n            config: {\n              type: 'ConditionalFormattingControl',\n              renderTrigger: true,\n              label: t('Conditional formatting'),\n              description: t('Apply conditional color formatting to metrics'),\n              mapStateToProps(explore, _, chart) {\n                const values =\n                  (explore?.controls?.metrics?.value as QueryFormMetric[]) ??\n                  [];\n                const verboseMap = explore?.datasource?.hasOwnProperty(\n                  'verbose_map',\n                )\n                  ? (explore?.datasource as Dataset)?.verbose_map\n                  : explore?.datasource?.columns ?? {};\n                const chartStatus = chart?.chartStatus;\n                const metricColumn = values.map(value => {\n                  if (typeof value === 'string') {\n                    return { value, label: verboseMap[value] ?? value };\n                  }\n                  return { value: value.label, label: value.label };\n                });\n                return {\n                  removeIrrelevantConditions: chartStatus === 'success',\n                  columnOptions: metricColumn,\n                  verboseMap,\n                };\n              },\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  formDataOverrides: formData => {\n    const groupbyColumns = getStandardizedControls().controls.columns.filter(\n      col => !ensureIsArray(formData.groupbyRows).includes(col),\n    );\n    getStandardizedControls().controls.columns =\n      getStandardizedControls().controls.columns.filter(\n        col => !groupbyColumns.includes(col),\n      );\n    return {\n      ...formData,\n      metrics: getStandardizedControls().popAllMetrics(),\n      groupbyColumns,\n    };\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ChartProps,\n  DataRecord,\n  extractTimegrain,\n  GenericDataType,\n  getTimeFormatter,\n  getTimeFormatterForGranularity,\n  QueryFormData,\n  smartDateFormatter,\n  TimeFormats,\n} from '@superset-ui/core';\nimport { getColorFormatters } from '@superset-ui/chart-controls';\nimport { DateFormatter } from '../types';\n\nconst { DATABASE_DATETIME } = TimeFormats;\n\nfunction isNumeric(key: string, data: DataRecord[] = []) {\n  return data.every(\n    record =>\n      record[key] === null ||\n      record[key] === undefined ||\n      typeof record[key] === 'number',\n  );\n}\n\nexport default function transformProps(chartProps: ChartProps<QueryFormData>) {\n  /**\n   * This function is called after a successful response has been\n   * received from the chart data endpoint, and is used to transform\n   * the incoming data prior to being sent to the Visualization.\n   *\n   * The transformProps function is also quite useful to return\n   * additional/modified props to your data viz component. The formData\n   * can also be accessed from your PivotTableChart.tsx file, but\n   * doing supplying custom props here is often handy for integrating third\n   * party libraries that rely on specific props.\n   *\n   * A description of properties in `chartProps`:\n   * - `height`, `width`: the height/width of the DOM element in which\n   *   the chart is located\n   * - `formData`: the chart data request payload that was sent to the\n   *   backend.\n   * - `queriesData`: the chart data response payload that was received\n   *   from the backend. Some notable properties of `queriesData`:\n   *   - `data`: an array with data, each row with an object mapping\n   *     the column/alias to its value. Example:\n   *     `[{ col1: 'abc', metric1: 10 }, { col1: 'xyz', metric1: 20 }]`\n   *   - `rowcount`: the number of rows in `data`\n   *   - `query`: the query that was issued.\n   *\n   * Please note: the transformProps function gets cached when the\n   * application loads. When making changes to the `transformProps`\n   * function during development with hot reloading, changes won't\n   * be seen until restarting the development server.\n   */\n  const {\n    width,\n    height,\n    queriesData,\n    formData,\n    rawFormData,\n    hooks: { setDataMask = () => {}, onContextMenu },\n    filterState,\n    datasource: { verboseMap = {}, columnFormats = {}, currencyFormats = {} },\n    emitCrossFilters,\n  } = chartProps;\n  const { data, colnames, coltypes } = queriesData[0];\n  const {\n    groupbyRows,\n    groupbyColumns,\n    metrics,\n    tableRenderer,\n    colOrder,\n    rowOrder,\n    aggregateFunction,\n    transposePivot,\n    combineMetric,\n    rowSubtotalPosition,\n    colSubtotalPosition,\n    colTotals,\n    colSubTotals,\n    rowTotals,\n    rowSubTotals,\n    valueFormat,\n    dateFormat,\n    metricsLayout,\n    conditionalFormatting,\n    timeGrainSqla,\n    currencyFormat,\n  } = formData;\n  const { selectedFilters } = filterState;\n  const granularity = extractTimegrain(rawFormData);\n\n  const dateFormatters = colnames\n    .filter(\n      (colname: string, index: number) =>\n        coltypes[index] === GenericDataType.Temporal,\n    )\n    .reduce(\n      (\n        acc: Record<string, DateFormatter | undefined>,\n        temporalColname: string,\n      ) => {\n        let formatter: DateFormatter | undefined;\n        if (dateFormat === smartDateFormatter.id) {\n          if (granularity) {\n            // time column use formats based on granularity\n            formatter = getTimeFormatterForGranularity(granularity);\n          } else if (isNumeric(temporalColname, data)) {\n            formatter = getTimeFormatter(DATABASE_DATETIME);\n          } else {\n            // if no column-specific format, print cell as is\n            formatter = String;\n          }\n        } else if (dateFormat) {\n          formatter = getTimeFormatter(dateFormat);\n        }\n        if (formatter) {\n          acc[temporalColname] = formatter;\n        }\n        return acc;\n      },\n      {},\n    );\n  const metricColorFormatters = getColorFormatters(conditionalFormatting, data);\n\n  return {\n    width,\n    height,\n    data,\n    groupbyRows,\n    groupbyColumns,\n    metrics,\n    tableRenderer,\n    colOrder,\n    rowOrder,\n    aggregateFunction,\n    transposePivot,\n    combineMetric,\n    rowSubtotalPosition,\n    colSubtotalPosition,\n    colTotals,\n    colSubTotals,\n    rowTotals,\n    rowSubTotals,\n    valueFormat,\n    currencyFormat,\n    emitCrossFilters,\n    setDataMask,\n    selectedFilters,\n    verboseMap,\n    columnFormats,\n    currencyFormats,\n    metricsLayout,\n    metricColorFormatters,\n    dateFormatters,\n    onContextMenu,\n    timeGrainSqla,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  Behavior,\n  ChartMetadata,\n  ChartPlugin,\n  ChartProps,\n  QueryFormData,\n  t,\n} from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from '../images/thumbnail.png';\nimport example from '../images/example.jpg';\nimport { PivotTableQueryFormData } from '../types';\n\nexport default class PivotTableChartPlugin extends ChartPlugin<\n  PivotTableQueryFormData,\n  ChartProps<QueryFormData>\n> {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    const metadata = new ChartMetadata({\n      behaviors: [\n        Behavior.InteractiveChart,\n        Behavior.DrillToDetail,\n        Behavior.DrillBy,\n      ],\n      category: t('Table'),\n      description: t(\n        'Used to summarize a set of data by grouping together multiple statistics along two axes. Examples: Sales numbers by region and month, tasks by status and assignee, active users by age and location. Not the most visually stunning visualization, but highly informative and versatile.',\n      ),\n      exampleGallery: [{ url: example }],\n      name: t('Pivot Table'),\n      tags: [t('Additive'), t('Report'), t('Tabular'), t('Popular')],\n      thumbnail,\n    });\n\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../PivotTableChart'),\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  buildQueryContext,\n  normalizeOrderBy,\n  QueryFormData,\n} from '@superset-ui/core';\n\nexport default function buildQuery(formData: QueryFormData) {\n  return buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      orderby: normalizeOrderBy(baseQueryObject).orderby,\n    },\n  ]);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelsContainerProps,\n  ControlStateMapping,\n} from '@superset-ui/chart-controls';\nimport {\n  ensureIsArray,\n  QueryFormColumn,\n  QueryMode,\n  t,\n} from '@superset-ui/core';\n\nexport function getQueryMode(controls: ControlStateMapping): QueryMode {\n  const mode = controls?.query_mode?.value;\n  if (mode === QueryMode.Aggregate || mode === QueryMode.Raw) {\n    return mode as QueryMode;\n  }\n  const rawColumns = controls?.all_columns?.value as\n    | QueryFormColumn[]\n    | undefined;\n  const hasRawColumns = rawColumns && rawColumns.length > 0;\n  return hasRawColumns ? QueryMode.Raw : QueryMode.Aggregate;\n}\n\n/**\n * Visibility check\n */\nexport function isQueryMode(mode: QueryMode) {\n  return ({ controls }: Pick<ControlPanelsContainerProps, 'controls'>) =>\n    getQueryMode(controls) === mode;\n}\n\nexport const isAggMode = isQueryMode(QueryMode.Aggregate);\nexport const isRawMode = isQueryMode(QueryMode.Raw);\n\nexport const validateAggControlValues = (\n  controls: ControlStateMapping,\n  values: any[],\n) => {\n  const areControlsEmpty = values.every(val => ensureIsArray(val).length === 0);\n  return areControlsEmpty && isAggMode({ controls })\n    ? [t('Group By, Metrics or Percentage Metrics must have a value')]\n    : [];\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlSetItem,\n  ExtraControlProps,\n  sharedControls,\n  Dataset,\n  ColumnMeta,\n} from '@superset-ui/chart-controls';\nimport { ensureIsArray, t } from '@superset-ui/core';\nimport { getQueryMode, isRawMode } from './shared';\n\nconst dndAllColumns: typeof sharedControls.groupby = {\n  type: 'DndColumnSelect',\n  label: t('Columns'),\n  description: t('Columns to display'),\n  default: [],\n  mapStateToProps({ datasource, controls }, controlState) {\n    const newState: ExtraControlProps = {};\n    if (datasource) {\n      if (datasource?.columns[0]?.hasOwnProperty('filterable')) {\n        newState.options = (datasource as Dataset)?.columns?.filter(\n          (c: ColumnMeta) => c.filterable,\n        );\n      } else newState.options = datasource.columns;\n    }\n    newState.queryMode = getQueryMode(controls);\n    newState.externalValidationErrors =\n      isRawMode({ controls }) && ensureIsArray(controlState?.value).length === 0\n        ? [t('must have a value')]\n        : [];\n    return newState;\n  },\n  visibility: isRawMode,\n  resetOnHide: false,\n};\n\nexport const allColumnsControlSetItem: ControlSetItem = {\n  name: 'all_columns',\n  config: dndAllColumns,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelState,\n  ControlSetItem,\n  ControlState,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { isAggMode, validateAggControlValues } from './shared';\n\nexport const groupByControlSetItem: ControlSetItem = {\n  name: 'groupby',\n  override: {\n    visibility: isAggMode,\n    resetOnHide: false,\n    mapStateToProps: (state: ControlPanelState, controlState: ControlState) => {\n      const { controls } = state;\n      const originalMapStateToProps = sharedControls?.groupby?.mapStateToProps;\n      const newState = originalMapStateToProps?.(state, controlState) ?? {};\n      newState.externalValidationErrors = validateAggControlValues(controls, [\n        controls.metrics?.value,\n        controls.percent_metrics?.value,\n        controlState.value,\n      ]);\n      return newState;\n    },\n    rerender: ['metrics', 'percent_metrics'],\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { FC } from 'react';\nimport AceEditor, { IAceEditorProps } from 'react-ace';\n\n// must go after AceEditor import\nimport 'ace-builds/src-min-noconflict/mode-handlebars';\nimport 'ace-builds/src-min-noconflict/mode-css';\nimport 'ace-builds/src-noconflict/theme-github';\nimport 'ace-builds/src-noconflict/theme-monokai';\n\nexport type CodeEditorMode = 'handlebars' | 'css';\nexport type CodeEditorTheme = 'light' | 'dark';\n\nexport interface CodeEditorProps extends IAceEditorProps {\n  mode?: CodeEditorMode;\n  theme?: CodeEditorTheme;\n  name?: string;\n}\n\nexport const CodeEditor: FC<CodeEditorProps> = ({\n  mode,\n  theme,\n  name,\n  width,\n  height,\n  value,\n  ...rest\n}: CodeEditorProps) => {\n  const m_name = name || Math.random().toString(36).substring(7);\n  const m_theme = theme === 'light' ? 'github' : 'monokai';\n  const m_mode = mode || 'handlebars';\n  const m_height = height || '300px';\n  const m_width = width || '100%';\n\n  return (\n    <div className=\"code-editor\" style={{ minHeight: height, width: m_width }}>\n      <AceEditor\n        mode={m_mode}\n        theme={m_theme}\n        name={m_name}\n        height={m_height}\n        width={m_width}\n        fontSize={14}\n        showPrintMargin\n        focus\n        editorProps={{ $blockScrolling: true }}\n        wrapEnabled\n        highlightActiveLine\n        value={value}\n        setOptions={{\n          enableBasicAutocompletion: true,\n          enableLiveAutocompletion: true,\n          enableSnippets: true,\n          showLineNumbers: true,\n          tabSize: 2,\n          showGutter: true,\n        }}\n        {...rest}\n      />\n    </div>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { ReactNode } from 'react';\n\ninterface ControlHeaderProps {\n  children: ReactNode;\n}\n\nexport const ControlHeader = ({\n  children,\n}: ControlHeaderProps): JSX.Element => (\n  <div className=\"ControlHeader\">\n    <div className=\"pull-left\">{children}</div>\n  </div>\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { debounce } from 'lodash';\nimport { formatSelectOptions } from '@superset-ui/chart-controls';\nimport { SLOW_DEBOUNCE, t } from '@superset-ui/core';\n\nexport const PAGE_SIZE_OPTIONS = formatSelectOptions<number>([\n  [0, t('page_size.all')],\n  1,\n  2,\n  3,\n  4,\n  5,\n  10,\n  20,\n  50,\n  100,\n  200,\n]);\n\nexport const debounceFunc = debounce(\n  (func: (val: string) => void, source: string) => func(source),\n  SLOW_DEBOUNCE,\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlSetItem,\n  CustomControlConfig,\n  sharedControls,\n} from '@superset-ui/chart-controls';\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport React from 'react';\nimport { CodeEditor } from '../../components/CodeEditor/CodeEditor';\nimport { ControlHeader } from '../../components/ControlHeader/controlHeader';\nimport { debounceFunc } from '../../consts';\n\ninterface HandlebarsCustomControlProps {\n  value: string;\n}\n\nconst HandlebarsTemplateControl = (\n  props: CustomControlConfig<HandlebarsCustomControlProps>,\n) => {\n  const val = String(\n    props?.value ? props?.value : props?.default ? props?.default : '',\n  );\n\n  return (\n    <div>\n      <ControlHeader>{props.label}</ControlHeader>\n      <CodeEditor\n        theme=\"dark\"\n        value={val}\n        onChange={source => {\n          debounceFunc(props.onChange, source || '');\n        }}\n      />\n    </div>\n  );\n};\n\nexport const handlebarsTemplateControlSetItem: ControlSetItem = {\n  name: 'handlebarsTemplate',\n  config: {\n    ...sharedControls.entity,\n    type: HandlebarsTemplateControl,\n    label: t('Handlebars Template'),\n    description: t('A handlebars template that is applied to the data'),\n    default: `<ul class=\"data-list\">\n  {{#each data}}\n    <li>{{stringify this}}</li>\n  {{/each}}\n</ul>`,\n    isInt: false,\n    renderTrigger: true,\n\n    validators: [validateNonEmpty],\n    mapStateToProps: ({ controls }) => ({\n      value: controls?.handlebars_template?.value,\n    }),\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlSetItem } from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport { isAggMode } from './shared';\n\nexport const includeTimeControlSetItem: ControlSetItem = {\n  name: 'include_time',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Include time'),\n    description: t(\n      'Whether to include the time granularity as defined in the time section',\n    ),\n    default: false,\n    visibility: isAggMode,\n    resetOnHide: false,\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelsContainerProps,\n  ControlSetItem,\n} from '@superset-ui/chart-controls';\nimport { isAggMode } from './shared';\n\nexport const rowLimitControlSetItem: ControlSetItem = {\n  name: 'row_limit',\n  override: {\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      !controls?.server_pagination?.value,\n  },\n};\n\nexport const timeSeriesLimitMetricControlSetItem: ControlSetItem = {\n  name: 'timeseries_limit_metric',\n  override: {\n    visibility: isAggMode,\n    resetOnHide: false,\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelState,\n  ControlSetItem,\n  ControlState,\n  sharedControls,\n  Dataset,\n  ColumnMeta,\n  defineSavedMetrics,\n} from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport { getQueryMode, isAggMode, validateAggControlValues } from './shared';\n\nconst percentMetrics: typeof sharedControls.metrics = {\n  type: 'MetricsControl',\n  label: t('Percentage metrics'),\n  description: t(\n    'Select one or many metrics to display, that will be displayed in the percentages of total. ' +\n      'Percentage metrics will be calculated only from data within the row limit. ' +\n      'You can use an aggregation function on a column or write custom SQL to create a percentage metric.',\n  ),\n  multi: true,\n  visibility: isAggMode,\n  resetOnHide: false,\n  mapStateToProps: ({ datasource, controls }, controlState) => ({\n    columns: datasource?.columns || [],\n    savedMetrics: defineSavedMetrics(datasource),\n    datasource,\n    datasourceType: datasource?.type,\n    queryMode: getQueryMode(controls),\n    externalValidationErrors: validateAggControlValues(controls, [\n      controls.groupby?.value,\n      controls.metrics?.value,\n      controlState?.value,\n    ]),\n  }),\n  rerender: ['groupby', 'metrics'],\n  default: [],\n  validators: [],\n};\n\nconst dndPercentMetrics = {\n  ...percentMetrics,\n  type: 'DndMetricSelect',\n};\n\nexport const percentMetricsControlSetItem: ControlSetItem = {\n  name: 'percent_metrics',\n  config: {\n    ...dndPercentMetrics,\n  },\n};\n\nexport const metricsControlSetItem: ControlSetItem = {\n  name: 'metrics',\n  override: {\n    validators: [],\n    visibility: isAggMode,\n    mapStateToProps: (\n      { controls, datasource, form_data }: ControlPanelState,\n      controlState: ControlState,\n    ) => ({\n      columns: datasource?.columns[0]?.hasOwnProperty('filterable')\n        ? (datasource as Dataset)?.columns?.filter(\n            (c: ColumnMeta) => c.filterable,\n          )\n        : datasource?.columns,\n      savedMetrics: defineSavedMetrics(datasource),\n      // current active adhoc metrics\n      selectedMetrics:\n        form_data.metrics || (form_data.metric ? [form_data.metric] : []),\n      datasource,\n      externalValidationErrors: validateAggControlValues(controls, [\n        controls.groupby?.value,\n        controls.percent_metrics?.value,\n        controlState.value,\n      ]),\n    }),\n    rerender: ['groupby', 'percent_metrics'],\n    resetOnHide: false,\n  },\n};\n\nexport const showTotalsControlSetItem: ControlSetItem = {\n  name: 'show_totals',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Show summary'),\n    default: false,\n    description: t(\n      'Show total aggregations of selected metrics. Note that row limit does not apply to the result.',\n    ),\n    visibility: isAggMode,\n    resetOnHide: false,\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ControlSetItem, Dataset } from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport { isEmpty } from 'lodash';\nimport { isAggMode, isRawMode } from './shared';\n\nexport const orderByControlSetItem: ControlSetItem = {\n  name: 'order_by_cols',\n  config: {\n    type: 'SelectControl',\n    label: t('Ordering'),\n    description: t('Order results by selected columns'),\n    multi: true,\n    default: [],\n    mapStateToProps: ({ datasource }) => ({\n      choices: datasource?.hasOwnProperty('order_by_choices')\n        ? (datasource as Dataset)?.order_by_choices\n        : datasource?.columns || [],\n    }),\n    visibility: isRawMode,\n    resetOnHide: false,\n  },\n};\n\nexport const orderDescendingControlSetItem: ControlSetItem = {\n  name: 'order_desc',\n  config: {\n    type: 'CheckboxControl',\n    label: t('Sort descending'),\n    default: true,\n    description: t('Whether to sort descending or ascending'),\n    visibility: ({ controls }) =>\n      !!(\n        isAggMode({ controls }) &&\n        controls?.timeseries_limit_metric.value &&\n        !isEmpty(controls?.timeseries_limit_metric.value)\n      ),\n    resetOnHide: false,\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelsContainerProps,\n  ControlSetItem,\n  ControlSetRow,\n} from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport { PAGE_SIZE_OPTIONS } from '../../consts';\n\nexport const serverPaginationControlSetRow: ControlSetRow = [\n  {\n    name: 'server_pagination',\n    config: {\n      type: 'CheckboxControl',\n      label: t('Server pagination'),\n      description: t(\n        'Enable server side pagination of results (experimental feature)',\n      ),\n      default: false,\n    },\n  },\n];\n\nexport const serverPageLengthControlSetItem: ControlSetItem = {\n  name: 'server_page_length',\n  config: {\n    type: 'SelectControl',\n    freeForm: true,\n    label: t('Server Page Length'),\n    default: 10,\n    choices: PAGE_SIZE_OPTIONS,\n    description: t('Rows per page, 0 means no pagination'),\n    visibility: ({ controls }: ControlPanelsContainerProps) =>\n      Boolean(controls?.server_pagination?.value),\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlConfig,\n  ControlSetItem,\n  QueryModeLabel,\n} from '@superset-ui/chart-controls';\nimport { QueryMode, t } from '@superset-ui/core';\nimport { getQueryMode } from './shared';\n\nconst queryMode: ControlConfig<'RadioButtonControl'> = {\n  type: 'RadioButtonControl',\n  label: t('Query mode'),\n  default: null,\n  options: [\n    [QueryMode.Aggregate, QueryModeLabel[QueryMode.Aggregate]],\n    [QueryMode.Raw, QueryModeLabel[QueryMode.Raw]],\n  ],\n  mapStateToProps: ({ controls }) => ({ value: getQueryMode(controls) }),\n  rerender: ['all_columns', 'groupby', 'metrics', 'percent_metrics'],\n};\n\nexport const queryModeControlSetItem: ControlSetItem = {\n  name: 'query_mode',\n  config: queryMode,\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlSetItem,\n  CustomControlConfig,\n  sharedControls,\n  InfoTooltipWithTrigger,\n} from '@superset-ui/chart-controls';\nimport { t, useTheme } from '@superset-ui/core';\nimport React from 'react';\nimport { CodeEditor } from '../../components/CodeEditor/CodeEditor';\nimport { ControlHeader } from '../../components/ControlHeader/controlHeader';\nimport { debounceFunc } from '../../consts';\n\ninterface StyleCustomControlProps {\n  value: string;\n}\n\nconst StyleControl = (props: CustomControlConfig<StyleCustomControlProps>) => {\n  const theme = useTheme();\n\n  const defaultValue = props?.value\n    ? undefined\n    : `/*\n  .data-list {\n    background-color: yellow;\n  }\n*/`;\n\n  return (\n    <div>\n      <ControlHeader>\n        <div>\n          {props.label}\n          <InfoTooltipWithTrigger\n            iconsStyle={{ marginLeft: theme.gridUnit }}\n            tooltip={t('You need to configure HTML sanitization to use CSS')}\n          />\n        </div>\n      </ControlHeader>\n      <CodeEditor\n        theme=\"dark\"\n        mode=\"css\"\n        value={props.value}\n        defaultValue={defaultValue}\n        onChange={source => {\n          debounceFunc(props.onChange, source || '');\n        }}\n      />\n    </div>\n  );\n};\n\nexport const styleControlSetItem: ControlSetItem = {\n  name: 'styleTemplate',\n  config: {\n    ...sharedControls.entity,\n    type: StyleControl,\n    label: t('CSS Styles'),\n    description: t('CSS applied to the chart'),\n    isInt: false,\n    renderTrigger: true,\n\n    validators: [],\n    mapStateToProps: ({ controls }) => ({\n      value: controls?.handlebars_template?.value,\n    }),\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  ControlPanelConfig,\n  getStandardizedControls,\n} from '@superset-ui/chart-controls';\nimport { t } from '@superset-ui/core';\nimport { allColumnsControlSetItem } from './controls/columns';\nimport { groupByControlSetItem } from './controls/groupBy';\nimport { handlebarsTemplateControlSetItem } from './controls/handlebarTemplate';\nimport { includeTimeControlSetItem } from './controls/includeTime';\nimport {\n  rowLimitControlSetItem,\n  timeSeriesLimitMetricControlSetItem,\n} from './controls/limits';\nimport {\n  metricsControlSetItem,\n  percentMetricsControlSetItem,\n  showTotalsControlSetItem,\n} from './controls/metrics';\nimport {\n  orderByControlSetItem,\n  orderDescendingControlSetItem,\n} from './controls/orderBy';\nimport {\n  serverPageLengthControlSetItem,\n  serverPaginationControlSetRow,\n} from './controls/pagination';\nimport { queryModeControlSetItem } from './controls/queryMode';\nimport { styleControlSetItem } from './controls/style';\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [queryModeControlSetItem],\n        [groupByControlSetItem],\n        [metricsControlSetItem, allColumnsControlSetItem],\n        [percentMetricsControlSetItem],\n        [timeSeriesLimitMetricControlSetItem, orderByControlSetItem],\n        [orderDescendingControlSetItem],\n        serverPaginationControlSetRow,\n        [rowLimitControlSetItem, serverPageLengthControlSetItem],\n        [includeTimeControlSetItem],\n        [showTotalsControlSetItem],\n        ['adhoc_filters'],\n      ],\n    },\n    {\n      label: t('Options'),\n      expanded: true,\n      controlSetRows: [\n        [handlebarsTemplateControlSetItem],\n        [styleControlSetItem],\n      ],\n    },\n  ],\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n    metrics: getStandardizedControls().popAllMetrics(),\n  }),\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ChartProps, TimeseriesDataRecord } from '@superset-ui/core';\n\nexport default function transformProps(chartProps: ChartProps) {\n  const { width, height, formData, queriesData } = chartProps;\n  const data = queriesData[0].data as TimeseriesDataRecord[];\n\n  return {\n    width,\n    height,\n    data,\n    formData,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ChartMetadata, ChartPlugin, t } from '@superset-ui/core';\nimport thumbnail from '../images/thumbnail.png';\nimport example1 from '../images/example1.jpg';\nimport example2 from '../images/example2.jpg';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\n\nexport default class HandlebarsChartPlugin extends ChartPlugin {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    const metadata = new ChartMetadata({\n      description: t('Write a handlebars template to render the data'),\n      name: t('Handlebars'),\n      thumbnail,\n      exampleGallery: [{ url: example1 }, { url: example2 }],\n    });\n\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../Handlebars'),\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { AdhocFilter } from '@superset-ui/core';\nimport moment, { Moment } from 'moment';\n\ntype MomentTuple = [moment.Moment | null, moment.Moment | null];\n\nconst getSinceUntil = (\n  timeRange: string | null = null,\n  relativeStart: string | null = null,\n  relativeEnd: string | null = null,\n): MomentTuple => {\n  const separator = ' : ';\n  const effectiveRelativeStart = relativeStart || 'today';\n  const effectiveRelativeEnd = relativeEnd || 'today';\n\n  if (!timeRange) {\n    return [null, null];\n  }\n\n  let modTimeRange: string | null = timeRange;\n\n  if (timeRange === 'NO_TIME_RANGE' || timeRange === '_(NO_TIME_RANGE)') {\n    return [null, null];\n  }\n\n  if (timeRange?.startsWith('last') && !timeRange.includes(separator)) {\n    modTimeRange = timeRange + separator + effectiveRelativeEnd;\n  }\n\n  if (timeRange?.startsWith('next') && !timeRange.includes(separator)) {\n    modTimeRange = effectiveRelativeStart + separator + timeRange;\n  }\n\n  if (\n    timeRange?.startsWith('previous calendar week') &&\n    !timeRange.includes(separator)\n  ) {\n    return [\n      moment().subtract(1, 'week').startOf('week'),\n      moment().startOf('week'),\n    ];\n  }\n\n  if (\n    timeRange?.startsWith('previous calendar month') &&\n    !timeRange.includes(separator)\n  ) {\n    return [\n      moment().subtract(1, 'month').startOf('month'),\n      moment().startOf('month'),\n    ];\n  }\n\n  if (\n    timeRange?.startsWith('previous calendar year') &&\n    !timeRange.includes(separator)\n  ) {\n    return [\n      moment().subtract(1, 'year').startOf('year'),\n      moment().startOf('year'),\n    ];\n  }\n\n  const timeRangeLookup: Array<[RegExp, (...args: string[]) => Moment]> = [\n    [\n      /^last\\s+(day|week|month|quarter|year)$/i,\n      (unit: string) =>\n        moment().subtract(1, unit as moment.unitOfTime.DurationConstructor),\n    ],\n    [\n      /^last\\s+([0-9]+)\\s+(second|minute|hour|day|week|month|year)s?$/i,\n      (delta: string, unit: string) =>\n        moment().subtract(delta, unit as moment.unitOfTime.DurationConstructor),\n    ],\n    [\n      /^next\\s+([0-9]+)\\s+(second|minute|hour|day|week|month|year)s?$/i,\n      (delta: string, unit: string) =>\n        moment().add(delta, unit as moment.unitOfTime.DurationConstructor),\n    ],\n    [\n      // eslint-disable-next-line no-useless-escape\n      /DATEADD\\(DATETIME\\(\"([^\"]+)\"\\),\\s*(-?\\d+),\\s*([^\\)]+)\\)/i,\n      (timePart: string, delta: string, unit: string) => {\n        if (timePart === 'now') {\n          return moment().add(\n            delta,\n            unit as moment.unitOfTime.DurationConstructor,\n          );\n        }\n        if (moment(timePart.toUpperCase(), true).isValid()) {\n          return moment(timePart).add(\n            delta,\n            unit as moment.unitOfTime.DurationConstructor,\n          );\n        }\n        return moment();\n      },\n    ],\n  ];\n\n  const sinceAndUntilPartition = modTimeRange\n    .split(separator, 2)\n    .map(part => part.trim());\n\n  const sinceAndUntil: (Moment | null)[] = sinceAndUntilPartition.map(part => {\n    if (!part) {\n      return null;\n    }\n\n    let transformedValue: Moment | null = null;\n    // Matching time_range_lookup\n    const matched = timeRangeLookup.some(([pattern, fn]) => {\n      const result = part.match(pattern);\n      if (result) {\n        transformedValue = fn(...result.slice(1));\n        return true;\n      }\n\n      if (part === 'today') {\n        transformedValue = moment().startOf('day');\n        return true;\n      }\n\n      if (part === 'now') {\n        transformedValue = moment();\n        return true;\n      }\n      return false;\n    });\n\n    if (matched && transformedValue !== null) {\n      // Handle the transformed value\n    } else {\n      // Handle the case when there was no match\n      transformedValue = moment(`${part}`);\n    }\n\n    return transformedValue;\n  });\n\n  const [_since, _until] = sinceAndUntil;\n\n  if (_since && _until && _since.isAfter(_until)) {\n    throw new Error('From date cannot be larger than to date');\n  }\n\n  return [_since, _until];\n};\n\nconst calculatePrev = (\n  startDate: Moment | null,\n  endDate: Moment | null,\n  calcType: String,\n) => {\n  if (!startDate || !endDate) {\n    return [null, null];\n  }\n\n  const daysBetween = endDate.diff(startDate, 'days');\n\n  let startDatePrev = moment();\n  let endDatePrev = moment();\n  if (calcType === 'y') {\n    startDatePrev = startDate.subtract(1, 'year');\n    endDatePrev = endDate.subtract(1, 'year');\n  } else if (calcType === 'w') {\n    startDatePrev = startDate.subtract(1, 'week');\n    endDatePrev = endDate.subtract(1, 'week');\n  } else if (calcType === 'm') {\n    startDatePrev = startDate.subtract(1, 'month');\n    endDatePrev = endDate.subtract(1, 'month');\n  } else if (calcType === 'r') {\n    startDatePrev = startDate.clone().subtract(daysBetween.valueOf(), 'day');\n    endDatePrev = startDate;\n  } else {\n    startDatePrev = startDate.subtract(1, 'year');\n    endDatePrev = endDate.subtract(1, 'year');\n  }\n\n  return [startDatePrev, endDatePrev];\n};\n\nconst getTimeRange = (\n  adhocFilters: AdhocFilter[],\n  extraFormData: any,\n): string | null => {\n  const timeFilterIndex =\n    adhocFilters?.findIndex(\n      filter => 'operator' in filter && filter.operator === 'TEMPORAL_RANGE',\n    ) ?? -1;\n\n  const timeFilter =\n    timeFilterIndex !== -1 ? adhocFilters[timeFilterIndex] : null;\n\n  if (\n    timeFilter &&\n    'comparator' in timeFilter &&\n    typeof timeFilter.comparator === 'string'\n  ) {\n    let timeRange = timeFilter.comparator.toLocaleLowerCase();\n    if (extraFormData?.time_range) {\n      timeRange = extraFormData.time_range;\n    }\n    return timeRange;\n  }\n\n  return null;\n};\n\nexport const computeQueryBComparator = (\n  adhocFilters: AdhocFilter[],\n  timeComparison: string,\n  extraFormData: any,\n  join = ':',\n) => {\n  const timeRange = getTimeRange(adhocFilters, extraFormData);\n\n  let testSince = null;\n  let testUntil = null;\n\n  if (timeRange) {\n    [testSince, testUntil] = getSinceUntil(timeRange);\n  }\n\n  if (timeComparison !== 'c') {\n    const [prevStartDateMoment, prevEndDateMoment] = calculatePrev(\n      testSince,\n      testUntil,\n      timeComparison,\n    );\n\n    return `${prevStartDateMoment?.format(\n      'YYYY-MM-DDTHH:mm:ss',\n    )} ${join} ${prevEndDateMoment?.format('YYYY-MM-DDTHH:mm:ss')}`.replace(\n      /Z/g,\n      '',\n    );\n  }\n\n  return null;\n};\n\nexport const formatCustomComparator = (\n  adhocFilters: AdhocFilter[],\n  extraFormData: any,\n): string => {\n  const timeRange = getTimeRange(adhocFilters, extraFormData);\n\n  if (timeRange) {\n    const [start, end] = timeRange.split(' : ').map(dateStr => {\n      const formattedDate = moment(dateStr).format('YYYY-MM-DDTHH:mm:ss');\n      return formattedDate.replace(/Z/g, '');\n    });\n\n    return `${start} - ${end}`;\n  }\n\n  return '';\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AdhocFilter,\n  buildQueryContext,\n  QueryFormData,\n} from '@superset-ui/core';\nimport { computeQueryBComparator } from '../utils';\n\n/**\n * The buildQuery function is used to create an instance of QueryContext that's\n * sent to the chart data endpoint. In addition to containing information of which\n * datasource to use, it specifies the type (e.g. full payload, samples, query) and\n * format (e.g. CSV or JSON) of the result and whether or not to force refresh the data from\n * the datasource as opposed to using a cached copy of the data, if available.\n *\n * More importantly though, QueryContext contains a property `queries`, which is an array of\n * QueryObjects specifying individual data requests to be made. A QueryObject specifies which\n * columns, metrics and filters, among others, to use during the query. Usually it will be enough\n * to specify just one query based on the baseQueryObject, but for some more advanced use cases\n * it is possible to define post processing operations in the QueryObject, or multiple queries\n * if a viz needs multiple different result sets.\n */\n\nexport default function buildQuery(formData: QueryFormData) {\n  const {\n    cols: groupby,\n    time_comparison: timeComparison,\n    extra_form_data: extraFormData,\n  } = formData;\n\n  const queryContextA = buildQueryContext(formData, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      groupby,\n    },\n  ]);\n\n  const timeFilterIndex: number =\n    formData.adhoc_filters?.findIndex(\n      filter => 'operator' in filter && filter.operator === 'TEMPORAL_RANGE',\n    ) ?? -1;\n\n  const timeFilter: AdhocFilter | null =\n    timeFilterIndex !== -1 && formData.adhoc_filters\n      ? formData.adhoc_filters[timeFilterIndex]\n      : null;\n\n  let formDataB: QueryFormData;\n  let queryBComparator = null;\n\n  if (timeComparison !== 'c') {\n    queryBComparator = computeQueryBComparator(\n      formData.adhoc_filters || [],\n      timeComparison,\n      extraFormData,\n    );\n\n    const queryBFilter: any = {\n      ...timeFilter,\n      comparator: queryBComparator,\n    };\n\n    const otherFilters = formData.adhoc_filters?.filter(\n      (_value: any, index: number) => timeFilterIndex !== index,\n    );\n    const queryBFilters = otherFilters\n      ? [queryBFilter, ...otherFilters]\n      : [queryBFilter];\n\n    formDataB = {\n      ...formData,\n      adhoc_filters: queryBFilters,\n      extra_form_data: {\n        ...extraFormData,\n        time_range: undefined,\n      },\n    };\n  } else {\n    formDataB = {\n      ...formData,\n      adhoc_filters: formData.adhoc_custom,\n      extra_form_data: {\n        ...extraFormData,\n        time_range: undefined,\n      },\n    };\n  }\n\n  const queryContextB = buildQueryContext(formDataB, baseQueryObject => [\n    {\n      ...baseQueryObject,\n      groupby,\n    },\n  ]);\n\n  return {\n    ...queryContextA,\n    queries: [...queryContextA.queries, ...queryContextB.queries],\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ensureIsArray, t, validateNonEmpty } from '@superset-ui/core';\nimport {\n  ControlPanelConfig,\n  ControlPanelState,\n  ControlState,\n  sharedControls,\n} from '@superset-ui/chart-controls';\n\nconst validateTimeComparisonRangeValues = (\n  timeRangeValue?: any,\n  controlValue?: any,\n) => {\n  const isCustomTimeRange = timeRangeValue === 'c';\n  const isCustomControlEmpty = controlValue?.every(\n    (val: any) => ensureIsArray(val).length === 0,\n  );\n  return isCustomTimeRange && isCustomControlEmpty\n    ? [t('Filters for comparison must have a value')]\n    : [];\n};\n\nconst config: ControlPanelConfig = {\n  controlPanelSections: [\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        [\n          {\n            name: 'metrics',\n            config: {\n              ...sharedControls.metrics,\n              // it's possible to add validators to controls if\n              // certain selections/types need to be enforced\n              validators: [validateNonEmpty],\n            },\n          },\n        ],\n        ['adhoc_filters'],\n        [\n          {\n            name: 'time_comparison',\n            config: {\n              type: 'SelectControl',\n              label: t('Range for Comparison'),\n              default: 'r',\n              choices: [\n                ['r', 'Inherit range from time filters'],\n                ['y', 'Year'],\n                ['m', 'Month'],\n                ['w', 'Week'],\n                ['c', 'Custom'],\n              ],\n              rerender: ['adhoc_custom'],\n              description: t(\n                'Set the time range that will be used for the comparison metrics. ' +\n                  'For example, \"Year\" will compare to the same dates one year earlier. ' +\n                  'Use \"Inherit range from time filters\" to shift the comparison time range' +\n                  'by the same length as your time range and use \"Custom\" to set a custom comparison range.',\n              ),\n            },\n          },\n        ],\n        [\n          {\n            name: `adhoc_custom`,\n            config: {\n              ...sharedControls.adhoc_filters,\n              label: t('Filters for Comparison'),\n              description:\n                'This only applies when selecting the Range for Comparison Type: Custom',\n              visibility: ({ controls }) =>\n                controls?.time_comparison?.value === 'c',\n              mapStateToProps: (\n                state: ControlPanelState,\n                controlState: ControlState,\n              ) => ({\n                ...(sharedControls.adhoc_filters.mapStateToProps?.(\n                  state,\n                  controlState,\n                ) || {}),\n                externalValidationErrors: validateTimeComparisonRangeValues(\n                  state.controls?.time_comparison?.value,\n                  controlState.value,\n                ),\n              }),\n            },\n          },\n        ],\n        [\n          {\n            name: 'row_limit',\n            config: sharedControls.row_limit,\n          },\n        ],\n      ],\n    },\n    {\n      label: t('Chart Options'),\n      expanded: true,\n      controlSetRows: [\n        ['y_axis_format'],\n        ['currency_format'],\n        [\n          {\n            name: 'header_font_size',\n            config: {\n              type: 'SelectControl',\n              label: t('Big Number Font Size'),\n              renderTrigger: true,\n              clearable: false,\n              default: 60,\n              options: [\n                {\n                  label: t('Tiny'),\n                  value: 16,\n                },\n                {\n                  label: t('Small'),\n                  value: 20,\n                },\n                {\n                  label: t('Normal'),\n                  value: 30,\n                },\n                {\n                  label: t('Large'),\n                  value: 48,\n                },\n                {\n                  label: t('Huge'),\n                  value: 60,\n                },\n              ],\n            },\n          },\n        ],\n        [\n          {\n            name: 'subheader_font_size',\n            config: {\n              type: 'SelectControl',\n              label: t('Subheader Font Size'),\n              renderTrigger: true,\n              clearable: false,\n              default: 40,\n              options: [\n                {\n                  label: t('Tiny'),\n                  value: 16,\n                },\n                {\n                  label: t('Small'),\n                  value: 20,\n                },\n                {\n                  label: t('Normal'),\n                  value: 26,\n                },\n                {\n                  label: t('Large'),\n                  value: 32,\n                },\n                {\n                  label: t('Huge'),\n                  value: 40,\n                },\n              ],\n            },\n          },\n        ],\n        [\n          {\n            name: 'comparison_color_enabled',\n            config: {\n              type: 'CheckboxControl',\n              label: t('Add color for positive/negative change'),\n              renderTrigger: true,\n              default: false,\n              description: t('Add color for positive/negative change'),\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    y_axis_format: {\n      label: t('Number format'),\n    },\n  },\n};\n\nexport default config;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport moment from 'moment';\nimport {\n  ChartProps,\n  getMetricLabel,\n  getValueFormatter,\n  NumberFormats,\n  getNumberFormatter,\n} from '@superset-ui/core';\nimport { computeQueryBComparator, formatCustomComparator } from '../utils';\n\nexport const parseMetricValue = (metricValue: number | string | null) => {\n  if (typeof metricValue === 'string') {\n    const dateObject = moment.utc(metricValue, moment.ISO_8601, true);\n    if (dateObject.isValid()) {\n      return dateObject.valueOf();\n    }\n    return 0;\n  }\n  return metricValue ?? 0;\n};\n\nexport default function transformProps(chartProps: ChartProps) {\n  /**\n   * This function is called after a successful response has been\n   * received from the chart data endpoint, and is used to transform\n   * the incoming data prior to being sent to the Visualization.\n   *\n   * The transformProps function is also quite useful to return\n   * additional/modified props to your data viz component. The formData\n   * can also be accessed from your CustomViz.tsx file, but\n   * doing supplying custom props here is often handy for integrating third\n   * party libraries that rely on specific props.\n   *\n   * A description of properties in `chartProps`:\n   * - `height`, `width`: the height/width of the DOM element in which\n   *   the chart is located\n   * - `formData`: the chart data request payload that was sent to the\n   *   backend.\n   * - `queriesData`: the chart data response payload that was received\n   *   from the backend. Some notable properties of `queriesData`:\n   *   - `data`: an array with data, each row with an object mapping\n   *     the column/alias to its value. Example:\n   *     `[{ col1: 'abc', metric1: 10 }, { col1: 'xyz', metric1: 20 }]`\n   *   - `rowcount`: the number of rows in `data`\n   *   - `query`: the query that was issued.\n   *\n   * Please note: the transformProps function gets cached when the\n   * application loads. When making changes to the `transformProps`\n   * function during development with hot reloading, changes won't\n   * be seen until restarting the development server.\n   */\n  const {\n    width,\n    height,\n    formData,\n    queriesData,\n    datasource: { currencyFormats = {}, columnFormats = {} },\n  } = chartProps;\n  const {\n    boldText,\n    headerFontSize,\n    headerText,\n    metrics,\n    yAxisFormat,\n    currencyFormat,\n    subheaderFontSize,\n    comparisonColorEnabled,\n  } = formData;\n  const { data: dataA = [] } = queriesData[0];\n  const { data: dataB = [] } = queriesData[1];\n  const data = dataA;\n  const metricName = getMetricLabel(metrics[0]);\n  let bigNumber: number | string =\n    data.length === 0 ? 0 : parseMetricValue(data[0][metricName]);\n  let prevNumber: number | string =\n    data.length === 0 ? 0 : parseMetricValue(dataB[0][metricName]);\n\n  const numberFormatter = getValueFormatter(\n    metrics[0],\n    currencyFormats,\n    columnFormats,\n    yAxisFormat,\n    currencyFormat,\n  );\n\n  const compTitles = {\n    r: 'Range' as string,\n    y: 'Year' as string,\n    m: 'Month' as string,\n    w: 'Week' as string,\n  };\n\n  const formatPercentChange = getNumberFormatter(\n    NumberFormats.PERCENT_SIGNED_1_POINT,\n  );\n\n  let valueDifference: number | string = bigNumber - prevNumber;\n\n  let percentDifferenceNum;\n\n  if (!bigNumber && !prevNumber) {\n    percentDifferenceNum = 0;\n  } else if (!bigNumber || !prevNumber) {\n    percentDifferenceNum = bigNumber ? 1 : -1;\n  } else {\n    percentDifferenceNum = (bigNumber - prevNumber) / Math.abs(prevNumber);\n  }\n\n  const compType = compTitles[formData.timeComparison];\n  bigNumber = numberFormatter(bigNumber);\n  prevNumber = numberFormatter(prevNumber);\n  valueDifference = numberFormatter(valueDifference);\n  const percentDifference: string = formatPercentChange(percentDifferenceNum);\n  const comparatorText =\n    formData.timeComparison !== 'c'\n      ? ` ${computeQueryBComparator(\n          formData.adhocFilters,\n          formData.timeComparison,\n          formData.extraFormData,\n          ' - ',\n        )}`\n      : `${formatCustomComparator(\n          formData.adhocCustom,\n          formData.extraFormData,\n        )}`;\n\n  return {\n    width,\n    height,\n    data,\n    // and now your control data, manipulated as needed, and passed through as props!\n    metrics,\n    metricName,\n    bigNumber,\n    prevNumber,\n    valueDifference,\n    percentDifferenceFormattedString: percentDifference,\n    boldText,\n    headerFontSize,\n    subheaderFontSize,\n    headerText,\n    compType,\n    comparisonColorEnabled,\n    percentDifferenceNumber: percentDifferenceNum,\n    comparatorText,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport buildQuery from './buildQuery';\nimport controlPanel from './controlPanel';\nimport transformProps from './transformProps';\nimport thumbnail from '../images/thumbnail.png';\n\nexport default class PopKPIPlugin extends ChartPlugin {\n  /**\n   * The constructor is used to pass relevant metadata and callbacks that get\n   * registered in respective registries that are used throughout the library\n   * and application. A more thorough description of each property is given in\n   * the respective imported file.\n   *\n   * It is worth noting that `buildQuery` and is optional, and only needed for\n   * advanced visualizations that require either post processing operations\n   * (pivoting, rolling aggregations, sorting etc) or submitting multiple queries.\n   */\n  constructor() {\n    const metadata = new ChartMetadata({\n      category: t('KPI'),\n      description:\n        'Showcases a metric along with a comparison of value, change, and percent change for a selected time period.',\n      name: t('Big Number with Time Period Comparison'),\n      tags: [\n        t('Comparison'),\n        t('Business'),\n        t('Percentages'),\n        t('Report'),\n        t('Description'),\n      ],\n      thumbnail,\n    });\n\n    super({\n      buildQuery,\n      controlPanel,\n      loadChart: () => import('../PopKPI'),\n      metadata,\n      transformProps,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ChartProps, DataRecord, Metric } from '@superset-ui/core';\n\ninterface FormData {\n  groupby: string[];\n  metrics: Array<object>;\n  url: string;\n  columnCollection: Array<object> | [];\n}\n\ninterface QueryData {\n  data: {\n    records: DataRecord[];\n    columns: string[];\n  };\n}\n\nexport type TableChartProps = ChartProps & {\n  formData: FormData;\n  queriesData: QueryData[];\n};\n\ninterface ColumnData {\n  timeLag?: string | number;\n}\nexport default function transformProps(chartProps: TableChartProps) {\n  const { height, datasource, formData, queriesData } = chartProps;\n  const { columnCollection = [], groupby, metrics, url } = formData;\n  const { records, columns } = queriesData[0].data;\n  const isGroupBy = groupby?.length > 0;\n\n  // When there is a \"group by\",\n  // each row in the table is a database column\n  // Otherwise each row in the table is a metric\n  let rows;\n  if (isGroupBy) {\n    rows = columns.map(column =>\n      typeof column === 'object' ? column : { label: column },\n    );\n  } else {\n    /* eslint-disable */\n    const metricMap = datasource.metrics.reduce(\n      (acc, current) => {\n        const map = acc;\n        map[current.metric_name] = current;\n        return map;\n      },\n      {} as Record<string, Metric>,\n    );\n    /* eslint-disable */\n    rows = metrics.map(metric =>\n      typeof metric === 'object' ? metric : metricMap[metric],\n    );\n  }\n\n  // TODO: Better parse this from controls instead of mutative value here.\n  columnCollection.forEach(column => {\n    const c: ColumnData = column;\n    if (typeof c.timeLag === 'string' && c.timeLag) {\n      c.timeLag = parseInt(c.timeLag, 10);\n    }\n  });\n\n  return {\n    height,\n    data: records,\n    columnConfigs: columnCollection,\n    rows,\n    rowType: isGroupBy ? 'column' : 'metric',\n    url,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport { getStandardizedControls, sections } from '@superset-ui/chart-controls';\n\nexport default {\n  controlPanelSections: [\n    sections.legacyTimeseriesTime,\n    {\n      label: t('Query'),\n      expanded: true,\n      controlSetRows: [\n        ['metrics'],\n        ['adhoc_filters'],\n        ['groupby'],\n        ['limit'],\n        [\n          {\n            name: 'column_collection',\n            config: {\n              type: 'CollectionControl',\n              label: t('Time series columns'),\n              renderTrigger: true,\n              validators: [validateNonEmpty],\n              controlName: 'TimeSeriesColumnControl',\n            },\n          },\n        ],\n        ['row_limit'],\n        [\n          {\n            name: 'url',\n            config: {\n              type: 'TextControl',\n              label: t('URL'),\n              description: t(\n                \"Templated link, it's possible to include {{ metric }} \" +\n                  'or other values coming from the controls.',\n              ),\n              default: '',\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    groupby: {\n      multiple: false,\n    },\n  },\n  formDataOverrides: formData => ({\n    ...formData,\n    groupby: getStandardizedControls().popAllColumns(),\n    metrics: getStandardizedControls().popAllMetrics(),\n  }),\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, ChartMetadata, ChartPlugin } from '@superset-ui/core';\nimport transformProps from './transformProps';\nimport thumbnail from './images/thumbnail.png';\nimport example from './images/example.jpg';\nimport controlPanel from './controlPanel';\n\nconst metadata = new ChartMetadata({\n  category: t('Table'),\n  name: t('Time-series Table'),\n  description: t(\n    'Compare multiple time series charts (as sparklines) and related metrics quickly.',\n  ),\n  exampleGallery: [{ url: example }],\n  tags: [\n    t('Multi-Variables'),\n    t('Comparison'),\n    t('Legacy'),\n    t('Percentages'),\n    t('Tabular'),\n    t('Text'),\n    t('Trend'),\n  ],\n  thumbnail,\n  useLegacyApi: true,\n});\n\nexport default class TimeTableChartPlugin extends ChartPlugin {\n  constructor() {\n    super({\n      metadata,\n      transformProps,\n      loadChart: () => import('./TimeTable'),\n      controlPanel,\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { isFeatureEnabled, FeatureFlag, Preset } from '@superset-ui/core';\nimport CalendarChartPlugin from '@superset-ui/legacy-plugin-chart-calendar';\nimport ChordChartPlugin from '@superset-ui/legacy-plugin-chart-chord';\nimport CountryMapChartPlugin from '@superset-ui/legacy-plugin-chart-country-map';\nimport EventFlowChartPlugin from '@superset-ui/legacy-plugin-chart-event-flow';\nimport HeatmapChartPlugin from '@superset-ui/legacy-plugin-chart-heatmap';\nimport HistogramChartPlugin from '@superset-ui/legacy-plugin-chart-histogram';\nimport HorizonChartPlugin from '@superset-ui/legacy-plugin-chart-horizon';\nimport MapBoxChartPlugin from '@superset-ui/legacy-plugin-chart-map-box';\nimport PairedTTestChartPlugin from '@superset-ui/legacy-plugin-chart-paired-t-test';\nimport ParallelCoordinatesChartPlugin from '@superset-ui/legacy-plugin-chart-parallel-coordinates';\nimport PartitionChartPlugin from '@superset-ui/legacy-plugin-chart-partition';\nimport RoseChartPlugin from '@superset-ui/legacy-plugin-chart-rose';\nimport SankeyChartPlugin from '@superset-ui/legacy-plugin-chart-sankey';\nimport TableChartPlugin from '@superset-ui/plugin-chart-table';\nimport { WordCloudChartPlugin } from '@superset-ui/plugin-chart-word-cloud';\nimport WorldMapChartPlugin from '@superset-ui/legacy-plugin-chart-world-map';\nimport {\n  AreaChartPlugin,\n  BarChartPlugin,\n  BubbleChartPlugin,\n  BulletChartPlugin,\n  CompareChartPlugin,\n  DistBarChartPlugin,\n  LineChartPlugin,\n  TimePivotChartPlugin,\n} from '@superset-ui/legacy-preset-chart-nvd3';\nimport { DeckGLChartPreset } from '@superset-ui/legacy-preset-chart-deckgl';\nimport {\n  BigNumberChartPlugin,\n  BigNumberTotalChartPlugin,\n  EchartsPieChartPlugin,\n  EchartsBoxPlotChartPlugin,\n  EchartsAreaChartPlugin,\n  EchartsTimeseriesChartPlugin,\n  EchartsTimeseriesBarChartPlugin,\n  EchartsTimeseriesLineChartPlugin,\n  EchartsTimeseriesScatterChartPlugin,\n  EchartsTimeseriesSmoothLineChartPlugin,\n  EchartsTimeseriesStepChartPlugin,\n  EchartsGraphChartPlugin,\n  EchartsGaugeChartPlugin,\n  EchartsRadarChartPlugin,\n  EchartsFunnelChartPlugin,\n  EchartsTreemapChartPlugin,\n  EchartsMixedTimeseriesChartPlugin,\n  EchartsTreeChartPlugin,\n  EchartsSunburstChartPlugin,\n  EchartsBubbleChartPlugin,\n  EchartsWaterfallChartPlugin,\n} from '@superset-ui/plugin-chart-echarts';\nimport {\n  SelectFilterPlugin,\n  RangeFilterPlugin,\n  TimeFilterPlugin,\n  TimeColumnFilterPlugin,\n  TimeGrainFilterPlugin,\n} from 'src/filters/components';\nimport { PivotTableChartPlugin as PivotTableChartPluginV2 } from '@superset-ui/plugin-chart-pivot-table';\nimport { HandlebarsChartPlugin } from '@superset-ui/plugin-chart-handlebars';\nimport { PopKPIPlugin } from '@superset-ui/plugin-chart-period-over-period-kpi';\nimport { FilterPlugins } from 'src/constants';\nimport TimeTableChartPlugin from '../TimeTable';\n\nexport default class MainPreset extends Preset {\n  constructor() {\n    const experimentalPlugins = isFeatureEnabled(\n      FeatureFlag.ChartPluginsExperimental,\n    )\n      ? [new PopKPIPlugin().configure({ key: 'pop_kpi' })]\n      : [];\n\n    super({\n      name: 'Legacy charts',\n      presets: [new DeckGLChartPreset()],\n      plugins: [\n        new AreaChartPlugin().configure({ key: 'area' }),\n        new BarChartPlugin().configure({ key: 'bar' }),\n        new BigNumberChartPlugin().configure({ key: 'big_number' }),\n        new BigNumberTotalChartPlugin().configure({ key: 'big_number_total' }),\n        new EchartsBoxPlotChartPlugin().configure({ key: 'box_plot' }),\n        new BubbleChartPlugin().configure({ key: 'bubble' }),\n        new BulletChartPlugin().configure({ key: 'bullet' }),\n        new CalendarChartPlugin().configure({ key: 'cal_heatmap' }),\n        new ChordChartPlugin().configure({ key: 'chord' }),\n        new CompareChartPlugin().configure({ key: 'compare' }),\n        new CountryMapChartPlugin().configure({ key: 'country_map' }),\n        new DistBarChartPlugin().configure({ key: 'dist_bar' }),\n        new EventFlowChartPlugin().configure({ key: 'event_flow' }),\n        new EchartsFunnelChartPlugin().configure({ key: 'funnel' }),\n        new EchartsTreemapChartPlugin().configure({ key: 'treemap_v2' }),\n        new EchartsGaugeChartPlugin().configure({ key: 'gauge_chart' }),\n        new EchartsGraphChartPlugin().configure({ key: 'graph_chart' }),\n        new EchartsRadarChartPlugin().configure({ key: 'radar' }),\n        new EchartsMixedTimeseriesChartPlugin().configure({\n          key: 'mixed_timeseries',\n        }),\n        new HeatmapChartPlugin().configure({ key: 'heatmap' }),\n        new HistogramChartPlugin().configure({ key: 'histogram' }),\n        new HorizonChartPlugin().configure({ key: 'horizon' }),\n        new LineChartPlugin().configure({ key: 'line' }),\n        new MapBoxChartPlugin().configure({ key: 'mapbox' }),\n        new PairedTTestChartPlugin().configure({ key: 'paired_ttest' }),\n        new ParallelCoordinatesChartPlugin().configure({ key: 'para' }),\n        new PartitionChartPlugin().configure({ key: 'partition' }),\n        new EchartsPieChartPlugin().configure({ key: 'pie' }),\n        new PivotTableChartPluginV2().configure({ key: 'pivot_table_v2' }),\n        new RoseChartPlugin().configure({ key: 'rose' }),\n        new SankeyChartPlugin().configure({ key: 'sankey' }),\n        new TableChartPlugin().configure({ key: 'table' }),\n        new TimePivotChartPlugin().configure({ key: 'time_pivot' }),\n        new TimeTableChartPlugin().configure({ key: 'time_table' }),\n        new WordCloudChartPlugin().configure({ key: 'word_cloud' }),\n        new WorldMapChartPlugin().configure({ key: 'world_map' }),\n        new EchartsAreaChartPlugin().configure({\n          key: 'echarts_area',\n        }),\n        new EchartsTimeseriesChartPlugin().configure({\n          key: 'echarts_timeseries',\n        }),\n        new EchartsTimeseriesBarChartPlugin().configure({\n          key: 'echarts_timeseries_bar',\n        }),\n        new EchartsTimeseriesLineChartPlugin().configure({\n          key: 'echarts_timeseries_line',\n        }),\n        new EchartsTimeseriesSmoothLineChartPlugin().configure({\n          key: 'echarts_timeseries_smooth',\n        }),\n        new EchartsTimeseriesScatterChartPlugin().configure({\n          key: 'echarts_timeseries_scatter',\n        }),\n        new EchartsTimeseriesStepChartPlugin().configure({\n          key: 'echarts_timeseries_step',\n        }),\n        new EchartsWaterfallChartPlugin().configure({\n          key: 'waterfall',\n        }),\n        new SelectFilterPlugin().configure({ key: FilterPlugins.Select }),\n        new RangeFilterPlugin().configure({ key: FilterPlugins.Range }),\n        new TimeFilterPlugin().configure({ key: FilterPlugins.Time }),\n        new TimeColumnFilterPlugin().configure({\n          key: FilterPlugins.TimeColumn,\n        }),\n        new TimeGrainFilterPlugin().configure({\n          key: FilterPlugins.TimeGrain,\n        }),\n        new EchartsTreeChartPlugin().configure({ key: 'tree_chart' }),\n        new EchartsSunburstChartPlugin().configure({ key: 'sunburst_v2' }),\n        new HandlebarsChartPlugin().configure({ key: 'handlebars' }),\n        new EchartsBubbleChartPlugin().configure({ key: 'bubble_v2' }),\n        ...experimentalPlugins,\n      ],\n    });\n  }\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t, validateNonEmpty } from '@superset-ui/core';\nimport { formatSelectOptions } from 'src/explore/exploreUtils';\n\nexport default {\n  controlPanelSections: [\n    {\n      label: t('Code'),\n      controlSetRows: [\n        [\n          {\n            name: 'markup_type',\n            config: {\n              type: 'SelectControl',\n              label: t('Markup type'),\n              clearable: false,\n              choices: formatSelectOptions(['markdown', 'html']),\n              default: 'markdown',\n              validators: [validateNonEmpty],\n              description: t('Pick your favorite markup language'),\n            },\n          },\n        ],\n        [\n          {\n            name: 'code',\n            config: {\n              type: 'TextAreaControl',\n              label: t('Code'),\n              description: t('Put your code here'),\n              mapStateToProps: state => ({\n                language:\n                  state.controls && state.controls.markup_type\n                    ? state.controls.markup_type.value\n                    : 'markdown',\n              }),\n              default: '',\n            },\n          },\n        ],\n      ],\n    },\n  ],\n  controlOverrides: {\n    code: {\n      default:\n        '####Section Title\\n' +\n        'A paragraph describing the section ' +\n        'of the dashboard, right before the separator line ' +\n        '\\n\\n' +\n        '---------------',\n    },\n  },\n  sectionOverrides: {\n    sqlaTimeSeries: {\n      controlSetRows: [],\n    },\n  },\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { getChartControlPanelRegistry } from '@superset-ui/core';\nimport MainPreset from '../visualizations/presets/MainPreset';\nimport setupPluginsExtra from './setupPluginsExtra';\n\nimport Separator from '../explore/controlPanels/Separator';\n\nexport default function setupPlugins() {\n  new MainPreset().register();\n\n  // TODO: Remove these shims once the control panel configs are moved into the plugin package.\n  getChartControlPanelRegistry().registerValue('separator', Separator);\n\n  setupPluginsExtra();\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { useComponentDidMount } from '@superset-ui/core';\n\ntype FlashMessageType = 'info' | 'alert' | 'danger' | 'warning' | 'success';\nexport type FlashMessage = [FlashMessageType, string];\n\ninterface Props {\n  children: JSX.Element;\n  messages: FlashMessage[];\n}\n\nconst flashObj = {\n  info: 'addInfoToast',\n  alert: 'addDangerToast',\n  danger: 'addDangerToast',\n  warning: 'addWarningToast',\n  success: 'addSuccessToast',\n};\n\nexport default function FlashProvider({ children, messages }: Props) {\n  const toasts = useToasts();\n  useComponentDidMount(() => {\n    messages.forEach(message => {\n      const [type, text] = message;\n      const flash = flashObj[type];\n      const toast = toasts[flash];\n      if (toast) {\n        toast(text);\n      }\n    });\n  });\n  return children;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React from 'react';\nimport { Route } from 'react-router-dom';\nimport { getExtensionsRegistry, ThemeProvider } from '@superset-ui/core';\nimport { Provider as ReduxProvider } from 'react-redux';\nimport { QueryParamProvider } from 'use-query-params';\nimport { DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport getBootstrapData from 'src/utils/getBootstrapData';\nimport { store } from './store';\nimport FlashProvider from '../components/FlashProvider';\nimport { theme } from '../preamble';\nimport { EmbeddedUiConfigProvider } from '../components/UiConfigContext';\nimport { DynamicPluginProvider } from '../components/DynamicPlugins';\n\nconst { common } = getBootstrapData();\n\nconst extensionsRegistry = getExtensionsRegistry();\n\nexport const RootContextProviders: React.FC = ({ children }) => {\n  const RootContextProviderExtension = extensionsRegistry.get(\n    'root.context.provider',\n  );\n\n  return (\n    <ThemeProvider theme={theme}>\n      <ReduxProvider store={store}>\n        <DndProvider backend={HTML5Backend}>\n          <FlashProvider messages={common.flash_messages}>\n            <EmbeddedUiConfigProvider>\n              <DynamicPluginProvider>\n                <QueryParamProvider\n                  ReactRouterRoute={Route}\n                  stringifyOptions={{ encode: false }}\n                >\n                  {RootContextProviderExtension ? (\n                    <RootContextProviderExtension>\n                      {children}\n                    </RootContextProviderExtension>\n                  ) : (\n                    children\n                  )}\n                </QueryParamProvider>\n              </DynamicPluginProvider>\n            </EmbeddedUiConfigProvider>\n          </FlashProvider>\n        </DndProvider>\n      </ReduxProvider>\n    </ThemeProvider>\n  );\n};\n"],"names":["TIME_SHIFT_PATTERN","ANIMATION_TIME","cleanColorInput","value","String","trim","replace","split","filter","k","test","join","getTimeOrNumberFormatter","format","smartDateFormatter","getNumberFormatter","drawBarValues","svg","data","stacked","axisFormat","countSeriesDisplayed","d","disabled","length","totalStackedValues","values","map","bar","iBar","bars","series","d3","y","selectAll","remove","setTimeout","groupLabels","select","append","attr","i","each","index","rectObj","this","transformAttr","xPos","parseFloat","yPos","rectWidth","rectHeight","textEls","text","bbox","node","getBBox","labelWidth","width","labelHeight","height","includes","getFormattedKey","seriesKey","shouldDompurify","slice","dompurify","generateRichLineTooltipContent","timeFormatter","valueFormatter","tooltip","sort","a","b","forEach","key","highlight","color","generateCompareTooltipContent","generateAreaChartTooltipContent","chart","total","style","s","_series$point","isTotal","trClass","point","toFixed","generateTimePivotTooltip","xFormatter","yFormatter","tooltipTitle","label","getLabel","stringOrObjectWithLabel","createHTMLRow","col1","col2","generateBubbleTooltipContent","entity","xField","yField","sizeField","sizeFormatter","group","x","size","hideTooltips","shouldRemove","targets","document","querySelectorAll","t","opacity","generateTooltipClassName","uuid","removeTooltip","classSelector","target","querySelector","wrapTooltip","tooltipLayer","useInteractiveGuideline","interactiveLayer","tooltipGeneratorFunc","contentGenerator","tipFactory","layer","d3tip","annotationTipClass","direction","offset","html","titleColumn","name","Array","isArray","descriptionColumns","c","Object","getMaxLabelSize","axisClass","tickTexts","lengths","getComputedTextLength","Math","ceil","max","formatLabel","input","verboseMap","verboseLookup","l","MIN_BAR_WIDTH","computeBarChartWidth","maxWidth","barWidth","tryNumify","n","Number","isNaN","stringifyTimeRange","extent","some","undefined","toISOString","setAxisShowMaxMin","axis","showminmax","showMaxMin","computeYDomain","extents","row","v","min","computeStackedYDomain","stackedValues","_","reduce","acc","cur","isTruthy","obj","toLowerCase","extractTypes","metadata","keys","prev","result","ANNOTATION_TYPES","FORMULA","EVENT","supportNativeSource","INTERVAL","TIME_SERIES","ANNOTATION_SOURCE_TYPES","NATIVE","NATIVE_COLUMN_NAMES","intervalEndColumn","timeColumn","applyNativeColumns","annotation","sourceType","legacyTimeseriesTime","expanded","description","controlSetRows","datasourceAndVizType","config","type","hidden","colorScheme","annotations","tabOverride","default","renderTrigger","advancedAnalyticsControls","visibility","displayTimeRelatedControls","___EmotionJSX","ControlSubSectionHeader","choices","concat","formatSelectOptions","RollingType","isInt","controls","_controls$rollingType","_controls$rollingType2","rollingTypeControlName","endsWith","Boolean","Cumsum","_controls$rollingType3","_controls$rollingType4","multi","freeForm","ComparisonType","Values","Difference","Percentage","Ratio","annotationLayers","annotationsAndLayersControls","FORECAST_DEFAULT_DATA","forecastEnabled","forecastInterval","forecastPeriods","forecastSeasonalityDaily","forecastSeasonalityWeekly","forecastSeasonalityYearly","forecastIntervalControls","validators","legacyValidateInteger","legacyValidateNumber","TITLE_MARGIN_OPTIONS","TITLE_POSITION_OPTIONS","titleControls","clearable","checkColumnType","columnName","datasource","columnTypes","isDataset","ensureIsArray","columns","type_generic","column_name","isQueryResponse","contributionModeControl","ContributionType","Row","Column","isSortable","_controls$x_axis2","_controls$datasource2","_controls$x_axis","_controls$datasource","_controls$xAxisForceC","getColumnLabel","x_axis","GenericDataType","Numeric","xAxisForceCategorical","isForcedCategorical","xAxisSortVisibility","_controls$groupby","_controls$metrics","groupby","metrics","xAxisMultiSortVisibility","_controls$groupby2","_controls$metrics2","xAxisSortControl","state","_state$form_data","form_data","orientation","shouldMapStateToProps","mapStateToProps","controlState","_controls$x_axis3","_controls$metrics3","_controls$timeseries_","_controls$x_axis4","_controls$datasource3","dataset","timeseries_limit_metric","metricLabels","Set","getMetricLabel","options","column","_dataset$verbose_map","verbose_map","_dataset$verbose_map2","shouldReset","option","isTemporalColumn","xAxisSortAscControl","_state$form_data2","_controls$x_axis_sort","x_axis_sort","xAxisForceCategoricalControl","initialValue","control","_state$form_data3","_controls$x_axis5","_controls$datasource4","xAxisSortSeriesControl","_state$form_data4","SORT_SERIES_CHOICES","DEFAULT_XAXIS_SORT_SERIES_DATA","sort_series_type","xAxisSortSeriesAscendingControl","_state$form_data5","sort_series_ascending","_controls$x_axis_sort2","x_axis_sort_series","controlsWithoutXAxis","echartsTimeSeriesQuery","echartsTimeSeriesQueryWithXAxisSort","mainMetric","savedMetrics","metric","m","metric_name","TestDataset","column_formats","currency_formats","advanced_data_type","certification_details","certified_by","expression","filterable","id","is_certified","is_dttm","python_date_format","verbose_name","warning_markdown","Temporal","datasource_name","granularity_sqla","main_dttm_col","d3format","currency","warning_text","order_by_choices","owners","first_name","last_name","username","DatasourceType","Dataset","uid","sections","sectionsModule","PERCENTILE_REGEX","boxplotOperator","formData","queryObject","whiskerOptions","whiskerType","percentiles","percentileMatch","exec","Error","parseInt","operation","whisker_type","contributionOperator","time_shifts","contributionMode","flattenOperator","pivotOperator","extractExtraMetrics","xAxisLabel","getXAxisLabel","series_columns","aggregates","fromEntries","operator","drop_missing_columns","show_empty_columns","prophetOperator","time_grain","time_grain_sqla","periods","confidence_interval","yearly_seasonality","weekly_seasonality","daily_seasonality","renameOperator","truncate_metric","isTimeComparison","comparison_type","renamePairs","metricOffsetMap","getMetricOffsetsMap","timeOffsets","time_compare","metricWithOffset","offsetLabel","find","push","level","inplace","resampleOperator","resampleZeroFill","resample_method","resampleMethod","resampleRule","resample_rule","method","rule","fill_value","rollingWindowOperator","metricsMap","from","columnsMap","col","rolling_type","Sum","Mean","Std","window","ensureIsInt","rolling_periods","min_periods","sortOperator","sortableLabels","isDefined","x_axis_sort_asc","_isEmpty","is_sort_index","ascending","by","timeCompareOperator","comparisonType","source_columns","compare_columns","compare_type","drop_original_columns","timeComparePivotOperator","TIME_COMPARISON_SEPARATOR","extra_metrics","limitMetric","queryMetrics","Map","set","isDerivedSeries","timeCompare","hasTimeOffset","getTimeOffset","timeOffset","_isString","getOriginalSeries","seriesName","compare","columnChoices","opt1","opt2","round","num","precision","getOpacity","cutoffPoint","extremeValue","minOpacity","maxOpacity","abs","getColorFunction","targetValue","targetValueLeft","targetValueRight","columnValues","alpha","comparatorFunction","MultipleValueComparators","Comparator","None","allValues","cutoffValue","GreaterThan","LessThan","GreaterOrEqual","LessOrEqual","Equal","NotEqual","Between","BetweenOrEqual","BetweenOrLeftEqual","BetweenOrRightEqual","compareResult","addAlpha","getColorFormatters","memoizeOne","columnConfig","_columnConfig$reduce","getColorFromValue","ChartMetadata","constructor","canBeAnnotationTypes","canBeAnnotationTypesLookup","credits","supportedAnnotationTypes","thumbnail","useLegacyApi","behaviors","datasourceCount","enableNoResults","exampleGallery","tags","category","deprecated","labelExplanation","queryObjectCount","parseMethod","lookup","canBeAnnotationType","clone","IDENTITY","EMPTY","sanitizeLoader","loader","loaded","Promise","then","module","ChartPlugin","Plugin","super","controlPanel","loadBuildQuery","loadTransformProps","loadChart","buildQuery","transformProps","Chart","register","isRequired","getChartMetadataRegistry","registerValue","getChartComponentRegistry","registerLoader","getChartControlPanelRegistry","getChartTransformPropsRegistry","getChartBuildQueryRegistry","unregister","configure","ChartComponentRegistry","Registry","overwritePolicy","OverwritePolicy","Warn","makeSingleton","ChartTransformPropsRegistry","FAST_DEBOUNCE","SLOW_DEBOUNCE","getCurrencySymbol","_Intl$NumberFormat$fo","Intl","NumberFormat","symbol","formatToParts","CurrencyFormatter","ExtensibleFunction","d3Format","locale","NumberFormats","SMART_NUMBER","hasValidCurrency","_this$currency","getNormalizedD3Format","formattedValue","symbolPosition","buildCustomFormatters","savedCurrencyFormats","savedColumnFormats","currencyFormat","isSavedMetric","actualD3Format","actualCurrencyFormat","getCustomFormatter","customFormatters","metricsArray","getValueFormatter","modulePromises","withNamespace","async","defineSharedModule","fetchModule","moduleKey","modulePromise","defineSharedModules","moduleMap","all","entries","reset","useComponentDidMount","effect","useEffect","REPLACE_OPERATORS","RegExp","TOKENS","token","show","evalExpression","_subExpressions$","parsedExpression","subExpressions","mexp","isValidExpression","err","resetConfig","Preset","presets","plugins","preset","plugin","extractTimegrain","extra_filters","extra_form_data","extra_grain","val","normalizeOrderBy","orderby","orderbyClause","_isBoolean","cloneQueryObject","series_limit_metric","legacy_order_by","order_desc","isAsc","AnnotationType","AnnotationSourceType","AnnotationOpacity","AnnotationStyle","isFormulaAnnotationLayer","annotationType","Formula","isEventAnnotationLayer","Event","isIntervalAnnotationLayer","Interval","isTimeseriesAnnotationLayer","Timeseries","isTableAnnotationLayer","Table","isTimeseriesAnnotationResult","isRecordAnnotationResult","records","createMultiFormatter","formats","millisecond","second","minute","hour","day","week","month","year","defaultValue","defaultOrNaN","NaN","isEqualArray","arrA","arrB","every","numeric","validateMapboxStylesUrl","startsWith","validateInteger","isFinite","countries","afghanistan","albania","algeria","argentina","australia","austria","belgium","bolivia","brazil","bulgaria","burundi","canada","chile","china","colombia","costa_rica","cuba","cyprus","denmark","dominican_republic","ecuador","egypt","el_salvador","estonia","ethiopia","france","france_regions","finland","germany","guatemala","haiti","honduras","iceland","india","indonesia","iran","italy","italy_regions","japan","jordan","kazakhstan","kenya","korea","kuwait","kyrgyzstan","latvia","liechtenstein","lithuania","malaysia","mexico","morocco","myanmar","netherlands","nicaragua","nigeria","norway","oman","pakistan","panama","papua_new_guinea","paraguay","peru","philippines","portugal","poland","puerto_rico","qatar","russia","rwanda","saint_barthelemy","saint_martin","saudi_arabia","singapore","slovenia","spain","sri_lanka","sweden","switzerland","syria","tajikistan","tanzania","thailand","timorleste","turkey","turkmenistan","uganda","uk","ukraine","united_arab_emirates","uruguay","usa","uzbekistan","venezuela","vietnam","zambia","countryOptions","toUpperCase","e","getLabelFontSize","getRectangle","element","getBoundingClientRect","getOverlappingElements","elements","overlappingElements","e1","index1","rect1","e2","index2","rect2","isOverlapping","x1","y1","width1","height1","x2","y2","width2","height2","ColorBy","OrientationType","EchartsTimeseriesSeriesType","COLOR_SATURATION","LABEL_FONTSIZE","BORDER_WIDTH","GAP_WIDTH","BORDER_COLOR","extractTreePathInfo","treePathInfo","treePath","pathInfo","path","metricLabel","shift","NULL_STRING","TIMESERIES_CONSTANTS","gridOffsetRight","gridOffsetLeft","gridOffsetTop","gridOffsetBottom","gridOffsetBottomZoomable","legendRightTopOffset","legendTopRightOffset","zoomBottom","toolboxTop","toolboxRight","dataZoomStart","dataZoomEnd","yAxisLabelTopOffset","extraControlsOffset","LABEL_POSITION","LabelPositionEnum","Top","Left","Right","Bottom","Inside","InsideBottomLeft","InsideBottomRight","InsideTop","InsideBottom","InsideTopLeft","InsideTopRight","OpacityEnum","StackControlsValue","StackControlOptions","Stack","Stream","AreaChartStackControlOptions","Expand","TIMEGRAIN_TO_TIMESTAMP","TimeGranularity","HOUR","DAY","MONTH","QUARTER","YEAR","DEFAULT_LEGEND_FORM_DATA","legendMargin","legendOrientation","LegendOrientation","legendType","LegendType","Scroll","showLegend","DEFAULT_TITLE_FORM_DATA","xAxisTitle","xAxisTitleMargin","yAxisTitle","yAxisTitleMargin","yAxisTitlePosition","TOOLTIP_POINTER_MARGIN","TOOLTIP_OVERFLOW_MARGIN","defaultGrid","containLabel","defaultYAxis","scale","yAxisLabelRotation","defaultXAxis","xAxisLabelRotation","defaultLegendPadding","ForecastSeriesEnum","EchartsChartPlugin","props","restProps","extractDataTotalValues","opts","thresholdValues","stack","percentageThreshold","xAxisCol","legendState","datum","curr","extractShowValueIndexes","showValueIndexes","isHorizontal","onlyTotal","entry","seriesIndex","dataIndex","extractSeries","fillNeighborValue","xAxis","DTTM_ALIAS","extraMetricLabels","removeNulls","sortSeriesType","sortSeriesAscending","xAxisSortSeries","xAxisSortSeriesAscending","rows","sortedSeries","seriesNames","aggregator","SortSeriesType","_sumBy","Min","_minBy2","_minBy","Max","_maxBy2","_maxBy","Avg","_meanBy","sortedValues","_orderBy","sortAndFilterSeries","sortedRows","idx","aggregate","sortKey","isValueDefined","Name","totalStackedValue","sortRows","minPositiveValue","_rows","_rows2","currentValue","isNextToDefinedValue","obs","formatSeriesName","numberFormatter","coltype","toString","Date","normalizedName","normalizeTimestamp","getColtypesMapping","coltypes","colnames","accumulator","item","extractGroupbyLabel","coltypeMapping","getLegendProps","theme","zoomable","legend","orient","selected","selector","selectorLabel","fontFamily","typography","families","sansSerif","fontSize","sizes","colors","grayscale","base","borderColor","left","right","top","bottom","getChartPadding","margin","padding","dedupSeries","counter","count","get","suffix","sanitizeHtml","getAxisType","forceCategorical","dataType","AxisType","Category","Time","Value","getOverMaxHiddenFormatter","formatter","shouldHideIfOverMax","NumberFormatter","formatFunc","OVER_MAX_HIDDEN","calculateLowerLogTick","logBase10","floor","log10","pow","getMinAndMaxFromBounds","axisType","truncateAxis","seriesType","ret","Bar","MetricsLayoutEnum","updateExternalFormData","setDataMask","pageNumber","pageSize","ownState","currentPage","addLocaleData","en","Aggregate","fr","zh","PAGE_SIZE_OPTIONS","DateWithFormatter","call","metadataRegistry","dummyPluginContext","loading","dynamicPlugins","mountedPluginMetadata","fetchAll","PluginContext","React","usePluginContext","useContext","getRegistryData","_omitBy","getMap","pluginContextReducer","action","error","mounting","pluginApi","makeApi","endpoint","sharedModules","react","lodash","react-dom","@superset-ui/chart-controls","@superset-ui/core","DynamicPluginProvider","children","pluginState","dispatch","useReducer","isFeatureEnabled","FeatureFlag","DynamicPlugins","import","bundle_url","logging","registryListener","addListener","removeListener","Provider","ErrorBoundary","info","componentDidCatch","_this$props$onError","_this$props","onError","setState","render","firstLine","messageString","messageElement","showMessage","ErrorMessageWithStackTrace","subtitle","copyText","stackTrace","componentStack","defaultProps","ToastContainer","styled","div","StyledIcon","css","gridUnit","Toast","toast","onCloseToast","hideTimer","useRef","visible","setVisible","useState","showToast","handleClosePress","useCallback","current","clearTimeout","duration","className","icon","Icons","CircleCheckSolid","toastType","ToastType","Warning","WarningSolid","Danger","ErrorSolid","Info","InfoSolid","cx","role","Interweave","content","noHtml","allowHtml","tabIndex","onClick","StyledToastPresenter","position","zIndex","dark1","borderRadius","dark2","mediumLight","light5","transitionTiming","connect","messageToasts","toasts","bindActionCreators","removeToast","SingleValueType","chartProps","queriesData","cellPadding","cellRadius","cellSize","domainGranularity","linearColorScheme","showMetricName","showValues","steps","subdomainGranularity","xAxisTimeFormat","yAxisFormat","ts","getFormattedUTCTime","timeFormat","date","getTimezoneOffset","getTimeFormatter","getTime","controlPanelSections","D3_TIME_FORMAT_OPTIONS","D3_FORMAT_DOCS","controlOverrides","y_axis_format","formDataOverrides","getStandardizedControls","popAllMetrics","url","example","CalendarChartPlugin","sliceId","numberFormat","validateNonEmpty","popAllColumns","shiftMetric","caption","ChordChartPlugin","selectCountry","country","D3_FORMAT_OPTIONS","linear_color_scheme","shiftColumn","exampleUsa","exampleGermany","CountryMapChartPlugin","_control$choices","_control$choices$","formatSelectOptionsForRange","optionRenderer","ColumnOption","showType","valueRenderer","valueKey","allowAll","_state$datasource","commaChoosesOption","row_limit","EventFlowChartPlugin","bottomMargin","canvasImageRendering","allColumnsX","allColumnsY","leftMargin","normalized","showPerc","sortXAxis","sortYAxis","xscaleInterval","yscaleInterval","yAxisBounds","columnFormats","currencyFormats","xAxisFormatter","yAxisFormatter","columnX","columnY","showPercentage","xScaleInterval","yScaleInterval","sortAxisChoices","dndAllColumns","sharedControls","x_axis_time_format","D3_TIME_FORMAT_DOCS","transportation","channels","employment","HeatmapChartPlugin","linkLength","cumulative","globalOpacity","yAxisLabel","binCount","columnsConfig","example1","example2","example3","HistogramChartPlugin","horizonColorScale","seriesHeight","colorScale","HorizonChartPlugin","colorChoices","datasourceChoices","isFloat","places","dontRefreshOnChange","MapBoxChartPlugin","liftvaluePrecision","pvaluePrecision","significanceLevel","groups","liftValPrec","pValPrec","override","PairedTTestChartPlugin","includeSeries","secondaryMetric","showDatatable","colorMetric","ParallelCoordinatesChartPlugin","dateTimeFormat","equalDateSize","logScale","partitionLimit","partitionThreshold","richTooltip","timeSeriesOption","levels","g","useLogScale","useRichTooltip","propTypes","PropTypes","OptionDescription","InfoTooltipWithTrigger","op","PartitionChartPlugin","roseAreaProportion","useAreaProportions","RoseChartPlugin","SankeyChartPlugin","PERCENT_3_POINT","DATABASE_DATETIME","TimeFormats","isNumeric","processDataRecords","timeColumns","processColumns","rawFormData","table_timestamp_format","tableTimestampFormat","metrics_","percent_metrics","percentMetrics_","column_config","granularity","rawPercentMetrics","percentMetrics","metricsSet","percentMetricsSet","rawPercentMetricsSet","has","_config$currencyForma","isMetric","isPercentMetric","hasOwnProperty","isTime","isNumber","savedFormat","savedCurrency","d3NumberFormat","d3TimeFormat","customFormat","getTimeFormatterForGranularity","propsA","propsB","_a$queriesData","_a$queriesData$","_b$queriesData","_b$queriesData$","_a$queriesData2","_a$queriesData2$","_b$queriesData2","_b$queriesData2$","timeGrainSqla","JSON","stringify","extraFilters","extraFormData","defaultServerPaginationData","defaultColorFormatters","_baseQuery2","_totalQuery","_getColorFormatters","filterState","serverPaginationData","hooks","onAddFilter","onChangeFilter","onContextMenu","emitCrossFilters","align_pn","alignPositiveNegative","color_pn","colorPositiveNegative","show_cell_bars","showCellBars","include_search","includeSearch","page_length","pageLength","server_pagination","serverPagination","server_page_length","serverPageLength","sortDesc","query_mode","queryMode","show_totals","showTotals","conditional_formatting","conditionalFormatting","allow_rearrange_columns","allowRearrangeColumns","timeGrain","baseQuery","countQuery","totalQuery","rowCount","_countQuery$data$0$ro","_countQuery","_countQuery$data","_countQuery$data$","_baseQuery$rowcount","_baseQuery","rowcount","totals","QueryMode","columnColorFormatters","isRawRecords","Raw","numRecords","numColumns","filters","getPageSize","getQueryMode","_controls$query_mode","_controls$all_columns","mode","rawColumns","all_columns","isQueryMode","isAggMode","isRawMode","validateAggControlValues","QueryModeLabel","rerender","allColumnsControl","externalValidationErrors","resetOnHide","percentMetricsControl","defineSavedMetrics","datasourceType","_sharedControls$group","_originalMapStateToPr","_controls$percent_met","originalMapStateToProps","newState","dttmLookup","selection","isAdhocColumn","isPhysicalColumn","_datasource$columns$","_datasource$columns","_controls$groupby3","_controls$percent_met2","selectedMetrics","_controls$server_pagi","_controls$server_pagi2","_controls$server_pagi3","explore","_chart$queriesRespons","queryResponse","queriesResponse","_explore$datasource","_explore$datasource2","_explore$datasource$c","_explore$datasource3","_chart$queriesRespons2","_chart$queriesRespons3","chartStatus","removeIrrelevantConditions","columnOptions","colname","_verboseMap$colname","cachedBuildQuery","cachedChanges","setCachedChanges","newChanges","_options$ownState2","orderDesc","sortByMetric","formDataCopy","include_time","buildQueryContext","baseQueryObject","_options$ownState","_options$extras","_options$extras$cache","_options$extras2","_options$extras2$cach","_options$hooks2","_metrics2","_formData$extra_form_","postProcessing","_metrics","percentMetricLabels","removeDuplicates","rename_columns","_formData$temporal_co","temporal_columns_lookup","columnType","sqlExpression","expressionType","moreProps","_ownState$pageSize","_ownState$currentPage","_ownState$pageSize2","row_offset","post_processing","_options$hooks","_queryObject$row_limi","extras","slice_id","extraQueries","interactiveGroupBy","interactive_groupby","is_rowcount","Behavior","InteractiveChart","DrillToDetail","DrillBy","TableChartPlugin","rotation","sizeFrom","sizeTo","seriesLabel","encoding","field","scheme","range","zero","sort_by_metric","Encodable","setNumberFormatResolver","setTimeFormatResolver","formatInLocalTime","formatString","addPrefix","LOCAL_PREFIX","getTimeFormatterRegistry","getDefaultKey","setColorSchemeResolver","colorSchemeResolver","getSequentialSchemeRegistry","getCategoricalSchemeRegistry","defaultColorSchemeResolver","setCategoricalColorScaleResolver","colorScaleResolver","namespace","CategoricalColorNamespace","getScale","WordCloudChartPlugin","inContextMenu","countryFieldtype","maxBubbleSize","showBubbles","colorPicker","colorBy","r","rgb","hex","Metric","Country","secondary_metric","color_picker","color_by","color_scheme","WorldMapChartPlugin","tokenizeToNumericArray","tokens","validateNumber","tokenizeToStringArray","NOOP","grabD3Format","targetMetric","foundFormatter","annotationData","barStacked","contribution","donut","labelsOutside","lineInterpolation","orderBars","pieLabelType","reduceXTicks","sendTimeRange","showBarValue","showBrush","showControls","showLabels","showMarkers","stackedStyle","vizType","xAxisFormat","xAxisShowminmax","xLogScale","xTicksLayout","yAxis2Bounds","yAxisShowminmax","yAxis2Showminmax","yLogScale","markerLabels","markerLines","markerLineLabels","markers","rangeLabels","ranges","rawData","measures","areaStackedStyle","baseColor","isBarStacked","isDonut","isPieLabelOutside","onBrushEnd","timeRange","xAxisShowMinMax","xIsLogScale","yAxisShowMinMax","yAxis2ShowMinMax","yIsLogScale","yAxisShowMinmax","xAxisShowMinmax","timeSeriesSection","example4","ChartLabel","Deprecated","AreaChartPlugin","limit","_state$controls","_state$controls$limit","timeserieslimitProps","BarChartPlugin","BubbleChartPlugin","BulletChartPlugin","CompareChartPlugin","groupbyProps","canDropValue","_state$controls$colum","columnsProps","_state$controls2","_state$controls2$grou","DistBarChartPlugin","battery","LineChartPlugin","tooltipOnClick","open","TimePivotChartPlugin","setControlValue","payload","viewport","PRIMARY_COLOR","_state$datasource$tim","o","opt","jsFunctionInfo","href","jsFunctionControl","extraDescr","defaultText","language","aboveEditorSection","warning","EnableJavascriptControls","readOnly","filterNulls","autozoom","dimension","jsColumns","jsDataMutator","jsTooltip","jsOnclickHref","legendFormat","legendPosition","lineWidth","fillColorPicker","strokeColorPicker","filled","stroked","extruded","gridSize","longitude","latitude","zoom","bearing","pitch","spatial","pointRadiusFixed","multiplier","lineType","reverseLongLat","mapboxStyle","timeGrainSqlaAnimationOverrides","ArcChartPlugin","dndLineColumn","dndGeojsonColumn","GeojsonChartPlugin","GridChartPlugin","HexChartPlugin","INTENSITY_OPTIONS","RADIUS_PIXEL_OPTIONS","dataEndpoint","placeholder","onAsyncErrorMessage","mutator","slice_name","MultiChartPlugin","PathChartPlugin","step","PolygonChartPlugin","onInit","ScatterChartPlugin","ScreengridChartPlugin","ContourChartPlugin","DeckGLChartPreset","GeoJsonChartPlugin","headerFontSize","subheaderFontSize","time_range","temporalColumnMixin","parseMetricValue","metricValue","dateObject","moment","isValid","valueOf","getDateFormatter","fallbackFormat","getDefaultTooltip","refs","appendToBody","canvasMousePos","params","tooltipDom","rect","_refs$divRef","_refs$divRef$current","divRect","divRef","mouseX","mouseY","tooltipWidth","contentSize","tooltipHeight","documentElement","clientWidth","clientHeight","defaultNumberFormatter","renderTooltipFactory","formatDate","smartDateVerboseFormatter","formatValue","formatPercentChange","PERCENT_SIGNED_1_POINT","_chartProps$datasourc","_metricEntry","compareLag","compareLag_","compareSuffix","showTimestamp","showTrendLine","startYAxisAtZero","subheader","forceTimestampFormatting","timeRangeFixed","from_dttm","fromDatetime","to_dttm","toDatetime","metricName","formattedSubheader","mainColor","trendLineData","bigNumberFallback","percentChange","bigNumber","timestamp","metricColtypeIndex","findIndex","metricColtype","sortedData","compareIndex","compareValue","reverse","metricEntry","formatTime","headerFormatter","toDatetimeOrToday","now","unshift","echartOptions","smooth","symbolSize","showSymbol","areaStyle","graphic","yAxis","grid","trigger","aria","enabled","xValueFormatter","isXAxisSet","getXAxisColumn","is_timeseries","BigNumberWithTrendlineChartPlugin","metricItem","colorThresholdFormatters","BigNumberTotalChartPlugin","_controls$columns","D3_NUMBER_FORMAT_DESCRIPTION_VALUES_TEXT","getTemporalColumns","defaultTemporalColumn","convertInteger","seriesTypeRegex","ForecastLower","ForecastTrend","ForecastUpper","extractForecastSeriesContext","regexMatch","Observation","extractForecastValuesFromTooltipParams","param","marker","seriesId","context","numericValue","_isNumber","forecastValues","observation","forecastTrend","forecastLower","forecastUpper","formatForecastTooltipSeries","isObservation","rebaseForecastDatum","newRow","forecastContext","verboseKey","lowerForecastKey","evalFormula","formula","xAxisType","parseAnnotationOpacity","Low","Medium","High","extractRecordAnnotations","annotationLayer","record","descriptions","intervalEnd","time","title","formatAnnotationLabel","labels","titleLabels","filteredDescriptions","extractAnnotationLabels","layers","formulaAnnotationLabels","anno","timeseriesAnnotationLabels","flatMap","annoSeries","getAnnotationData","_chartProps$queriesDa","annotation_data","transformSeries","colorScaleKey","area","connectNulls","seriesContexts","markerEnabled","markerSize","areaOpacity","stackIdSuffix","yAxisIndex","showValue","queryIndex","contexts","hasForecast","forecastSeries","isConfidenceBand","selectedValues","NonTransparent","SemiTransparent","isTrend","stackId","plotType","itemStyle","emphasis","lineStyle","Transparent","triggerLineEvent","stackStrategy","isSelectedLegend","isAreaExpand","MIN_SAFE_INTEGER","transformFormulaAnnotation","transformIntervalAnnotation","showLabel","intervalData","intervalLabel","verticalAlign","fontWeight","backgroundColor","animation","markArea","silent","transformEventAnnotation","eventData","eventLabel","markLine","transformTimeseriesAnnotation","hideLine","getPadding","addYAxisTitleOffset","addXAxisTitleOffset","yAxisOffset","xAxisOffset","dateFormat","colorFn","groupbyLabels","transformedData","groupbyLabel","isFiltered","outlierData","outlierDatum","outlierName","stats","flat","labelMap","selectedValue","axisLabel","rotate","headline","chartPadding","nameGap","nameLocation","axisPointer","EchartsFunnelLabelTypeType","EchartsBoxPlotChartPlugin","DEFAULT_FORM_DATA","labelLine","labelType","Key","defaultTooltipLabel","KeyValuePercent","gap","PercentCalcType","DEFAULT_SORT_SERIES_DATA","logAxis","minorSplitLine","rowLimit","Line","tooltipTimeFormat","truncateXAxis","truncateYAxis","Vertical","TIME_SERIES_DESCRIPTION_TEXT","showLegendControl","legendMarginControl","_controls$show_legend","show_legend","legendTypeControl","_controls$show_legend2","legendOrientationControl","_controls$show_legend3","legendSection","showValueControl","stackControl","onlyTotalControl","_controls$show_value","_controls$stack","show_value","percentageThresholdControl","_controls$show_value2","_controls$stack2","_controls$only_total","only_total","showValueSection","showValueSectionWithoutStack","richTooltipControl","tooltipTimeFormatControl","tooltipSortByMetricControl","_controls$rich_toolti","rich_tooltip","richTooltipSection","seriesOrderSection","xAxisBounds","_controls$truncateXAx","minorTicks","funnelLegendSection","splice","FirstStep","PreviousStep","Total","Percent","KeyValue","KeyPercent","ValuePercent","percentFormatter","PERCENT_2_POINT","formatFunnelLabel","percentCalculationType","sanitizeName","rawName","percent","totalPercent","firstStepPercent","prevStepPercent","formattedPercent","tooltipLabelType","showTooltipLabels","DEFAULT_FUNNEL_FORM_DATA","defaultLabel","minSize","maxSize","funnelAlign","textBorderColor","EchartsFunnelChartPlugin","EchartsTreemapLabelType","labelPosition","showUpperLabels","getMetricValue","treeBuilder","groupBy","curGroupBy","restGroupby","curData","_groupBy2","_transform","secondaryValue","dashboardId","DEFAULT_TREEMAP_FORM_DATA","columnsLabelMap","treeData","traverse","treeNodes","treeNode","_treeNode$children","nodeName","newPath","colorSaturation","borderWidth","gapWidth","joinedName","colorAlpha","upperLabel","nodeClick","roam","breadcrumb","emptyItemWidth","primary","currentNode","parentNode","formatTooltip","EchartsTreemapChartPlugin","minVal","maxVal","showProgress","overlap","roundCap","showAxisTick","showSplitLine","splitNumber","startAngle","endAngle","showPointer","intervals","intervalColorIndices","parseAxisBound","bound","parseNumbersList","delim","INTERVAL_GAUGE_SERIES_OPTION","splitLine","axisTick","pointer","_queriesData$","_gaugeSeriesOptions$s","_gaugeSeriesOptions$s2","_gaugeSeriesOptions$a","_gaugeSeriesOptions$a2","_gaugeSeriesOptions$a3","_gaugeSeriesOptions$a4","_gaugeSeriesOptions$d","gaugeSeriesOptions","defaultGaugeSeriesOption","axisLine","light4","detail","DEFAULT_GAUGE_FORM_DATA","axisLineWidth","calculateAxisLineWidth","axisTickLength","splitLineLength","titleOffsetFromTitle","detailOffsetFromTitle","data_point","offsetCenter","calculateMin","calculateMax","axisLabels","_range","axisLabelLength","intervalBoundsAndColors","getIntervalBoundsAndColors","intervalBoundsNonNormalized","intervalColorIndicesArray","intervalBounds","intervalColors","ind","axisLabelDistance","axisTickDistance","progress","distance","valueAnimation","_INTERVAL_GAUGE_SERIE","_INTERVAL_GAUGE_SERIE2","_INTERVAL_GAUGE_SERIE3","_INTERVAL_GAUGE_SERIE4","_INTERVAL_GAUGE_SERIE5","_INTERVAL_GAUGE_SERIE6","showAbove","radius","center","EchartsGaugeChartPlugin","source","layout","draggable","selectedMode","showSymbolThreshold","repulsion","gravity","edgeSymbol","edgeLength","baseEdgeWidth","baseNodeSize","friction","requiredEntity","optionalEntity","DEFAULT_GRAPH_SERIES_OPTION","circular","rotateLabel","force","initLayout","layoutAnimation","fontStyle","overflow","focus","animationDuration","animationEasing","curveness","verifyEdgeSymbol","parseEdgeSymbol","symbols","start","end","getEmphasizedEdgeWidth","getKeyByValue","object","getCategoryName","sourceCategory","targetCategory","DEFAULT_GRAPH_FORM_DATA","nodes","categories","echartNodes","echartLinks","getOrCreateNode","add","link","sourceName","targetName","sourceCategoryName","targetCategoryName","sourceNode","targetNode","links","minNodeSize","maxNodeSize","minEdgeWidth","maxEdgeWidth","nodeMinValue","nodeMaxValue","d3Extent","nodeSpread","linkMinValue","linkMaxValue","linkSpread","normalizeStyles","categoryList","edgeSymbolSize","sourceIndex","targetIndex","edgeFormatter","queryFields","source_category","target_category","EchartsGraphChartPlugin","EchartsRadarLabelType","isCircle","radarMetricMaxValue","controlType","debounceDelay","configFormLayout","_explore$controls$met","_explore$controls","_explore$controls$met2","metricColumn","appliedColumnNames","DEFAULT_RADAR_FORM_DATA","metricLabelAndMaxValueMap","indicator","_columnConfig$metricL","maxValueInControl","metricValueAsMax","MAX_SAFE_INTEGER","radar","shape","EchartsRadarChartPlugin","baseFormData","formData1","removeFormDataSuffix","controlSuffix","newFormData","formData2","retainFormDataSuffix","weight_a","queryContexts","fd","pivotOperatorInRuntime","tmpQueryObject","time_offsets","queries","TIMESERIES_DEFAULTS","truncateYAxisSecondary","logAxisSecondary","yAxisBoundsSecondary","yAxisFormatSecondary","yAxisTitleSecondary","areaB","markerEnabledB","markerSizeB","opacityB","orderDescB","rowLimitB","seriesTypeB","showValueB","stackB","yAxisIndexB","groupbyB","createQuerySection","adhoc_filters","createCustomizeSection","Scatter","Smooth","Start","Middle","End","createAdvancedAnalyticsSection","aaWithSuffix","_cloneDeep","currency_format","groupby_b","metrics_b","getPercentFormatter","PERCENT","getYAxisFormatter","forcePercentFormatter","defaultFormatter","formatters","_formatter$currency","_formatters$","_formatters$$currency","getTooltipTimeFormatter","smartDateDetailedFormatter","getXAxisFormatter","getFormatter","formatterKey","forcePercentFormat","_getCustomFormatter","_chartProps$rawFormDa","_dataTypes$xAxisLabel","_chartProps$rawFormDa2","focusedSeries","label_map","labelMapB","data1","data2","currencyFormatSecondary","tooltipSortByMetric","xAxisOrig","metricsB","rebasedDataA","rawSeriesA","rebasedDataB","rawSeriesB","dataTypes","xAxisDataType","formatterSecondary","customFormattersSecondary","primarySeries","secondarySeries","mapSeriesIdToAxis","seriesOption","showValueIndexesA","showValueIndexesB","totalStackedValuesB","thresholdValuesB","xAxisMin","xAxisMax","yAxisMin","yAxisMax","minSecondary","maxSecondary","array","inverted","_invert","_labelMap$seriesName","entryName","seriesFormatter","transformedSeries","_labelMapB$seriesName","seriesEntry","tooltipFormatter","alignTicks","useUTC","minorTick","minInterval","xValue","forecastValue","_labelMap$key","_labelMapB$key","tooltipFormatterSecondary","contentStyle","toolbox","feature","dataZoom","back","seriesBreakdown","onFocusedSeries","EchartsTimeseriesChartPlugin","EchartsPieLabelType","innerRadius","outerRadius","showLabelsThreshold","tokenSeparators","_controls$show_labels","show_labels","_controls$show_labels2","_controls$donut","formatPieLabel","getTotalValuePadding","showTotal","DEFAULT_PIE_FORM_DATA","minShowLabelAngle","totalValue","avoidLabelOverlap","alignTo","bleedMargin","z","EchartsPieChartPlugin","_controls$markerEnabl","_controls$truncateYAx","queryData","rebasedData","Horizontal","isMultiSeries","rawSeries","sortedTotalValues","agg","currentContexts","extractForecastSeriesContexts","offsetLineWidths","derivedSeries","_chartProps$rawFormDa3","_row$","baselineSeries","getBaselineSeriesForStream","seriesLength","baselineSeriesDelta","fill","getVal","seriesSum","weightedSeriesSum","j","delta","deltaPrev","onLegendStateChanged","legendData","hideOverlap","Log","xIndex","yIndex","_getCustomFormatter2","areaTransformProps","EchartsAreaChartPlugin","_controls$area","createAxisTitleControl","isXAxis","isVertical","createAxisControl","barTransformProps","EchartsTimeseriesBarChartPlugin","lineTransformProps","EchartsTimeseriesLineChartPlugin","smoothTransformProps","EchartsTimeseriesSmoothLineChartPlugin","scatterTransformProps","EchartsTimeseriesScatterChartPlugin","EchartsTimeseriesStepChartPlugin","DEFAULT_TIME_FORMAT","TOTAL_MARK","ASSIST_MARK","LEGEND","INCREASE","DECREASE","TOTAL","TOKEN","granularitySqla","increaseColor","decreaseColor","totalColor","seriesformatter","originalValue","groupbyArray","breakdownColumn","breakdownName","xAxisColumn","xAxisName","breakdown","groupedData","categoryLabel","categoryData","tempValue","sum","_cur$metric","_cur$metric2","transformer","assistData","increaseData","decreaseData","totalData","previousTotal","self","totalSum","_cur$metricLabel","_cur$metricLabel2","oppositeSigns","sign","rgbToHex","xAxisColumns","xAxisData","seriesProps","barSeries","nameTextStyle","createRow","weights","normal","bold","EchartsWaterfallChartPlugin","DEFAULT_TREE_SERIES_OPTION","parent","rootNodeId","nodeLabelPosition","childLabelPosition","nameColumn","createTree","rootNodeName","findNodeName","tree","indexMap","_node$parent","_tree$children","parentId","finalTree","parentChildMap","maxChildren","totalChildren","getTotalChildren","leaves","triggerOn","treeAncestors","EchartsTreeChartPlugin","EchartsSunburstLabelType","primaryValueFormatter","secondaryValueFormatter","visWidth","visHeight","secondaryMetricLabel","totalSecondaryValue","categoricalColorScale","linearColorScale","colorByCategory","_getSequentialSchemeR","_getSequentialSchemeR2","domain","callback","temp","getLinearDomain","createLinearScale","pathRecords","_treeNode$children2","_filterState$selected","_filterState$selected2","formattedSecondaryValue","compareValuePercentage","absolutePercentage","replaceAll","conditionalPercentage","minAngle","_controls$secondary_m","_controls$secondary_m2","_controls$secondary_m3","_controls$secondary_m4","EchartsSunburstChartPlugin","emitFilter","logXAis","logYAxis","bubbleSeries","bubbleXAxisTitle","bubbleYAxisTitle","logXAxis","tooltipSizeFormat","legends","sizeLabel","dataName","bubbleSeriesValue","maxBubbleValue","bubbleMinValue","bubbleMaxValue","normalizeSymbolSize","tooltipSizeFormatter","nameRotate","fontWight","EchartsBubbleChartPlugin","enableEmptyFilter","inverseSelection","defaultToFirstItem","multiSelect","searchAllOptions","sortAscending","search","coltypeMap","sortMetric","sortColumns","required","affectsDataMask","requiredFirst","displaySettings","appSection","isRefreshing","inputRef","noOp","setHoveredFilter","unsetHoveredFilter","setFocusedFilter","unsetFocusedFilter","setFilterActive","filterBarOrientation","isOverflowingFilterBar","FilterSelectPlugin","NativeFilter","hasCustomLabel","Exact","RangeFilterPlugin","TimeFilterPlugin","result_type","FilterTimeColumnPlugin","FilterTimeGrainPlugin","groupbyColumns","groupbyRows","orderBy","_controls$groupbyColu","COLUMNS","ROWS","_verboseMap$value","tableRenderer","colOrder","rowOrder","aggregateFunction","transposePivot","combineMetric","rowSubtotalPosition","colSubtotalPosition","colTotals","colSubTotals","rowTotals","rowSubTotals","valueFormat","metricsLayout","selectedFilters","dateFormatters","temporalColname","metricColorFormatters","PivotTableChartPlugin","allColumnsControlSetItem","groupByControlSetItem","CodeEditor","rest","m_name","random","substring","m_theme","m_mode","m_height","m_width","minHeight","AceEditor","_extends","showPrintMargin","editorProps","$blockScrolling","wrapEnabled","highlightActiveLine","setOptions","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets","showLineNumbers","tabSize","showGutter","ControlHeader","debounceFunc","_debounce","func","handlebarsTemplateControlSetItem","onChange","_controls$handlebars_","handlebars_template","includeTimeControlSetItem","timeSeriesLimitMetricControlSetItem","percentMetricsControlSetItem","metricsControlSetItem","showTotalsControlSetItem","orderByControlSetItem","orderDescendingControlSetItem","serverPaginationControlSetRow","serverPageLengthControlSetItem","queryModeControlSetItem","styleControlSetItem","useTheme","iconsStyle","marginLeft","HandlebarsChartPlugin","getTimeRange","adhocFilters","_adhocFilters$findInd","timeFilterIndex","timeFilter","comparator","toLocaleLowerCase","computeQueryBComparator","timeComparison","testSince","testUntil","getSinceUntil","relativeStart","relativeEnd","separator","effectiveRelativeStart","effectiveRelativeEnd","modTimeRange","subtract","startOf","timeRangeLookup","unit","timePart","sinceAndUntil","part","transformedValue","pattern","fn","match","_since","_until","isAfter","prevStartDateMoment","prevEndDateMoment","calculatePrev","startDate","endDate","calcType","daysBetween","diff","startDatePrev","endDatePrev","_formData$adhoc_filte","_formData$adhoc_filte2","cols","time_comparison","queryContextA","formDataB","queryBComparator","_formData$adhoc_filte3","queryBFilter","otherFilters","_value","queryBFilters","adhoc_custom","queryContextB","validateTimeComparisonRangeValues","timeRangeValue","controlValue","isCustomTimeRange","isCustomControlEmpty","_controls$time_compar","_state$controls$time_","boldText","headerText","comparisonColorEnabled","dataA","dataB","prevNumber","percentDifferenceNum","valueDifference","compType","w","percentDifferenceFormattedString","percentDifferenceNumber","comparatorText","formatCustomComparator","dateStr","adhocCustom","PopKPIPlugin","columnCollection","isGroupBy","metricMap","timeLag","columnConfigs","rowType","controlName","multiple","TimeTableChartPlugin","MainPreset","experimentalPlugins","ChartPluginsExperimental","BigNumberChartPlugin","EchartsMixedTimeseriesChartPlugin","PivotTableChartPluginV2","SelectFilterPlugin","FilterPlugins","Select","Range","TimeColumnFilterPlugin","TimeColumn","TimeGrainFilterPlugin","TimeGrain","markup_type","code","sectionOverrides","sqlaTimeSeries","setupPlugins","Separator","flashObj","alert","danger","success","FlashProvider","messages","useToasts","message","common","getBootstrapData","extensionsRegistry","getExtensionsRegistry","RootContextProviders","RootContextProviderExtension","ThemeProvider","ReduxProvider","store","DndProvider","backend","HTML5Backend","flash_messages","EmbeddedUiConfigProvider","QueryParamProvider","ReactRouterRoute","Route","stringifyOptions","encode"],"sourceRoot":""}