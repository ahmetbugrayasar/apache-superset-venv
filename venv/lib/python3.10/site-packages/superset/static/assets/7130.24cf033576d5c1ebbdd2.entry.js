(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7130],{11409:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ADD_QUERY_EDITOR:()=>I,CHANGE_DATA_PREVIEW_ID:()=>fe,CLEAR_INACTIVE_QUERIES:()=>me,CLEAR_QUERY_RESULTS:()=>_e,CLONE_QUERY_TO_NEW_TAB:()=>N,COLLAPSE_TABLE:()=>P,COST_ESTIMATE_FAILED:()=>ge,COST_ESTIMATE_RETURNED:()=>ye,COST_ESTIMATE_STARTED:()=>Ee,CREATE_DATASOURCE_FAILED:()=>Re,CREATE_DATASOURCE_STARTED:()=>Te,CREATE_DATASOURCE_SUCCESS:()=>ve,CtasEnum:()=>Ce,END_QUERY:()=>x,EXPAND_TABLE:()=>Z,LOAD_QUERY_EDITOR:()=>re,MERGE_TABLE:()=>L,MIGRATE_QUERY:()=>X,MIGRATE_QUERY_EDITOR:()=>W,MIGRATE_TABLE:()=>J,MIGRATE_TAB_HISTORY:()=>K,QUERY_EDITOR_PERSIST_HEIGHT:()=>G,QUERY_EDITOR_SAVED:()=>D,QUERY_EDITOR_SETDB:()=>M,QUERY_EDITOR_SET_AUTORUN:()=>Q,QUERY_EDITOR_SET_CURSOR_POSITION:()=>Y,QUERY_EDITOR_SET_FUNCTION_NAMES:()=>V,QUERY_EDITOR_SET_QUERY_LIMIT:()=>B,QUERY_EDITOR_SET_SCHEMA:()=>F,QUERY_EDITOR_SET_SELECTED_TEXT:()=>j,QUERY_EDITOR_SET_SQL:()=>$,QUERY_EDITOR_SET_TEMPLATE_PARAMS:()=>H,QUERY_EDITOR_SET_TITLE:()=>k,QUERY_EDITOR_TOGGLE_LEFT_BAR:()=>z,QUERY_FAILED:()=>pe,QUERY_SUCCESS:()=>ue,REFRESH_QUERIES:()=>oe,REMOVE_DATA_PREVIEW:()=>he,REMOVE_QUERY:()=>U,REMOVE_QUERY_EDITOR:()=>w,REMOVE_TABLES:()=>q,REQUEST_QUERY_RESULTS:()=>de,RESET_STATE:()=>O,RUN_QUERY:()=>ie,SET_ACTIVE_QUERY_EDITOR:()=>te,SET_ACTIVE_SOUTHPANE_TAB:()=>ae,SET_DATABASES:()=>ee,SET_EDITOR_TAB_LAST_UPDATE:()=>be,SET_TABLES:()=>ne,SET_USER_OFFLINE:()=>se,START_QUERY:()=>le,STOP_QUERY:()=>ce,UPDATE_QUERY_EDITOR:()=>C,addDangerToast:()=>Oe,addInfoToast:()=>Se,addNewQueryEditor:()=>rt,addQueryEditor:()=>tt,addSavedQueryToTabState:()=>yt,addSuccessToast:()=>Ae,addTable:()=>Ct,addWarningToast:()=>Ie,changeDataPreviewId:()=>wt,clearInactiveQueries:()=>ke,clearQueryResults:()=>He,cloneQueryToNewTab:()=>nt,collapseTable:()=>xt,convertQueryToClient:()=>qe,convertQueryToServer:()=>Le,createCtasDatasource:()=>Vt,createDatasource:()=>jt,createDatasourceFailed:()=>Ht,createDatasourceStarted:()=>Yt,createDatasourceSuccess:()=>Bt,estimateQueryCost:()=>Fe,expandTable:()=>qt,fetchQueryResults:()=>Ge,formatQuery:()=>bt,getUpToDateQuery:()=>xe,loadQueryEditor:()=>ot,mergeTable:()=>It,migrateQueryEditorFromLocalStorage:()=>et,persistEditorHeight:()=>Mt,popDatasourceQuery:()=>$t,popQuery:()=>Qt,popSavedQuery:()=>kt,popStoredQuery:()=>Ft,postStopQuery:()=>Je,queryEditorSetAndSaveSql:()=>Rt,queryEditorSetAutorun:()=>ht,queryEditorSetCursorPosition:()=>vt,queryEditorSetDb:()=>mt,queryEditorSetQueryLimit:()=>St,queryEditorSetSchema:()=>_t,queryEditorSetSelectedText:()=>Ot,queryEditorSetSql:()=>Tt,queryEditorSetTemplateParams:()=>At,queryEditorSetTitle:()=>ft,queryFailed:()=>Ye,querySuccess:()=>$e,reFetchQueryResults:()=>Lt,reRunQuery:()=>Ke,refreshQueries:()=>Zt,removeAllOtherQueryEditors:()=>ut,removeDataPreview:()=>je,removeQuery:()=>pt,removeQueryEditor:()=>dt,removeTables:()=>Ut,requestQueryResults:()=>Ve,resetState:()=>Ue,runQuery:()=>ze,runQueryFromSqlEditor:()=>We,runTablePreviewQuery:()=>Dt,saveQuery:()=>Et,scheduleQuery:()=>Me,setActiveQueryEditor:()=>at,setActiveSouthPaneTab:()=>lt,setDatabases:()=>Xe,setEditorTabLastUpdate:()=>Pe,setTables:()=>st,setUserOffline:()=>Pt,startQuery:()=>Qe,stopQuery:()=>Be,switchQueryEditor:()=>it,syncTable:()=>Nt,toggleLeftBar:()=>ct,updateQueryEditor:()=>Ze,updateSavedQuery:()=>gt});var n=r(67523),a=r.n(n),o=r(63137),s=r.n(o),i=r(14670),l=r.n(i),c=r(15926),d=r.n(c),u=r(61988),p=r(31069),m=r(93185),_=r(44814),h=r(72570),f=r(98286),E=r(66785),y=r(3741),g=r(20292),T=r(97381);const v=/^Untitled Query (\d+)$/,R="Untitled Query ",b=(e,t=`${R}1`)=>{const r=(0,u.t)(t);if(e.length>0){const t=e.filter((e=>{var t;return null==(t=e.name)?void 0:t.match(v)})).map((e=>+e.name.replace(R,"")));if(t.length>0){const e=Math.max(...t);return(0,u.t)("%s%s",R,e+1)}return r}return r};var S=r(36627),A=r(82591);const O="RESET_STATE",I="ADD_QUERY_EDITOR",C="UPDATE_QUERY_EDITOR",D="QUERY_EDITOR_SAVED",N="CLONE_QUERY_TO_NEW_TAB",w="REMOVE_QUERY_EDITOR",L="MERGE_TABLE",q="REMOVE_TABLES",x="END_QUERY",U="REMOVE_QUERY",Z="EXPAND_TABLE",P="COLLAPSE_TABLE",M="QUERY_EDITOR_SETDB",F="QUERY_EDITOR_SET_SCHEMA",k="QUERY_EDITOR_SET_TITLE",Q="QUERY_EDITOR_SET_AUTORUN",$="QUERY_EDITOR_SET_SQL",Y="QUERY_EDITOR_SET_CURSOR_POSITION",B="QUERY_EDITOR_SET_QUERY_LIMIT",H="QUERY_EDITOR_SET_TEMPLATE_PARAMS",j="QUERY_EDITOR_SET_SELECTED_TEXT",V="QUERY_EDITOR_SET_FUNCTION_NAMES",G="QUERY_EDITOR_PERSIST_HEIGHT",z="QUERY_EDITOR_TOGGLE_LEFT_BAR",W="MIGRATE_QUERY_EDITOR",K="MIGRATE_TAB_HISTORY",J="MIGRATE_TABLE",X="MIGRATE_QUERY",ee="SET_DATABASES",te="SET_ACTIVE_QUERY_EDITOR",re="LOAD_QUERY_EDITOR",ne="SET_TABLES",ae="SET_ACTIVE_SOUTHPANE_TAB",oe="REFRESH_QUERIES",se="SET_USER_OFFLINE",ie="RUN_QUERY",le="START_QUERY",ce="STOP_QUERY",de="REQUEST_QUERY_RESULTS",ue="QUERY_SUCCESS",pe="QUERY_FAILED",me="CLEAR_INACTIVE_QUERIES",_e="CLEAR_QUERY_RESULTS",he="REMOVE_DATA_PREVIEW",fe="CHANGE_DATA_PREVIEW_ID",Ee="COST_ESTIMATE_STARTED",ye="COST_ESTIMATE_RETURNED",ge="COST_ESTIMATE_FAILED",Te="CREATE_DATASOURCE_STARTED",ve="CREATE_DATASOURCE_SUCCESS",Re="CREATE_DATASOURCE_FAILED",be="SET_EDITOR_TAB_LAST_UPDATE",Se=h.bM,Ae=h.ws,Oe=h.Gb,Ie=h.Dz,Ce={Table:"TABLE",View:"VIEW"},De=(0,u.t)("The query couldn't be loaded"),Ne={id:"remoteId",db_id:"dbId",label:"name",template_parameters:"templateParams"},we=e=>t=>a()(t,((t,r)=>r in e?e[r]:r)),Le=we(s()(Ne)),qe=we(Ne);function xe(e,t,r){const{sqlLab:{unsavedQueryEditor:n,queryEditors:a}}=e,o=null!=r?r:t.id;return{id:o,...a.find((e=>e.id===o)),...o===n.id&&n}}function Ue(e){return(t,r)=>{const{common:n}=r(),a=(0,S.Z)({...(0,g.Z)(),common:n,...e});t({type:O,sqlLabInitialState:a.sqlLab}),(0,A.$e)(t,a)}}function Ze(e){return{type:C,alterations:e}}function Pe(e){return{type:be,timestamp:e}}function Me(e){return t=>p.Z.post({endpoint:"/savedqueryviewapi/api/create",postPayload:e,stringify:!1}).then((()=>t(Ae((0,u.t)("Your query has been scheduled. To see details of your query, navigate to Saved queries"))))).catch((()=>t(Oe((0,u.t)("Your query could not be scheduled")))))}function Fe(e){return(t,r)=>{const{dbId:n,schema:a,sql:o,selectedText:s,templateParams:i}=xe(r(),e),l={database_id:n,schema:a,sql:s||o,template_params:JSON.parse(i||"{}")};return Promise.all([t({type:Ee,query:e}),p.Z.post({endpoint:"/api/v1/sqllab/estimate/",body:JSON.stringify(l),headers:{"Content-Type":"application/json"}}).then((({json:r})=>t({type:ye,query:e,json:r}))).catch((r=>(0,f.O$)(r).then((r=>{const n=r.error||r.statusText||(0,u.t)("Failed at retrieving results");return t({type:ge,query:e,error:n})}))))])}}function ke(e){return{type:me,interval:e}}function Qe(e){return Object.assign(e,{id:e.id?e.id:l().generate(),progress:0,startDttm:(0,_.zO)(),state:e.runAsync?"pending":"running",cached:!1}),{type:le,query:e}}function $e(e,t){return{type:ue,query:e,results:t}}function Ye(e,t,r,n){return function(a){const o={has_err:!0,start_offset:e.startDttm,ts:(new Date).getTime()};null==n||n.forEach((({error_type:e,extra:t})=>{var r;((null==t||null==(r=t.issue_codes)?void 0:r.map((({message:e})=>e)))||[e]).forEach((t=>{a((0,T.logEvent)(y.Im,{...o,error_type:e,error_details:t}))}))})),a({type:pe,query:e,msg:t,link:r,errors:n})}}function Be(e){return{type:ce,query:e}}function He(e){return{type:_e,query:e}}function je(e){return{type:he,table:e}}function Ve(e){return{type:de,query:e}}function Ge(e,t){return function(r){r(Ve(e));const n=d().encode({key:e.resultsKey,rows:t||null});return p.Z.get({endpoint:`/api/v1/sqllab/results/?q=${n}`,parseMethod:"json-bigint"}).then((({json:t})=>r($e(e,t)))).catch((t=>(0,f.O$)(t).then((t=>{const n=t.error||t.statusText||(0,u.t)("Failed at retrieving results");return r(Ye(e,n,t.link,t.errors))}))))}}function ze(e){return function(t){t(Qe(e));const r={client_id:e.id,database_id:e.dbId,json:!0,runAsync:e.runAsync,schema:e.schema,sql:e.sql,sql_editor_id:e.sqlEditorId,tab:e.tab,tmp_table_name:e.tempTable,select_as_cta:e.ctas,ctas_method:e.ctas_method,templateParams:e.templateParams,queryLimit:e.queryLimit,expand_data:!0},n=window.location.search||"";return p.Z.post({endpoint:`/api/v1/sqllab/execute/${n}`,body:JSON.stringify(r),headers:{"Content-Type":"application/json"},parseMethod:"json-bigint"}).then((({json:r})=>{e.runAsync||t($e(e,r))})).catch((r=>(0,f.O$)(r).then((r=>{let n=r.error||r.message||r.statusText||(0,u.t)("Unknown error");n.includes("CSRF token")&&(n=(0,u.t)(E.Z.SESSION_TIMED_OUT)),t(Ye(e,n,r.link,r.errors))}))))}}function We(e,t,r,n,a,o){return function(s,i){const l=xe(i(),t,t.id);s(ze({dbId:l.dbId,sql:l.selectedText||l.sql,sqlEditorId:l.id,tab:l.name,schema:l.schema,tempTable:n,templateParams:l.templateParams,queryLimit:l.queryLimit||r,runAsync:!!e&&e.allow_run_async,ctas:a,ctas_method:o,updateTabState:!l.selectedText}))}}function Ke(e){return function(t){t(ze({...e,id:l().generate()}))}}function Je(e){return function(t){return p.Z.post({endpoint:"/api/v1/query/stop",body:JSON.stringify({client_id:e.id}),headers:{"Content-Type":"application/json"}}).then((()=>t(Be(e)))).then((()=>t(Ae((0,u.t)("Query was stopped."))))).catch((()=>t(Oe((0,u.t)("Failed at stopping query. %s",e.id)))))}}function Xe(e){return{type:ee,databases:e}}function et(e,t,r){return function(n){return p.Z.post({endpoint:"/tabstateview/",postPayload:{queryEditor:e}}).then((({json:a})=>{const o={...e,id:a.id.toString(),inLocalStorage:!1};return n({type:W,oldQueryEditor:e,newQueryEditor:o}),n({type:K,oldId:e.id,newId:o.id}),Promise.all([...t.map((e=>function(e,t,r){return p.Z.post({endpoint:encodeURI("/tableschemaview/"),postPayload:{table:{...e,queryEditorId:t}}}).then((({json:n})=>{const a={...e,id:n.id,queryEditorId:t};return r({type:J,oldTable:e,newTable:a})})).catch((()=>r(Ie((0,u.t)("Unable to migrate table schema state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}(e,o.id,n))),...r.map((e=>function(e,t,r){return p.Z.post({endpoint:encodeURI(`/tabstateview/${t}/migrate_query`),postPayload:{queryId:e}}).then((()=>r({type:X,queryId:e,queryEditorId:t}))).catch((()=>r(Ie((0,u.t)("Unable to migrate query state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}(e.id,o.id,n)))])})).catch((()=>n(Ie((0,u.t)("Unable to migrate query editor state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}}function tt(e){return function(t){return((0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.post({endpoint:"/tabstateview/",postPayload:{queryEditor:e}}).then((({json:e})=>({...e,loaded:!0}))):Promise.resolve({id:l().generate()})).then((({id:r,loaded:n})=>{const a={...e,id:r.toString(),loaded:n};return t({type:I,queryEditor:a})})).catch((()=>t(Oe((0,u.t)("Unable to add a new tab to the backend. Please contact your administrator.")))))}}function rt(){return function(e,t){const{sqlLab:{queryEditors:r,tabHistory:n,unsavedQueryEditor:a,databases:o},common:s}=t(),i=s.conf.SQLLAB_DEFAULT_DBID,l=r.find((e=>e.id===n[n.length-1])),c=Object.values(o).map((e=>e.id)),d=c.length>0?Math.min(...c):void 0,{dbId:p,schema:_,queryLimit:h,autorun:f}={...r[0],...l,...a.id===(null==l?void 0:l.id)&&a},E=(0,m.cr)(m.TT.SqllabBackendPersistence)?"":(0,u.t)("-- Note: Unless you save your query, these tabs will NOT persist if you clear your cookies or change browsers.\n\n"),y=b((null==r?void 0:r.map((e=>({...e,...e.id===a.id&&a}))))||[]);return e(tt({dbId:p||i||d,schema:null!=_?_:null,autorun:null!=f&&f,sql:`${E}SELECT ...`,queryLimit:h||s.conf.DEFAULT_SQLLAB_LIMIT,name:y}))}}function nt(e,t){return function(r,n){const a=n(),{queryEditors:o,unsavedQueryEditor:s,tabHistory:i}=a.sqlLab,l={...o.find((e=>e.id===i[i.length-1])),...i[i.length-1]===s.id&&s};return r(tt({name:(0,u.t)("Copy of %s",l.name),dbId:e.dbId?e.dbId:null,schema:e.schema?e.schema:null,autorun:t,sql:e.sql,queryLimit:l.queryLimit,maxRow:l.maxRow,templateParams:l.templateParams}))}}function at(e){return function(t){return((0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.post({endpoint:encodeURI(`/tabstateview/${e.id}/activate`)}):Promise.resolve()).then((()=>t({type:te,queryEditor:e}))).catch((r=>404!==r.status?t(Oe((0,u.t)("An error occurred while setting the active tab. Please contact your administrator."))):t({type:w,queryEditor:e})))}}function ot(e){return{type:re,queryEditor:e}}function st(e){const t=e.filter((e=>null!==e.description)).map((e=>{const{columns:t,selectStar:r,primaryKey:n,foreignKeys:a,indexes:o,dataPreviewQueryId:s}=e.description;return{dbId:e.database_id,queryEditorId:e.tab_state_id.toString(),schema:e.schema,name:e.table,expanded:e.expanded,id:e.id,dataPreviewQueryId:s,columns:t,selectStar:r,primaryKey:n,foreignKeys:a,indexes:o,isMetadataLoading:!1,isExtraMetadataLoading:!1}}));return{type:ne,tables:t}}function it(e,t){return function(r){(0,m.cr)(m.TT.SqllabBackendPersistence)&&e&&!e.loaded?p.Z.get({endpoint:encodeURI(`/tabstateview/${e.id}`)}).then((({json:e})=>{var n,a;const o={id:e.id.toString(),loaded:!0,name:e.label,sql:e.sql,selectedText:null,latestQueryId:null==(n=e.latest_query)?void 0:n.id,autorun:e.autorun,dbId:e.database_id,templateParams:e.template_params,schema:e.schema,queryLimit:e.query_limit,remoteId:null==(a=e.saved_query)?void 0:a.id,hideLeftBar:e.hide_left_bar};r(ot(o)),r(st(e.table_schemas||[])),r(at(o)),e.latest_query&&e.latest_query.resultsKey&&r(Ge(e.latest_query,t))})).catch((t=>404!==t.status?r(Oe((0,u.t)("An error occurred while fetching tab state"))):r({type:w,queryEditor:e}))):r(at(e))}}function lt(e){return{type:ae,tabId:e}}function ct(e){const t=!e.hideLeftBar;return{type:z,queryEditor:e,hideLeftBar:t}}function dt(e){return function(t){return((0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.delete({endpoint:encodeURI(`/tabstateview/${e.id}`)}):Promise.resolve()).then((()=>t({type:w,queryEditor:e}))).catch((({status:r})=>t(404!==r?Oe((0,u.t)("An error occurred while removing tab. Please contact your administrator.")):{type:w,queryEditor:e})))}}function ut(e){return function(t,r){var n;const{sqlLab:a}=r();null==(n=a.queryEditors)||n.forEach((r=>{r.id!==e.id&&t(dt(r))}))}}function pt(e){return function(t){return((0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.delete({endpoint:encodeURI(`/tabstateview/${e.sqlEditorId}/query/${e.id}`)}):Promise.resolve()).then((()=>t({type:U,query:e}))).catch((()=>t(Oe((0,u.t)("An error occurred while removing query. Please contact your administrator.")))))}}function mt(e,t){return{type:M,queryEditor:e,dbId:t}}function _t(e,t){return{type:F,queryEditor:e||{},schema:t}}function ht(e,t){return{type:Q,queryEditor:e,autorun:t}}function ft(e,t,r){return{type:k,queryEditor:{...e,id:r},name:t}}function Et(e,t){const{id:r,...n}=Le(e);return r=>p.Z.post({endpoint:"/api/v1/saved_query/",jsonPayload:Le(n)}).then((n=>{const a=qe({id:n.json.id,...n.json.result});return r({type:D,query:e,clientId:t,result:a}),r(ft(e,e.name,t)),a})).catch((()=>r(Oe((0,u.t)("Your query could not be saved")))))}const yt=(e,t)=>r=>((0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.put({endpoint:`/tabstateview/${e.id}`,postPayload:{saved_query_id:t.remoteId}}):Promise.resolve()).catch((()=>{r(Oe((0,u.t)("Your query was not properly saved")))})).then((()=>{r(Ae((0,u.t)("Your query was saved")))}));function gt(e,t){const{id:r,...n}=Le(e);return r=>p.Z.put({endpoint:`/api/v1/saved_query/${e.remoteId}`,jsonPayload:Le(n)}).then((()=>{r(Ae((0,u.t)("Your query was updated"))),r(ft(e,e.name,t))})).catch((e=>{const t=(0,u.t)("Your query could not be updated");console.error(t,e),r(Oe(t))})).then((()=>r(Ze(e))))}function Tt(e,t,r){return{type:$,queryEditor:e,sql:t,queryId:r}}function vt(e,t){return{type:Y,queryEditor:e,position:t}}function Rt(e,t,r){return function(n,a){const o=xe(a(),e);return n(Tt(o,t,r)),(0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.put({endpoint:encodeURI(`/tabstateview/${o.id}`),postPayload:{sql:t,latest_query_id:r}}).catch((()=>n(Oe((0,u.t)('An error occurred while storing your query in the backend. To avoid losing your changes, please save your query using the "Save Query" button.'))))):Promise.resolve()}}function bt(e){return function(t,r){const{sql:n}=xe(r(),e);return p.Z.post({endpoint:"/api/v1/sqllab/format_sql/",body:JSON.stringify({sql:n}),headers:{"Content-Type":"application/json"}}).then((({json:r})=>{t(Tt(e,r.result))}))}}function St(e,t){return{type:B,queryEditor:e,queryLimit:t}}function At(e,t){return{type:H,queryEditor:e,templateParams:t}}function Ot(e,t){return{type:j,queryEditor:e,sql:t}}function It(e,t,r){return{type:L,table:e,query:t,prepend:r}}function Ct(e,t,r){return function(n,a){const o=xe(a(),e,e.id);n(It({dbId:o.dbId,queryEditorId:o.id,schema:r,name:t,id:l().generate(),expanded:!0},null,!0))}}function Dt(e){return function(t,r){const{sqlLab:{databases:n}}=r(),a=n[e.dbId],{dbId:o}=e;if(a&&!a.disable_data_preview){const r={id:l().generate(),dbId:o,sql:e.selectStar,tableName:e.name,sqlEditorId:null,tab:"",runAsync:a.allow_run_async,ctas:!1,isDataPreview:!0};return Promise.all([t(It({id:e.id,dbId:e.dbId,schema:e.schema,name:e.name,queryEditorId:e.queryEditorId,dataPreviewQueryId:r.id},r)),t(ze(r))])}return Promise.resolve()}}function Nt(e,t){return function(r){return((0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.post({endpoint:encodeURI("/tableschemaview/"),postPayload:{table:{...t,...e}}}):Promise.resolve({json:{id:e.id}})).then((({json:n})=>{const a={...e,id:n.id};r(It({...a,expanded:!0,initialized:!0})),e.dataPreviewQueryId||r(Dt({...t,...a}))})).catch((()=>r(Oe((0,u.t)("An error occurred while fetching table metadata. Please contact your administrator.")))))}}function wt(e,t){return{type:fe,oldQueryId:e,newQuery:t}}function Lt(e){return function(t){const r={id:l().generate(),dbId:e.dbId,sql:e.sql,tableName:e.tableName,sqlEditorId:null,tab:"",runAsync:!1,ctas:!1,queryLimit:e.queryLimit,isDataPreview:e.isDataPreview};t(ze(r)),t(wt(e.id,r))}}function qt(e){return function(t){return((0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.post({endpoint:encodeURI(`/tableschemaview/${e.id}/expanded`),postPayload:{expanded:!0}}):Promise.resolve()).then((()=>t({type:Z,table:e}))).catch((()=>t(Oe((0,u.t)("An error occurred while expanding the table schema. Please contact your administrator.")))))}}function xt(e){return function(t){return((0,m.cr)(m.TT.SqllabBackendPersistence)?p.Z.post({endpoint:encodeURI(`/tableschemaview/${e.id}/expanded`),postPayload:{expanded:!1}}):Promise.resolve()).then((()=>t({type:P,table:e}))).catch((()=>t(Oe((0,u.t)("An error occurred while collapsing the table schema. Please contact your administrator.")))))}}function Ut(e){return function(t){var r;const n=null!=(r=null==e?void 0:e.filter(Boolean))?r:[];return((0,m.cr)(m.TT.SqllabBackendPersistence)?Promise.all(n.map((e=>e.initialized?p.Z.delete({endpoint:encodeURI(`/tableschemaview/${e.id}`)}):Promise.resolve()))):Promise.resolve()).then((()=>t({type:q,tables:n}))).catch((()=>t(Oe((0,u.t)("An error occurred while removing the table schema. Please contact your administrator.")))))}}function Zt(e){return{type:oe,alteredQueries:e}}function Pt(e){return{type:se,offline:e}}function Mt(e,t,r){return{type:G,queryEditor:e,northPercent:t,southPercent:r}}function Ft(e){return function(t){return p.Z.get({endpoint:`/kv/${e}`}).then((({json:e})=>t(tt({name:e.name?e.name:(0,u.t)("Shared query"),dbId:e.dbId?parseInt(e.dbId,10):null,schema:e.schema?e.schema:null,autorun:!!e.autorun&&e.autorun,sql:e.sql?e.sql:"SELECT ...",templateParams:e.templateParams})))).catch((()=>t(Oe(De))))}}function kt(e){return function(t){return p.Z.get({endpoint:`/savedqueryviewapi/api/get/${e}`}).then((({json:e})=>{const r={...qe(e.result),loaded:!0,autorun:!1};return t(tt(r))})).catch((()=>t(Oe(De))))}}function Qt(e){return function(t){return p.Z.get({endpoint:`/api/v1/query/${e}`}).then((({json:e})=>{const r=e.result,n={dbId:r.database.id,schema:r.schema,sql:r.sql,name:(0,u.t)("Copy of %s",r.tab_name),autorun:!1};return t(tt(n))})).catch((()=>t(Oe(De))))}}function $t(e,t){return function(r){const n=(0,u.t)("Query"),a=e.split("__")[0],o=d().encode({keys:["none"],columns:["name","schema","database.id","select_star"]});return p.Z.get({endpoint:`/api/v1/dataset/${a}?q=${o}`}).then((({json:e})=>r(tt({name:`${n} ${e.result.name}`,dbId:e.result.database.id,schema:e.result.schema,autorun:void 0!==t,sql:t||e.result.select_star})))).catch((()=>r(Oe((0,u.t)("The datasource couldn't be loaded")))))}}function Yt(){return{type:Te}}function Bt(e){const t=`${e.id}__table`;return{type:ve,datasource:t}}function Ht(e){return{type:Re,err:e}}function jt(e){return t=>{t(Yt());const{dbId:r,schema:n,datasourceName:a,sql:o}=e;return p.Z.post({endpoint:"/api/v1/dataset/",headers:{"Content-Type":"application/json"},body:JSON.stringify({database:r,schema:n,sql:o,table_name:a,is_managed_externally:!1,external_url:null})}).then((({json:e})=>(t(Bt(e)),Promise.resolve(e)))).catch((e=>((0,f.O$)(e).then((e=>{t(Oe(e.error))})),t(Ht((0,u.t)("An error occurred while creating the data source"))),Promise.reject())))}}function Vt(e){return t=>(t(Yt()),p.Z.post({endpoint:"/api/v1/dataset/get_or_create/",jsonPayload:e}).then((({json:e})=>(t(Bt(e.result)),e.result))).catch((()=>{const e=(0,u.t)("An error occurred while creating the data source");return t(Ht(e)),Promise.reject(new Error(e))})))}},52256:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ADD_CHART:()=>X,ANNOTATION_QUERY_FAILED:()=>P,ANNOTATION_QUERY_STARTED:()=>U,ANNOTATION_QUERY_SUCCESS:()=>q,CHART_RENDERING_FAILED:()=>I,CHART_RENDERING_SUCCEEDED:()=>D,CHART_UPDATE_FAILED:()=>A,CHART_UPDATE_STARTED:()=>g,CHART_UPDATE_STOPPED:()=>b,CHART_UPDATE_SUCCEEDED:()=>v,DYNAMIC_PLUGIN_CONTROLS_READY:()=>F,POST_CHART_FORM_DATA:()=>ne,REMOVE_CHART:()=>w,RENDER_TRIGGERED:()=>V,TRIGGER_QUERY:()=>H,UPDATE_CHART_ID:()=>K,UPDATE_QUERY_FORM_DATA:()=>z,addChart:()=>ee,annotationQueryFailed:()=>M,annotationQueryStarted:()=>Z,annotationQuerySuccess:()=>x,chartRenderingFailed:()=>C,chartRenderingSucceeded:()=>N,chartUpdateFailed:()=>O,chartUpdateStarted:()=>T,chartUpdateStopped:()=>S,chartUpdateSucceeded:()=>R,dynamicPluginControlsReady:()=>k,exploreJSON:()=>re,getChartDataRequest:()=>Y,getDatasourceSamples:()=>ie,handleChartDataResponse:()=>te,postChartFormData:()=>ae,redirectSQLLab:()=>oe,refreshChart:()=>se,removeChart:()=>L,renderTriggered:()=>G,runAnnotationQuery:()=>B,triggerQuery:()=>j,updateChartId:()=>J,updateQueryFormData:()=>W});var n=r(30381),a=r.n(n),o=r(31069),s=r(93185),i=r(61988),l=r(37731),c=r(35854),d=r(12515),u=r(72570),p=r(97381),m=r(3741),_=r(98286),h=r(86374),f=r(74599),E=r(77997),y=r(9679);const g="CHART_UPDATE_STARTED";function T(e,t,r){return{type:g,queryController:e,latestQueryFormData:t,key:r}}const v="CHART_UPDATE_SUCCEEDED";function R(e,t){return{type:v,queriesResponse:e,key:t}}const b="CHART_UPDATE_STOPPED";function S(e){return{type:b,key:e}}const A="CHART_UPDATE_FAILED";function O(e,t){return{type:A,queriesResponse:e,key:t}}const I="CHART_RENDERING_FAILED";function C(e,t,r){return{type:I,error:e,key:t,stackTrace:r}}const D="CHART_RENDERING_SUCCEEDED";function N(e){return{type:D,key:e}}const w="REMOVE_CHART";function L(e){return{type:w,key:e}}const q="ANNOTATION_QUERY_SUCCESS";function x(e,t,r){return{type:q,annotation:e,queryResponse:t,key:r}}const U="ANNOTATION_QUERY_STARTED";function Z(e,t,r){return{type:U,annotation:e,queryController:t,key:r}}const P="ANNOTATION_QUERY_FAILED";function M(e,t,r){return{type:P,annotation:e,queryResponse:t,key:r}}const F="DYNAMIC_PLUGIN_CONTROLS_READY",k=()=>(e,t)=>{const r=t(),n=(0,c.R3)(r.explore,r.explore.form_data);e({type:F,key:n.slice_id.value,controlsState:n})},Q=async(e,t,r,n,a="POST",s={},i)=>{const l=(0,d.pd)({resultFormat:t,resultType:r}),c=h._&&(null==s?void 0:s.dashboard_id),u=(0,d.H6)({formData:e,endpointType:l,force:n,allowDomainSharding:c,method:a,requestParams:s.dashboard_id?{dashboard_id:s.dashboard_id}:{}}),p={...s,url:u,postPayload:{form_data:e},parseMethod:i};return o.Z.post(p).then((({json:e,response:t})=>({response:t,json:{result:[e]}})))},$=async(e,t,r,n,a,s,i,l)=>{const c=(0,d.u)({formData:e,resultType:r,resultFormat:t,force:n,setDataMask:s,ownState:i}),{slice_id:u}=e,{dashboard_id:p}=a,m={};void 0!==u&&(m.form_data=`{"slice_id":${u}}`),void 0!==p&&(m.dashboard_id=p),n&&(m.force=n);const _=h._&&(null==a?void 0:a.dashboard_id),f=(0,d.kN)({path:"/api/v1/chart/data",qs:m,allowDomainSharding:_}).toString(),E={...a,url:f,headers:{"Content-Type":"application/json"},body:JSON.stringify(c),parseMethod:l};return o.Z.post(E)};async function Y({formData:e,setDataMask:t=(()=>{}),resultFormat:r="json",resultType:n="full",force:a=!1,method:o="POST",requestParams:s={},ownState:i={}}){let l={...s};h._&&(l={...l,mode:"cors",credentials:"include"});const[c,u]=(0,d.hz)(e);return c?Q(e,r,n,a,o,l,u):$(e,r,n,a,l,t,i,u)}function B({annotation:e,timeout:t,formData:r=null,key:n,isDashboardRequest:a=!1,force:s=!1}){return function(i,l){var c;const{charts:u,common:p}=l(),m=n||Object.keys(u)[0],h=t||p.conf.SUPERSET_WEBSERVER_TIMEOUT,f={...r||u[m].latestQueryFormData};if(!e.sourceType)return Promise.resolve();f.time_grain_sqla=f.time_grain_sqla||f.granularity,f.granularity=f.granularity_sqla;const E=Object.keys(e.overrides);(E.includes("since")||E.includes("until"))&&(e.overrides={...e.overrides,time_range:null});const y=Object.keys(e.overrides).reduce(((t,r)=>({...t,[r]:e.overrides[r]||f[r]})),{});if(!a&&f){const e=f.extra_filters&&f.extra_filters.length>0;y.extra_filters=e?f.extra_filters:void 0}const g=(0,d.xW)(e.value,s),T=new AbortController,{signal:v}=T;i(Z(e,T,m));const R=null==f||null==(c=f.annotation_layers)?void 0:c.findIndex((t=>t.name===e.name));return R>=0&&(f.annotation_layers[R].overrides=y),o.Z.post({url:g,signal:v,timeout:1e3*h,headers:{"Content-Type":"application/json"},jsonPayload:(0,d.u)({formData:f,force:s,resultFormat:"json",resultType:"full"})}).then((({json:t})=>{var r,n,a;const o=null==t||null==(r=t.result)||null==(n=r[0])||null==(a=n.annotation_data)?void 0:a[e.name];return i(x(e,{data:o},m))})).catch((t=>(0,_.O$)(t).then((t=>{"timeout"===t.statusText?i(M(e,{error:"Query timeout"},m)):(t.error||"").toLowerCase().includes("no data")?i(x(e,t,m)):"abort"!==t.statusText&&i(M(e,t,m))}))))}}const H="TRIGGER_QUERY";function j(e=!0,t){return{type:H,value:e,key:t}}const V="RENDER_TRIGGERED";function G(e,t){return{type:V,value:e,key:t}}const z="UPDATE_QUERY_FORM_DATA";function W(e,t){return{type:z,value:e,key:t}}const K="UPDATE_CHART_ID";function J(e,t=0){return{type:K,newId:e,key:t}}const X="ADD_CHART";function ee(e,t){return{type:X,chart:e,key:t}}function te(e,t,r){if((0,s.cr)(s.TT.GlobalAsyncQueries)){const n="result"in t?t.result:t;switch(e.status){case 200:return Promise.resolve(n);case 202:return r?(0,E.YJ)(n[0]):(0,E.YJ)(n);default:throw new Error(`Received unexpected response status (${e.status}) while fetching chart data`)}}return t.result}function re(e,t=!1,r,n,o,i){return async(l,c)=>{const u=m.Yd.getTimestamp(),h=new AbortController,E=r||c().common.conf.SUPERSET_WEBSERVER_TIMEOUT,y={signal:h.signal,timeout:1e3*E};o&&(y.dashboard_id=o);const g=Y({setDataMask:t=>{l((0,f.eG)(e.slice_id,t))},formData:e,resultFormat:"json",resultType:"full",force:t,method:"POST",requestParams:y,ownState:i});l(T(h,e,n));const[v]=(0,d.hz)(e),b=g.then((({response:e,json:t})=>te(e,t,v))).then((r=>(r.forEach((r=>l((0,p.logEvent)(m.W9,{slice_id:n,applied_filters:r.applied_filters,is_cached:r.is_cached,force_refresh:t,row_count:r.rowcount,datasource:e.datasource,start_offset:u,ts:(new Date).getTime(),duration:m.Yd.getTimestamp()-u,has_extra_filters:e.extra_filters&&e.extra_filters.length>0,viz_type:e.viz_type,data_age:r.is_cached?a()(new Date).diff(a().utc(r.cached_dttm)):null})))),l(R(r,n))))).catch((t=>{if((0,s.cr)(s.TT.GlobalAsyncQueries))return l(O([t],n));const r=(t,r)=>{l((0,p.logEvent)(m.W9,{slice_id:n,has_err:!0,is_cached:r,error_details:t,datasource:e.datasource,start_offset:u,ts:(new Date).getTime(),duration:m.Yd.getTimestamp()-u}))};return"AbortError"===t.name?(r("abort"),l(S(n))):(0,_.O$)(t).then((e=>("timeout"===t.statusText?r("timeout"):r(e.error,e.is_cached),l(O([e],n)))))})),A=v&&e.annotation_layers||[],I=o>0;return Promise.all([b,l(j(!1,n)),l(W(e,n)),...A.map((a=>l(B({annotation:a,timeout:r,formData:e,key:n,isDashboardRequest:I,force:t}))))])}}const ne="POST_CHART_FORM_DATA";function ae(e,t=!1,r,n,a,o){return re(e,t,r,n,a,o)}function oe(e,t){return r=>{Y({formData:e,resultFormat:"json",resultType:"query"}).then((({json:r})=>{const n="/sqllab/",a={datasourceKey:e.datasource,sql:r.result[0].query};t?t.push({pathname:n,state:{requestedQuery:a}}):o.Z.postForm(n,{form_data:(0,y.o)(a)})})).catch((()=>r((0,u.Gb)((0,i.t)("An error occurred while loading the SQL")))))}}function se(e,t,r){return(n,a)=>{var o;const s=(a().charts||{})[e],i=a().dashboardInfo.common.conf.SUPERSET_WEBSERVER_TIMEOUT;s.latestQueryFormData&&0!==Object.keys(s.latestQueryFormData).length&&n(ae(s.latestQueryFormData,t,i,s.id,r,null==(o=a().dataMask[s.id])?void 0:o.ownState))}}const ie=async(e,t,r,n,a,s)=>{try{const i={force:r,datasource_type:e,datasource_id:t};return(0,l.Z)(a)&&(0,l.Z)(s)&&(i.per_page=a,i.page=s),(await o.Z.post({endpoint:"/datasource/samples",jsonPayload:n,searchParams:i,parseMethod:"json-bigint"})).json.result}catch(e){const t=await(0,_.O$)(e);throw new Error(t.message||t.error||(0,i.t)("Sorry, an error occurred"),{cause:e})}}},13433:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(67294),a=r(45697),o=r.n(a),s=r(61988),i=r(58593),l=r(14114),c=r(10222),d=r(11965);const u={copyNode:o().node,getText:o().func,onCopyEnd:o().func,shouldShowText:o().bool,text:o().string,wrapped:o().bool,tooltipText:o().string,addDangerToast:o().func.isRequired,addSuccessToast:o().func.isRequired,hideTooltip:o().bool},p={copyNode:(0,d.tZ)("span",null,(0,s.t)("Copy")),onCopyEnd:()=>{},shouldShowText:!0,wrapped:!0,tooltipText:(0,s.t)("Copy to clipboard"),hideTooltip:!1};var m={name:"8irbms",styles:"display:inline-flex;align-items:center"};class _ extends n.Component{constructor(e){super(e),this.copyToClipboard=this.copyToClipboard.bind(this),this.onClick=this.onClick.bind(this)}onClick(){this.props.getText?this.props.getText((e=>{this.copyToClipboard(Promise.resolve(e))})):this.copyToClipboard(Promise.resolve(this.props.text))}getDecoratedCopyNode(){return n.cloneElement(this.props.copyNode,{style:{cursor:"pointer"},onClick:this.onClick})}copyToClipboard(e){(0,c.Z)((()=>e)).then((()=>{this.props.addSuccessToast((0,s.t)("Copied to clipboard!"))})).catch((()=>{this.props.addDangerToast((0,s.t)("Sorry, your browser does not support copying. Use Ctrl / Cmd + C!"))})).finally((()=>{this.props.onCopyEnd()}))}renderTooltip(e){return(0,d.tZ)(n.Fragment,null,this.props.hideTooltip?this.getDecoratedCopyNode():(0,d.tZ)(i.u,{id:"copy-to-clipboard-tooltip",placement:"topRight",style:{cursor:e},title:this.props.tooltipText,trigger:["hover"],arrowPointAtCenter:!0},this.getDecoratedCopyNode()))}renderNotWrapped(){return this.renderTooltip("pointer")}renderLink(){return(0,d.tZ)("span",{css:m},this.props.shouldShowText&&this.props.text&&(0,d.tZ)("span",{className:"m-r-5"},this.props.text),this.renderTooltip())}render(){const{wrapped:e}=this.props;return e?this.renderLink():this.renderNotWrapped()}}const h=(0,l.ZP)(_);_.propTypes=u,_.defaultProps=p},81395:(e,t,r)=>{"use strict";function n(e,t){return e().dashboardState.sliceIds.includes(t)}r.d(t,{M6:()=>o,P_:()=>c,cK:()=>d,ib:()=>l,l6:()=>u,oT:()=>s,oW:()=>a,yz:()=>i});const a="CHANGE_FILTER";function o(e,t,r){return(o,s)=>{if(n(s,e)){const n=s().dashboardLayout.present;return o({type:a,chartId:e,newSelectedValues:t,merge:r,components:n})}return s().dashboardFilters}}const s="UPDATE_DIRECT_PATH_TO_FILTER";function i(e,t){return(r,a)=>n(a,e)?r({type:s,chartId:e,path:t}):a().dashboardFilters}const l="UPDATE_LAYOUT_COMPONENTS";function c(e){return t=>{t({type:l,components:e})}}const d="UPDATE_DASHBOARD_FILTERS_SCOPE";function u(e){return t=>{t({type:d,scopes:e})}}},12885:(e,t,r)=>{"use strict";r.d(t,{J0:()=>T,YA:()=>R,bK:()=>f,CB:()=>y,Mu:()=>S,L1:()=>N,aZ:()=>C,qL:()=>O,nj:()=>p,x_:()=>x,LM:()=>v,Ww:()=>E,v7:()=>g,g3:()=>A,_p:()=>w,az:()=>q,iO:()=>I,Ou:()=>L,WZ:()=>_,A7:()=>h});var n=r(21090),a=r(61988),o=r(72570),s=r(81255),i=r(80621),l=r(47456),c=r(95173),d=r(81395),u=r(9467);const p="UPDATE_COMPONENTS";function m(e){return(...t)=>(r,n)=>{const a=e(...t);r("function"==typeof a?a(r,n):a);const{dashboardLayout:o,dashboardState:s}=n();if(a.type!==p||!a.payload||!a.payload.nextComponents){const e=o.present;r((0,d.P_)(e))}s.hasUnsavedChanges||r((0,u.if)(!0))}}const _=m((e=>({type:p,payload:{nextComponents:e}})));function h(e){return(t,r)=>{const{dashboardLayout:n}=r();t(_({[i.M2]:{...n.present[i.M2],meta:{text:e}}}))}}const f="DASHBOARD_TITLE_CHANGED";function E(e){return{type:f,text:e}}const y="DELETE_COMPONENT",g=m(((e,t)=>({type:y,payload:{id:e,parentId:t}}))),T="CREATE_COMPONENT",v=m((e=>({type:T,payload:{dropResult:e}}))),R="CREATE_TOP_LEVEL_TABS",b=m((e=>({type:R,payload:{dropResult:e}}))),S="DELETE_TOP_LEVEL_TABS",A=m((()=>({type:S,payload:{}}))),O="RESIZE_COMPONENT";function I({id:e,width:t,height:r}){return(n,a)=>{const{dashboardLayout:o}=a(),{present:s}=o,i=s[e],l=t&&i.meta.width!==t,c=r&&i.meta.height!==r;if(i&&(l||c)){const a={[e]:{...i,meta:{...i.meta,width:t||i.meta.width,height:r||i.meta.height}}};n(_(a))}}}const C="MOVE_COMPONENT",D=m((e=>({type:C,payload:{dropResult:e}}))),N="HANDLE_COMPONENT_DROP";function w(e){return(t,r)=>{const n=function(e,t){const r=(0,l.Z)({dropResult:e,layout:t});return"number"==typeof r&&r<0}(e,r().dashboardLayout.present);if(n)return t((0,o.Dz)((0,a.t)("There is not enough space for this component. Try decreasing its width, or increasing the destination width.")));const{source:d,destination:u}=e,p=u&&u.id===i._4,m=d.id===i.D0,_=r().dashboardLayout.present[i._4],h=_&&_.children?_.children[0]:"";if(p)t(b(e));else if(u&&m)t(v(e));else{if(d.type===s.yR&&u.type===s.yR&&d.id===h&&u.id!==h)return t((0,o.Dz)((0,a.t)("Can not move top level tab into nested tabs")));u&&d&&(u.id!==d.id||u.index!==d.index)&&t(D(e))}const{dashboardFilters:f,dashboardLayout:E}=r();if(!m){const{present:e}=E,r=e[d.id]||{},n=e[u.id]||{};if((r.type===s.yR||r.type===s.Os)&&r.children&&0===r.children.length){const r=(0,c.Z)({childId:d.id,layout:e});t(g(d.id,r))}(function({dashboardFilters:e={},source:t=[],destination:r=[]}){const n=new Set(t),a=new Set(r);return[].concat(...Object.values(e).map((({scopes:e})=>[].concat(...Object.values(e).map((({scope:e})=>e)))))).some((e=>a.has(e)!==n.has(e)))})({dashboardFilters:f,source:(r.parents||[]).concat(d.id),destination:(n.parents||[]).concat(u.id)})&&t((0,o.Dz)((0,a.t)("This chart has been moved to a different filter scope.")))}return null}}function L(){return(e,t)=>{e(n.zF.undo());const{dashboardLayout:r,dashboardState:a}=t();0!==r.past.length||a.maxUndoHistoryExceeded||a.updatedColorScheme||e((0,u.if)(!1))}}const q=m(n.zF.redo),x="UPDATE_COMPONENTS_PARENTS_LIST"},9467:(e,t,r)=>{"use strict";r.d(t,{BD:()=>q,P0:()=>V,bs:()=>le,sm:()=>ce,ec:()=>pe,k5:()=>ue,Ii:()=>z,Vd:()=>x,qJ:()=>ne,hD:()=>re,om:()=>Re,J$:()=>ye,FF:()=>qe,RU:()=>Te,$f:()=>H,mq:()=>Se,r$:()=>Ce,n1:()=>Ne,w9:()=>ee,yV:()=>K,ee:()=>w,oJ:()=>_e,ek:()=>Q,Z9:()=>U,H9:()=>F,Iw:()=>Oe,Be:()=>Y,Pi:()=>fe,Mn:()=>se,Lb:()=>P,Qt:()=>Le,z2:()=>G,YC:()=>de,Yy:()=>me,Vv:()=>W,rL:()=>Ee,M8:()=>oe,TN:()=>M,dr:()=>k,r7:()=>be,uW:()=>ge,sL:()=>xe,E2:()=>ve,Mb:()=>j,GH:()=>Ae,zL:()=>De,uN:()=>we,Qo:()=>te,fE:()=>J,if:()=>L,O8:()=>he,WL:()=>$,oY:()=>Ie,Sn:()=>B});var n=r(21090),a=r(15926),o=r.n(a),s=r(31069),i=r(61988),l=r(55786),c=r(93185),d=r(78161),u=r(52256),p=r(37863),m=r(35854),_=r(98286),h=r(80621),f=r(52838),E=r(72570),y=r(11370),g=r(43399),T=r(9679),v=r(97381),R=r(3741),b=r(12885),S=r(41295),A=r(50810),O=r(81395),I=r(52794),C=r(9531);const D=new Set(["json_metadata","position_json"]);function N(e,t){return t.split(".").reduce(((e,t)=>{const r=null==e?void 0:e[t];return D.has(t)&&r?JSON.parse(r):r}),e)}const w="SET_UNSAVED_CHANGES";function L(e){return{type:w,payload:{hasUnsavedChanges:e}}}const q="ADD_SLICE",x="REMOVE_SLICE",U="TOGGLE_FAVE_STAR";function Z(e){return{type:U,isStarred:e}}function P(e){return function(t){return s.Z.get({endpoint:`/api/v1/dashboard/favorite_status/?q=${o().encode([e])}`}).then((({json:e})=>{var r,n;t(Z(!(null==e||null==(r=e.result)||null==(n=r[0])||!n.value)))})).catch((()=>t((0,E.Gb)((0,i.t)("There was an issue fetching the favorite status of this dashboard.")))))}}function M(e,t){return function(r){const n=`/api/v1/dashboard/${e}/favorites/`;return(t?s.Z.delete({endpoint:n}):s.Z.post({endpoint:n})).then((()=>{r(Z(!t))})).catch((()=>r((0,E.Gb)((0,i.t)("There was an issue favoriting this dashboard.")))))}}const F="TOGGLE_PUBLISHED";function k(e,t){return function(r){return s.Z.put({endpoint:`/api/v1/dashboard/${e}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({published:t})}).then((()=>{r((0,E.ws)(t?(0,i.t)("This dashboard is now published"):(0,i.t)("This dashboard is now hidden"))),r(function(e){return{type:F,isPublished:e}}(t))})).catch((()=>{r((0,E.Gb)((0,i.t)("You do not have permissions to edit this dashboard.")))}))}}const Q="TOGGLE_EXPAND_SLICE";function $(e){return{type:Q,sliceId:e}}const Y="UPDATE_CSS";function B(e){return{type:Y,css:e}}const H="SET_EDIT_MODE";function j(e){return{type:H,editMode:e}}const V="ON_CHANGE";function G(){return{type:V}}const z="ON_SAVE";function W(e){return{type:z,lastModifiedTime:e}}const K="SET_REFRESH_FREQUENCY";function J(e,t=!1){return{type:K,refreshFrequency:e,isPersistent:t}}function X(e){return t=>{t(W(e)),t(n.zF.clearHistory())}}const ee="SET_OVERRIDE_CONFIRM";function te(e){return{type:ee,overwriteConfirmMetadata:e}}const re="SAVE_DASHBOARD_STARTED",ne="SAVE_DASHBOARD_FINISHED";function ae(){return{type:ne}}function oe(e,t,r){return(n,a)=>{var o,d,u,p,m,A,w,L,q;n({type:b.x_}),n({type:re});const{dashboardFilters:x,dashboardLayout:U}=a(),Z=U.present;Object.values(x).forEach((e=>{var t;const{chartId:r}=e,a=e.directPathToFilter.slice().pop(),o=((null==(t=Z[a])?void 0:t.parents)||[]).slice();o.push(a),n((0,O.yz)(r,o))}));const P=(0,y.Z)((0,g.De)()),M=function(e){return Object.values(e).reduce(((e,{chartId:t,scopes:r})=>({...e,[t]:Object.keys(r).reduce(((e,t)=>({...e,[t]:r[t]})),{})})),{})}(x),{certified_by:F,certification_details:k,css:Q,dashboard_title:$,owners:Y,roles:B,slug:H}=e,j=e=>void 0!==e.id,V=null==(o=e.metadata)?void 0:o.cross_filters_enabled,G={...e,certified_by:F||"",certification_details:F&&k?k:"",css:Q||"",dashboard_title:$||(0,i.t)("[ untitled dashboard ]"),owners:(0,l.Z)(Y).map((e=>j(e)?e.id:e)),roles:(0,c.cr)(c.TT.DashboardRbac)?(0,l.Z)(B).map((e=>j(e)?e.id:e)):void 0,slug:H||null,metadata:{...e.metadata,color_namespace:(null==(d=e.metadata)?void 0:d.color_namespace)||void 0,color_scheme:(null==(u=e.metadata)?void 0:u.color_scheme)||"",color_scheme_domain:(null==(p=e.metadata)?void 0:p.color_scheme_domain)||[],expanded_slices:(null==(m=e.metadata)?void 0:m.expanded_slices)||{},label_colors:(null==(A=e.metadata)?void 0:A.label_colors)||{},shared_label_colors:(null==(w=e.metadata)?void 0:w.shared_label_colors)||{},refresh_frequency:(null==(L=e.metadata)?void 0:L.refresh_frequency)||0,timed_refresh_immune_slices:(null==(q=e.metadata)?void 0:q.timed_refresh_immune_slices)||[],cross_filters_enabled:(0,f.U)(V)}},z=()=>{const{dashboardLayout:e,charts:t,dashboardInfo:{metadata:r}}=a();return(0,f.g)(e.present,r,t)},W=async e=>{const{error:t,message:r}=await(0,_.O$)(e);let a=(0,i.t)("Sorry, an unknown error occurred");t&&(a=(0,i.t)("Sorry, there was an error saving this dashboard: %s",t)),"string"==typeof r&&"Forbidden"===r&&(a=(0,i.t)("You do not have permission to edit this dashboard")),n(ae()),n((0,E.Gb)(a))};if([h.TN,h.NT].includes(r)){let a={},o={};(0,c.cr)(c.TT.DashboardCrossFilters)&&({chartConfiguration:a,globalChartConfiguration:o}=z());const l=r===h.NT?e:{certified_by:G.certified_by,certification_details:G.certification_details,css:G.css,dashboard_title:G.dashboard_title,slug:G.slug,owners:G.owners,roles:G.roles,json_metadata:(0,T.o)({...(null==G?void 0:G.metadata)||{},default_filters:(0,T.o)(P),filter_scopes:M,chart_configuration:a,global_chart_configuration:o})},d=()=>s.Z.put({endpoint:`/api/v1/dashboard/${t}`,headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then((e=>(e=>{const r=e.json.result,a=e.json.last_modified_time;if(r.json_metadata){const e=JSON.parse(r.json_metadata);n((0,S.a8)({metadata:e})),e.chart_configuration&&n({type:S.Jy,chartConfiguration:e.chart_configuration}),e.native_filter_configuration&&n({type:I.qe,filterConfig:e.native_filter_configuration})}return a&&n(X(a)),n(ae()),window.history.pushState({event:"dashboard_properties_changed"},"",`/superset/dashboard/${H||t}/`),n((0,E.ws)((0,i.t)("This dashboard was saved successfully."))),n(te(void 0)),e})(e))).catch((e=>W(e)));return new Promise(((e,a)=>{(0,c.cr)(c.TT.ConfirmDashboardDiff)&&r!==h.NT?s.Z.get({endpoint:`/api/v1/dashboard/${t}`}).then((r=>{const o=r.json.result,s=(i=o,c=l,C.yT.map((e=>({keyPath:e,...e.split(".").find((e=>D.has(e)))?{oldValue:JSON.stringify(N(i,e),null,2)||"{}",newValue:JSON.stringify(N(c,e),null,2)||"{}"}:{oldValue:N(i,e)||"",newValue:N(c,e)||""}}))).filter((({oldValue:e,newValue:t})=>e!==t)));var i,c;return s.length>0?(n(te({updatedAt:o.changed_on,updatedBy:o.changed_by_name,overwriteConfirmItems:s,dashboardId:t,data:l})),a(s)):e()})):e()})).then(d).catch((e=>{const r=(0,i.t)("Please confirm the overwrite values.");n((0,v.logEvent)(R.yw,{dashboard_id:t,items:e})),n((0,E.Gb)(r))}))}"positions"in G&&!("positions"in G.metadata)&&(G.metadata.positions=G.positions),G.metadata.default_filters=(0,T.o)(P),G.metadata.filter_scopes=M;const K={dashboard_title:G.dashboard_title,css:G.css,duplicate_slices:G.duplicate_slices,json_metadata:JSON.stringify(G.metadata)};return s.Z.post({endpoint:`/api/v1/dashboard/${t}/copy/`,jsonPayload:K}).then((e=>(e=>{const t=e.json.result.last_modified_time;if(t&&n(X(t)),(0,c.cr)(c.TT.DashboardCrossFilters)){const{chartConfiguration:e,globalChartConfiguration:t}=z();n((0,S.Mi)({chartConfiguration:e,globalChartConfiguration:t}))}return n(ae()),n((0,E.ws)((0,i.t)("This dashboard was saved successfully."))),e})(e))).catch((e=>W(e)))}}function se(e=[],t=!1,r=0,n){return(a,o)=>{if(!r)return void e.forEach((e=>a((0,u.refreshChart)(e,t,n))));const{metadata:s}=o().dashboardInfo,i=Math.max(r,s.stagger_time||5e3);"boolean"!=typeof s.stagger_refresh&&(s.stagger_refresh=void 0===s.stagger_refresh||"true"===s.stagger_refresh);const l=s.stagger_refresh?i/(e.length-1):0;e.forEach(((e,r)=>{setTimeout((()=>a((0,u.refreshChart)(e,t,n))),l*r)}))}}const ie=(e,t,r,n,a)=>new Promise((o=>{a(se(e,t,r,n)),o()})),le="ON_FILTERS_REFRESH",ce="ON_FILTERS_REFRESH_SUCCESS";function de(){return{type:ce}}const ue="ON_REFRESH_SUCCESS",pe="ON_REFRESH";function me(e=[],t=!1,r=0,n){return a=>{a({type:pe}),ie(e,t,r,n,a).then((()=>{a({type:ue}),a({type:le})}))}}const _e="SHOW_BUILDER_PANE";function he(){return{type:_e}}function fe(e){return(t,r)=>{const{sliceEntities:n}=r(),a=n.slices[e];if(!a)return t((0,E.Dz)("Sorry, there is no chart definition associated with the chart trying to be added."));const o={...a.form_data,slice_id:a.slice_id},s={...p.u,id:e,form_data:(0,m.oN)(o)};return Promise.all([t((0,u.addChart)(s,e)),t((0,A.QR)(o.datasource))]).then((()=>{t({type:q,slice:a})}))}}function Ee(e){return t=>{t({type:x,sliceId:e}),t((0,u.removeChart)(e)),(0,d.ZP)().removeSlice(e)}}const ye="SET_COLOR_SCHEME";function ge(e){return{type:ye,colorScheme:e}}const Te="SET_DIRECT_PATH";function ve(e){return{type:Te,path:e}}const Re="SET_ACTIVE_TAB";function be(e,t){return{type:Re,tabId:e,prevTabId:t}}const Se="SET_FOCUSED_FILTER_FIELD";function Ae(e,t){return{type:Se,chartId:e,column:t}}const Oe="UNSET_FOCUSED_FILTER_FIELD";function Ie(e,t){return{type:Oe,chartId:e,column:t}}const Ce="SET_FULL_SIZE_CHART_ID";function De(e){return{type:Ce,chartId:e}}const Ne="SET_MAX_UNDO_HISTORY_EXCEEDED";function we(e=!0){return{type:Ne,payload:{maxUndoHistoryExceeded:e}}}function Le(){return(e,t)=>{const{dashboardLayout:r}=t(),n=r.past.length;return e((0,E.Dz)((0,i.t)("You have used all %(historyLength)s undo slots and will not be able to fully undo subsequent actions. You may save your current state to reset the history.",{historyLength:n})))}}const qe="SET_DATASETS_STATUS";function xe(e){return{type:qe,status:e}}},4305:(e,t,r)=>{"use strict";r.d(t,{$:()=>b,Y:()=>S});var n=r(93185),a=r(37863),o=r(37927),s=r(39759),i=r(35854),l=r(43399),c=r(12617),d=r(22318),u=r(52838),p=r(80621),m=r(81255),_=r(56967),h=r(28428),f=r(27600),E=r(23525),y=r(42190),g=r(70400),T=r(41295),v=r(37418),R=r(52004);const b="HYDRATE_DASHBOARD",S=({history:e,dashboard:t,charts:r,dataMask:S,activeTabs:A})=>(O,I)=>{const{user:C,common:D,dashboardState:N}=I(),{metadata:w,position_data:L}=t,q=(0,g.Z)("regular"),x="true"===(0,g.Z)("reserved").edit;r.forEach((e=>{e.slice_id=e.form_data.slice_id})),null!=w&&w.shared_label_colors&&(0,T.fO)(w,null==w?void 0:w.shared_label_colors),null!=w&&w.label_colors&&(0,T.fO)(w,null==w?void 0:w.label_colors);const U=L&&Object.keys(L).length>0?L:{[p.Zn]:"v2",[p._4]:{type:m.U0,id:p._4,children:[p.PV]},[p.PV]:{type:m.BG,id:p.PV,children:[],parents:[p._4]}},Z={};Object.values(U).forEach((e=>{e.type===m.dW&&(Z[e.meta.chartId]=e.id)}));const P=function(e={}){let t=e[p._4];return t=t&&t.children.length&&e[t.children[0]].type===m.yR?e[e[t.children[0]].children[0]]:e[t.children[0]],t.id}(U),M=U[P];let F,k=0;const Q={},$={},Y={},B=new Set,H=new Map;r.forEach((e=>{const t=e.slice_id,r={...e.form_data,url_params:{...e.form_data.url_params,...q}};if(Q[t]={...a.u,id:t,form_data:(0,i.oN)(r)},Y[t]={slice_id:t,slice_url:e.slice_url,slice_name:e.slice_name,form_data:e.form_data,viz_type:e.form_data.viz_type,datasource:e.form_data.datasource,description:e.description,description_markeddown:e.description_markeddown,owners:e.owners,modified:e.modified,changed_on:new Date(e.changed_on).getTime()},B.add(t),!Z[t]&&U[P]){var n;(0===k||k+p.fw>p.cz)&&(F=(0,h.Z)(m.Os,(M.parents||[]).slice()),U[F.id]=F,M.children.push(F.id),k=0);const t=(0,h.Z)(m.dW,{chartId:e.slice_id},(F.parents||[]).slice()),r=(null!=(n=H.get(e.slice_id))?n:0)+1;t.id=`${m.dW}-explore-${e.slice_id}-${r}`,H.set(e.slice_id,r),U[t.id]=t,F.children.push(t.id),Z[t.meta.chartId]=t.id,k+=p.fw}const o=Z[t];o&&U[o]&&(U[o].meta.sliceName=e.slice_name)})),Object.values(U).some((e=>e.id!==p._4&&!e.parents))&&(0,v.Z)({currentComponent:U[p._4],layout:U}),(0,l.DU)({dashboardFilters:$,components:U}),U[p.M2]={id:p.M2,type:m.Vl,meta:{text:t.dashboard_title}};const j={past:[],present:U,future:[]},V=(0,E.eY)(f.KD.dashboardFocusedChart);let G;if(V){const t=Object.values(j.present).find((e=>{var t;return(null==(t=e.meta)?void 0:t.chartId)===V}));G=null==t?void 0:t.id;const r=new URLSearchParams(window.location.search);r.delete(f.KD.dashboardFocusedChart.name),e.replace({search:r.toString()})}const z=G||(0,_.Z)();let W=N.directPathToChild||[];U[z]&&(W=(U[z].parents||[]).slice(),W.push(z));const K=(0,s.a)({filterConfig:(null==w?void 0:w.native_filter_configuration)||[]});if((0,n.cr)(n.TT.DashboardCrossFilters)){const{chartConfiguration:e,globalChartConfiguration:t}=(0,u.g)(j.present,w,Q);w.chart_configuration=e,w.global_chart_configuration=t}const{roles:J}=C,X=(0,d.Ms)(t,C),ee=(0,u.U)(w.cross_filters_enabled);return O({type:b,data:{sliceEntities:{...o.b,slices:Y,isLoading:!1},charts:Q,dashboardInfo:{...t,metadata:w,userId:C.userId?String(C.userId):null,dash_edit_perm:X,dash_save_perm:(0,d.Xg)(t,C),dash_share_perm:(0,c.R)("can_share_dashboard","Superset",J),superset_can_explore:(0,c.R)("can_explore","Superset",J),superset_can_share:(0,c.R)("can_share_chart","Superset",J),superset_can_csv:(0,c.R)("can_csv","Superset",J),common:{flash_messages:null==D?void 0:D.flash_messages,conf:null==D?void 0:D.conf},filterBarOrientation:(0,n.cr)(n.TT.HorizontalFilterBar)&&w.filter_bar_orientation||R.Bp.Vertical,crossFiltersEnabled:ee},dataMask:S,dashboardFilters:$,nativeFilters:K,dashboardState:{preselectNativeFilters:(0,E.eY)(f.KD.nativeFilters),sliceIds:Array.from(B),directPathToChild:W,directPathLastUpdated:Date.now(),focusedFilterField:null,expandedSlices:(null==w?void 0:w.expanded_slices)||{},refreshFrequency:(null==w?void 0:w.refresh_frequency)||0,shouldPersistRefreshFrequency:!1,css:t.css||"",colorNamespace:(null==w?void 0:w.color_namespace)||null,colorScheme:(null==w?void 0:w.color_scheme)||null,editMode:X&&x,isPublished:t.published,hasUnsavedChanges:!1,dashboardIsSaving:!1,maxUndoHistoryExceeded:!1,lastModifiedTime:t.changed_on,isRefreshing:!1,isFiltersRefreshing:!1,activeTabs:A||(null==N?void 0:N.activeTabs)||[],datasetsStatus:y.ni.Loading},dashboardLayout:j}})}},39023:(e,t,r)=>{"use strict";r.d(t,{GI:()=>l,ZP:()=>d});var n=r(81395),a=r(4305),o=r(80621),s=r(43399),i=r(20194);const l={scope:[o._4],immune:[]},c=[n.oW];function d(e={},t){const r={[n.oW](e){const{newSelectedValues:r,merge:n}=t,a=Object.keys(r).reduce(((e,t)=>n&&t in e?{...e,[t]:[...e[t],...r[t]]}:{...e,[t]:r[t]}),{...e.columns});return{...e,columns:a}},[n.oT](e){const{path:r}=t;return{...e,directPathToFilter:r}}};if(t.type===n.ib)return(0,s.DU)({dashboardFilters:e,components:t.components}),e;if(t.type===n.cK){const r=t.scopes,n=Object.entries(r).reduce(((e,t)=>{const[r,{scope:n,immune:a}]=t,{chartId:o,column:s}=(0,i._)(r),l={...e[o].scopes,[s]:{scope:n,immune:a}};return{...e,[o]:{...e[o],scopes:l}}}),e);return(0,s.DU)({dashboardFilters:n}),n}if(t.type===a.$)return t.data.dashboardFilters;if(t.type in r){const n={...e,[t.chartId]:r[t.type](e[t.chartId])};return c.includes(t.type)&&(0,s.DU)({dashboardFilters:n}),n}return e}},37927:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i,b:()=>s});var n=r(61988),a=r(38523),o=r(4305);const s={slices:{},isLoading:!0,errorMessage:null,lastUpdated:0};function i(e=s,t){const r={[o.$]:()=>({...t.data.sliceEntities}),[a.D2]:()=>({...e,isLoading:!0}),[a.JV]:()=>({...e,isLoading:!1,slices:{...e.slices,...t.payload.slices},lastUpdated:(new Date).getTime()}),[a.EO]:()=>({isLoading:!1,slices:{...t.payload.slices},lastUpdated:(new Date).getTime()}),[a.cK]:()=>({...e,isLoading:!1,lastUpdated:(new Date).getTime(),errorMessage:t.payload.error||(0,n.t)("Could not fetch all saved charts")})};return t.type in r?r[t.type]():e}},43399:(e,t,r)=>{"use strict";r.d(t,{DU:()=>T,De:()=>E,Q1:()=>g,_f:()=>y});var n=r(58809),a=r.n(n),o=r(8816),s=r.n(o),i=r(83927),l=r.n(i),c=r(41609),d=r.n(c),u=r(20194),p=r(81255),m=r(39023);let _={},h={},f={};function E(){return _}function y(e,t){if(!(e in h)){const r=Object.entries(t||_).filter((([,{scope:t}])=>t.includes(e)));h[e]=s()(a()((([e])=>(0,u._)(e).column)),l()((([,{values:e}])=>e)))(r)}return h[e]}function g({filterScope:e}){function t(e=[],r={},n=[]){r&&(r.type===p.dW&&r.meta&&r.meta.chartId&&!n.includes(r.meta.chartId)?e.push(r.meta.chartId):r.children&&r.children.forEach((r=>t(e,f[r],n))))}const r=[],{scope:n,immune:a}=e||m.GI;return n.forEach((e=>t(r,f[e],a))),r}function T({dashboardFilters:e={},components:t={}}){d()(t)||(f=t),h={},_=Object.values(e).reduce(((e,t)=>{const{chartId:r,columns:n,scopes:a}=t,o={};return Object.keys(n).forEach((e=>{if(Array.isArray(n[e])?n[e].length:void 0!==n[e]){const t=g({filterScope:a[e]}).filter((e=>r!==e));o[(0,u.w)({chartId:r,column:e})]={values:n[e],scope:t}}})),{...e,...o}}),{})}},47456:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(80621),a=r(95173),o=r(72673),s=r(28428);function i({dropResult:e,layout:t}){const{source:r,destination:i,dragging:l}=e,c=r.id===n.D0?(0,s.Z)(l.type):t[l.id]||{};if(r.id===i.id)return c.meta.width;const{width:d,minimumWidth:u}=(0,o.Z)({component:c,components:t}),{width:p,occupiedWidth:m}=(0,o.Z)({id:i.id,components:t});let _=Number(p-m);if(Number.isNaN(_)){const{width:e,occupiedWidth:r}=(0,o.Z)({id:(0,a.Z)({childId:i.id,layout:t}),components:t});_=Number(e-r)}return Number.isNaN(_)||Number.isNaN(Number(d))||_>=d?d:_>=u?_:-1}},72673:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(95173),a=r(80621),o=r(81255);function s({id:e,components:t}){const r=t[e];if(!r)return 0;let n=0;return(r.children||[]).forEach((e=>{const r=t[e]||{};n+=(r.meta||{}).width||0})),n}function i({id:e,component:t,components:r={}}){const l={width:void 0,occupiedWidth:void 0,minimumWidth:void 0},c=t||r[e];return c?(l.width=(c.meta||{}).width,l.occupiedWidth=l.width,c.type===o.Os?(l.width=i({id:(0,n.Z)({childId:c.id,layout:r}),components:r}).width||a.cz,l.occupiedWidth=s({id:c.id,components:r}),l.minimumWidth=l.occupiedWidth||a.cx):c.type===o.BA?(l.minimumWidth=a.cx,l.occupiedWidth=0,(c.children||[]).forEach((e=>{r[e].type===o.Os&&(l.minimumWidth=Math.max(l.minimumWidth,s({id:e,components:r})))}))):c.type!==o.t&&c.type!==o.xh&&c.type!==o.dW||(l.minimumWidth=a.cx),l):l}},28428:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(14670),a=r.n(n),o=r(61988),s=r(81255),i=r(80621);const l={[s.dW]:{width:i.fw,height:50},[s.BA]:{width:i.fw,background:i.HE},[s.hE]:null,[s.Nc]:{text:(0,o.t)("New header"),headerSize:i.OE,background:i.HE},[s.xh]:{width:i.fw,height:50},[s.Os]:{background:i.HE},[s.yR]:null,[s.gn]:{text:"",defaultText:(0,o.t)("Tab title"),placeholder:(0,o.t)("Tab title")},[s.t]:{width:i.cz,background:i.HE}};function c(e){return`${e}-${a().generate()}`}function d(e,t,r=[]){return{type:e,id:c(e),children:[],parents:r,meta:{...l[e],...t}}}},11370:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(20194);function a(e){return Object.entries(e).reduce(((e,t)=>{const[r,{values:a}]=t,{chartId:o,column:s}=(0,n._)(r),i={...e[o],[s]:a};return{...e,[o]:i}}),{})}},37418:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(68492);function a({currentComponent:e,layout:t={}}){if(e&&t)if(t[e.id]){const r=Array.isArray(e.parents)?e.parents.slice():[];r.push(e.id),Array.isArray(e.children)&&e.children.forEach((e=>{t[e]?(t[e]={...t[e],parents:r},a({currentComponent:t[e],layout:t})):n.Z.warn(`The current layout does not contain a component with the id: ${e}.  Skipping this component`)}))}else n.Z.warn(`The current layout does not contain a component with the id: ${null==e?void 0:e.id}.  Skipping this component`)}},19485:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FETCH_DASHBOARDS_FAILED:()=>h,FETCH_DASHBOARDS_SUCCEEDED:()=>m,SAVE_SLICE_FAILED:()=>g,SAVE_SLICE_SUCCESS:()=>v,SET_SAVE_CHART_MODAL_VISIBILITY:()=>E,createDashboard:()=>I,createSlice:()=>O,fetchDashboardsFailed:()=>f,fetchDashboardsSucceeded:()=>_,getSliceDashboards:()=>C,getSlicePayload:()=>b,saveSliceFailed:()=>T,saveSliceSuccess:()=>R,setSaveChartModalVisibility:()=>y,updateSlice:()=>A});var n=r(41609),a=r.n(n),o=r(15926),s=r.n(o),i=r(61988),l=r(31069),c=r(72570),d=r(12515),u=r(69856);const p=/^adhoc_filters/,m="FETCH_DASHBOARDS_SUCCEEDED";function _(e){return{type:m,choices:e}}const h="FETCH_DASHBOARDS_FAILED";function f(e){return{type:h,userId:e}}const E="SET_SAVE_CHART_MODAL_VISIBILITY";function y(e){return{type:E,isVisible:e}}const g="SAVE_SLICE_FAILED";function T(){return{type:g}}const v="SAVE_SLICE_SUCCESS";function R(e){return{type:v,data:e}}const b=(e,t,r,n,o={})=>{const s=(i=t,Object.entries(i).reduce(((e,[t,r])=>p.test(t)?{...e,[t]:null==r?void 0:r.filter((e=>!e.isExtra))}:e),{}));var i,l;a()(o)||Object.keys(s||{}).forEach((e=>{var t;a()(s[e])&&(null==o||null==(t=o[e])||t.forEach((t=>{t.operator!==u.d.TemporalRange||t.isExtra||s[e].push({...t,comparator:"No filter"})})))})),(e=>((null==e?void 0:e.adhoc_filters)||[]).some((e=>e.operator===u.d.TemporalRange)))(s)||null==t||null==(l=t.adhoc_filters)||l.forEach((e=>{e.operator===u.d.TemporalRange&&e.isExtra&&s.adhoc_filters.push({...e,comparator:"No filter"})}));const c={...t,...s,dashboards:r},[m,_]=c.datasource.split("__");return{params:JSON.stringify(c),slice_name:e,viz_type:c.viz_type,datasource_id:parseInt(m,10),datasource_type:_,dashboards:r,owners:n,query_context:JSON.stringify((0,d.u)({formData:c,force:!1,resultFormat:"json",resultType:"full",setDataMask:null,ownState:null}))}},S=(e,t,r)=>{const n=[];return e?n.push((0,c.ws)((0,i.t)("Chart [%s] has been saved",t))):n.push((0,c.ws)((0,i.t)("Chart [%s] has been overwritten",t))),r&&(r.new?n.push((0,c.ws)((0,i.t)("Dashboard [%s] just got created and chart [%s] was added to it",r.title,t))):n.push((0,c.ws)((0,i.t)("Chart [%s] was added to dashboard [%s]",t,r.title)))),n},A=(e,t,r,n)=>async(a,o)=>{const{slice_id:s,owners:i,form_data:c}=e,{explore:{form_data:{url_params:d,...u}}}=o();try{const e=await l.Z.put({endpoint:`/api/v1/chart/${s}`,jsonPayload:b(t,u,r,i,c)});return a(R()),S(!1,t,n).map(a),e.json}catch(e){throw a(T()),e}},O=(e,t,r)=>async(n,a)=>{const{explore:{form_data:{url_params:o,...s}}}=a();try{const a=await l.Z.post({endpoint:"/api/v1/chart/",jsonPayload:b(e,s,t)});return n(R()),S(!0,e,r).map(n),a.json}catch(e){throw n(T()),e}},I=e=>async t=>{try{return(await l.Z.post({endpoint:"/api/v1/dashboard/",jsonPayload:{dashboard_title:e}})).json}catch(e){throw t(T()),e}},C=e=>async t=>{try{return(await l.Z.get({endpoint:`/api/v1/chart/${e.slice_id}?q=${s().encode({columns:["dashboards.id"]})}`})).json.result.dashboards.map((({id:e})=>e))}catch(e){throw t(T()),e}}},92252:(e,t,r)=>{"use strict";r.d(t,{ai:()=>g}),r(67294);var n=r(81545),a=r(45511),o=r(61988),s=r(95826),i=r(75294),l=r(12515),c=r(69856),d=r(99963),u=r(11965);const p=(0,n.Z)(),m=(0,a.Z)(),_=[["SMART_NUMBER",(0,o.t)("Adaptive formatting")],["~g",(0,o.t)("Original value")],[",d",",d (12345.432 => 12,345)"],[".1s",".1s (12345.432 => 10k)"],[".3s",".3s (12345.432 => 12.3k)"],[",.1%",",.1% (12345.432 => 1,234,543.2%)"],[".3%",".3% (12345.432 => 1234543.200%)"],[".4r",".4r (12345.432 => 12350)"],[",.3f",",.3f (12345.432 => 12,345.432)"],["+,","+, (12345.432 => +12,345.432)"],["$,.2f","$,.2f (12345.432 => $12,345.43)"],["DURATION",(0,o.t)("Duration in ms (66000 => 1m 6s)")],["DURATION_SUB",(0,o.t)("Duration in ms (100.40008 => 100ms 400µs 80ns)")]],h=((0,o.t)("Adaptive formatting"),{verbose_name:"Time",column_name:"__timestamp",description:(0,o.t)("A reference to the [Time] configuration, taking granularity into account")}),f={type:"SelectControl",multi:!0,freeForm:!0,label:(0,o.t)("Dimensions"),default:[],includeTime:!1,description:(0,o.t)("One or many columns to group by. High cardinality groupings should include a series limit to limit the number of fetched and rendered series."),optionRenderer:e=>(0,u.tZ)(d.l,{column:e,showType:!0}),valueKey:"column_name",filterOption:({data:e},t)=>e.column_name&&e.column_name.toLowerCase().indexOf(t.toLowerCase())>=0||e.verbose_name&&e.verbose_name.toLowerCase().indexOf(t.toLowerCase())>=0,mapStateToProps:(e,t)=>{const r={};return e.datasource&&(r.options=e.datasource.columns.filter((e=>e.groupby)),t&&t.includeTime&&r.options.push(h)),r}},E={type:"MetricsControl",multi:!0,label:(0,o.t)("Metrics"),validators:[s.Z],mapStateToProps:e=>{const{datasource:t}=e;return{columns:t?t.columns:[],savedMetrics:t?t.metrics:[],datasource:t}},description:(0,o.t)("One or many metrics to display")},y={...E,multi:!1,label:(0,o.t)("Metric"),description:(0,o.t)("Metric")},g={metrics:E,metric:y,datasource:{type:"DatasourceControl",label:(0,o.t)("Dataset"),default:null,description:null,mapStateToProps:({datasource:e})=>({datasource:e,isEditable:!!e})},viz_type:{type:"VizTypeControl",default:"table",description:(0,o.t)("The type of visualization to display")},color_picker:{label:(0,o.t)("Fixed color"),description:(0,o.t)("Use this to define a static color for all circles"),type:"ColorPickerControl",default:{r:0,g:122,b:135,a:1},renderTrigger:!0},metric_2:{...y,label:(0,o.t)("Right axis metric"),clearable:!0,description:(0,o.t)("Choose a metric for right axis")},linear_color_scheme:{type:"ColorSchemeControl",label:(0,o.t)("Linear color scheme"),choices:()=>m.values().map((e=>[e.id,e.label])),default:m.getDefaultKey(),clearable:!1,description:"",renderTrigger:!0,schemes:()=>m.getMap(),isLinear:!0},secondary_metric:{...y,label:(0,o.t)("Color metric"),default:null,validators:[],description:(0,o.t)("A metric to use for color")},groupby:f,columns:{...f,label:(0,o.t)("Columns"),description:(0,o.t)("One or many controls to pivot as columns")},granularity:{type:"SelectControl",freeForm:!0,label:c.m_.granularity,default:"P1D",choices:[[null,(0,o.t)("all")],["PT5S",(0,o.t)("5 seconds")],["PT30S",(0,o.t)("30 seconds")],["PT1M",(0,o.t)("1 minute")],["PT5M",(0,o.t)("5 minutes")],["PT30M",(0,o.t)("30 minutes")],["PT1H",(0,o.t)("1 hour")],["PT6H",(0,o.t)("6 hour")],["P1D",(0,o.t)("1 day")],["P7D",(0,o.t)("7 days")],["P1W",(0,o.t)("week")],["week_starting_sunday",(0,o.t)("week starting Sunday")],["week_ending_saturday",(0,o.t)("week ending Saturday")],["P1M",(0,o.t)("month")],["P3M",(0,o.t)("quarter")],["P1Y",(0,o.t)("year")]],description:(0,o.t)("The time granularity for the visualization. Note that you can type and use simple natural language as in `10 seconds`,`1 day` or `56 weeks`")},granularity_sqla:{type:"SelectControl",label:c.m_.granularity_sqla,description:(0,o.t)("The time column for the visualization. Note that you can define arbitrary expression that return a DATETIME column in the table. Also note that the filter below is applied against this column or expression"),clearable:!1,optionRenderer:e=>(0,u.tZ)(d.l,{column:e,showType:!0}),valueKey:"column_name",mapStateToProps:e=>{const t={};return e.datasource&&(t.choices=e.datasource.granularity_sqla,t.default=null,e.datasource.main_dttm_col?t.default=e.datasource.main_dttm_col:t.choices&&t.choices.length>0&&(t.default=t.choices[0].column_name)),t}},time_grain_sqla:{type:"SelectControl",label:c.m_.time_grain_sqla,default:"P1D",description:(0,o.t)("The time granularity for the visualization. This applies a date transformation to alter your time column and defines a new time granularity. The options here are defined on a per database engine basis in the Superset source code."),mapStateToProps:e=>({choices:e.datasource?e.datasource.time_grain_sqla:null})},time_range:{type:"DateFilterControl",freeForm:!0,label:c.m_.time_range,default:(0,o.t)("No filter"),description:(0,o.t)('The time range for the visualization. All relative times, e.g. "Last month", "Last 7 days", "now", etc. are evaluated on the server using the server\'s local time (sans timezone). All tooltips and placeholder times are expressed in UTC (sans timezone). The timestamps are then evaluated by the database using the engine\'s local timezone. Note one can explicitly set the timezone per the ISO 8601 format if specifying either the start and/or end time.')},row_limit:{type:"SelectControl",freeForm:!0,label:(0,o.t)("Row limit"),validators:[i.Z],default:1e4,choices:(0,l.mG)([10,50,100,250,500,1e3,5e3,1e4,5e4]),description:(0,o.t)("Limits the number of rows that get displayed.")},limit:{type:"SelectControl",freeForm:!0,label:(0,o.t)("Series limit"),validators:[i.Z],choices:(0,l.mG)([5,10,25,50,100,500]),clearable:!0,description:(0,o.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},timeseries_limit_metric:{type:"MetricsControl",label:(0,o.t)("Sort by"),default:null,clearable:!0,description:(0,o.t)("Metric used to define how the top series are sorted if a series or row limit is present. If undefined reverts to the first metric (where appropriate)."),mapStateToProps:e=>({columns:e.datasource?e.datasource.columns:[],savedMetrics:e.datasource?e.datasource.metrics:[],datasource:e.datasource})},series:{...f,label:(0,o.t)("Dimensions"),multi:!1,default:null,description:(0,o.t)("Defines the grouping of entities. Each series is shown as a specific color on the chart and has a legend toggle")},entity:{...f,label:(0,o.t)("Entity"),default:null,multi:!1,validators:[s.Z],description:(0,o.t)("This defines the element to be plotted on the chart")},x:{...y,label:(0,o.t)("X Axis"),description:(0,o.t)("Metric assigned to the [X] axis"),default:null},y:{...y,label:(0,o.t)("Y Axis"),default:null,description:(0,o.t)("Metric assigned to the [Y] axis")},size:{...y,label:(0,o.t)("Bubble size"),default:null},y_axis_format:{type:"SelectControl",freeForm:!0,label:(0,o.t)("Y Axis Format"),renderTrigger:!0,default:"SMART_NUMBER",choices:_,description:"D3 format syntax: https://github.com/d3/d3-format",mapStateToProps:e=>{const t=e.controls&&e.controls.comparison_type&&"percentage"===e.controls.comparison_type.value;return{warning:t?(0,o.t)('When `Calculation type` is set to "Percentage change", the Y Axis Format is forced to `.1%`'):null,disabled:t}}},adhoc_filters:{type:"AdhocFilterControl",label:(0,o.t)("Filters"),default:null,description:"",mapStateToProps:e=>({columns:e.datasource?e.datasource.columns.filter((e=>e.filterable)):[],savedMetrics:e.datasource?e.datasource.metrics:[],datasource:e.datasource})},color_scheme:{type:"ColorSchemeControl",label:(0,o.t)("Color scheme"),default:p.getDefaultKey(),renderTrigger:!0,choices:()=>p.keys().map((e=>[e,e])),description:(0,o.t)("The color scheme for rendering chart"),schemes:()=>p.getMap()}}},12515:(e,t,r)=>{"use strict";r.d(t,{AH:()=>D,CB:()=>w,H6:()=>S,Jp:()=>E,bX:()=>N,hz:()=>A,kN:()=>b,mG:()=>L,pd:()=>I,pe:()=>C,u:()=>O,xW:()=>T,y8:()=>R});var n=r(67294),a=r(54998),o=r.n(a),s=r(11064),i=r(19427),l=r(61654),c=r(31069),d=r(55786),u=r(86374),p=r(9679),m=r(54076),_=r(27600),h=r(69856),f=r(80621);function E(e){var t,r;const{slice:n,form_data:a}=e;return null!=(t=null!=(r=null==n?void 0:n.slice_id)?r:null==a?void 0:a.slice_id)?t:h.xA}let y=0;function g(e=!1){let t=0;return e&&(t=y%u.X.length,y+=1,0===t&&(t+=1,y+=1)),u.X[t]}function T(e,t){return null==e?null:o()(window.location.search).pathname("/api/v1/chart/data").search({form_data:(0,p.o)({slice_id:e}),force:t}).toString()}function v(e="base"){return["full","json","csv","query","results","samples"].includes(e)?"/superset/explore_json/":"/explore/"}function R(e,t={},r=!1){const n=new(o())("/"),a=v(e),s=n.search(!0);return Object.keys(t).forEach((e=>{s[e]=t[e]})),e===_.KD.standalone.name&&(r&&(s.force="1"),s.standalone=f._B.HideNav),n.directory(a).search(s).toString()}function b({path:e,qs:t,allowDomainSharding:r=!1}){let n=new(o())({protocol:window.location.protocol.slice(0,-1),hostname:g(r),port:window.location.port?window.location.port:"",path:e});return t&&(n=n.search(t)),n}function S({formData:e,endpointType:t="base",force:r=!1,curUrl:n=null,requestParams:a={},allowDomainSharding:s=!1,method:i="POST"}){if(!e.datasource)return null;delete e.label_colors;let l=b({path:"/",allowDomainSharding:s});n&&(l=o()(o()(n).search()));const c=v(t),d=l.search(!0),{slice_id:u,extra_filters:m,adhoc_filters:h,viz_type:f}=e;if(u){const e={slice_id:u};"GET"===i&&(e.viz_type=f,m&&m.length&&(e.extra_filters=m),h&&h.length&&(e.adhoc_filters=h)),d.form_data=(0,p.o)(e)}r&&(d.force="true"),"csv"===t&&(d.csv="true"),t===_.KD.standalone.name&&(d.standalone="1"),"query"===t&&(d.query="true"),"results"===t&&(d.results="true"),"samples"===t&&(d.samples="true");const E=Object.keys(a);return E.length&&E.forEach((e=>{a.hasOwnProperty(e)&&(d[e]=a[e])})),l.search(d).directory(c).toString()}const A=e=>{var t,r;const n=(0,s.Z)().get(e.viz_type);return[null!=(t=null==n?void 0:n.useLegacyApi)&&t,null!=(r=null==n?void 0:n.parseMethod)?r:"json-bigint"]},O=({formData:e,force:t,resultFormat:r,resultType:n,setDataMask:a,ownState:o})=>{var s;return(null!=(s=(0,i.Z)().get(e.viz_type))?s:e=>(0,l.Z)(e,(e=>[{...e}])))({...e,force:t,result_format:r,result_type:n},{ownState:o,hooks:{setDataMask:a}})},I=({resultType:e,resultFormat:t})=>"csv"===t?t:e,C=({formData:e,resultFormat:t="json",resultType:r="full",force:n=!1,ownState:a={}})=>{let o,s;const[i,l]=A(e);i?(o=S({formData:e,endpointType:I({resultFormat:t,resultType:r}),allowDomainSharding:!1}),s=e):(o="/api/v1/chart/data",s=O({formData:e,force:n,resultFormat:t,resultType:r,ownState:a,parseMethod:l})),c.Z.postForm(o,{form_data:(0,p.o)(s)})},D=(e,t)=>{const r=S({formData:e,endpointType:"base",allowDomainSharding:!1,requestParams:t});c.Z.postForm(r,{form_data:(0,p.o)(e)})},N=(e,t,r)=>{const a=(0,n.useCallback)(e,r);(0,n.useEffect)((()=>{const e=setTimeout((()=>{a()}),t);return()=>{clearTimeout(e)}}),[a,t])},w=(e,t,r)=>{var n;const a=[...h.qK].map((e=>h.LT[e].operation)).indexOf(t)>=0;let o="object"==typeof e?null!=(n=null==e?void 0:e.column_name)?n:"":null!=e?e:"";if(e&&t){o+=` ${t}`;const e=a&&Array.isArray(r)?r[0]:r,n=(0,d.Z)(r),s=void 0!==e&&Number.isNaN(Number(e)),i=s?"'":"",[l,c]=a?["(",")"]:["",""],u=n.map((e=>(0,m.lo)(e))).map((e=>`${i}${s?String(e).replace("'","''"):e}${i}`));n.length>0&&(o+=` ${l}${u.join(", ")}${c}`)}return o};function L(e){return e.map((e=>[e,e.toString()]))}},35854:(e,t,r)=>{"use strict";r.d(t,{R3:()=>s,oN:()=>i});var n=r(37687),a=r(10331),o=r(92252);function s(e,t){var r;const o={...t},s=o.viz_type||(null==(r=e.common)?void 0:r.conf.DEFAULT_VIZ_TYPE)||"table";!function(e){e.y_axis_zero&&(e.y_axis_bounds=[0,null])}(o);const i=(0,a.mi)(s,e.datasource.type,e,o),l=(0,n.Z)().get(s)||{};return l.onInit?l.onInit(i):i}function i(e){const t=e.datasource.split("__")[1],r=e.viz_type,n=(0,a.mi)(r,t,null,e),o=(0,a.Hu)(n),s={};return Object.keys(n).concat(Object.keys(e)).forEach((t=>{void 0===e[t]?s[t]=o[t]:s[t]=e[t]})),s}const l={...o.ai};Object.keys(o.ai).forEach((e=>{l[e].value=o.ai[e].default})),(0,a.Hu)(l)},39666:(e,t,r)=>{"use strict";r.d(t,{Aw:()=>u,Dr:()=>h,J8:()=>m,M:()=>E,MZ:()=>g,Me:()=>f,_M:()=>y,cq:()=>_,jt:()=>d});var n=r(41609),a=r.n(n),o=r(31069),s=r(61988),i=r(15926),l=r.n(i),c=r(72570);const d="SET_REPORT";function u({userId:e,filterField:t,creationMethod:r,resourceId:n}){const a=l().encode({filters:[{col:t,opr:"eq",value:n},{col:"creation_method",opr:"eq",value:r},{col:"created_by",opr:"rel_o_m",value:e}]});return function(e){return o.Z.get({endpoint:`/api/v1/report/?q=${a}`}).then((({json:a})=>{e(function(e,t,r,n){return{type:d,report:e,resourceId:t,creationMethod:r,filterField:n}}(a,n,r,t))})).catch((()=>e((0,c.Gb)((0,s.t)("There was an issue fetching reports attached to this dashboard.")))))}}const p=(e,t)=>{const r=t(),{user:n,dashboardInfo:o,charts:s,explore:i}=r;if(a()(o)){var l;const[t]=Object.keys(s);e(u({userId:(null==(l=i.user)?void 0:l.userId)||(null==n?void 0:n.userId),filterField:"chart_id",creationMethod:"charts",resourceId:s[t].id}))}else e(u({userId:n.userId,filterField:"dashboard_id",creationMethod:"dashboards",resourceId:o.id}))},m="ADD_REPORT",_=e=>t=>o.Z.post({endpoint:"/api/v1/report/",jsonPayload:e}).then((({json:e})=>{t({type:m,json:e}),t((0,c.ws)((0,s.t)("The report has been created")))})),h="EDIT_REPORT",f=(e,t)=>r=>o.Z.put({endpoint:`/api/v1/report/${e}`,jsonPayload:t}).then((({json:e})=>{r({type:h,json:e}),r((0,c.ws)((0,s.t)("Report updated")))}));function E(e,t){return function(r){return o.Z.put({endpoint:encodeURI(`/api/v1/report/${e.id}`),headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t})}).catch((()=>{r((0,c.Gb)((0,s.t)("We were unable to active or deactivate this report.")))})).finally((()=>{r(p)}))}}const y="DELETE_REPORT";function g(e){return function(t){return o.Z.delete({endpoint:encodeURI(`/api/v1/report/${e.id}`)}).catch((()=>{t((0,c.Gb)((0,s.t)("Your report could not be deleted")))})).finally((()=>{t({type:y,report:e}),t((0,c.ws)((0,s.t)("Deleted: %s",e.name)))}))}}},54076:(e,t,r)=>{"use strict";r.d(t,{EI:()=>E,G6:()=>g,G9:()=>p,Mv:()=>h,Tb:()=>c,cD:()=>f,fV:()=>y,jy:()=>d,li:()=>l,lo:()=>m});var n=r(51115),a=r(42846),o=r(31069),s=r(55786);const i="<empty string>",l="<NULL>",c="TRUE",d="FALSE",u=(0,n.bt)(a.default.DATABASE_DATETIME);function p(e){return o.Z.post({endpoint:"/kv/store/",postPayload:{data:e}}).then((e=>`${window.location.origin+window.location.pathname}?id=${e.json.id}`))}function m(e){return null===e?l:""===e?i:!0===e?c:!1===e?d:"string"!=typeof e&&e.toString?e.toString():e}function _(e){return e.name||e}function h(e,t){let r=t.length?`${t.map(_).join("\t")}\n`:"";for(let n=0;n<e.length;n+=1){const a={};for(let r=0;r<t.length;r+=1){const o=_(t[r]);o in e[n]?a[r]=e[n][o]:a[r]=e[n][parseFloat(o)]}r+=`${Object.values(a).join("\t")}\n`}return r}function f(e,t){return e&&0!==e.length&&0!==(0,s.Z)(t).length?e.map((e=>({...e,...t.reduce(((t,r)=>(null!==e[r]&&void 0!==e[r]&&(t[r]=u(e[r])),t)),{})}))):e}const E=()=>{},y=()=>{const{appVersion:e}=navigator;return e.includes("Win")?"Windows":e.includes("Mac")?"MacOS":e.includes("X11")?"UNIX":e.includes("Linux")?"Linux":"Unknown OS"},g=()=>{const{userAgent:e}=navigator;return e&&/^((?!chrome|android).)*safari/i.test(e)}},44814:(e,t,r)=>{"use strict";r.d(t,{zO:()=>s,zQ:()=>o});var n=r(30381),a=r.n(n);const o=function(e,t,r="HH:mm:ss.SS"){const n=t-e;return a()(new Date(n)).utc().format(r)},s=function(){return a()().utc().valueOf()}},86374:(e,t,r)=>{"use strict";r.d(t,{X:()=>o,_:()=>s});var n=r(93185),a=r(20292);const o=function(){var e,t;if(!document.getElementById("app"))return[];const r=new Set([window.location.hostname]);if("1"===new URLSearchParams(window.location.search).get("disableDomainSharding"))return Array.from(r);const o=(0,a.Z)();return(0,n.fG)(o.common.feature_flags),null!=o&&null!=(e=o.common)&&null!=(t=e.conf)&&t.SUPERSET_WEBSERVER_DOMAINS&&o.common.conf.SUPERSET_WEBSERVER_DOMAINS.forEach((e=>{r.add(e)})),Array.from(r)}(),s=o.length>1},61819:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(21804),a=r.n(n),o=(r(67294),r(51995)),s=r(61988),i=r(51776),l=r(11965);const c=o.iK.div`
  margin-bottom: ${({theme:e})=>2*e.gridUnit}px;
`,d=function({certifiedBy:e,details:t,metricName:r}){const n=(0,o.Fg)();return(0,l.tZ)(i.Z,{id:`${a()(r)}-tooltip`,title:(0,l.tZ)("div",null,e&&(0,l.tZ)(c,null,(0,s.t)("Certified by %s",e)),(0,l.tZ)("div",null,t))},(0,l.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",enableBackground:"new 0 0 24 24",height:"14",viewBox:"0 0 24 24",width:"14"},(0,l.tZ)("g",null,(0,l.tZ)("path",{fill:n.colors.primary.base,d:"M23,12l-2.44-2.79l0.34-3.69l-3.61-0.82L15.4,1.5L12,2.96L8.6,1.5L6.71,4.69L3.1,5.5L3.44,9.2L1,12l2.44,2.79l-0.34,3.7 l3.61,0.82L8.6,22.5l3.4-1.47l3.4,1.46l1.89-3.19l3.61-0.82l-0.34-3.69L23,12z M9.38,16.01L7,13.61c-0.39-0.39-0.39-1.02,0-1.41 l0.07-0.07c0.39-0.39,1.03-0.39,1.42,0l1.61,1.62l5.15-5.16c0.39-0.39,1.03-0.39,1.42,0l0.07,0.07c0.39,0.39,0.39,1.02,0,1.41 l-5.92,5.94C10.41,16.4,9.78,16.4,9.38,16.01z"}))))}},65634:(e,t,r)=>{"use strict";r.d(t,{E:()=>p});var n=r(67294),a=r(51995),o=r(11965),s=r(51776),i=r(1455),l=r(61819),c=r(71963),d=r(60605);const u=a.iK.span`
  display: flex;
  align-items: center;
  svg {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`;function p({column:e,labelRef:t,showType:r=!1}){const{expression:a,column_name:p,type_generic:m}=e,_=a&&a!==p,h=_?"expression":m,[f,E]=(0,n.useState)(e.column_name),[y,g]=(0,n.useState)(e.type);return(0,n.useLayoutEffect)((()=>{E((0,c.ZK)(e,t)),g((0,c.GX)(e))}),[t,e]),(0,o.tZ)(u,null,r&&void 0!==h&&(0,o.tZ)(s.u,{id:"metric-type-tooltip",title:y,placement:"bottomRight",align:{offset:[8,-2]}},(0,o.tZ)("span",null,(0,o.tZ)(i.j,{type:h}))),(0,o.tZ)(s.u,{id:"metric-name-tooltip",title:f},(0,o.tZ)("span",{className:"option-label column-option-label",css:e=>o.iv`
            margin-right: ${e.gridUnit}px;
          `,ref:t},(0,c.ok)(e))),_&&(0,o.tZ)(d.Z,{sqlExpression:a}),e.is_certified&&(0,o.tZ)(l.Z,{metricName:e.metric_name,certifiedBy:e.certified_by,details:e.certification_details}))}},1455:(e,t,r)=>{"use strict";r.d(t,{j:()=>I});var n,a=r(67294),o=r(51995),s=r(11965),i=r(61988),l=r(88889),c=r(63270),d=r(30071);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u.apply(this,arguments)}const p=({title:e,titleId:t,...r},o)=>a.createElement("svg",u({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:o,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,n||(n=a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"m6.988 10.809-1.031 4.84q-.276 1.3-1.16 2.126-.885.827-1.822.827-.516 0-.76-.197a.61.61 0 0 1-.242-.495.7.7 0 0 1 .152-.445q.152-.194.44-.194.18 0 .319.082a1 1 0 0 1 .243.206q.082.099.185.27l.178.292q.452-.034.77-.61.32-.573.554-1.64l1.079-5.062H4.75l.123-.534h1.13l.083-.398q.14-.68.445-1.225t.692-.925q.381-.375.864-.59.483-.213.929-.213.515 0 .758.196a.61.61 0 0 1 .244.495.73.73 0 0 1-.144.446q-.144.193-.448.193a.6.6 0 0 1-.317-.08.9.9 0 0 1-.24-.207 2 2 0 0 1-.187-.276 4 4 0 0 0-.176-.287q-.405.018-.715.534-.311.515-.562 1.716l-.13.621H8.57l-.123.534zm2.225 2.261c0-1.758.45-3.183 1.387-4.424h.713c-.694.89-1.236 2.774-1.236 4.424 0 1.66.537 3.54 1.236 4.429H10.6c-.938-1.24-1.387-2.666-1.387-4.429m5.288.957h-.078l-1.25 1.988h-.952l1.802-2.632L12.2 10.75h1.001l1.25 1.958h.078l1.236-1.958h.952l-1.787 2.598 1.811 2.666h-.996zm5.23-.952c0 1.758-.45 3.184-1.387 4.424h-.713c.693-.889 1.235-2.773 1.235-4.424 0-1.66-.537-3.54-1.235-4.429h.713c.937 1.24 1.386 2.666 1.386 4.43",clipRule:"evenodd"}))),m=(0,a.forwardRef)(p);var _;function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h.apply(this,arguments)}const f=({title:e,titleId:t,...r},n)=>a.createElement("svg",h({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:n,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,_||(_=a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 4h-1v16h1zm3.248 8.475c0 2.343.913 3.691 2.5 3.691 1.582 0 2.49-1.338 2.49-3.677 0-2.334-.923-3.7-2.49-3.7-1.577 0-2.5 1.361-2.5 3.686M5.579 9.93V16h.879V8.954h-.874l-1.875 1.348v.928l1.792-1.3zm12.169 5.468c1.04 0 1.607-1.035 1.607-2.924 0-1.87-.577-2.915-1.607-2.915s-1.616 1.054-1.616 2.915c0 1.884.576 2.924 1.616 2.924",clipRule:"evenodd"}))),E=(0,a.forwardRef)(f);var y;function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g.apply(this,arguments)}const T=({title:e,titleId:t,...r},n)=>a.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:n,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,y||(y=a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M5.91 16.14c-1.14 0-2.047-.671-2.047-1.843 0-1.375 1.215-1.621 2.328-1.766 1.094-.14 1.547-.117 1.547-.562 0-.778-.41-1.235-1.265-1.235-.88 0-1.36.47-1.563.907l-.875-.313c.469-1.094 1.5-1.406 2.406-1.406.766 0 2.22.219 2.22 2.125V16h-.923v-.812h-.047c-.187.39-.734.953-1.78.953m.14-.828c1.095 0 1.688-.734 1.688-1.484v-.844c-.156.188-1.203.297-1.593.344-.72.094-1.36.313-1.36 1.016 0 .64.531.969 1.266.969M9.799 16V8h.922v2.953h.078c.203-.312.562-1.031 1.734-1.031 1.516 0 2.563 1.203 2.563 3.094 0 1.906-1.047 3.109-2.547 3.109-1.157 0-1.547-.719-1.75-1.047h-.11V16zm.906-3c0 1.36.61 2.297 1.719 2.297 1.156 0 1.75-1.016 1.75-2.297 0-1.266-.578-2.25-1.75-2.25-1.125 0-1.72.906-1.72 2.25m7.684 3.125c-1.687 0-2.719-1.297-2.719-3.094 0-1.828 1.079-3.11 2.704-3.11 1.265 0 2.218.75 2.375 1.876h-.922c-.14-.547-.625-1.047-1.438-1.047-1.078 0-1.797.89-1.797 2.25 0 1.39.703 2.297 1.797 2.297.719 0 1.266-.39 1.438-1.047h.922c-.157 1.063-1.032 1.875-2.36 1.875",clipRule:"evenodd"}))),v=(0,a.forwardRef)(T);var R;function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b.apply(this,arguments)}const S=({title:e,titleId:t,...r},n)=>a.createElement("svg",b({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:n,"aria-labelledby":t},r),e?a.createElement("title",{id:t},e):null,R||(R=a.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M10 8h1v2h2V8h1v2h2v1h-2v2h2v1h-2v2h-1v-2h-2v2h-1v-2H8v-1h2v-2H8v-1h2zm3 5v-2h-2v2z",clipRule:"evenodd"}))),A=(0,a.forwardRef)(S),O=o.iK.div`
  ${({theme:e})=>s.iv`
    display: flex;
    justify-content: center;
    align-items: center;
    width: ${6*e.gridUnit}px;
    height: ${6*e.gridUnit}px;
    margin-right: ${e.gridUnit}px;

    && svg {
      margin-right: 0;
      margin-left: 0;
      width: 100%;
      height: 100%;
    }
  `};
`;function I({type:e}){let t=(0,s.tZ)(c.Z,{"aria-label":(0,i.t)("unknown type icon")});return""===e||"expression"===e?t=(0,s.tZ)(m,{"aria-label":(0,i.t)("function type icon")}):e===l.Z.String?t=(0,s.tZ)(v,{"aria-label":(0,i.t)("string type icon")}):e===l.Z.Numeric?t=(0,s.tZ)(A,{"aria-label":(0,i.t)("numeric type icon")}):e===l.Z.Boolean?t=(0,s.tZ)(E,{"aria-label":(0,i.t)("boolean type icon")}):e===l.Z.Temporal&&(t=(0,s.tZ)(d.Z,{"aria-label":(0,i.t)("temporal type icon")})),(0,s.tZ)(O,null,t)}},46666:(e,t,r)=>{"use strict";r.d(t,{U:()=>n});const n=r(51995).iK.div`
  font-weight: ${({theme:e})=>e.typography.weights.bold};
  font-size: ${({theme:e})=>e.typography.sizes.s};
  margin-bottom: ${({theme:e})=>e.gridUnit}px;
`},9882:(e,t,r)=>{"use strict";r.d(t,{V:()=>l,Z:()=>c});var n=r(21804),a=r.n(n),o=(r(67294),r(61988)),s=r(51776),i=r(11965);function l({label:e,tooltip:t,bsStyle:r,onClick:n,icon:l="info-circle",className:c="text-muted",placement:d="right",iconsStyle:u={}}){const p=`fa fa-${l} ${c} ${r?`text-${r}`:""}`,m=(0,i.tZ)("i",{role:"button","aria-label":(0,o.t)("Show info tooltip"),tabIndex:0,className:p,style:{cursor:n?"pointer":void 0,...u},onClick:n,onKeyPress:n&&(e=>{"Enter"!==e.key&&" "!==e.key||n()})});return t?(0,i.tZ)(s.u,{id:`${a()(e)}-tooltip`,title:t,placement:d},m):m}const c=l},51384:(e,t,r)=>{"use strict";r.d(t,{m:()=>_});var n=r(67294),a=r(51995),o=r(11965),s=r(78186),i=r(9882),l=r(1455),c=r(61819),d=r(51776),u=r(71963),p=r(60605);const m=a.iK.div`
  align-items: center;
  display: flex;

  > svg {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`;function _({metric:e,labelRef:t,openInNewWindow:r=!1,showFormula:a=!0,showType:_=!1,shouldShowTooltip:h=!0,url:f=""}){const E=e.verbose_name||e.metric_name||e.label,y=f?(0,o.tZ)("a",{href:f,target:r?"_blank":"",rel:"noreferrer"},E):E,g=(0,o.tZ)("span",{className:"option-label metric-option-label",css:e=>o.iv`
        margin-right: ${e.gridUnit}px;
      `,ref:t},y),T=e.warning_markdown||e.warning_text,[v,R]=(0,n.useState)(e.metric_name);return(0,n.useLayoutEffect)((()=>{R((0,u.Lk)(e,t))}),[t,e]),(0,o.tZ)(m,{className:"metric-option"},_&&(0,o.tZ)(l.j,{type:"expression"}),h?(0,o.tZ)(d.Z,{id:"metric-name-tooltip",title:v},g):g,a&&e.expression&&(0,o.tZ)(p.Z,{sqlExpression:e.expression}),e.is_certified&&(0,o.tZ)(c.Z,{metricName:e.metric_name,certifiedBy:e.certified_by,details:e.certification_details}),T&&(0,o.tZ)(i.Z,{className:"text-warning",icon:"warning",tooltip:(0,o.tZ)(s.Z,{source:T}),label:`warn-${e.metric_name}`,iconsStyle:{marginLeft:0}}))}},60605:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(73126),a=(r(67294),r(19181)),o=r(74981),s=r(85369),i=r(51995),l=r(11965),c=r(61988);r(89899);const d=(0,i.iK)(s.Z)`
  ${({theme:e})=>l.iv`
    color: ${e.colors.grayscale.base};
    font-size: ${e.typography.sizes.s}px;
    & svg {
      margin-left: ${e.gridUnit}px;
      margin-right: ${e.gridUnit}px;
    }
  `}
`,u=e=>{const t=(0,i.Fg)();return(0,l.tZ)(a.Z,(0,n.Z)({content:(0,l.tZ)(o.default,{mode:"sql",value:e.sqlExpression,editorProps:{$blockScrolling:!0},setOptions:{highlightActiveLine:!1,highlightGutterLine:!1},minLines:2,maxLines:6,readOnly:!0,wrapEnabled:!0,style:{border:`1px solid ${t.colors.grayscale.light2}`,background:t.colors.secondary.light5,maxWidth:100*t.gridUnit}}),placement:"bottomLeft",arrowPointAtCenter:!0,title:(0,c.t)("SQL expression")},e),(0,l.tZ)(d,null))}},51776:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c,u:()=>l});var n=r(73126),a=r(67294),o=r(51995),s=r(11965),i=r(31097);const l=({overlayStyle:e,color:t,...r})=>{const l=(0,o.Fg)(),c=`${l.colors.grayscale.dark2}e6`;return(0,s.tZ)(a.Fragment,null,(0,s.tZ)(s.xB,{styles:s.iv`
          .ant-tooltip-open {
            display: inline-block;
            &::after {
              content: '';
              display: block;
            }
          }
        `}),(0,s.tZ)(i.Z,(0,n.Z)({overlayStyle:{fontSize:l.typography.sizes.s,lineHeight:"1.6",maxWidth:62*l.gridUnit,minWidth:30*l.gridUnit,...e},align:{offset:[0,1]},color:c||t,trigger:"hover",placement:"bottom",mouseLeaveDelay:0},r)))},c=l},71963:(e,t,r)=>{"use strict";r.d(t,{GX:()=>p,Lk:()=>_,ZK:()=>m,ok:()=>u});var n=r(67294),a=r(51995),o=r(11965),s=r(61988);const i=a.iK.div`
  ${({theme:e})=>o.iv`
    display: flex;
    flex-direction: column;
    font-size: ${e.typography.sizes.s}px;
    line-height: 1.2;

    &:not(:last-of-type) {
      margin-bottom: ${2*e.gridUnit}px;
    }
    &:last-of-type {
      display: -webkit-box;
      -webkit-line-clamp: 40;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  `}
`,l=a.iK.span`
  ${({theme:e})=>o.iv`
    font-weight: ${e.typography.weights.bold};
  `}
`,c=({label:e,text:t})=>(0,o.tZ)(i,null,(0,o.tZ)(l,null,e),(0,o.tZ)("span",null,t)),d=e=>{var t,r;return!!((null==e||null==(t=e.current)?void 0:t.scrollWidth)>(null==e||null==(r=e.current)?void 0:r.clientWidth))},u=e=>e.verbose_name||e.column_name,p=e=>e.type?(0,o.tZ)(c,{label:(0,s.t)("Column datatype"),text:e.type.toLowerCase()}):null,m=(e,t)=>e.column_name&&e.verbose_name||e.description||d(t)?(0,o.tZ)(n.Fragment,null,e.column_name&&(0,o.tZ)(c,{label:(0,s.t)("Column name"),text:e.column_name}),e.verbose_name&&(0,o.tZ)(c,{label:(0,s.t)("Label"),text:e.verbose_name}),e.description&&(0,o.tZ)(c,{label:(0,s.t)("Description"),text:e.description})):null,_=(e,t)=>e.verbose_name||e.description||e.label||d(t)?(0,o.tZ)(n.Fragment,null,(0,o.tZ)(c,{label:(0,s.t)("Metric name"),text:e.metric_name}),(e.label||e.verbose_name)&&(0,o.tZ)(c,{label:(0,s.t)("Label"),text:e.label||e.verbose_name}),e.description&&(0,o.tZ)(c,{label:(0,s.t)("Description"),text:e.description})):null},35622:(e,t,r)=>{"use strict";r.d(t,{$z:()=>l,CV:()=>p,DS:()=>d,LU:()=>u,PJ:()=>_,YY:()=>h,ZK:()=>f,cm:()=>m,m_:()=>c});var n=r(61988),a=r(5364),o=r(88889),s=r(20620),i=r(38575);const l=1e5,c={time_range:(0,n.t)("Time Range"),granularity_sqla:(0,n.t)("Time Column"),time_grain_sqla:(0,n.t)("Time Grain"),granularity:(0,n.t)("Time Granularity")},d={[a.W3]:(0,n.t)("Time")},u={verbose_name:d[a.W3],column_name:a.W3,type:"TIMESTAMP",type_generic:o.Z.Temporal,description:(0,n.t)("A reference to the [Time] configuration, taking granularity into account")},p={column_name:a.W3,is_dttm:!0,type:"TIMESTAMP",type_generic:o.Z.Temporal},m={[s.n.Aggregate]:(0,n.t)("Aggregate"),[s.n.Raw]:(0,n.t)("Raw records")},_={sort_series_type:i.Id.Sum,sort_series_ascending:!1},h=[[i.Id.Name,(0,n.t)("Category name")],[i.Id.Sum,(0,n.t)("Total value")],[i.Id.Min,(0,n.t)("Minimum value")],[i.Id.Max,(0,n.t)("Maximum value")],[i.Id.Avg,(0,n.t)("Average value")]],f={sort_series_type:i.Id.Name,sort_series_ascending:!0}},93362:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var n=r(11965),a=(r(67294),r(51995)),o=r(61988),s=r(9882),i=r(51776);function l({name:e,description:t,label:r,tooltipOnClick:a,onClick:l,warning:c,danger:d,leftNode:u,rightNode:p,validationErrors:m=[],renderTrigger:_=!1,hovered:h=!1,required:f=!1}){if(!r)return null;const E=m.length>0?"text-danger":"";return(0,n.tZ)("div",{className:"ControlHeader"},(0,n.tZ)("div",{className:"pull-left"},(0,n.tZ)("label",{className:"control-label",htmlFor:e},u&&(0,n.tZ)("span",null,u),(0,n.tZ)("span",{role:"button",tabIndex:0,onClick:l,className:E,style:{cursor:l?"pointer":""}},r)," ",c&&(0,n.tZ)("span",null,(0,n.tZ)(i.u,{id:"error-tooltip",placement:"top",title:c},(0,n.tZ)("i",{className:"fa fa-exclamation-circle text-warning"}))," "),d&&(0,n.tZ)("span",null,(0,n.tZ)(i.u,{id:"error-tooltip",placement:"top",title:d},(0,n.tZ)("i",{className:"fa fa-exclamation-circle text-danger"}))," "),m.length>0&&(0,n.tZ)("span",null,(0,n.tZ)(i.u,{id:"error-tooltip",placement:"top",title:m.join(" ")},(0,n.tZ)("i",{className:"fa fa-exclamation-circle text-danger"}))," "),h?(0,n.tZ)("span",null,t&&(0,n.tZ)("span",null,(0,n.tZ)(s.V,{label:(0,o.t)("description"),tooltip:t,placement:"top",onClick:a})," "),_&&(0,n.tZ)("span",null,(0,n.tZ)(s.V,{label:(0,o.t)("bolt"),tooltip:(0,o.t)("Changing this control takes effect instantly"),placement:"top",icon:"bolt"})," ")):null,f&&(0,n.tZ)("span",{className:"text-danger m-l-4"},(0,n.tZ)("strong",null,"*")))),p&&(0,n.tZ)("div",{className:"pull-right"},p),(0,n.tZ)("div",{className:"clearfix"}))}const c={RadioButtonControl:function({value:e,options:t,onChange:r,...o}){const s=e||t[0][0],i=(0,a.Fg)();return(0,n.tZ)("div",{css:(0,n.iv)({".btn svg":{position:"relative",top:"0.2em"},".btn:focus":{outline:"none"},".control-label":{color:i.colors.grayscale.base,marginBottom:i.gridUnit},".control-label + .btn-group":{marginTop:"1px"},".btn-group .btn-default":{color:i.colors.grayscale.dark1},".btn-group .btn.active":{background:i.colors.grayscale.light4,fontWeight:i.typography.weights.bold,boxShadow:"none"}},"","")},(0,n.tZ)(l,o),(0,n.tZ)("div",{className:"btn-group btn-group-sm"},t.map((([e,t])=>(0,n.tZ)("button",{key:JSON.stringify(e),type:"button",className:"btn btn-default "+(e===s?"active":""),onClick:()=>{r(e)}},t)))))}}},83389:(e,t,r)=>{"use strict";r.d(t,{P2:()=>c,V7:()=>d,sy:()=>u});var n=r(61988),a=r(95826),o=r(55786),s=r(5364),i=r(45211);const l=e=>"horizontal"===(null==e?void 0:e.orientation)?{label:(0,n.t)("Y-axis"),description:(0,n.t)("Dimension to use on y-axis.")}:{label:(0,n.t)("X-axis"),description:(0,n.t)("Dimension to use on x-axis.")},c={label:e=>l(null==e?void 0:e.form_data).label,multi:!1,description:e=>l(null==e?void 0:e.form_data).description,validators:[a.Z],initialValue:(e,t)=>{var r,n;if(null!=t&&null!=(r=t.form_data)&&r.granularity_sqla&&(null==(n=t.form_data)||!n.x_axis)&&(null==e||!e.value))return t.form_data.granularity_sqla},default:void 0},d={isTemporal:!0,mapStateToProps:({datasource:e})=>{const t=(0,i.X)(e);return{options:t.temporalColumns,default:t.defaultTemporalColumn}}},u={initialValue:(e,t)=>{var r,n,a,l;if(null!=t&&null!=(r=t.controls)&&null!=(n=r.time_range)&&n.value||(0,o.Z)(e.value).findIndex((e=>"TEMPORAL_RANGE"===(null==e?void 0:e.operator)))>-1)return;if(null!=t&&null!=(a=t.form_data)&&a.granularity_sqla&&null!=t&&null!=(l=t.form_data)&&l.time_range)return[...(0,o.Z)(e.value),{clause:"WHERE",subject:t.form_data.granularity_sqla,operator:"TEMPORAL_RANGE",comparator:t.form_data.time_range,expressionType:"SIMPLE"}];const c=(null==t?void 0:t.datasource)&&(0,i.X)(t.datasource).defaultTemporalColumn;var d,u;return c?[...(0,o.Z)(e.value),{clause:"WHERE",subject:c,operator:"TEMPORAL_RANGE",comparator:(null==t||null==(d=t.common)||null==(u=d.conf)?void 0:u.DEFAULT_TIME_FILTER)||s.vM,expressionType:"SIMPLE"}]:void 0}}},45329:(e,t,r)=>{"use strict";r.d(t,{Z:()=>ne});var n=r(41609),a=r.n(n),o=r(81545),s=r(45511),i=r(61988),l=r(37731),c=r(5364),d=r(75294),u=r(74029),p=r(62363),m=r(55786),_=r(36846),h=r(6126),f=r(58842),E=r(35622),y=(r(67294),r(95826)),g=r(38575),T=r(65634),v=r(19835),R=r(83389),b=r(11965);const S={type:"DndColumnSelect",label:(0,i.t)("Dimensions"),multi:!0,freeForm:!0,clearable:!0,default:[],includeTime:!1,description:(0,i.t)("Dimensions contain qualitative values such as names, dates, or geographical data. Use dimensions to categorize, segment, and reveal the details in your data. Dimensions affect the level of detail in the view."),optionRenderer:e=>(0,b.tZ)(T.E,{showType:!0,column:e}),valueRenderer:e=>(0,b.tZ)(T.E,{column:e}),valueKey:"column_name",allowAll:!0,filterOption:({data:e},t)=>{var r,n;return(null==(r=e.column_name)?void 0:r.toLowerCase().includes(t.toLowerCase()))||(null==(n=e.verbose_name)?void 0:n.toLowerCase().includes(t.toLowerCase()))||!1},promptTextCreator:e=>e,mapStateToProps(e,t){var r;const n={},{datasource:a}=e;if(null!=a&&null!=(r=a.columns[0])&&r.hasOwnProperty("groupby")){const e=a.columns.filter((e=>e.groupby));null!=t&&t.includeTime&&e.unshift(E.LU),n.options=e,n.savedMetrics=a.metrics||[]}else{const e=(null==a?void 0:a.columns)||[];null!=t&&t.includeTime&&e.unshift(E.CV),n.options=e}return n},commaChoosesOption:!1},A={...S,label:(0,i.t)("Columns"),description:(0,i.t)("Add dataset columns here to group the pivot table columns.")},O={...S,label:(0,i.t)("Dimension"),multi:!1,default:null,description:(0,i.t)("Defines the grouping of entities. Each series is represented by a specific color in the chart.")},I={...S,label:(0,i.t)("Entity"),default:null,multi:!1,validators:[y.Z],description:(0,i.t)("This defines the element to be plotted on the chart")},C={type:"DndFilterSelect",label:(0,i.t)("Filters"),default:[],description:"",mapStateToProps:({datasource:e,form_data:t})=>({columns:(0,g.It)(e)?e.columns.filter((e=>e.filterable)):(null==e?void 0:e.columns)||[],savedMetrics:(0,v.R)(e),selectedMetrics:t.metrics||(t.metric?[t.metric]:[]),datasource:e}),provideFormDataToProps:!0,...R.sy},D={type:"DndMetricSelect",multi:!0,label:(0,i.t)("Metrics"),validators:[y.Z],mapStateToProps:({datasource:e})=>({columns:(null==e?void 0:e.columns)||[],savedMetrics:(0,v.R)(e),datasource:e,datasourceType:null==e?void 0:e.type}),description:(0,i.t)("Select one or many metrics to display. You can use an aggregation function on a column or write custom SQL to create a metric.")},N={...D,multi:!1,label:(0,i.t)("Metric"),description:(0,i.t)("Select a metric to display. You can use an aggregation function on a column or write custom SQL to create a metric.")},w={...N,label:(0,i.t)("Right Axis Metric"),clearable:!0,description:(0,i.t)("Select a metric to display on the right axis")},L={type:"DndMetricSelect",label:(0,i.t)("Sort by"),default:null,description:(0,i.t)("This metric is used to define row selection criteria (how the rows are sorted) if a series or row limit is present. If not defined, it reverts to the first metric (where appropriate)."),mapStateToProps:({datasource:e})=>({columns:(null==e?void 0:e.columns)||[],savedMetrics:(0,v.R)(e),datasource:e,datasourceType:null==e?void 0:e.type})},q={...N,label:(0,i.t)("Bubble Size"),description:(0,i.t)("Metric used to calculate bubble size"),default:null},x={...N,label:(0,i.t)("X Axis"),description:(0,i.t)("The dataset column/metric that returns the values on your chart's x-axis."),default:null},U={...N,label:(0,i.t)("Y Axis"),description:(0,i.t)("The dataset column/metric that returns the values on your chart's y-axis."),default:null},Z={...N,label:(0,i.t)("Color Metric"),default:null,validators:[],description:(0,i.t)("A metric to use for color")},P={...O,...R.V7,label:E.m_.granularity_sqla,description:(0,i.t)("The time column for the visualization. Note that you can define arbitrary expression that return a DATETIME column in the table. Also note that the filter below is applied against this column or expression"),default:e=>e.default,clearable:!1,canDelete:!1,ghostButtonText:(0,i.t)("Drop a temporal column here or click"),optionRenderer:e=>(0,b.tZ)(T.E,{showType:!0,column:e}),valueRenderer:e=>(0,b.tZ)(T.E,{column:e}),valueKey:"column_name"},M={...S,...R.P2},F=(0,o.Z)(),k=(0,s.Z)(),Q=[5,10,25,50,100,500],$=document.getElementById("app"),{user:Y}=JSON.parse((null==$?void 0:$.getAttribute("data-bootstrap"))||"{}"),B={type:"DatasourceControl",label:(0,i.t)("Datasource"),default:null,description:null,mapStateToProps:({datasource:e,form_data:t})=>({datasource:e,form_data:t,user:Y})},H={type:"VizTypeControl",label:(0,i.t)("Visualization Type"),default:"table",description:(0,i.t)("The type of visualization to display")},j={type:"ColorPickerControl",label:(0,i.t)("Fixed Color"),description:(0,i.t)("Use this to define a static color for all circles"),default:{r:0,g:122,b:135,a:1},renderTrigger:!0},V={type:"ColorSchemeControl",label:(0,i.t)("Linear Color Scheme"),choices:()=>k.values().map((e=>[e.id,e.label])),default:k.getDefaultKey(),clearable:!1,description:"",renderTrigger:!0,schemes:()=>k.getMap(),isLinear:!0,mapStateToProps:e=>{var t;return{dashboardId:null==e||null==(t=e.form_data)?void 0:t.dashboardId}}},G={type:"SelectControl",freeForm:!0,label:E.m_.granularity,default:"one day",choices:[[null,(0,i.t)("all")],["PT5S",(0,i.t)("5 seconds")],["PT30S",(0,i.t)("30 seconds")],["PT1M",(0,i.t)("1 minute")],["PT5M",(0,i.t)("5 minutes")],["PT30M",(0,i.t)("30 minutes")],["PT1H",(0,i.t)("1 hour")],["PT6H",(0,i.t)("6 hour")],["P1D",(0,i.t)("1 day")],["P7D",(0,i.t)("7 days")],["P1W",(0,i.t)("week")],["week_starting_sunday",(0,i.t)("week starting Sunday")],["week_ending_saturday",(0,i.t)("week ending Saturday")],["P1M",(0,i.t)("month")],["P3M",(0,i.t)("quarter")],["P1Y",(0,i.t)("year")]],description:(0,i.t)("The time granularity for the visualization. Note that you can type and use simple natural language as in `10 seconds`, `1 day` or `56 weeks`")},z={type:"SelectControl",label:E.m_.time_grain_sqla,placeholder:(0,i.t)("None"),initialValue:(e,t)=>{var r,n;return(0,l.Z)(t)?null!=t&&t.metadata||"time_grain_sqla"in(null!=(r=null==t?void 0:t.form_data)?r:{})?null==t||null==(n=t.form_data)?void 0:n.time_grain_sqla:"P1D":e.value},description:(0,i.t)("Select a time grain for the visualization. The grain is the time interval represented by a single point on the chart."),mapStateToProps:({datasource:e})=>({choices:(null==e?void 0:e.time_grain_sqla)||[]}),visibility:_.Z},W={type:"DateFilterControl",freeForm:!0,label:E.m_.time_range,default:c.vM,description:(0,i.t)('This control filters the whole chart based on the selected time range. All relative times, e.g. "Last month", "Last 7 days", "now", etc. are evaluated on the server using the server\'s local time (sans timezone). All tooltips and placeholder times are expressed in UTC (sans timezone). The timestamps are then evaluated by the database using the engine\'s local timezone. Note one can explicitly set the timezone per the ISO 8601 format if specifying either the start and/or end time.')},K={type:"SelectControl",freeForm:!0,label:(0,i.t)("Row limit"),clearable:!1,mapStateToProps:e=>{var t,r;return{maxValue:null==e||null==(t=e.common)||null==(r=t.conf)?void 0:r.SQL_MAX_ROW}},validators:[d.Z,(e,t)=>(0,u.Z)(e,(null==t?void 0:t.maxValue)||E.$z)],default:1e4,choices:(0,h.m)([10,50,100,250,500,1e3,5e3,1e4,5e4]),description:(0,i.t)("Limits the number of the rows that are computed in the query that is the source of the data used for this chart.")},J={type:"CheckboxControl",label:(0,i.t)("Sort Descending"),default:!0,description:(0,i.t)("If enabled, this control sorts the results/values descending, otherwise it sorts the results ascending."),visibility:({controls:e})=>Boolean((null==e?void 0:e.timeseries_limit_metric.value)&&!a()(null==e?void 0:e.timeseries_limit_metric.value))},X={type:"SelectControl",freeForm:!0,label:(0,i.t)("Series limit"),placeholder:(0,i.t)("None"),validators:[d.Z],choices:(0,h.m)(Q),clearable:!0,description:(0,i.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},ee={type:"SelectControl",freeForm:!0,label:(0,i.t)("Series limit"),placeholder:(0,i.t)("None"),validators:[d.Z],choices:(0,h.m)(Q),description:(0,i.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},te={type:"SelectControl",freeForm:!0,label:(0,i.t)("Y Axis Format"),renderTrigger:!0,default:f.Ul,choices:f.F6,description:f.YD,tokenSeparators:["\n","\t",";"],filterOption:({data:e},t)=>e.label.includes(t)||e.value.includes(t),mapStateToProps:e=>{var t,r;return{choices:(null==(t=e.controls)||null==(r=t.comparison_type)?void 0:r.value)===p.wj.Percentage?f.F6.filter((e=>e[0].includes("%"))):f.F6}}},re={type:"CurrencyControl",label:(0,i.t)("Currency format"),renderTrigger:!0},ne={metrics:D,metric:N,datasource:B,viz_type:H,color_picker:j,metric_2:w,linear_color_scheme:V,secondary_metric:Z,groupby:S,columns:A,granularity:G,granularity_sqla:P,time_grain_sqla:z,time_range:W,row_limit:K,limit:X,timeseries_limit_metric:L,orderby:L,order_desc:J,series:O,entity:I,x,y:U,size:q,y_axis_format:te,x_axis_time_format:{type:"SelectControl",freeForm:!0,label:(0,i.t)("Time format"),renderTrigger:!0,default:f._r,choices:f.HC,description:f.oq,filterOption:({data:e},t)=>e.label.includes(t)||e.value.includes(t)},adhoc_filters:C,color_scheme:{type:"ColorSchemeControl",label:(0,i.t)("Color Scheme"),default:F.getDefaultKey(),renderTrigger:!0,choices:()=>F.keys().map((e=>[e,e])),description:(0,i.t)("The color scheme for rendering chart"),schemes:()=>F.getMap(),mapStateToProps:e=>{var t;return{dashboardId:null==e||null==(t=e.form_data)?void 0:t.dashboardId}}},series_columns:A,series_limit:ee,series_limit_metric:L,legacy_order_by:L,truncate_metric:{type:"CheckboxControl",label:(0,i.t)("Truncate Metric"),default:!0,description:(0,i.t)("Whether to truncate metrics")},x_axis:M,show_empty_columns:{type:"CheckboxControl",label:(0,i.t)("Show empty columns"),default:!0,description:(0,i.t)("Show empty columns")},temporal_columns_lookup:{type:"HiddenControl",initialValue:(e,t)=>{var r;return Object.fromEntries((0,m.Z)(null==t||null==(r=t.datasource)?void 0:r.columns).filter((e=>e.is_dttm)).map((e=>{var t;return[null!=(t=e.column_name)?t:e.name,e.is_dttm]})))}},currency_format:re}},38575:(e,t,r)=>{"use strict";r.d(t,{D_:()=>l,Id:()=>u,It:()=>c,JQ:()=>d,i3:()=>o,pp:()=>n,s2:()=>a,xN:()=>s,zy:()=>i});const n=e=>{var t,r;return(null==e||null==(t=e.standardizedFormData)?void 0:t.controls)&&(null==e||null==(r=e.standardizedFormData)?void 0:r.memorizedFormData)&&Array.isArray(e.standardizedFormData.controls.metrics)&&Array.isArray(e.standardizedFormData.controls.columns)};var a;!function(e){e.None="None",e.GreaterThan=">",e.LessThan="<",e.GreaterOrEqual="≥",e.LessOrEqual="≤",e.Equal="=",e.NotEqual="≠",e.Between="< x <",e.BetweenOrEqual="≤ x ≤",e.BetweenOrLeftEqual="≤ x <",e.BetweenOrRightEqual="< x ≤"}(a||(a={}));const o=[a.Between,a.BetweenOrEqual,a.BetweenOrLeftEqual,a.BetweenOrRightEqual];function s(e){return!!e&&"column_name"in e}function i(e){return"column_name"in e&&"expression"in e&&!!e.expression}function l(e){return null!==e}function c(e){return!!e&&"columns"in e&&!("sqlEditorId"in e)}function d(e){return!!e&&"results"in e&&"sqlEditorId"in e}var u;!function(e){e.Name="name",e.Max="max",e.Min="min",e.Sum="sum",e.Avg="avg"}(u||(u={}))},58842:(e,t,r)=>{"use strict";r.d(t,{F6:()=>u,HC:()=>m,Ul:()=>_,YD:()=>i,_r:()=>h,oq:()=>p,pj:()=>l,u6:()=>c});var n=r(61988),a=r(67190),o=r(45636),s=r(78900);const i=(0,n.t)("D3 format syntax: https://github.com/d3/d3-format"),l=(0,n.t)('Only applies when "Label Type" is set to show values.'),c=(0,n.t)('Only applies when "Label Type" is not set to a percentage.'),d=[",d",".1s",".3s",",.1%",".2%",".3%",".4r",",.1f",",.2f",",.3f","+,","$,.2f"].map((e=>[e,`${e} (${(0,a.JB)(e).preview()})`])),u=[[o.default.SMART_NUMBER,(0,n.t)("Adaptive formatting")],["~g",(0,n.t)("Original value")],...d,["DURATION",(0,n.t)("Duration in ms (66000 => 1m 6s)")],["DURATION_SUB",(0,n.t)("Duration in ms (1.40008 => 1ms 400µs 80ns)")]],p=(0,n.t)("D3 time format syntax: https://github.com/d3/d3-time-format"),m=[[s.Z.id,(0,n.t)("Adaptive formatting")],["%d/%m/%Y","%d/%m/%Y | 14/01/2019"],["%m/%d/%Y","%m/%d/%Y | 01/14/2019"],["%Y-%m-%d","%Y-%m-%d | 2019-01-14"],["%Y-%m-%d %H:%M:%S","%Y-%m-%d %H:%M:%S | 2019-01-14 01:32:10"],["%d-%m-%Y %H:%M:%S","%d-%m-%Y %H:%M:%S | 14-01-2019 01:32:10"],["%H:%M:%S","%H:%M:%S | 01:32:10"]],_=u[0][0],h=m[0][0]},19835:(e,t,r)=>{"use strict";r.d(t,{R:()=>a});var n=r(46078);const a=e=>null!=e&&e.hasOwnProperty("metrics")?(null==e?void 0:e.metrics)||[]:n.BH},36846:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(72813);function a({controls:e}){if(null==e||!e.x_axis)return!0;const t=null==e?void 0:e.x_axis,r=null==t?void 0:t.value;return!!(0,n.GA)(r)||!!(0,n.s9)(r)&&!(null==(a=(null!=(o=null==t?void 0:t.options)?o:[]).find((e=>(null==e?void 0:e.column_name)===r)))||!a.is_dttm);var a,o}},89368:(e,t,r)=>{"use strict";r.d(t,{$:()=>s,q:()=>i});var n=r(67294),a=r(93362),o=r(45329);function s(e){return"string"==typeof e&&e in a.default?a.default[e]:e}function i(e,t={}){if("string"==typeof e&&e in o.Z){const r=e;return{name:r,config:{...o.Z[r],...t[r]}}}if(!e||"string"==typeof e||n.isValidElement(e))return e;if("name"in e&&"config"in e)return{...e,config:{...e.config,type:s(e.config.type)}};if("override"in e&&e.name in o.Z){const{name:t,override:r}=e;return{name:t,config:{...o.Z[t],...r}}}return null}},20002:(e,t,r)=>{"use strict";r.d(t,{u:()=>o});var n=r(1875),a=r(38575);const o=(0,n.Z)(class{constructor(){this.controls=void 0,this.controls={metrics:[],columns:[]}}setStandardizedControls(e){if((0,a.pp)(e)){const{controls:t}=e.standardizedFormData;this.controls={metrics:t.metrics,columns:t.columns}}}shiftMetric(){return this.controls.metrics.shift()}shiftColumn(){return this.controls.columns.shift()}popAllMetrics(){return this.controls.metrics.splice(0,this.controls.metrics.length)}popAllColumns(){return this.controls.columns.splice(0,this.controls.columns.length)}clear(){this.controls={metrics:[],columns:[]}}})},45211:(e,t,r)=>{"use strict";r.d(t,{X:()=>s,x:()=>i});var n=r(55786),a=r(37731),o=r(38575);function s(e){const t={temporalColumns:[],defaultTemporalColumn:void 0};var r,s,i;return(0,o.It)(e)&&(t.temporalColumns=(0,n.Z)(e.columns).filter((e=>e.is_dttm))),(0,o.JQ)(e)&&(t.temporalColumns=(0,n.Z)(e.columns).filter((e=>e.is_dttm))),(0,o.It)(e)&&(t.defaultTemporalColumn=e.main_dttm_col),(0,a.Z)(t.defaultTemporalColumn)||(t.defaultTemporalColumn=null!=(r=null==(s=t.temporalColumns[0])?void 0:s.column_name)?r:null==(i=t.temporalColumns[0])?void 0:i.name),t}function i(e,t){const r=s(t).temporalColumns;for(let t=0;t<r.length;t+=1)if(r[t].column_name===e)return!0;return!1}},6126:(e,t,r)=>{"use strict";function n(e){return e.map((e=>Array.isArray(e)?e:[e,e.toString()]))}function a(e,t){const r=[];for(let n=e;n<=t;n+=1)r.push([n,n.toString()]);return r}r.d(t,{B:()=>a,m:()=>n})},19427:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(90537),a=r(1875);class o extends n.Z{constructor(){super({name:"ChartBuildQuery",overwritePolicy:n.r.Warn})}}const s=(0,a.Z)(o)},37687:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(90537),a=r(1875);class o extends n.Z{constructor(){super({name:"ChartControlPanel"})}}const s=(0,a.Z)(o)},11064:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(90537),a=r(1875);class o extends n.Z{constructor(){super({name:"ChartMetadata",overwritePolicy:n.r.Warn})}}const s=(0,a.Z)(o)},16355:(e,t,r)=>{"use strict";var n,a,o;r.d(t,{Df:()=>o,Tr:()=>a,ZP:()=>c,cg:()=>n,eH:()=>i,t$:()=>s,we:()=>l}),function(e){e.InteractiveChart="INTERACTIVE_CHART",e.NativeFilter="NATIVE_FILTER",e.DrillToDetail="DRILL_TO_DETAIL",e.DrillBy="DRILL_BY"}(n||(n={})),function(e){e.Explore="EXPLORE",e.Dashboard="DASHBOARD",e.FilterBar="FILTER_BAR",e.FilterConfigModal="FILTER_CONFIG_MODAL",e.Embedded="EMBEDDED"}(a||(a={})),function(e){e.Deprecated="DEPRECATED",e.Featured="FEATURED"}(o||(o={}));const s={[o.Deprecated]:"This chart uses features or modules which are no longer actively maintained. It will eventually be replaced or removed.",[o.Featured]:"This chart was tested and verified, so the overall experience should be stable."},i={[o.Deprecated]:{weight:-.1},[o.Featured]:{weight:.1}};var l;!function(e){e.Category="category",e.Value="value",e.Time="time",e.Log="log"}(l||(l={}));const c={}},28062:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DEFAULT_NAMESPACE:()=>l,default:()=>s,getColor:()=>d,getNamespace:()=>c,getScale:()=>u});var n=r(97466),a=r(81545),o=r(86041);class s{constructor(e){this.name=void 0,this.forcedItems=void 0,this.scales=void 0,this.name=e,this.scales={},this.forcedItems={}}getScale(e){var t,r;const o=null!=(t=null!=e?e:(0,a.Z)().getDefaultKey())?t:"",s=(0,a.Z)().get(o);return new n.Z(null!=(r=null==s?void 0:s.colors)?r:[],this.forcedItems)}setColor(e,t){return this.forcedItems[(0,o.Z)(e)]=t,this}resetColors(){this.forcedItems={}}}const i={},l="GLOBAL";function c(e=l){const t=i[e];if(t)return t;const r=new s(e);return i[e]=r,r}function d(e,t,r){return c(r).getScale(t).getColor(e)}function u(e,t){return c(t).getScale(e)}},97466:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(99481),a=r(54732),o=r(86041),s=r(78161),i=r(25130),l=r(93185);class c extends a.Z{constructor(e,t={}){super(((e,t)=>this.getColor(e,t))),this.originColors=void 0,this.colors=void 0,this.scale=void 0,this.parentForcedColors=void 0,this.forcedColors=void 0,this.multiple=void 0,this.originColors=e,this.colors=e,this.scale=(0,n.Z)(),this.scale.range(e),Object.entries(t).forEach((([r,n])=>{"number"==typeof n&&(t[r]=e[n%e.length])})),this.parentForcedColors=t,this.forcedColors={},this.multiple=0}removeSharedLabelColorFromRange(e,t){const r=new Set(this.originColors);e.forEach(((e,n)=>{n!==t&&r.delete(e)})),Object.entries(this.parentForcedColors).forEach((([e,n])=>{e!==t&&r.delete(n)})),this.range(r.size>0?[...r]:this.originColors)}getColor(e,t){var r,n;const a=(0,o.Z)(e),c=(0,s.ZP)(),d=c.getColorMap(),u=d.get(a);let p=(null==(r=this.parentForcedColors)?void 0:r[a])||(null==(n=this.forcedColors)?void 0:n[a])||u;if((0,l.cr)(l.TT.UseAnalagousColors)){const e=Math.floor(this.domain().length/this.originColors.length);if(e>this.multiple){this.multiple=e;const t=(0,i.Gh)(this.originColors,e);this.range(this.originColors.concat(t))}}const m=this.scale(a);return p||(p=m,(0,l.cr)(l.TT.AvoidColorsCollision)&&(this.removeSharedLabelColorFromRange(d,a),p=this.scale(a))),c.addSlice(a,p,t),p}setColor(e,t){return this.forcedColors[(0,o.Z)(e)]=t,this}getColorMap(){const e={};return this.scale.domain().forEach((t=>{e[t.toString()]=this.scale(t)})),{...e,...this.forcedColors,...this.parentForcedColors}}copy(){const e=new c(this.scale.range(),this.parentForcedColors);return e.forcedColors={...this.forcedColors},e.domain(this.domain()),e.unknown(this.unknown()),e}domain(e){return void 0===e?this.scale.domain():(this.scale.domain(e),this)}range(e){return void 0===e?this.scale.range():(this.colors=e,this.scale.range(e),this)}unknown(e){return void 0===e?this.scale.unknown():(this.scale.unknown(e),this)}}const d=c},78161:(e,t,r)=>{"use strict";r.d(t,{Ag:()=>n,Xs:()=>s,ZP:()=>i});var n,a=r(28062),o=r(1875);!function(e){e[e.Dashboard=0]="Dashboard",e[e.Explore=1]="Explore"}(n||(n={}));class s{constructor(){this.sliceLabelMap=void 0,this.colorMap=void 0,this.source=void 0,this.sliceLabelMap=new Map,this.colorMap=new Map,this.source=n.Dashboard}updateColorMap(e,t){const r=a.getNamespace(e),n=new Map;this.colorMap.clear(),this.sliceLabelMap.forEach((e=>{const a=r.getScale(t);e.forEach((e=>{const t=a(e);n.set(e,t)}))})),this.colorMap=n}getColorMap(){return this.colorMap}addSlice(e,t,r){if(this.source!==n.Dashboard||void 0===r)return;const a=this.sliceLabelMap.get(r)||[];a.includes(e)||(a.push(e),this.sliceLabelMap.set(r,a)),this.colorMap.set(e,t)}removeSlice(e){if(this.source!==n.Dashboard)return;this.sliceLabelMap.delete(e);const t=new Map;this.sliceLabelMap.forEach((e=>{e.forEach((e=>{t.set(e,this.colorMap.get(e))}))})),this.colorMap=t}reset(){new Map(this.colorMap).forEach(((e,t)=>{this.colorMap.set(t,"")}))}clear(){this.sliceLabelMap.clear(),this.colorMap.clear()}}const i=(0,o.Z)(s)},86041:(e,t,r)=>{"use strict";function n(e){return String(e).trim()}r.d(t,{Z:()=>n})},25130:(e,t,r)=>{"use strict";r.d(t,{Gh:()=>i,Qg:()=>s,Zf:()=>l,oo:()=>c,vq:()=>d});var n=r(17621),a=r.n(n);const o=/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/;function s(e,t=186){let r=0,n=0,a=0;if(e.length>7){const t=o.exec(e);if(!t)throw new Error(`Invalid color: ${e}`);r=parseInt(t[1],10),n=parseInt(t[2],10),a=parseInt(t[3],10)}else{let t=e;if(t.startsWith("#")&&(t=t.substring(1)),3===t.length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]].join("")),6!==t.length)throw new Error(`Invalid color: ${e}`);r=parseInt(t.slice(0,2),16),n=parseInt(t.slice(2,4),16),a=parseInt(t.slice(4,6),16)}return.299*r+.587*n+.114*a>t?"#000":"#FFF"}function i(e,t){const r=[],n=e.map((e=>a()(e).analogous(t+3).slice(3)));for(;null!=(o=n[n.length-1])&&o.length;){var o;n.forEach((e=>{const t=e.shift();r.push(t.toHexString())}))}return r}function l(e,t){if(t>1||t<0)throw new Error(`The opacity should between 0 and 1, but got: ${t}`);return`${e}${`0${Math.round(255*t).toString(16).toUpperCase()}`.slice(-2)}`}function c(e){let t="0",r="0",n="0";return 4===e.length?(t=`0x${e[1]}${e[1]}`,r=`0x${e[2]}${e[2]}`,n=`0x${e[3]}${e[3]}`):7===e.length&&(t=`0x${e[1]}${e[2]}`,r=`0x${e[3]}${e[4]}`,n=`0x${e[5]}${e[6]}`),`rgb(${+t}, ${+r}, ${+n})`}function d(e,t,r){let n=e.toString(16),a=t.toString(16),o=r.toString(16);return 1===n.length&&(n=`0${n}`),1===a.length&&(a=`0${a}`),1===o.length&&(o=`0${o}`),`#${n}${a}${o}`}},78186:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(1469),a=r.n(n),o=r(30236),s=r.n(o),i=r(67294),l=r(30301),c=r(82781),d=r(68743),u=r(15097),p=r(55582),m=r(93185),_=r(11965);const h=function({source:e,htmlSanitization:t=!0,htmlSchemaOverrides:r={}}){const n=(0,m.cr)(m.TT.EscapeMarkdownHtml),o=(0,i.useMemo)((()=>{const e=[];if(!n&&(e.push(u.Z),t)){const t=function(e,t){return s()(e,t,((e,t)=>a()(e)?e.concat(t):void 0))}(c.R,r);e.push([d.Z,t])}return e}),[n,t,r]);return(0,_.tZ)(l.D,{rehypePlugins:o,remarkPlugins:[p.Z],skipHtml:!1,transformLinkUri:null},e)}},85716:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var n=r(67294);function a(e,t){const r=(0,n.useRef)(t);return(0,n.useEffect)((()=>{r.current=e}),[e]),r.current}},3297:(e,t,r)=>{"use strict";r.d(t,{B:()=>a,Z:()=>o});var n=r(67294);const a={name:"l8l8b8",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis"},o=()=>{const[e,t]=(0,n.useState)(!0),r=(0,n.useRef)(null),[a,o]=(0,n.useState)(0),[s,i]=(0,n.useState)(0);return(0,n.useEffect)((()=>{var e,t,n,a;o(null!=(e=null==(t=r.current)?void 0:t.offsetWidth)?e:0),i(null!=(n=null==(a=r.current)?void 0:a.scrollWidth)?n:0)})),(0,n.useEffect)((()=>{t(a<s)}),[a,s]),[r,e]}},53652:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=class{constructor(e){this.name="TypedRegistry",this.records=void 0,this.records=e}get(e){return this.records[e]}set(e,t){this.records[e]=t}}},67706:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(46078);class a{constructor(e){this.id=void 0,this.type=void 0;const[t,r]=e.split("__");this.id=parseInt(t,10),this.type=n.i9.Table,this.type="query"===r?n.i9.Query:this.type}toString(){return`${this.id}__${this.type}`}toObject(){return{id:this.id,type:this.type}}}},61654:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(65946),a=r(67706),o=r(78444),s=r(11146);const i=e=>[e];function l(e,t){const{queryFields:r,buildQuery:l=i}="function"==typeof t?{buildQuery:t,queryFields:{}}:t||{};let c=l((0,n.Z)(e,r));return c.forEach((e=>{Array.isArray(e.post_processing)&&(e.post_processing=e.post_processing.filter(Boolean))})),(0,s.SR)(e)&&(c=c.map((t=>(0,o.T)(e,t)))),{datasource:new a.Z(e.datasource).toObject(),force:e.force||!1,queries:c,form_data:e,result_format:e.result_format||"json",result_type:e.result_type||"full"}}},65946:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(62446),a=r(46306),o=r(78483);function s(e){let t=e;return e.includes("--")&&(t=`${e}\n`),`(${t})`}var i=r(69363),l=r(5364),c=r(37731);function d(e,t){var r,d;const{annotation_layers:u=[],extra_form_data:p,time_range:m,since:_,until:h,row_limit:f,row_offset:E,order_desc:y,limit:g,timeseries_limit_metric:T,granularity:v,url_params:R={},custom_params:b={},series_columns:S,series_limit:A,series_limit_metric:O,...I}=e,{adhoc_filters:C=[],filters:D=[],custom_form_data:N={},...w}=p||{},L=Number(f),q=Number(E),{metrics:x,columns:U,orderby:Z}=(0,i.Z)(I,t),P=function(e){const t={},r=[],n={},a={filters:r,extras:n,applied_time_extras:t},o={__time_range:"time_range",__time_col:"granularity_sqla",__time_grain:"time_grain_sqla",__granularity:"granularity"};return(e.extra_filters||[]).forEach((e=>{if(e.col in o){const r=e.col;a[o[r]]=e.val,t[r]=e.val}else r.push(e)})),n.time_grain_sqla=a.time_grain_sqla||e.time_grain_sqla,a.granularity=a.granularity_sqla||e.granularity||e.granularity_sqla,delete a.granularity_sqla,delete a.time_grain_sqla,a}(e),{filters:M}=P,F={filters:[...M,...D],adhoc_filters:[...e.adhoc_filters||[],...C]},k=function(e){const{adhoc_filters:t,extras:r={},filters:n=[],where:i}=e,l=n,c=[];i&&c.push(i);const d=[];return(t||[]).forEach((e=>{const{clause:t}=e;if((0,a.Ki)(e)){const r=(0,o.Z)(e);"WHERE"===t&&l.push(r)}else{const{sqlExpression:r}=e;"WHERE"===t?c.push(r):d.push(r)}})),r.having=d.map(s).join(" AND "),r.where=c.map(s).join(" AND "),{filters:l,extras:r}}({...e,...P,...F});let Q={time_range:m||void 0,since:_||void 0,until:h||void 0,granularity:v||void 0,...P,...k,columns:U,metrics:x,orderby:Z,annotation_layers:u,row_limit:null==f||Number.isNaN(L)?void 0:L,row_offset:null==E||Number.isNaN(q)?void 0:q,series_columns:S,series_limit:null!=A?A:(0,c.Z)(g)?Number(g):0,series_limit_metric:null!=(r=null!=(d=(e=>{if((0,n.I0)(e))return e})(O))?d:T)?r:void 0,order_desc:void 0===y||y,url_params:R||void 0,custom_params:b};return Q=function(e,t){const r={...e},{extras:n={}}=r;return Object.entries(l.gn).forEach((([e,n])=>{const a=t[e];void 0!==a&&(r[n]=a)})),l.fn.forEach((e=>{e in t&&(n[e]=t[e])})),Object.keys(n).length>0&&(r.extras=n),r}(Q,w),{...Q,custom_form_data:N}}},5364:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,Ci:()=>s,NU:()=>l,W3:()=>n,fn:()=>o,gn:()=>i,vM:()=>a});const n="__timestamp",a="No filter",o=["relative_start","relative_end","time_grain_sqla"],s=["adhoc_filters","filters","interactive_groupby","interactive_highlight","interactive_drilldown","custom_form_data"],i={granularity:"granularity",granularity_sqla:"granularity",time_column:"time_column",time_grain:"time_grain",time_range:"time_range"},l=Object.keys(i),c=[...l,...o]},78483:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(46306);function a(e){const{subject:t}=e;if((0,n._l)(e)){const{operator:r}=e;return{col:t,op:r}}if((0,n.kC)(e)){const{operator:r}=e;return{col:t,op:r,val:e.comparator}}const{operator:r}=e;return{col:t,op:r,val:e.comparator}}},69363:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(61988),a=r(74765),o=r(10581),s=r(56652),i=r(20620);function l(e,t){const r={metric:"metrics",metric_2:"metrics",secondary_metric:"metrics",x:"metrics",y:"metrics",size:"metrics",all_columns:"columns",series:"groupby",order_by_cols:"orderby",...t},{query_mode:l,...c}=e;let d=[],u=[],p=[];return Object.entries(c).forEach((([e,t])=>{if(null==t)return;let n=r[e]||e;l===i.n.Aggregate&&"columns"===n||(l!==i.n.Raw||"groupby"!==n&&"metrics"!==n)&&("groupby"===n&&(n="columns"),"metrics"===n?u=u.concat(t):"columns"===n?d=d.concat(t):"orderby"===n&&(p=p.concat(t)))})),{columns:(0,a.Z)(d.filter((e=>""!==e)),o.Z),metrics:l===i.n.Raw?void 0:(0,a.Z)(u,s.Z),orderby:p.length>0?p.map((e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){throw new Error((0,n.t)("Found invalid orderby options"))}return e})):void 0}}},10581:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(72813);function a(e){return(0,n.s9)(e)?e:null!=e&&e.label?e.label:null==e?void 0:e.sqlExpression}},56652:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(62446);function a(e){return(0,n.AG)(e)?e:e.label?e.label:(0,n.nX)(e)?`${e.aggregate}(${e.column.columnName||e.column.column_name})`:e.sqlExpression}},11146:(e,t,r)=>{"use strict";r.d(t,{Bw:()=>i,M8:()=>l,SR:()=>s});var n=r(72813),a=r(5364),o=r(10581);const s=e=>(0,n.Gk)(e.x_axis),i=e=>{if(e.granularity_sqla||e.x_axis)return s(e)?e.x_axis:a.W3},l=e=>{const t=i(e);if(t)return(0,o.Z)(t)}},78444:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var n=r(57557),a=r.n(n),o=r(72813),s=r(11146);function i(e,t){if(!(0,s.SR)(e))return t;const{columns:r,extras:n}=t,i=[...r||[]],l=null==r?void 0:r.findIndex((t=>(0,o.s9)(t)&&(0,o.s9)(e.x_axis)&&t===e.x_axis||(0,o.GA)(t)&&(0,o.GA)(e.x_axis)&&t.sqlExpression===e.x_axis.sqlExpression));if(void 0!==l&&l>-1&&e.x_axis&&Array.isArray(r)){(0,o.GA)(r[l])?i[l]={timeGrain:null==n?void 0:n.time_grain_sqla,columnType:"BASE_AXIS",...r[l]}:i[l]={timeGrain:null==n?void 0:n.time_grain_sqla,columnType:"BASE_AXIS",sqlExpression:e.x_axis,label:e.x_axis,expressionType:"SQL"};const s=a()(t,["is_timeseries"]);return s.columns=i,s}return t}},62363:(e,t,r)=>{"use strict";var n,a;r.d(t,{ZP:()=>o,su:()=>n,wj:()=>a}),function(e){e.Mean="mean",e.Sum="sum",e.Std="std",e.Cumsum="cumsum"}(n||(n={})),function(e){e.Values="values",e.Difference="difference",e.Percentage="percentage",e.Ratio="ratio"}(a||(a={}));const o={}},72813:(e,t,r)=>{"use strict";function n(e){return"string"==typeof e}function a(e){return"string"!=typeof e&&void 0!==(null==e?void 0:e.sqlExpression)&&void 0!==(null==e?void 0:e.label)&&(void 0===(null==e?void 0:e.expressionType)||"SQL"===(null==e?void 0:e.expressionType))}function o(e){return n(e)||a(e)}r.d(t,{GA:()=>a,Gk:()=>o,ZP:()=>s,s9:()=>n});const s={}},10916:(e,t,r)=>{"use strict";var n,a;function o(e){return e.type===n.NativeFilter}function s(e){var t,r;return o(e)&&(null==(t=e.dataMask)||null==(r=t.filterState)?void 0:r.value)}function i(e){return e.type===n.Divider}r.d(t,{BE:()=>n,S0:()=>s,ZP:()=>l,gT:()=>a,kI:()=>o,nY:()=>i}),function(e){e.NativeFilter="NATIVE_FILTER",e.Divider="DIVIDER"}(n||(n={})),function(e){e.NativeFilters="nativeFilters",e.CrossFilters="crossFilters"}(a||(a={}));const l={}},46078:(e,t,r)=>{"use strict";var n;r.d(t,{BH:()=>a,ZP:()=>o,i9:()=>n}),function(e){e.Table="table",e.Query="query",e.Dataset="dataset",e.SlTable="sl_table",e.SavedQuery="saved_query"}(n||(n={}));const a=[{metric_name:"COUNT(*)",expression:"COUNT(*)"}],o={}},46306:(e,t,r)=>{"use strict";r.d(t,{Ki:()=>a,VK:()=>l,_l:()=>s,jz:()=>o,kC:()=>i});var n=r(31612);function a(e){return"SIMPLE"===e.expressionType}function o(e){return"SQL"===e.expressionType}function s(e){return(0,n.CW)(e.operator)}function i(e){return(0,n.VU)(e.operator)}function l(e){return(0,n.XA)(e.operator)}},62446:(e,t,r)=>{"use strict";function n(e){return"string"==typeof e}function a(e){return"string"!=typeof e&&"SIMPLE"===(null==e?void 0:e.expressionType)}function o(e){return"string"!=typeof e&&"SQL"===(null==e?void 0:e.expressionType)}function s(e){return n(e)||a(e)||o(e)}r.d(t,{AG:()=>n,I0:()=>s,ZP:()=>i,nX:()=>a,q5:()=>o});const i={}},31612:(e,t,r)=>{"use strict";r.d(t,{CW:()=>a,VU:()=>s,XA:()=>l});const n=new Set(["IS NOT NULL","IS NULL"]);function a(e){return n.has(e)}const o=new Set(["==","!=",">","<",">=","<=","ILIKE","LIKE","REGEX","TEMPORAL_RANGE"]);function s(e){return o.has(e)}const i=new Set(["IN","NOT IN"]);function l(e){return i.has(e)}},43716:(e,t,r)=>{"use strict";r.d(t,{C5:()=>o,Qn:()=>d,Tb:()=>i,WN:()=>s,YC:()=>m,ZP:()=>_,eh:()=>u,pY:()=>p,sn:()=>l,yv:()=>c});var n=r(46078),a=r(88889);const o={FRONTEND_CSRF_ERROR:"FRONTEND_CSRF_ERROR",FRONTEND_NETWORK_ERROR:"FRONTEND_NETWORK_ERROR",FRONTEND_TIMEOUT_ERROR:"FRONTEND_TIMEOUT_ERROR",GENERIC_DB_ENGINE_ERROR:"GENERIC_DB_ENGINE_ERROR",COLUMN_DOES_NOT_EXIST_ERROR:"COLUMN_DOES_NOT_EXIST_ERROR",TABLE_DOES_NOT_EXIST_ERROR:"TABLE_DOES_NOT_EXIST_ERROR",SCHEMA_DOES_NOT_EXIST_ERROR:"SCHEMA_DOES_NOT_EXIST_ERROR",CONNECTION_INVALID_USERNAME_ERROR:"CONNECTION_INVALID_USERNAME_ERROR",CONNECTION_INVALID_PASSWORD_ERROR:"CONNECTION_INVALID_PASSWORD_ERROR",CONNECTION_INVALID_HOSTNAME_ERROR:"CONNECTION_INVALID_HOSTNAME_ERROR",CONNECTION_PORT_CLOSED_ERROR:"CONNECTION_PORT_CLOSED_ERROR",CONNECTION_INVALID_PORT_ERROR:"CONNECTION_INVALID_PORT_ERROR",CONNECTION_HOST_DOWN_ERROR:"CONNECTION_HOST_DOWN_ERROR",CONNECTION_ACCESS_DENIED_ERROR:"CONNECTION_ACCESS_DENIED_ERROR",CONNECTION_UNKNOWN_DATABASE_ERROR:"CONNECTION_UNKNOWN_DATABASE_ERROR",CONNECTION_DATABASE_PERMISSIONS_ERROR:"CONNECTION_DATABASE_PERMISSIONS_ERROR",CONNECTION_MISSING_PARAMETERS_ERRORS:"CONNECTION_MISSING_PARAMETERS_ERRORS",OBJECT_DOES_NOT_EXIST_ERROR:"OBJECT_DOES_NOT_EXIST_ERROR",SYNTAX_ERROR:"SYNTAX_ERROR",VIZ_GET_DF_ERROR:"VIZ_GET_DF_ERROR",UNKNOWN_DATASOURCE_TYPE_ERROR:"UNKNOWN_DATASOURCE_TYPE_ERROR",FAILED_FETCHING_DATASOURCE_INFO_ERROR:"FAILED_FETCHING_DATASOURCE_INFO_ERROR",TABLE_SECURITY_ACCESS_ERROR:"TABLE_SECURITY_ACCESS_ERROR",DATASOURCE_SECURITY_ACCESS_ERROR:"DATASOURCE_SECURITY_ACCESS_ERROR",DATABASE_SECURITY_ACCESS_ERROR:"DATABASE_SECURITY_ACCESS_ERROR",QUERY_SECURITY_ACCESS_ERROR:"QUERY_SECURITY_ACCESS_ERROR",MISSING_OWNERSHIP_ERROR:"MISSING_OWNERSHIP_ERROR",BACKEND_TIMEOUT_ERROR:"BACKEND_TIMEOUT_ERROR",DATABASE_NOT_FOUND_ERROR:"DATABASE_NOT_FOUND_ERROR",MISSING_TEMPLATE_PARAMS_ERROR:"MISSING_TEMPLATE_PARAMS_ERROR",INVALID_TEMPLATE_PARAMS_ERROR:"INVALID_TEMPLATE_PARAMS_ERROR",RESULTS_BACKEND_NOT_CONFIGURED_ERROR:"RESULTS_BACKEND_NOT_CONFIGURED_ERROR",DML_NOT_ALLOWED_ERROR:"DML_NOT_ALLOWED_ERROR",INVALID_CTAS_QUERY_ERROR:"INVALID_CTAS_QUERY_ERROR",INVALID_CVAS_QUERY_ERROR:"INVALID_CVAS_QUERY_ERROR",SQLLAB_TIMEOUT_ERROR:"SQLLAB_TIMEOUT_ERROR",RESULTS_BACKEND_ERROR:"RESULTS_BACKEND_ERROR",ASYNC_WORKERS_ERROR:"ASYNC_WORKERS_ERROR",GENERIC_COMMAND_ERROR:"GENERIC_COMMAND_ERROR",GENERIC_BACKEND_ERROR:"GENERIC_BACKEND_ERROR",INVALID_PAYLOAD_FORMAT_ERROR:"INVALID_PAYLOAD_FORMAT_ERROR",INVALID_PAYLOAD_SCHEMA_ERROR:"INVALID_PAYLOAD_SCHEMA_ERROR"},s={TABLE:"TABLE",VIEW:"VIEW"};var i;!function(e){e.Started="started",e.Stopped="stopped",e.Failed="failed",e.Pending="pending",e.Running="running",e.Scheduled="scheduled",e.Success="success",e.Fetching="fetching",e.TimedOut="timed_out"}(i||(i={}));const l=[i.Running,i.Started,i.Pending,i.Fetching,i.Scheduled],c=[i.Stopped,i.Failed,i.Success,i.TimedOut],d={id:"clientId2353",dbId:1,sql:"SELECT * FROM something",sqlEditorId:"dfsadfs",tab:"unimportant",tempTable:"",ctas:!1,cached:!1,errorMessage:null,extra:{progress:null},isDataPreview:!1,progress:0,resultsKey:null,state:i.Success,tempSchema:null,trackingUrl:null,templateParams:null,rows:42,queryLimit:100,limitingFactor:"",endDttm:1476910579693,duration:"",startDttm:1476910566092.96,time:{},user:{},userId:1,db:{},started:"",querylink:{},queryId:1,executedSql:"",output:"",actions:{},type:n.i9.Query,columns:[{column_name:"Column 1",type:"STRING",is_dttm:!1,type_generic:a.Z.String},{column_name:"Column 3",type:"STRING",is_dttm:!1,type_generic:a.Z.String},{column_name:"Column 2",type:"TIMESTAMP",is_dttm:!0,type_generic:a.Z.Temporal}]},u={results:{displayLimitReached:!1,columns:[{column_name:"Column 1",type:"STRING",type_generic:a.Z.String,is_dttm:!1},{column_name:"Column 3",type:"STRING",type_generic:a.Z.String,is_dttm:!1},{column_name:"Column 2",type:"TIMESTAMP",type_generic:a.Z.Temporal,is_dttm:!0}],data:[{"Column 1":"a","Column 2":"b","Column 3":"2014-11-11T00:00:00"}],expanded_columns:[],selected_columns:[{column_name:"Column 1",type:"STRING",type_generic:a.Z.String,is_dttm:!1},{column_name:"Column 3",type:"STRING",type_generic:a.Z.String,is_dttm:!1},{column_name:"Column 2",type:"TIMESTAMP",type_generic:a.Z.Temporal,is_dttm:!0}],query:{limit:6}}},p={...d,...u};var m;!function(e){e.Row="row",e.Column="column"}(m||(m={}));const _={}},20620:(e,t,r)=>{"use strict";var n;r.d(t,{Z:()=>a,n:()=>n}),function(e){e.Aggregate="aggregate",e.Raw="raw"}(n||(n={}));const a={}},88889:(e,t,r)=>{"use strict";var n;r.d(t,{C:()=>a,Z:()=>n}),function(e){e[e.Numeric=0]="Numeric",e[e.String=1]="String",e[e.Temporal=2]="Temporal",e[e.Boolean=3]="Boolean"}(n||(n={}));const a={}},88484:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a,t:()=>n});const n=/(\d{4}-\d{2}-\d{2})[\sT](\d{2}:\d{2}:\d{2}\.?\d*).*/;function a(e){const t=e.match(n);return t?`${t[1]}T${t[2]}Z`:e}},75049:(e,t,r)=>{"use strict";r.d(t,{I:()=>s});var n=r(53652),a=r(1875);class o extends n.Z{constructor(...e){super(...e),this.name="ExtensionsRegistry"}}const s=(0,a.Z)(o,{})},55786:(e,t,r)=>{"use strict";function n(e){return null==e?[]:Array.isArray(e)?e:[e]}r.d(t,{Z:()=>n})},37731:(e,t,r)=>{"use strict";function n(e){return null!=e}r.d(t,{Z:()=>n})},74765:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function(e,t){if(t){const r=new Set;return e.filter((e=>{const n=t(e);return!r.has(n)&&(r.add(n),!0)}))}return[...new Set(e)]}},75294:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(61988);function a(e){return!(!e||!Number.isNaN(Number(e))&&parseInt(e,10)===Number(e))&&(0,n.t)("is expected to be an integer")}},74029:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(61988);function a(e,t){return Number(e)>+t&&(0,n.t)("Value cannot exceed %s",t)}},95826:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(61988);function a(e){return!!(null==e||""===e||Array.isArray(e)&&0===e.length)&&(0,n.t)("cannot be empty")}},43693:(e,t,r)=>{"use strict";r.d(t,{Z:()=>_,V:()=>m});var n=r(67294),a=r(28216),o=r(68492),s=r(35937),i=r.n(s),l=r(28241);const c=r(10362).h.injectEndpoints({endpoints:e=>({updateSqlEditorTab:e.mutation({query:({queryEditor:{version:e=l.o7,id:t,dbId:r,schema:n,queryLimit:a,sql:o,name:s,latestQueryId:c,hideLeftBar:d,templateParams:u,autorun:p,updatedAt:m},extra:_})=>({method:"PUT",endpoint:encodeURI(`/tabstateview/${t}`),postPayload:i()({database_id:r,schema:n,sql:o,label:s,query_limit:a,latest_query_id:c,template_params:u,hide_left_bar:d,autorun:p,extra_json:JSON.stringify({updatedAt:m,version:e,..._})},(e=>void 0!==e))})})})}),{useUpdateSqlEditorTabMutation:d}=c;var u=r(74004),p=r(11409);function m(e,t,r){return e.map((e=>({...e,...t.id===e.id&&t}))).filter((e=>function(e,t){return e.inLocalStorage||e.updatedAt&&e.updatedAt>t}(e,r)))}const _=()=>{const e=(0,a.v9)((e=>e.sqlLab.queryEditors)),t=(0,a.v9)((e=>e.sqlLab.unsavedQueryEditor)),r=(0,a.v9)((e=>e.sqlLab.editorTabLastUpdatedAt)),s=(0,a.I0)(),i=(0,n.useRef)(r),[l,{error:c}]=d(),_=(0,u.n)(t,5e3);return(0,n.useEffect)((()=>{const t=m(e,_,i.current);Promise.all(t.filter((({inLocalStorage:e})=>!e)).map((e=>l({queryEditor:e})))).then((e=>{e.some((e=>"error"in e))||(i.current=Date.now(),s((0,p.setEditorTabLastUpdate)(i.current)))}))}),[_,s,e,l]),(0,n.useEffect)((()=>{c&&o.Z.warn("An error occurred while saving your editor state.",c)}),[s,c]),null}},44904:(e,t,r)=>{"use strict";r.d(t,{Em:()=>s,GJ:()=>O,IY:()=>a,N2:()=>S,OI:()=>D,TU:()=>g,U$:()=>T,Yn:()=>A,Yo:()=>y,b$:()=>v,bR:()=>i,eU:()=>l,ev:()=>c,fM:()=>h,hC:()=>f,iJ:()=>I,lV:()=>_,lr:()=>C,oN:()=>m,rD:()=>b,rP:()=>u,rp:()=>d,uC:()=>o,xj:()=>p,zY:()=>E,zf:()=>R});var n=r(61988);const a={offline:"danger",failed:"danger",pending:"info",fetching:"info",running:"warning",stopped:"danger",success:"success"},o={offline:(0,n.t)("offline"),failed:(0,n.t)("failed"),pending:(0,n.t)("pending"),fetching:(0,n.t)("fetching"),running:(0,n.t)("running"),stopped:(0,n.t)("stopped"),success:(0,n.t)("success")},s={success:"success",failed:"failed",running:"running",offline:"offline",pending:"pending"},i={success:(0,n.t)("success"),failed:(0,n.t)("failed"),running:(0,n.t)("running"),offline:(0,n.t)("offline"),pending:(0,n.t)("pending")},l=5,c=3,d=51,u=400,p=10,m=30,_=70,h=2e3,f=600,E=100,y=1024,g=2,T=864e5,v=5120,R=1024,b=.9,S=8e3,A=100,O=90,I=60,C=55,D=50},36627:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(61988),a=r(28241);function o(e){return e.reduce(((e,t)=>e.slice(-1)[0]===t?e:e.concat(t)),[])}function s({common:e,active_tab:t,tab_state_ids:r=[],databases:s,queries:i,...l}){let c={};const d={version:a.o7,loaded:!0,name:(0,n.t)("Untitled query"),sql:"",latestQueryId:null,autorun:!1,dbId:e.conf.SQLLAB_DEFAULT_DBID,queryLimit:e.conf.DEFAULT_SQLLAB_LIMIT,hideLeftBar:!1,remoteId:null,cursorPosition:{row:0,column:0}};let u={};r.forEach((({id:e,label:r})=>{let n;var o,s,i,l;n=t&&t.id===e?{version:null!=(o=null==(s=t.extra_json)?void 0:s.version)?o:a.$I.V1,id:e.toString(),loaded:!0,name:t.label,sql:t.sql||"",selectedText:void 0,latestQueryId:t.latest_query?t.latest_query.id:null,remoteId:(null==(i=t.saved_query)?void 0:i.id)||null,autorun:Boolean(t.autorun),templateParams:t.template_params||void 0,dbId:t.database_id,schema:t.schema,queryLimit:t.query_limit,hideLeftBar:t.hide_left_bar,updatedAt:null==(l=t.extra_json)?void 0:l.updatedAt}:{...d,id:e.toString(),loaded:!1,name:r,dbId:void 0},c={...c,[n.id]:n}}));const p=t?[t.id.toString()]:[];let m={},_=Date.now();var h;t&&(_=(null==(h=t.extra_json)?void 0:h.updatedAt)||_,t.table_schemas.filter((e=>null!==e.description)).forEach((e=>{const{dataPreviewQueryId:t,...r}=e.description,n={dbId:e.database_id,queryEditorId:e.tab_state_id.toString(),schema:e.schema,name:e.table,expanded:e.expanded,id:e.id,dataPreviewQueryId:t,persistData:r,initialized:!0};m={...m,[n.id]:n}})));const f={...i,...(null==t?void 0:t.latest_query)&&{[t.latest_query.id]:t.latest_query}};try{const e=localStorage.getItem("redux"),t=e?JSON.parse(e):void 0;if(e&&null!=t&&t.sqlLab){const{sqlLab:e}=t;if(0===e.queryEditors.length)localStorage.removeItem("redux");else{u=e.unsavedQueryEditor||u,e.queryEditors.forEach((e=>{var t,r;const n=Boolean(c[e.id]),a=null==(t=c[e.id])?void 0:t.updatedAt,o=e.updatedAt&&(!a||e.updatedAt>a),s=!n||o?e:{};c={...c,[e.id]:{...c[e.id],...s,name:s.title||s.name||(null==(r=c[e.id])?void 0:r.name),...s.id&&u.id===e.id&&u,inLocalStorage:!n,loaded:!0}}}));const t=new Set;e.tables&&(m=e.tables.reduce(((e,r)=>{const n=!t.has(r.queryEditorId);return n&&t.add(r.queryEditorId),{...e,[r.id]:{...m[r.id],...r,expanded:n,inLocalStorage:!0}}}),m)),e.queries&&Object.values(e.queries).forEach((e=>{f[e.id]={...e,inLocalStorage:!0}})),e.tabHistory&&p.push(...e.tabHistory)}}}catch(e){}return{sqlLab:{activeSouthPaneTab:"Results",alerts:[],databases:s,offline:!1,queries:Object.fromEntries(Object.entries(f).map((([e,t])=>[e,{...t,...t.startDttm&&{startDttm:Number(t.startDttm)},...t.endDttm&&{endDttm:Number(t.endDttm)}}]))),queryEditors:Object.values(c),tabHistory:o(p),tables:Object.values(m),queriesLastUpdate:Date.now(),editorTabLastUpdatedAt:_,queryCostEstimates:{},unsavedQueryEditor:u},localStorageUsageInKilobytes:0,common:e,...l}}},28241:(e,t,r)=>{"use strict";var n;r.d(t,{$I:()=>n,C9:()=>s,fT:()=>o,o7:()=>a}),function(e){e[e.V1=1]="V1"}(n||(n={}));const a=n.V1;var o;!function(e){e[e.SaveNew=1]="SaveNew",e[e.OverwriteDataset=2]="OverwriteDataset"}(o||(o={}));const s={metrics:[],groupby:[],time_range:"No filter",row_limit:1e3}},82591:(e,t,r)=>{"use strict";r.d(t,{$e:()=>p,NU:()=>d,St:()=>u,uQ:()=>c});var n=r(78718),a=r.n(n),o=r(23936),s=r(44904);const i=new Set(["version","remoteId","autorun","dbId","height","id","latestQueryId","northPercent","queryLimit","schema","selectedText","southPercent","sql","templateParams","name","hideLeftBar"]);function l(e){var t;const{startDttm:r,results:n}=e;return Date.now()-r>s.U$||((null==(t=JSON.stringify(n))?void 0:t.length)||0)*s.TU/s.Yo>s.zf}function c(e){return e.map((e=>a()(e,["id","name","dbId","schema","dataPreviewQueryId","queryEditorId"]))).filter((({queryEditorId:e})=>Boolean(e)))}function d(e){return Object.keys(e).reduce(((t,r)=>{const{results:n}=e[r];return{...t,[r]:{...e[r],results:l(e[r])?{}:n}}}),{})}function u(e){return e.map((e=>Object.keys(e).filter((e=>i.has(e))).reduce(((t,r)=>({...t,[r]:e[r]})),{})))}function p(e,t){t.sqlLab.tables.forEach((({name:t,schema:r,dbId:n,persistData:a})=>{n&&r&&t&&null!=a&&a.columns&&(e(o.$K.upsertQueryData("tableMetadata",{dbId:n,schema:r,table:t},a)),e(o.$K.upsertQueryData("tableExtendedMetadata",{dbId:n,schema:r,table:t},{})))}))}},35932:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(73126),a=r(11965),o=r(67294),s=r(84967),i=r(94184),l=r.n(i),c=r(4715),d=r(51995),u=r(58593);function p(e){const{tooltip:t,placement:r,disabled:i=!1,buttonSize:p,buttonStyle:m,className:_,cta:h,children:f,href:E,showMarginRight:y=!0,...g}=e,T=(0,d.Fg)(),{colors:v,transitionTiming:R,borderRadius:b,typography:S}=T,{primary:A,grayscale:O,success:I,warning:C,error:D}=v;let N=32,w=18;"xsmall"===p?(N=22,w=5):"small"===p&&(N=30,w=10);let L=A.light4,q=(0,s.CD)(.1,A.base,A.light4),x=(0,s.CD)(.25,A.base,A.light4),U=O.light2,Z=A.dark1,P=Z,M=0,F="none",k="transparent",Q="transparent",$="transparent";"primary"===m?(L=A.base,q=A.dark1,x=(0,s.CD)(.2,O.dark2,A.dark1),Z=O.light5,P=Z):"tertiary"===m||"dashed"===m?(L=O.light5,q=O.light5,x=O.light5,U=O.light5,M=1,F="dashed"===m?"dashed":"solid",k=A.dark1,Q=A.light1,$=O.light2):"danger"===m?(L=D.base,q=(0,s.CD)(.1,O.light5,D.base),x=(0,s.CD)(.2,O.dark2,D.base),Z=O.light5,P=Z):"warning"===m?(L=C.base,q=(0,s.CD)(.1,O.dark2,C.base),x=(0,s.CD)(.2,O.dark2,C.base),Z=O.light5,P=Z):"success"===m?(L=I.base,q=(0,s.CD)(.1,O.light5,I.base),x=(0,s.CD)(.2,O.dark2,I.base),Z=O.light5,P=Z):"link"===m&&(L="transparent",q="transparent",x="transparent",P=A.base);const Y=f;let B=[];B=Y&&Y.type===o.Fragment?o.Children.toArray(Y.props.children):o.Children.toArray(f);const H=y&&B.length>1?2*T.gridUnit:0,j=(0,a.tZ)(c.C0,(0,n.Z)({href:i?void 0:E,disabled:i,className:l()(_,"superset-button",`superset-button-${m}`,{cta:!!h}),css:(0,a.iv)({display:"inline-flex",alignItems:"center",justifyContent:"center",lineHeight:1.5715,fontSize:S.sizes.s,fontWeight:S.weights.bold,height:N,textTransform:"uppercase",padding:`0px ${w}px`,transition:`all ${R}s`,minWidth:h?36*T.gridUnit:void 0,minHeight:h?8*T.gridUnit:void 0,boxShadow:"none",borderWidth:M,borderStyle:F,borderColor:k,borderRadius:b,color:Z,backgroundColor:L,"&:hover":{color:P,backgroundColor:q,borderColor:Q},"&:active":{color:Z,backgroundColor:x},"&:focus":{color:Z,backgroundColor:L,borderColor:k},"&[disabled], &[disabled]:hover":{color:O.base,backgroundColor:"link"===m?"transparent":U,borderColor:"link"===m?"transparent":$,pointerEvents:"none"},marginLeft:0,"& + .superset-button":{marginLeft:2*T.gridUnit},"& > :first-of-type":{marginRight:H}},"","")},g),f);return t?(0,a.tZ)(u.u,{placement:r,title:t},i?(0,a.tZ)("span",{css:(0,a.iv)({cursor:"not-allowed","& > .superset-button":{marginLeft:2*T.gridUnit}},"","")},j):j):j}},37863:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m,u:()=>p});var n=r(57557),a=r.n(n),o=r(61988),s=r(4305),i=r(50810),l=r(10331),c=r(76445),d=r(44814),u=r(52256);const p={id:0,chartAlert:null,chartStatus:"loading",chartStackTrace:null,chartUpdateEndTime:null,chartUpdateStartTime:0,latestQueryFormData:{},sliceFormData:null,queryController:null,queriesResponse:null,triggerQuery:!0,lastRendered:0};function m(e={},t){const r={[u.ADD_CHART]:()=>({...p,...t.chart}),[u.CHART_UPDATE_SUCCEEDED]:e=>({...e,chartStatus:"success",chartAlert:null,queriesResponse:t.queriesResponse,chartUpdateEndTime:(0,d.zO)()}),[u.CHART_UPDATE_STARTED]:e=>({...e,chartStatus:"loading",chartStackTrace:null,chartAlert:null,chartUpdateEndTime:null,chartUpdateStartTime:(0,d.zO)(),queryController:t.queryController}),[u.CHART_UPDATE_STOPPED]:e=>({...e,chartStatus:"stopped",chartAlert:(0,o.t)("Updating chart was stopped"),chartUpdateEndTime:(0,d.zO)()}),[u.CHART_RENDERING_SUCCEEDED]:e=>({...e,chartStatus:"rendered",chartUpdateEndTime:(0,d.zO)()}),[u.CHART_RENDERING_FAILED]:e=>({...e,chartStatus:"failed",chartStackTrace:t.stackTrace,chartAlert:(0,o.t)("An error occurred while rendering the visualization: %s",t.error)}),[u.CHART_UPDATE_FAILED](e){var r,n,a,s;return{...e,chartStatus:"failed",chartAlert:t.queriesResponse?null==(r=t.queriesResponse)||null==(n=r[0])?void 0:n.error:(0,o.t)("Network error."),chartUpdateEndTime:(0,d.zO)(),queriesResponse:t.queriesResponse,chartStackTrace:t.queriesResponse?null==(a=t.queriesResponse)||null==(s=a[0])?void 0:s.stacktrace:null}},[u.DYNAMIC_PLUGIN_CONTROLS_READY]:e=>({...e,sliceFormData:(0,l.Hu)(t.controlsState)}),[u.TRIGGER_QUERY]:e=>({...e,triggerQuery:t.value,chartStatus:"loading"}),[u.RENDER_TRIGGERED]:e=>({...e,lastRendered:t.value}),[u.UPDATE_QUERY_FORM_DATA]:e=>({...e,latestQueryFormData:t.value}),[u.ANNOTATION_QUERY_STARTED](e){var r;null!=(r=e.annotationQuery)&&r[t.annotation.name]&&e.annotationQuery[t.annotation.name].abort();const n={...e.annotationQuery,[t.annotation.name]:t.queryController};return{...e,annotationQuery:n}},[u.ANNOTATION_QUERY_SUCCESS](e){const r={...e.annotationData,[t.annotation.name]:t.queryResponse.data},n={...e.annotationError};delete n[t.annotation.name];const a={...e.annotationQuery};return delete a[t.annotation.name],{...e,annotationData:r,annotationError:n,annotationQuery:a}},[u.ANNOTATION_QUERY_FAILED](e){const r={...e.annotationData};delete r[t.annotation.name];const n={...e.annotationError,[t.annotation.name]:t.queryResponse?t.queryResponse.error:(0,o.t)("Network error.")},a={...e.annotationQuery};return delete a[t.annotation.name],{...e,annotationData:r,annotationError:n,annotationQuery:a}}};if(t.type===u.REMOVE_CHART)return a()(e,[t.key]);if(t.type===u.UPDATE_CHART_ID){const{newId:r,key:n}=t;return e[r]={...e[n],id:r},delete e[n],e}return t.type===s.$||t.type===c._?{...t.data.charts}:t.type===i.Rn.SetDatasources?Object.fromEntries(Object.entries(e).map((([e,t])=>[e,"failed"===t.chartStatus&&t.chartStackTrace?{...t,chartStatus:"",chartStackTrace:null,chartAlert:null}:t]))):t.type in r?{...e,[t.key]:r[t.type](e[t.key])}:e}},91178:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(67294),a=r(51995),o=r(61988),s=r(54076),i=r(74069),l=r(35932),c=r(71894),d=r(13322),u=r(13433),p=r(11965);const m=a.iK.div`
  align-items: center;
  background-color: ${({level:e,theme:t})=>t.colors[e].light2};
  border-radius: ${({theme:e})=>e.borderRadius}px;
  border: 1px solid ${({level:e,theme:t})=>t.colors[e].base};
  color: ${({level:e,theme:t})=>t.colors[e].dark2};
  padding: ${({theme:e})=>2*e.gridUnit}px;
  width: 100%;

  .top-row {
    display: flex;
    justify-content: space-between;
  }

  .error-body {
    padding-top: ${({theme:e})=>e.gridUnit}px;
    padding-left: ${({theme:e})=>8*e.gridUnit}px;
  }

  .icon {
    margin-right: ${({theme:e})=>2*e.gridUnit}px;
  }

  .link {
    color: ${({level:e,theme:t})=>t.colors[e].dark2};
    text-decoration: underline;
  }
`,_=(0,a.iK)(i.default)`
  color: ${({level:e,theme:t})=>t.colors[e].dark2};
  overflow-wrap: break-word;

  .ant-modal-header {
    background-color: ${({level:e,theme:t})=>t.colors[e].light2};
    padding: ${({theme:e})=>4*e.gridUnit}px;
  }

  .icon {
    margin-right: ${({theme:e})=>2*e.gridUnit}px;
  }

  .header {
    display: flex;
    align-items: center;
    font-size: ${({theme:e})=>e.typography.sizes.l}px;
  }
`,h=a.iK.div`
  align-items: center;
  display: flex;
`;function f({body:e,copyText:t,level:r="error",source:i="dashboard",subtitle:f,title:E,description:y}){const g=(0,a.Fg)(),[T,v]=(0,n.useState)(!1),[R,b]=(0,n.useState)((0,c.b)()),S=(0,c.b)()||["explore","sqllab"].includes(i),A=g.colors[r].base;return(0,p.tZ)(m,{level:r,role:"alert"},(0,p.tZ)("div",{className:"top-row"},(0,p.tZ)(h,null,"error"===r?(0,p.tZ)(d.Z.ErrorSolid,{className:"icon",iconColor:A}):(0,p.tZ)(d.Z.WarningSolid,{className:"icon",iconColor:A}),(0,p.tZ)("strong",null,E)),!S&&!y&&(0,p.tZ)("span",{role:"button",tabIndex:0,className:"link",onClick:()=>v(!0)},(0,o.t)("See more"))),y&&(0,p.tZ)("div",{className:"error-body"},(0,p.tZ)("p",null,y),!S&&(0,p.tZ)("span",{role:"button",tabIndex:0,className:"link",onClick:()=>v(!0)},(0,o.t)("See more"))),S?(0,p.tZ)("div",{className:"error-body"},(0,p.tZ)("p",null,f),e&&(0,p.tZ)(n.Fragment,null,!R&&(0,p.tZ)("span",{role:"button",tabIndex:0,className:"link",onClick:()=>b(!0)},(0,o.t)("See more")),R&&(0,p.tZ)(n.Fragment,null,(0,p.tZ)("br",null),e,(0,p.tZ)("span",{role:"button",tabIndex:0,className:"link",onClick:()=>b(!1)},(0,o.t)("See less"))))):(0,p.tZ)(_,{level:r,show:T,onHide:()=>v(!1),destroyOnClose:!0,title:(0,p.tZ)("div",{className:"header"},"error"===r?(0,p.tZ)(d.Z.ErrorSolid,{className:"icon",iconColor:A}):(0,p.tZ)(d.Z.WarningSolid,{className:"icon",iconColor:A}),(0,p.tZ)("div",{className:"title"},E)),footer:(0,p.tZ)(n.Fragment,null,t&&(0,p.tZ)(u.Z,{text:t,shouldShowText:!1,wrapped:!1,copyNode:(0,p.tZ)(l.Z,{onClick:s.EI},(0,o.t)("Copy message"))}),(0,p.tZ)(l.Z,{cta:!0,buttonStyle:"primary",onClick:()=>v(!1)},(0,o.t)("Close")))},(0,p.tZ)(n.Fragment,null,(0,p.tZ)("p",null,f),f&&e&&(0,p.tZ)("br",null),e)))}},72875:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(67294),a=r(61988),o=r(92869),s=r(91178),i=r(11965);const l=(0,a.t)("Unexpected error");function c({title:e=l,error:t,subtitle:r,copyText:a,link:c,stackTrace:d,source:u,description:p,fallback:m}){if(t){const e=(0,o.Z)().get(t.error_type);if(e)return(0,i.tZ)(e,{error:t,source:u,subtitle:r})}return m?(0,i.tZ)(n.Fragment,null,m):(0,i.tZ)(s.Z,{level:"warning",title:e,subtitle:r,copyText:a,description:p,source:u,body:c||d?(0,i.tZ)(n.Fragment,null,c&&(0,i.tZ)("a",{href:c,target:"_blank",rel:"noopener noreferrer"},"(Request Access)"),(0,i.tZ)("br",null),d&&(0,i.tZ)("pre",null,d)):void 0})}},92869:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(90537),a=r(1875);class o extends n.Z{constructor(){super({name:"ErrorMessageComponent",overwritePolicy:n.r.Allow})}}const s=(0,a.Z)(o)},67663:(e,t,r)=>{"use strict";r.d(t,{C:()=>n});const n={FRONTEND_CSRF_ERROR:"FRONTEND_CSRF_ERROR",FRONTEND_NETWORK_ERROR:"FRONTEND_NETWORK_ERROR",FRONTEND_TIMEOUT_ERROR:"FRONTEND_TIMEOUT_ERROR",GENERIC_DB_ENGINE_ERROR:"GENERIC_DB_ENGINE_ERROR",COLUMN_DOES_NOT_EXIST_ERROR:"COLUMN_DOES_NOT_EXIST_ERROR",TABLE_DOES_NOT_EXIST_ERROR:"TABLE_DOES_NOT_EXIST_ERROR",SCHEMA_DOES_NOT_EXIST_ERROR:"SCHEMA_DOES_NOT_EXIST_ERROR",CONNECTION_INVALID_USERNAME_ERROR:"CONNECTION_INVALID_USERNAME_ERROR",CONNECTION_INVALID_PASSWORD_ERROR:"CONNECTION_INVALID_PASSWORD_ERROR",CONNECTION_INVALID_HOSTNAME_ERROR:"CONNECTION_INVALID_HOSTNAME_ERROR",CONNECTION_PORT_CLOSED_ERROR:"CONNECTION_PORT_CLOSED_ERROR",CONNECTION_INVALID_PORT_ERROR:"CONNECTION_INVALID_PORT_ERROR",CONNECTION_HOST_DOWN_ERROR:"CONNECTION_HOST_DOWN_ERROR",CONNECTION_ACCESS_DENIED_ERROR:"CONNECTION_ACCESS_DENIED_ERROR",CONNECTION_UNKNOWN_DATABASE_ERROR:"CONNECTION_UNKNOWN_DATABASE_ERROR",CONNECTION_DATABASE_PERMISSIONS_ERROR:"CONNECTION_DATABASE_PERMISSIONS_ERROR",CONNECTION_MISSING_PARAMETERS_ERRORS:"CONNECTION_MISSING_PARAMETERS_ERRORS",OBJECT_DOES_NOT_EXIST_ERROR:"OBJECT_DOES_NOT_EXIST_ERROR",SYNTAX_ERROR:"SYNTAX_ERROR",VIZ_GET_DF_ERROR:"VIZ_GET_DF_ERROR",UNKNOWN_DATASOURCE_TYPE_ERROR:"UNKNOWN_DATASOURCE_TYPE_ERROR",FAILED_FETCHING_DATASOURCE_INFO_ERROR:"FAILED_FETCHING_DATASOURCE_INFO_ERROR",TABLE_SECURITY_ACCESS_ERROR:"TABLE_SECURITY_ACCESS_ERROR",DATASOURCE_SECURITY_ACCESS_ERROR:"DATASOURCE_SECURITY_ACCESS_ERROR",DATABASE_SECURITY_ACCESS_ERROR:"DATABASE_SECURITY_ACCESS_ERROR",QUERY_SECURITY_ACCESS_ERROR:"QUERY_SECURITY_ACCESS_ERROR",MISSING_OWNERSHIP_ERROR:"MISSING_OWNERSHIP_ERROR",DASHBOARD_SECURITY_ACCESS_ERROR:"DASHBOARD_SECURITY_ACCESS_ERROR",BACKEND_TIMEOUT_ERROR:"BACKEND_TIMEOUT_ERROR",DATABASE_NOT_FOUND_ERROR:"DATABASE_NOT_FOUND_ERROR",MISSING_TEMPLATE_PARAMS_ERROR:"MISSING_TEMPLATE_PARAMS_ERROR",INVALID_TEMPLATE_PARAMS_ERROR:"INVALID_TEMPLATE_PARAMS_ERROR",RESULTS_BACKEND_NOT_CONFIGURED_ERROR:"RESULTS_BACKEND_NOT_CONFIGURED_ERROR",DML_NOT_ALLOWED_ERROR:"DML_NOT_ALLOWED_ERROR",INVALID_CTAS_QUERY_ERROR:"INVALID_CTAS_QUERY_ERROR",INVALID_CVAS_QUERY_ERROR:"INVALID_CVAS_QUERY_ERROR",SQLLAB_TIMEOUT_ERROR:"SQLLAB_TIMEOUT_ERROR",RESULTS_BACKEND_ERROR:"RESULTS_BACKEND_ERROR",ASYNC_WORKERS_ERROR:"ASYNC_WORKERS_ERROR",GENERIC_COMMAND_ERROR:"GENERIC_COMMAND_ERROR",GENERIC_BACKEND_ERROR:"GENERIC_BACKEND_ERROR",INVALID_PAYLOAD_FORMAT_ERROR:"INVALID_PAYLOAD_FORMAT_ERROR",INVALID_PAYLOAD_SCHEMA_ERROR:"INVALID_PAYLOAD_SCHEMA_ERROR",MARSHMALLOW_ERROR:"MARSHMALLOW_ERROR"}},13322:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var n=r(73126),a=r(18029),o=r.n(a),s=r(67294),i=r(62816),l=r(16165),c=r(51995);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d.apply(this,arguments)}const u=({title:e,titleId:t,...r},n)=>s.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:n,"aria-labelledby":t},r)),p=(0,s.forwardRef)(u);var m=r(11965);const _=(0,c.iK)((({iconColor:e,iconSize:t,viewBox:r,...a})=>(0,m.tZ)(l.Z,(0,n.Z)({viewBox:r||"0 0 24 24"},a))))`
  ${({iconColor:e})=>e&&`color: ${e};`};
  font-size: ${({iconSize:e,theme:t})=>e?`${t.typography.sizes[e]||t.typography.sizes.m}px`:"24px"};
`,h=e=>{const{fileName:t,...a}=e,[,o]=(0,s.useState)(!1),i=(0,s.useRef)(),l=t.replace("_","-");return(0,s.useEffect)((()=>{let e=!1;return async function(){i.current=(await r(69233)(`./${t}.svg`)).default,e||o(!0)}(),()=>{e=!0}}),[t,i]),(0,m.tZ)(_,(0,n.Z)({component:i.current||p,"aria-label":l},a))},f=Object.keys(i).filter((e=>!e.includes("TwoTone"))).map((e=>({[e]:t=>(0,m.tZ)(_,(0,n.Z)({component:i[e]},t))}))).reduce(((e,t)=>({...e,...t}))),E={};["alert","alert_solid","alert_solid_small","area-chart-tile","bar-chart-tile","big-number-chart-tile","binoculars","bolt","bolt_small","bolt_small_run","calendar","cancel","cancel_solid","cancel-x","card_view","cards","cards_locked","caret_down","caret_left","caret_right","caret_up","certified","check","checkbox-half","checkbox-off","checkbox-on","circle_check","circle_check_solid","circle","clock","close","code","cog","collapse","color_palette","current-rendered-tile","components","copy","cursor_target","database","dataset_physical","dataset_virtual_greyscale","dataset_virtual","download","drag","edit_alt","edit","email","error","error_solid","error_solid_small","exclamation","expand","eye","eye_slash","favorite-selected","favorite_small_selected","favorite-unselected","field_abc","field_boolean","field_date","field_derived","field_num","field_struct","file","filter","filter_small","folder","full","function_x","gear","grid","image","import","info","info-solid","info_solid_small","join","keyboard","layers","lightbulb","line-chart-tile","link","list","list_view","location","lock_locked","lock_unlocked","map","message","minus","minus_solid","more_horiz","more_vert","move","nav_charts","nav_dashboard","nav_data","nav_explore","nav_home","nav_lab","note","offline","paperclip","pie-chart-tile","placeholder","plus","plus_large","plus_small","plus_solid","queued","refresh","running","save","sql","search","server","share","slack","sort_asc","sort_desc","sort","table","table-chart-tile","tag","trash","triangle_change","triangle_down","triangle_up","up-level","user","warning","warning_solid","x-large","x-small","tags","ballot","category","undo","redo"].forEach((e=>{const t=o()(e).replace(/ /g,"");E[t]=t=>(0,m.tZ)(h,(0,n.Z)({fileName:e},t))}));const y={...f,...E}},38703:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c}),r(67294);var n=r(51995),a=r(94184),o=r.n(a),s=r(89419),i=r(11965);const l=n.iK.img`
  z-index: 99;
  width: 50px;
  height: unset;
  position: relative;
  margin: 10px;
  &.inline {
    margin: 0px;
    width: 30px;
  }
  &.inline-centered {
    margin: 0 auto;
    width: 30px;
    display: block;
  }
  &.floating {
    padding: 0;
    margin: 0;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }
`;function c({position:e="floating",image:t,className:r}){return(0,i.tZ)(l,{className:o()("loading",e,r),alt:"Loading...",src:t||s,role:"status","aria-live":"polite","aria-label":"Loading"})}},72570:(e,t,r)=>{"use strict";r.d(t,{Dz:()=>p,Gb:()=>m,K7:()=>l,RS:()=>c,bM:()=>d,h:()=>s,s2:()=>_,ws:()=>u});var n=r(14670),a=r.n(n),o=r(1927);const s="ADD_TOAST";function i({toastType:e,text:t,duration:r=8e3,noDuplicate:n=!1}){return{type:s,payload:{id:(o=e,`${o}-${a().generate()}`),toastType:e,text:t,duration:r,noDuplicate:n}};var o}const l="REMOVE_TOAST";function c(e){return{type:l,payload:{id:e}}}function d(e,t){return i({text:e,toastType:o.p.Info,duration:4e3,...t})}function u(e,t){return i({text:e,toastType:o.p.Success,duration:4e3,...t})}function p(e,t){return i({text:e,toastType:o.p.Warning,duration:6e3,...t})}function m(e,t){return i({text:e,toastType:o.p.Danger,duration:8e3,...t})}const _={addInfoToast:d,addSuccessToast:u,addWarningToast:p,addDangerToast:m}},1927:(e,t,r)=>{"use strict";var n;r.d(t,{p:()=>n}),function(e){e.Info="INFO_TOAST",e.Success="SUCCESS_TOAST",e.Warning="WARNING_TOAST",e.Danger="DANGER_TOAST"}(n||(n={}))},14114:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>l,e1:()=>c});var n=r(67294),a=r(14890),o=r(28216),s=r(72570);const i={addInfoToast:s.bM,addSuccessToast:s.ws,addWarningToast:s.Dz,addDangerToast:s.Gb};function l(e){return(0,o.$j)(null,(e=>(0,a.DE)(i,e)))(e)}function c(){const e=(0,o.I0)();return(0,n.useMemo)((()=>(0,a.DE)(i,e)),[e])}},74069:(e,t,r)=>{"use strict";r.d(t,{o:()=>h,default:()=>g});var n=r(73126),a=r(14293),o=r.n(a),s=r(67294),i=r(51995),l=r(61988),c=r(11965),d=r(4715),u=r(35932),p=r(29119),m=r(61193),_=r.n(m);const h=(0,i.iK)((e=>(0,c.tZ)(d.xT,(0,n.Z)({},e,{maskTransitionName:""}))))`
  ${({theme:e,responsive:t,maxWidth:r})=>t&&(0,c.iv)("max-width:",null!=r?r:"900px",";padding-left:",3*e.gridUnit,"px;padding-right:",3*e.gridUnit,"px;padding-bottom:0;top:0;","")}

  .ant-modal-content {
    display: flex;
    flex-direction: column;
    max-height: ${({theme:e})=>`calc(100vh - ${8*e.gridUnit}px)`};
    margin-bottom: ${({theme:e})=>4*e.gridUnit}px;
    margin-top: ${({theme:e})=>4*e.gridUnit}px;
  }

  .ant-modal-header {
    flex: 0 0 auto;
    background-color: ${({theme:e})=>e.colors.grayscale.light4};
    border-radius: ${({theme:e})=>e.borderRadius}px
      ${({theme:e})=>e.borderRadius}px 0 0;
    padding-left: ${({theme:e})=>4*e.gridUnit}px;
    padding-right: ${({theme:e})=>4*e.gridUnit}px;

    .ant-modal-title h4 {
      display: flex;
      margin: 0;
      align-items: center;
    }
  }

  .ant-modal-close-x {
    display: flex;
    align-items: center;

    .close {
      flex: 1 1 auto;
      margin-bottom: ${({theme:e})=>e.gridUnit}px;
      color: ${({theme:e})=>e.colors.secondary.dark1};
      font-size: 32px;
      font-weight: ${({theme:e})=>e.typography.weights.light};
    }
  }

  .ant-modal-body {
    flex: 0 1 auto;
    padding: ${({theme:e})=>4*e.gridUnit}px;
    overflow: auto;
    ${({resizable:e,height:t})=>!e&&t&&`height: ${t};`}
  }
  .ant-modal-footer {
    flex: 0 0 1;
    border-top: ${({theme:e})=>e.gridUnit/4}px solid
      ${({theme:e})=>e.colors.grayscale.light2};
    padding: ${({theme:e})=>4*e.gridUnit}px;

    .btn {
      font-size: 12px;
      text-transform: uppercase;
    }

    .btn + .btn {
      margin-left: ${({theme:e})=>2*e.gridUnit}px;
    }
  }

  // styling for Tabs component
  // Aaron note 20-11-19: this seems to be exclusively here for the Edit Database modal.
  // TODO: remove this as it is a special case.
  .ant-tabs-top {
    margin-top: -${({theme:e})=>4*e.gridUnit}px;
  }

  &.no-content-padding .ant-modal-body {
    padding: 0;
  }

  ${({draggable:e,theme:t})=>e&&`\n    .ant-modal-header {\n      padding: 0;\n      .draggable-trigger {\n          cursor: move;\n          padding: ${4*t.gridUnit}px;\n          width: 100%;\n        }\n    }\n  `};

  ${({resizable:e,hideFooter:t})=>e&&`\n    .resizable {\n      pointer-events: all;\n\n      .resizable-wrapper {\n        height: 100%;\n      }\n\n      .ant-modal-content {\n        height: 100%;\n\n        .ant-modal-body {\n          /* 100% - header height - footer height */\n          height: ${t?"calc(100% - 55px);":"calc(100% - 55px - 65px);"}\n        }\n      }\n    }\n  `}
`,f=e=>({maxHeight:"100vh",maxWidth:"100vw",minHeight:e?109:174,minWidth:"380px",enable:{bottom:!0,bottomLeft:!1,bottomRight:!0,left:!1,top:!1,topLeft:!1,topRight:!1,right:!0}}),E=({children:e,disablePrimaryButton:t=!1,primaryTooltipMessage:r,primaryButtonLoading:a=!1,onHide:i,onHandledPrimaryAction:d,primaryButtonName:m=(0,l.t)("OK"),primaryButtonType:E="primary",show:y,name:g,title:T,width:v,maxWidth:R,responsive:b=!1,centered:S,footer:A,hideFooter:O,wrapProps:I,draggable:C=!1,resizable:D=!1,resizableConfig:N=f(O),draggableConfig:w,destroyOnClose:L,...q})=>{const x=(0,s.useRef)(null),[U,Z]=(0,s.useState)(),[P,M]=(0,s.useState)(!0);let F;s.isValidElement(A)&&(F=s.cloneElement(A,{closeModal:i}));const k=o()(F)?[(0,c.tZ)(u.Z,{key:"back",onClick:i,cta:!0},(0,l.t)("Cancel")),(0,c.tZ)(u.Z,{key:"submit",buttonStyle:E,disabled:t,tooltip:r,loading:a,onClick:d,cta:!0},m)]:F,Q=v||(b?"100vw":"600px"),$=!(D||C),Y=(0,s.useMemo)((()=>0===Object.keys(N).length?f(O):N),[O,N]);return(0,c.tZ)(h,(0,n.Z)({centered:!!S,onOk:d,onCancel:i,width:Q,maxWidth:R,responsive:b,visible:y,title:(0,c.tZ)((()=>C?(0,c.tZ)("div",{className:"draggable-trigger",onMouseOver:()=>P&&M(!1),onMouseOut:()=>!P&&M(!0)},T):(0,c.tZ)(s.Fragment,null,T)),null),closeIcon:(0,c.tZ)("span",{className:"close","aria-hidden":"true"},"×"),footer:O?null:k,hideFooter:O,wrapProps:{"data-test":`${g||T}-modal`,...I},modalRender:e=>D||C?(0,c.tZ)(_(),(0,n.Z)({disabled:!C||P,bounds:U,onStart:(e,t)=>((e,t)=>{var r,n,a;const{clientWidth:o,clientHeight:s}=null==(r=window)||null==(n=r.document)?void 0:n.documentElement,i=null==x||null==(a=x.current)?void 0:a.getBoundingClientRect();i&&Z({left:-(null==i?void 0:i.left)+(null==t?void 0:t.x),right:o-((null==i?void 0:i.right)-(null==t?void 0:t.x)),top:-(null==i?void 0:i.top)+(null==t?void 0:t.y),bottom:s-((null==i?void 0:i.bottom)-(null==t?void 0:t.y))})})(0,t)},w),D?(0,c.tZ)(p.e,(0,n.Z)({className:"resizable"},Y),(0,c.tZ)("div",{className:"resizable-wrapper",ref:x},e)):(0,c.tZ)("div",{ref:x},e)):e,mask:$,draggable:C,resizable:D,destroyOnClose:L},q),e)};E.displayName="Modal";const y={okButtonProps:{className:"modal-functions-ok-button"},cancelButtonProps:{className:"modal-functions-cancel-button"}},g=Object.assign(E,{error:e=>d.xT.error({...e,...y}),warning:e=>d.xT.warning({...e,...y}),confirm:e=>d.xT.confirm({...e,...y}),useModal:d.xT.useModal})},84101:(e,t,r)=>{"use strict";r.d(t,{Z:()=>S});var n=r(73126),a=r(44908),o=r.n(a),s=r(18446),i=r.n(s),l=r(23279),c=r.n(l),d=r(67294),u=r(61988),p=r(85716),m=r(55786),_=r(13322),h=r(98286),f=r(27600),E=r(85633),y=r(47767),g=r(26579),T=r(34891),v=r(11965);const R=({error:e})=>(0,v.tZ)(y.BD,null,(0,v.tZ)(_.Z.ErrorSolid,null)," ",(0,v.tZ)(y.Vv,null,e)),b=(e,t,r)=>`${e};${t};${r}`,S=(0,d.forwardRef)((({allowClear:e,allowNewOptions:t=!1,ariaLabel:r,autoClearSearchValue:a=!1,fetchOnlyOnSearch:s,filterOption:l=!0,header:_=null,headerPosition:S="top",helperText:A,invertSelection:O=!1,lazyLoading:I=!0,loading:C,mode:D="single",name:N,notFoundContent:w,onBlur:L,onError:q,onChange:x,onClear:U,onDropdownVisibleChange:Z,onDeselect:P,onSearch:M,onSelect:F,optionFilterProps:k=["label","value"],options:Q,pageSize:$=g.L8,placeholder:Y=(0,u.t)("Select ..."),showSearch:B=!0,sortComparator:H=g.Ns,tokenSeparators:j=g.pp,value:V,getPopupContainer:G,oneLine:z,maxTagCount:W,...K},J)=>{const X="single"===D,[ee,te]=(0,d.useState)(V),[re,ne]=(0,d.useState)(""),[ae,oe]=(0,d.useState)(C),[se,ie]=(0,d.useState)(""),[le,ce]=(0,d.useState)(!1),[de,ue]=(0,d.useState)(0),[pe,me]=(0,d.useState)(0),[_e,he]=(0,d.useState)(!I),[fe,Ee]=(0,d.useState)(!1),ye=(0,d.useRef)(ee),ge=(0,d.useRef)(new Map),Te=X?void 0:"multiple",ve=!s||re,[Re,be]=(0,d.useState)(null!=W?W:g.pM),[Se,Ae]=(0,d.useState)(0),Oe=(0,p.D)(Se,0),Ie=(0,d.useCallback)((()=>Ae(Se+1)),[Se]);(0,d.useEffect)((()=>{z&&be(le?0:1)}),[le,z]),(0,d.useEffect)((()=>{ye.current=ee}),[ee]);const Ce=(0,d.useCallback)(((e,t)=>(0,E.Y1)(e,t,ye.current)),[]),De=(0,d.useCallback)(((e,t)=>(0,E.tj)(e,t,re,Ce,H)),[re,H,Ce]),Ne=(0,d.useCallback)(((e,t)=>(0,E.Sl)(e,t,Ce,H)),[H,Ce]),[we,Le]=(0,d.useState)(g.DW),qe=(0,d.useMemo)((()=>{const e=(0,m.Z)(ee).filter((e=>!(0,E.Gq)((0,E.NA)(e),we))).map((e=>(0,E.nq)(e)?e:{value:e,label:String(e)}));return e.length>0?e.concat(we):we}),[we,ee]),xe=(0,d.useCallback)((e=>(0,h.O$)(e).then((e=>{const{error:t}=e;ie(t),q&&q(t)}))),[q]),Ue=(0,d.useCallback)((e=>{let t=[];if(e&&Array.isArray(e)&&e.length){const r=new Set(e.map((e=>e.value)));Le((n=>(t=n.filter((e=>!r.has(e.value))).concat(e).sort(Ne),t)))}return t}),[Ne]),Ze=(0,d.useMemo)((()=>(e,t)=>{if(ue(t),fe)return void oe(!1);const r=b(e,t,$),n=ge.current.get(r);if(void 0!==n)return me(n),void oe(!1);oe(!0),Q(e,t,$).then((({data:t,totalCount:n})=>{const a=Ue(t);ge.current.set(r,n),me(n),!s&&""===e&&a.length>=n&&Ee(!0)})).catch(xe).finally((()=>{oe(!1)}))}),[fe,s,Ue,xe,Q,$]),Pe=(0,d.useMemo)((()=>c()(Ze,f.M$)),[Ze]),Me=c()((e=>{const r=e.trim();if(t){const e=r&&!(0,E.Gq)(r,qe,!0)&&{label:r,value:r,isNewOption:!0},t=qe.filter((e=>!e.isNewOption||(0,E.Gq)(e.value,ee))),n=e?[e,...t]:t;Le(n)}fe||!_e||ge.current.has(b(r,0,$))||oe(!(s&&!r)),ne(e),null==M||M(r)}),f.oP);(0,d.useEffect)((()=>()=>Me.cancel()),[Me]),(0,d.useEffect)((()=>{if(Se!==Oe){const e=(0,m.Z)(ee),t=new Set(e.map(E.NA)),r=(0,E.vi)(qe.filter((e=>t.has(e.value))));X?null==x||x(ee,r[0]):null==x||x(e,r)}}),[qe,X,x,Se,Oe,ee]),(0,d.useEffect)((()=>{ge.current.clear(),Ee(!1),Le(g.DW)}),[Q]),(0,d.useEffect)((()=>{te(V)}),[V]),(0,d.useEffect)((()=>()=>{Pe.cancel()}),[Pe]),(0,d.useEffect)((()=>{_e&&ve&&(re?Pe(re,0):Ze("",0))}),[_e,Ze,ve,re,Pe]),(0,d.useEffect)((()=>{void 0!==C&&C!==ae&&oe(C)}),[ae,C]);const Fe=()=>ge.current.clear();(0,d.useImperativeHandle)(J,(()=>({...J.current,clearCache:Fe})),[J]);const ke=(0,d.useCallback)((async e=>{let r=(0,E.Rl)(e,qe,!0);if(!r&&!fe){const t=Q;r=await t(e,0,$).then((({data:t})=>t.find((t=>t.label===e))))}if(!r&&!t)return;const n={label:e,value:e};return r&&(n.label=(0,E.Kn)(r)?r.label:r,n.value=(0,E.Kn)(r)?r.value:r),n}),[fe,t,qe,Q,$]),Qe=(0,d.useMemo)((()=>(0,E.$)(qe)),[qe]);return(0,v.tZ)(y.PQ,{headerPosition:S},_&&(0,v.tZ)(y.eb,{headerPosition:S},_),(0,v.tZ)(y.Qr,(0,n.Z)({allowClear:!ae&&e,"aria-label":r||N,autoClearSearchValue:a,dropdownRender:e=>(0,E.RI)(e,le,ae,qe.length,A,se?(0,v.tZ)(R,{error:se}):void 0),filterOption:(e,t)=>(0,E.Dz)(e,t,k,l),filterSort:De,getPopupContainer:G||(e=>e.parentNode),headerPosition:S,labelInValue:!0,maxTagCount:Re,mode:Te,notFoundContent:ae?(0,u.t)("Loading..."):w,onBlur:e=>{ne(""),null==L||L(e)},onDeselect:(e,t)=>{Array.isArray(ee)&&((0,E.nq)(e)?te(ee.filter((t=>t.value!==e.value))):te(ee.filter((t=>t!==e))),t.isNewOption&&Le(qe.filter((t=>(0,E.NA)(t.value)!==(0,E.NA)(e))))),Ie(),null==P||P(e,t)},onDropdownVisibleChange:e=>{if(ce(e),_e!==e&&he(e),!e&&ae&&setTimeout((()=>{oe(!1)}),250),e&&!re&&we.length>1){const e=we.slice().sort(Ne);i()(e,we)||Le(e)}Z&&Z(e)},onPaste:async e=>{const t=e.clipboardData.getData("text");if(X){const e=await ke(t);e&&te(e)}else{const e=j.find((e=>t.includes(e))),r=e?o()(t.split(e)):[t],n=(await Promise.all(r.map((e=>ke(e))))).filter((e=>void 0!==e));te((e=>[...e||[],...n.filter((t=>!(0,E.Gq)(t.value,e)))]))}Ie()},onPopupScroll:e=>{const t=e.currentTarget,r=t.scrollTop>.7*(t.scrollHeight-t.offsetHeight);!ae&&de*$+$<pe&&r&&Ze(re,de+1)},onSearch:B?Me:void 0,onSelect:(e,t)=>{if(X){const t=!(0,E.Xy)(e,ee,"value");te(e),t&&Ie()}else te((t=>{const r=(0,m.Z)(t),n=(0,E.NA)(e);if(!(0,E.Gq)(n,r)){const t=[...r,e];return(0,E.nq)(e),t}return t})),Ie();null==F||F(e,t)},onClear:()=>{te(void 0),U&&U(),Ie()},options:Qe?void 0:qe,placeholder:Y,showSearch:B,showArrow:!0,tokenSeparators:j,value:ee,suffixIcon:(0,E.AI)(ae,B,le),menuItemSelectedIcon:O?(0,v.tZ)(y.F6,{iconSize:"m","aria-label":"stop"}):(0,v.tZ)(y.Y1,{iconSize:"m","aria-label":"check"}),oneLine:z,tagRender:T.Z},K,{ref:J}),(0,E.$)(qe)&&(0,E.PO)(qe)))}))},34891:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var n=r(73126),a=(r(67294),r(60331)),o=r(51995),s=r(3297),i=r(58593),l=r(85633),c=r(47767),d=r(11965);const u=(0,o.iK)(a.Z)`
  & .ant-tag-close-icon {
    display: inline-flex;
    align-items: center;
    margin-left: ${({theme:e})=>e.gridUnit}px;
  }

  & .tag-content {
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,p=e=>{const[t,r]=(0,s.Z)();return(0,d.tZ)(i.u,{title:r?e.children:null},(0,d.tZ)(u,(0,n.Z)({},e,{className:"ant-select-selection-item"}),(0,d.tZ)("span",{className:"tag-content",ref:t},e.children)))},m=e=>{const{label:t,value:r}=e;return r!==l.qP?(0,d.tZ)(p,(0,n.Z)({onMouseDown:e=>{const t=e.target;("svg"===t.tagName||"path"===t.tagName||"span"===t.tagName&&t.className.includes("ant-tag-close-icon"))&&e.stopPropagation()}},e),t):(0,d.tZ)(c.WC,null)}},81315:(e,t,r)=>{"use strict";r.d(t,{Z:()=>b});var n=r(73126),a=r(44908),o=r.n(a),s=r(18446),i=r.n(s),l=r(23279),c=r.n(l),d=r(67294),u=r(61988),p=r(85716),m=r(55786),_=r(67190),h=r(45636),f=r(64749),E=r(27600),y=r(85633),g=r(47767),T=r(26579),v=r(34891),R=r(11965);const b=(0,d.forwardRef)((({allowClear:e,allowNewOptions:t=!1,allowSelectAll:r=!0,ariaLabel:a,autoClearSearchValue:s=!1,filterOption:l=!0,header:b=null,headerPosition:S="top",helperText:A,invertSelection:O=!1,labelInValue:I=!1,loading:C,mode:D="single",name:N,notFoundContent:w,onBlur:L,onChange:q,onClear:x,onDropdownVisibleChange:U,onDeselect:Z,onSearch:P,onSelect:M,optionFilterProps:F=["label","value"],options:k,placeholder:Q=(0,u.t)("Select ..."),showSearch:$=!0,sortComparator:Y=T.Ns,tokenSeparators:B=T.pp,value:H,getPopupContainer:j,oneLine:V,maxTagCount:G,...z},W)=>{const K="single"===D,J=!!t||$,[X,ee]=(0,d.useState)(H),[te,re]=(0,d.useState)(""),[ne,ae]=(0,d.useState)(C),[oe,se]=(0,d.useState)(!1),[ie,le]=(0,d.useState)(null!=G?G:T.pM),[ce,de]=(0,d.useState)(0),ue=(0,p.D)(ce,0),pe=(0,d.useCallback)((()=>de(ce+1)),[ce]);(0,d.useEffect)((()=>{V&&le(oe?0:1)}),[oe,V]);const me=K?void 0:"multiple",{Option:_e}=f.default,he=(0,d.useCallback)(((e,t)=>(0,y.Y1)(e,t,X)),[X]),fe=(0,d.useCallback)(((e,t)=>(0,y.tj)(e,t,te,he,Y)),[te,Y,he]),Ee=(0,d.useMemo)((()=>Array.isArray(k)?k.slice():T.DW),[k]),ye=(0,d.useMemo)((()=>Ee.slice().sort(he)),[Ee,he]),[ge,Te]=(0,d.useState)(ye),ve=(0,d.useMemo)((()=>{const e=(0,m.Z)(X).filter((e=>!(0,y.Gq)((0,y.NA)(e),ge))).map((e=>(0,y.nq)(e)?e:{value:e,label:String(e)}));return(e.length>0?e.concat(ge):ge).filter((e=>e.value!==y.qP))}),[ge,X]),Re=(0,d.useMemo)((()=>ve.filter((e=>!e.disabled))),[ve]),be=(0,d.useMemo)((()=>ve.filter((e=>(0,y.Gq)(e.value,X)||!e.disabled))),[ve,X]),Se=(0,d.useMemo)((()=>!K&&r&&ge.length>0&&Re.length>1&&!te),[K,r,ge.length,Re.length,te]),Ae=(0,d.useMemo)((()=>(0,m.Z)(X).length===be.length+1),[X,be]),Oe=()=>{ee(K?void 0:ve.filter((e=>e.disabled&&(0,y.Gq)(e.value,X))).map((e=>I?{label:e.label,value:e.value}:e.value))),pe()},Ie=c()((e=>{const r=e.trim();if(t){const e=r&&!(0,y.Gq)(r,ve,!0)&&{label:r,value:r,isNewOption:!0},t=(0,m.Z)(ve).filter((e=>!e.isNewOption||(0,y.Gq)(e.value,X))),n=e?[e,...t]:t;Te(n)}re(r),null==P||P(r)}),E.oP);(0,d.useEffect)((()=>()=>Ie.cancel()),[Ie]),(0,d.useEffect)((()=>{Te(Ee)}),[Ee]),(0,d.useEffect)((()=>{void 0!==C&&C!==ne&&ae(C)}),[ne,C]),(0,d.useEffect)((()=>{ee(H)}),[H]),(0,d.useEffect)((()=>{Se&&(0,m.Z)(H).length===be.length&&ee(I?[...(0,m.Z)(H),y.tP]:[...(0,m.Z)(H),y.qP])}),[I,be.length,Se,H]),(0,d.useEffect)((()=>{if((0,m.Z)(X).some((e=>(0,y.NA)(e)===y.qP))&&!Ae){const e=be.map((e=>I?e:e.value));e.push(I?y.tP:y.qP),ee(e),pe()}}),[X,Ae,I,be,pe]);const Ce=(0,d.useMemo)((()=>()=>`${y.qP} (${(0,_.uf)(h.default.INTEGER,be.length)})`),[be]),De=(0,d.useCallback)(((e,t)=>{let r=e,n=t;if(!K)if((0,m.Z)(r).some((e=>(0,y.NA)(e)===y.qP)))Ae?r=(0,m.Z)(e).filter((e=>(0,y.NA)(e)!==y.qP)):(r=(0,y.Q8)(be,I),n=(0,y.vi)(be));else if((0,m.Z)(e).length===be.length&&Ae){const e=be.filter((e=>(0,y.Gq)(e.value,X)&&e.disabled));r=(0,y.Q8)(e,I),n=(0,y.vi)(e)}null==q||q(r,n)}),[K,I,q,be,Ae,X]);(0,d.useEffect)((()=>{if(ce!==ue){const e=(0,m.Z)(X),t=new Set(e.map(y.NA)),r=(0,y.vi)(ve.filter((e=>t.has(e.value))));K?De(X,X?r[0]:void 0):De(e,r)}}),[ve,De,K,q,ce,ue,X]);const Ne=(0,d.useMemo)((()=>Se||(0,y.$)(k)),[Se,k]),we=(0,d.useMemo)((()=>(0,m.Z)(X).length-ie-(Ae?1:0)),[ie,Ae,X]);let Le=ie;"responsive"!==Le&&0===we&&Ae&&(Le-=1);const qe=(0,d.useCallback)((e=>{const r=(0,y.Rl)(e,ve,!0);if(r||t){if(I){const t={label:e,value:e};return r&&(t.label=(0,y.Kn)(r)?r.label:r,t.value=(0,y.Kn)(r)?r.value:r),t}return r?(0,y.Kn)(r)?r.value:r:e}}),[t,ve,I]);return(0,R.tZ)(g.PQ,{headerPosition:S},b&&(0,R.tZ)(g.eb,{headerPosition:S},b),(0,R.tZ)(g.Qr,(0,n.Z)({allowClear:!ne&&e,"aria-label":a||N,autoClearSearchValue:s,dropdownRender:e=>(0,y.RI)(e,oe,ne,ve.length,A),filterOption:(e,t)=>(0,y.Dz)(e,t,F,l),filterSort:fe,getPopupContainer:j||(e=>e.parentNode),headerPosition:S,labelInValue:I,maxTagCount:Le,maxTagPlaceholder:()=>`+ ${we>0?we:1} ...`,mode:me,notFoundContent:ne?(0,u.t)("Loading..."):w,onBlur:e=>{re(""),null==L||L(e)},onDeselect:(e,t)=>{if(Array.isArray(X))if((0,y.NA)(e)===(0,y.NA)(y.qP))Oe();else{let r=X;r=r.filter((t=>(0,y.NA)(t)!==(0,y.NA)(e))),Ae&&!t.isNewOption&&(r=r.filter((e=>(0,y.NA)(e)!==y.qP))),ee(r),t.isNewOption&&Te(ve.filter((t=>(0,y.NA)(t.value)!==(0,y.NA)(e))))}pe(),null==Z||Z(e,t)},onDropdownVisibleChange:e=>{se(e),e&&!te&&ge.length>1&&(i()(ye,ge)||Te(ye)),U&&U(e)},onPaste:e=>{const t=e.clipboardData.getData("text");if(K){const e=qe(t);e&&ee(e)}else{const e=B.find((e=>t.includes(e))),r=(e?o()(t.split(e)):[t]).map((e=>qe(e))).filter((e=>void 0!==e));ee((e=>[...e||[],...r]))}pe()},onPopupScroll:void 0,onSearch:J?Ie:void 0,onSelect:(e,t)=>{if(K){const t=!(0,y.Xy)(e,X,"value");ee(e),t&&pe()}else ee((t=>{const r=(0,m.Z)(t),n=(0,y.NA)(e);if(n===(0,y.NA)(y.qP))return(0,y.nq)(e)?[...be,y.tP]:[y.qP,...be.map((e=>e.value))];if(!(0,y.Gq)(n,r)){const t=[...r,e];return t.length===be.length&&Se?(0,y.nq)(e)?[...t,y.tP]:[...t,y.qP]:t}return t})),pe();null==M||M(e,t)},onClear:()=>{Oe(),x&&x()},placeholder:Q,showSearch:J,showArrow:!0,tokenSeparators:B,value:X,suffixIcon:(0,y.AI)(ne,J,oe),menuItemSelectedIcon:O?(0,R.tZ)(g.F6,{iconSize:"m","aria-label":"stop"}):(0,R.tZ)(g.Y1,{iconSize:"m","aria-label":"check"}),options:Ne?void 0:ve,oneLine:V,tagRender:v.Z},z,{ref:W}),Se&&(0,R.tZ)(_e,{id:"select-all",className:"select-all",key:y.qP,value:y.qP},Ce()),Ne&&(0,y.PO)(ve)))}))},26579:(e,t,r)=>{"use strict";r.d(t,{L8:()=>s,Ns:()=>i,DW:()=>o,pM:()=>n,pp:()=>a});const n=4,a=[",","\r\n","\n","\t",";"],o=[],s=100,i=(e,t,r)=>{let n,a;return"string"==typeof e.label&&"string"==typeof t.label?(n=e.label,a=t.label):"string"==typeof e.value&&"string"==typeof t.value&&(n=e.value,a=t.value),"string"==typeof n&&"string"==typeof a?r?function(e,t,r){const n=e.toLowerCase()||"",a=t.toLowerCase()||"",o=r.toLowerCase()||"";return r&&(Number(t===r)-Number(e===r)||Number(t.startsWith(r))-Number(e.startsWith(r))||Number(a===o)-Number(n===o)||Number(a.startsWith(o))-Number(n.startsWith(o))||Number(t.includes(r))-Number(e.includes(r))||Number(a.includes(o))-Number(e.includes(o)))||e.localeCompare(t)}(n,a,r):n.localeCompare(a):e.value-t.value}},47767:(e,t,r)=>{"use strict";r.d(t,{BD:()=>E,F6:()=>p,H$:()=>_,PQ:()=>c,Qr:()=>d,SC:()=>h,Vv:()=>y,WC:()=>u,Y1:()=>m,eb:()=>l,oz:()=>f});var n=r(51995),a=r(13322),o=r(60331),s=r(11382),i=r(64749);const l=n.iK.span`
  ${({theme:e,headerPosition:t})=>`\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    margin-right: ${"left"===t?2*e.gridUnit:0}px;\n  `}
`,c=n.iK.div`
  ${({headerPosition:e})=>`\n    display: flex;\n    flex-direction: ${"top"===e?"column":"row"};\n    align-items: ${"left"===e?"center":void 0};\n    width: 100%;\n  `}
`,d=(0,n.iK)(i.default,{shouldForwardProp:e=>"headerPosition"!==e&&"oneLine"!==e})`
  ${({theme:e,headerPosition:t,oneLine:r})=>`\n    flex: ${"left"===t?1:0};\n    && .ant-select-selector {\n      border-radius: ${e.gridUnit}px;\n    }\n    // Open the dropdown when clicking on the suffix\n    // This is fixed in version 4.16\n    .ant-select-arrow .anticon:not(.ant-select-suffix) {\n      pointer-events: none;\n    }\n    .select-all {\n      border-bottom: 1px solid ${e.colors.grayscale.light3};\n    }\n    ${r&&`\n        .ant-select-selection-overflow {\n          flex-wrap: nowrap;\n        }\n\n        .ant-select-selection-overflow-item:not(.ant-select-selection-overflow-item-rest):not(.ant-select-selection-overflow-item-suffix) {\n          flex-shrink: 1;\n          min-width: ${13*e.gridUnit}px;\n        }\n\n        .ant-select-selection-overflow-item-suffix {\n          flex: unset;\n          min-width: 0px;\n        }\n      `};\n `}
`,u=n.iK.span`
  display: none;
`,p=((0,n.iK)(o.Z)`
  ${({theme:e})=>`\n    background: ${e.colors.grayscale.light3};\n    font-size: ${e.typography.sizes.m}px;\n    border: none;\n  `}
`,(0,n.iK)(a.Z.StopOutlined)`
  vertical-align: 0;
`),m=(0,n.iK)(a.Z.CheckOutlined)`
  vertical-align: 0;
`,_=(0,n.iK)(s.Z)`
  margin-top: ${({theme:e})=>-e.gridUnit}px;
`,h=n.iK.div`
  ${({theme:e})=>`\n   margin-left: ${3*e.gridUnit}px;\n   line-height: ${8*e.gridUnit}px;\n   color: ${e.colors.grayscale.light1};\n `}
`,f=n.iK.div`
  ${({theme:e})=>`\n   padding: ${2*e.gridUnit}px ${3*e.gridUnit}px;\n   color: ${e.colors.grayscale.base};\n   font-size: ${e.typography.sizes.s}px;\n   cursor: default;\n   border-bottom: 1px solid ${e.colors.grayscale.light2};\n `}
`,E=n.iK.div`
  ${({theme:e})=>`\n    display: flex;\n    justify-content: center;\n    align-items: flex-start;\n    width: 100%;\n    padding: ${2*e.gridUnit}px;\n    color: ${e.colors.error.base};\n    & svg {\n      margin-right: ${2*e.gridUnit}px;\n    }\n  `}
`,y=n.iK.div`
  overflow: hidden;
  text-overflow: ellipsis;
`},85633:(e,t,r)=>{"use strict";r.d(t,{$:()=>I,AI:()=>S,Dz:()=>O,Gq:()=>g,Kn:()=>_,NA:()=>f,PO:()=>C,Q8:()=>D,RI:()=>A,Rl:()=>y,Sl:()=>b,Xy:()=>E,Y1:()=>v,mj:()=>T,nq:()=>h,qP:()=>p,tP:()=>m,tj:()=>R,vi:()=>N});var n=r(73126),a=r(55786),o=r(61988),s=r(64749),i=r(67294),l=r(13322),c=r(47767),d=r(11965);const{Option:u}=s.default,p="Select All",m={value:p,label:String(p)};function _(e){return null!==e&&"object"==typeof e&&!1===Array.isArray(e)}function h(e){return _(e)&&"value"in e&&"label"in e}function f(e){return h(e)?e.value:e}function E(e,t,r){return(_(e)&&r in e?e[r]:e)==(_(t)&&r in t?t[r]:t)}function y(e,t,r=!1){return(0,a.Z)(t).find((t=>E(t,e,"value")||r&&E(t,e,"label")))}function g(e,t,r=!1){return void 0!==y(e,t,r)}const T=e=>(t,r)=>"string"==typeof t[e]&&"string"==typeof r[e]?t[e].localeCompare(r[e]):t[e]-r[e],v=(e,t,r)=>r&&void 0!==e.value&&void 0!==t.value?Number(g(t.value,r))-Number(g(e.value,r)):0,R=(e,t,r,n,a)=>n(e,t)||a(e,t,r),b=(e,t,r,n)=>r(e,t)||n(e,t,""),S=(e,t,r)=>e?(0,d.tZ)(c.H$,{size:"small"}):t&&r?(0,d.tZ)(l.Z.SearchOutlined,{iconSize:"s"}):(0,d.tZ)(l.Z.DownOutlined,{iconSize:"s"}),A=(e,t,r,n,a,s)=>{var l,u;return t||null==(l=e.ref)||null==(u=l.current)||u.scrollTo({top:0}),r&&0===n?(0,d.tZ)(c.SC,null,(0,o.t)("Loading...")):s||(0,d.tZ)(i.Fragment,null,a&&(0,d.tZ)(c.oz,{role:"note"},a),e)},O=(e,t,r,n)=>{if("function"==typeof n)return n(e,t);if(n){const n=e.trim().toLowerCase();if(null!=r&&r.length)return r.some((e=>(null!=t&&t[e]?String(t[e]).trim().toLowerCase():"").includes(n)))}return!1},I=e=>null==e?void 0:e.some((e=>!(null==e||!e.customLabel))),C=e=>e.map((e=>{const t="object"==typeof e,r=t?(null==e?void 0:e.label)||e.value:e,a=t?e.value:e,{customLabel:o,...s}=e;return(0,d.tZ)(u,(0,n.Z)({},s,{key:a,label:r,value:a}),t&&o?o:r)})),D=(e,t)=>t?e.map((e=>({key:e.value,value:e.value,label:e.label}))):e.map((e=>e.value)),N=e=>e.map((e=>({children:e.label,key:e.value,...e})))},58593:(e,t,r)=>{"use strict";r.d(t,{u:()=>l});var n=r(73126),a=r(67294),o=r(51995),s=r(11965),i=r(31097);const l=e=>{const t=(0,o.Fg)();return(0,s.tZ)(a.Fragment,null,(0,s.tZ)(s.xB,{styles:s.iv`
          .ant-tooltip-open {
            display: inline-block;
            &::after {
              content: '';
              display: block;
            }
          }
          .ant-tooltip-inner > p {
            margin: 0;
          }
        `}),(0,s.tZ)(i.Z,(0,n.Z)({overlayStyle:{fontSize:t.typography.sizes.s,lineHeight:"1.6"},overlayInnerStyle:{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:40,WebkitBoxOrient:"vertical",textOverflow:"ellipsis"},color:`${t.colors.grayscale.dark2}e6`},e)))}},29147:(e,t,r)=>{"use strict";r.d(t,{DG:()=>c,fG:()=>l});var n=r(67294),a=r(27600),o=r(23525),s=r(11965);const i=(0,n.createContext)({hideTitle:!1,hideTab:!1,hideNav:!1,hideChartControls:!1}),l=()=>(0,n.useContext)(i),c=({children:e})=>{const t=(0,o.eY)(a.KD.uiConfig)||0,[r]=(0,n.useState)({hideTitle:0!=(1&t),hideTab:0!=(2&t),hideNav:0!=(4&t),hideChartControls:0!=(8&t)});return(0,s.tZ)(i.Provider,{value:r},e)}},4715:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>v.Z,C0:()=>T.Z,Gj:()=>S.Z,Grid:()=>c.ZP,HY:()=>l.Z,IZ:()=>C.Z,JX:()=>s.Z,KU:()=>N.Z,O5:()=>g.Z,Od:()=>p.Z,Ol:()=>b.Z,Ph:()=>n.Z,Rg:()=>_.Z,T:()=>m.Z,Vp:()=>h.Z,X2:()=>u.Z,ZT:()=>E.Z,_e:()=>w.Z,aV:()=>d.ZP,gq:()=>y.Z,iz:()=>i.Z,mp:()=>f.Z,oc:()=>O.Z,qE:()=>o.C,qb:()=>a.Z,qz:()=>A.Z,r4:()=>R.Z,rb:()=>D.Z,xT:()=>I.Z});var n=r(81315),a=r(84101),o=r(51890),s=r(15746),i=r(27049),l=r(14277),c=r(75302),d=r(8243),u=r(71230),p=r(33860),m=r(19650),_=r(27220),h=r(60331),f=r(6802),E=r(16809),y=r(81306),g=r(35247),T=r(71577),v=r(71277),R=r(9676),b=r(46445),S=r(13013),A=r(33746),O=r(77808),I=r(99441),C=r(8834),D=r(31955),N=r(59314),w=r(31097)},41295:(e,t,r)=>{"use strict";r.d(t,{$A:()=>u,C6:()=>g,Fl:()=>E,Jy:()=>_,Mi:()=>h,Mn:()=>y,a8:()=>m,fO:()=>p,nH:()=>f});var n=r(47037),a=r.n(n),o=r(28062),s=r(22102),i=r(61988),l=r(98286),c=r(72570),d=r(9467);const u="DASHBOARD_INFO_UPDATED";function p(e,t){const r=o.getNamespace(null==e?void 0:e.color_namespace),n=a()(t)?JSON.parse(t):t;Object.keys(n).forEach((e=>{r.setColor(e,n[e])}))}function m(e){const{metadata:t}=e;return o.getNamespace(null==t?void 0:t.color_namespace).resetColors(),null!=t&&t.shared_label_colors&&p(t,null==t?void 0:t.shared_label_colors),null!=t&&t.label_colors&&p(t,null==t?void 0:t.label_colors),{type:u,newInfo:e}}const _="SAVE_CHART_CONFIG_COMPLETE",h=({chartConfiguration:e,globalChartConfiguration:t})=>async(r,n)=>{r({type:"SAVE_CHART_CONFIG_BEGIN",chartConfiguration:e,globalChartConfiguration:t});const{id:a,metadata:o}=n().dashboardInfo,l=(0,s.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${a}`});try{const n=await l({json_metadata:JSON.stringify({...o,chart_configuration:null!=e?e:o.chart_configuration,global_chart_configuration:null!=t?t:o.global_chart_configuration})});r(m({metadata:JSON.parse(n.result.json_metadata)})),r({type:_,chartConfiguration:e,globalChartConfiguration:t})}catch(n){r({type:"SAVE_CHART_CONFIG_FAIL",chartConfiguration:e,globalChartConfiguration:t}),r((0,c.Gb)((0,i.t)("Failed to save cross-filter scoping")))}},f="SET_FILTER_BAR_ORIENTATION",E="SET_CROSS_FILTERS_ENABLED";function y(e){return async(t,r)=>{const{id:n,metadata:a}=r().dashboardInfo,o=(0,s.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${n}`});try{const r=await o({json_metadata:JSON.stringify({...a,filter_bar_orientation:e})}),n=r.result,s=r.last_modified_time;if(n.json_metadata){const e=JSON.parse(n.json_metadata);e.filter_bar_orientation&&t((i=e.filter_bar_orientation,{type:f,filterBarOrientation:i}))}s&&t((0,d.Vv)(s))}catch(e){const r=await(0,l.HR)(e,"dashboard");throw t((0,c.Gb)(r)),e}var i}}function g(e){return async(t,r)=>{const{id:n,metadata:a}=r().dashboardInfo,o=(0,s.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${n}`});try{const r=await o({json_metadata:JSON.stringify({...a,cross_filters_enabled:e})}),n=r.result,s=r.last_modified_time;n.json_metadata&&t(function(e){return{type:E,crossFiltersEnabled:e}}(JSON.parse(n.json_metadata).cross_filters_enabled)),s&&t((0,d.Vv)(s))}catch(e){const r=await(0,l.HR)(e,"dashboard");throw t((0,c.Gb)(r)),e}}}},50810:(e,t,r)=>{"use strict";r.d(t,{Fy:()=>o,QR:()=>i,Rn:()=>n});var n,a=r(31069);function o(e){return{type:n.SetDatasources,datasources:e}}function s(e,t){return{type:n.SetDatasource,key:t,datasource:e}}function i(e){return(t,r)=>{const{datasources:n}=r(),o=n[e];return o?t(s(o,e)):a.Z.get({endpoint:`/superset/fetch_datasource_metadata?datasourceKey=${e}`}).then((({json:r})=>t(s(r,e))))}}!function(e){e.SetDatasources="SET_DATASOURCES",e.SetDatasource="SET_DATASOURCE"}(n||(n={}))},52794:(e,t,r)=>{"use strict";r.d(t,{$7:()=>_,DU:()=>g,RY:()=>d,T6:()=>m,TT:()=>E,Up:()=>h,X8:()=>p,jE:()=>f,kN:()=>c,qN:()=>y,qe:()=>l,rF:()=>v,rR:()=>T,xk:()=>u});var n=r(50361),a=r.n(n),o=r(22102),s=r(74599),i=r(41295);const l="SET_FILTER_CONFIG_COMPLETE",c="SET_IN_SCOPE_STATUS_OF_FILTERS",d=e=>async(t,r)=>{var n;t({type:"SET_FILTER_CONFIG_BEGIN",filterConfig:e});const{id:a,metadata:c}=r().dashboardInfo,d=null==(n=r().nativeFilters)?void 0:n.filters,u=(0,o.Z)({method:"PUT",endpoint:`/api/v1/dashboard/${a}`}),p=e.map((e=>{const t=d[e.id];return t?{...t,...e}:e}));try{const e=await u({json_metadata:JSON.stringify({...c,native_filter_configuration:p})});t((0,i.a8)({metadata:JSON.parse(e.result.json_metadata)})),t({type:l,filterConfig:p}),t((0,s.Ft)(p,d))}catch(e){t({type:"SET_FILTER_CONFIG_FAIL",filterConfig:p}),t({type:s.u3,filterConfig:p})}},u=e=>async(t,r)=>{var n;const o=null==(n=r().nativeFilters)?void 0:n.filters,s=e.map((e=>({...o[e.filterId],chartsInScope:e.chartsInScope,tabsInScope:e.tabsInScope})));t({type:c,filterConfig:s});const l=a()(r().dashboardInfo.metadata),d=l.native_filter_configuration.map((e=>{const t=s.find((t=>t.id===e.id));return t?{...t,...e}:e}));l.native_filter_configuration=d,t((0,i.a8)({metadata:l}))},p="SET_FOCUSED_NATIVE_FILTER",m="UNSET_FOCUSED_NATIVE_FILTER";function _(e){return{type:p,id:e}}function h(){return{type:m}}const f="SET_HOVERED_NATIVE_FILTER",E="UNSET_HOVERED_NATIVE_FILTER";function y(e){return{type:f,id:e}}function g(){return{type:E}}const T="UPDATE_CASCADE_PARENT_IDS";function v(e,t){return{type:T,id:e,parentIds:t}}},38523:(e,t,r)=>{"use strict";r.d(t,{D2:()=>p,EO:()=>u,Ff:()=>h,JV:()=>d,cK:()=>m,ex:()=>f});var n=r(15926),a=r.n(n),o=r(31069),s=r(61988),i=r(72570),l=r(98286);const c=200,d="ADD_SLICES",u="SET_SLICES",p="FETCH_ALL_SLICES_STARTED",m="FETCH_ALL_SLICES_FAILED",_=e=>e.reduce(((e,t)=>{let r=JSON.parse(t.params);var n,a;return r={...r,datasource:(n=t.datasource_id,a=t.datasource_type,`${n}__${a}`||r.datasource)},{...e,[t.id]:{slice_id:t.id,slice_url:t.url,slice_name:t.slice_name,form_data:r,datasource_name:t.datasource_name_text,datasource_url:t.datasource_url,datasource_id:t.datasource_id,datasource_type:t.datasource_type,changed_on:new Date(t.changed_on_utc).getTime(),description:t.description,description_markdown:t.description_markeddown,viz_type:t.viz_type,modified:t.changed_on_delta_humanized,changed_on_humanized:t.changed_on_delta_humanized,thumbnail_url:t.thumbnail_url,owners:t.owners,created_by:t.created_by}}}),{});function h(e){return t=>{t(function(e){return{type:u,payload:{slices:e}}}(e))}}function f(e,t,r="changed_on"){return n=>{n({type:p});const u=t?[{col:"slice_name",opr:"chart_all_text",value:t}]:[];return e&&u.push({col:"owners",opr:"rel_m_m",value:e}),o.Z.get({endpoint:`/api/v1/chart/?q=${a().encode({columns:["changed_on_delta_humanized","changed_on_utc","datasource_id","datasource_type","datasource_url","datasource_name_text","description_markeddown","description","id","params","slice_name","thumbnail_url","url","viz_type","owners.id","created_by.id"],filters:u,page_size:c,order_column:"changed_on"===r?"changed_on_delta_humanized":r,order_direction:"changed_on"===r?"desc":"asc"})}`}).then((({json:e})=>{const{result:t}=e,r=_(t);return n(function(e){return{type:d,payload:{slices:e}}}(r))})).catch((e=>(0,l.O$)(e).then((({error:e})=>{n(function(e){return{type:m,payload:{error:e}}}(e||(0,s.t)("Could not fetch all saved charts"))),n((0,i.Gb)((0,s.t)("Sorry there was an error fetching saved charts: ")+e))}))))}}},92242:(e,t,r)=>{"use strict";r.d(t,{EJ:()=>p,G$:()=>d,GA:()=>u,Ky:()=>_,QN:()=>f,W6:()=>h,rW:()=>m,uh:()=>c});var n=r(14670),a=r.n(n),o=r(8868),s=r(68492),i=r(10916),l=r(80621);const c=(e,t,r=[])=>{if(r.includes(t))return!0;const n=e.get(t);return!!n&&n.some((n=>c(e,n,[...r,t])))},d=async(e,t,r)=>{try{let t;try{t=await e.validateFields()}catch(e){var n;if(null!=e&&null!=(n=e.errorFields)&&n.length||null==e||!e.outOfDate)throw e;t=e.values}return t}catch(e){var a;if(s.Z.warn("Filter configuration failed:",e),null==(a=e.errorFields)||!a.length)return null;const n=e.errorFields;if(!n.some((e=>e.name[1]===t))){const e=n.find((e=>"filters"===e.name[0]));e&&r(e.name[1])}return null}},u=(e,t,r,n,a)=>async()=>{const s=t.filter((e=>!r[e])).map((t=>{var r,n,s,c;const d=null==(r=a.filters)?void 0:r[t];if(!d)return e[t];if(d.type===i.BE.Divider)return{id:t,type:i.BE.Divider,scope:{rootPath:[l._4],excluded:[]},title:d.title,description:d.description};const u={};return d.dataset&&(u.datasetId=d.dataset.value),d.dataset&&d.column&&(u.column={name:d.column}),{id:t,adhoc_filters:d.adhoc_filters,time_range:d.time_range,controlValues:null!=(n=d.controlValues)?n:{},granularity_sqla:d.granularity_sqla,requiredFirst:Object.values(null!=(s=d.requiredFirst)?s:{}).find((e=>e)),name:d.name,filterType:d.filterType,targets:[u],defaultDataMask:null!=(c=d.defaultDataMask)?c:(0,o.H)(),cascadeParentIds:d.dependencies||[],scope:d.scope,sortMetric:d.sortMetric,type:d.type,description:(d.description||"").trim()}}));await n(s)},p=(e,t,r)=>n=>{const a=window.setTimeout((()=>{(r=>{e((e=>({...e,[r]:{isPending:!1}}))),t((e=>e.filter((e=>e!==r))))})(n)}),5e3);e((e=>({...e,[n]:{isPending:!0,timerId:a}}))),r(!1)},m="NATIVE_FILTER-",_="NATIVE_FILTER_DIVIDER-",h=e=>`${e===i.BE.NativeFilter?m:_}${a().generate()}`,f=e=>e.map((e=>e.id))},9531:(e,t,r)=>{"use strict";r.d(t,{I6:()=>l,Ky:()=>s,UN:()=>d,XX:()=>u,aF:()=>c,eV:()=>_,gz:()=>i,oB:()=>m,tw:()=>o,yT:()=>p});var n=r(46078),a=r(80621);const o={id:0,type:n.i9.Table,uid:"_placeholder_",datasource_name:"",table_name:"",columns:[],column_types:[],metrics:[],column_formats:{},currency_formats:{},verbose_map:{},main_dttm_col:"",description:""},s=53,i=32,l=260,c=550,d=80,u=374,p=["css","json_metadata.filter_scopes"],m=10,_={rootPath:[a._4],excluded:[]}},39759:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s,a:()=>o});var n=r(52794),a=r(4305);function o({filterConfig:e,state:t}){const r={},n={};var a;return e?(e.forEach((e=>{const{id:t}=e;n[t]=e})),r.filters=n):r.filters=null!=(a=null==t?void 0:t.filters)?a:{},r.focusedFilterId=void 0,r}function s(e={filters:{}},t){switch(t.type){case a.$:return{filters:t.data.nativeFilters.filters};case n.qe:case n.kN:return o({filterConfig:t.filterConfig,state:e});case n.X8:return{...e,focusedFilterId:t.id};case n.T6:return{...e,focusedFilterId:void 0};case n.jE:return{...e,hoveredFilterId:t.id};case n.TT:return{...e,hoveredFilterId:void 0};case n.rR:return{...e,filters:{...e.filters,[t.id]:{...e.filters[t.id],cascadeParentIds:t.parentIds}}};default:return e}}},52004:(e,t,r)=>{"use strict";var n;r.d(t,{$:()=>a,Bp:()=>n,_6:()=>o}),function(e){e.Vertical="VERTICAL",e.Horizontal="HORIZONTAL"}(n||(n={}));const a="global",o=e=>e===a},81255:(e,t,r)=>{"use strict";r.d(t,{BA:()=>a,BG:()=>s,F0:()=>u,Nc:()=>c,Os:()=>p,U0:()=>i,Vl:()=>o,ZP:()=>f,dW:()=>n,gn:()=>_,hE:()=>l,t:()=>h,xh:()=>d,yR:()=>m});const n="CHART",a="COLUMN",o="HEADER",s="GRID",i="ROOT",l="DIVIDER",c="HEADER",d="MARKDOWN",u="NEW_COMPONENT_SOURCE",p="ROW",m="TABS",_="TAB",h="DYNAMIC",f={CHART_TYPE:n,COLUMN_TYPE:a,DASHBOARD_HEADER_TYPE:o,DASHBOARD_GRID_TYPE:s,DASHBOARD_ROOT_TYPE:i,DIVIDER_TYPE:l,HEADER_TYPE:c,MARKDOWN_TYPE:d,NEW_COMPONENT_SOURCE_TYPE:u,ROW_TYPE:p,TABS_TYPE:m,TAB_TYPE:_,DYNAMIC_TYPE:h}},80621:(e,t,r)=>{"use strict";r.d(t,{AA:()=>R,Bu:()=>q,C3:()=>p,D0:()=>i,ES:()=>d,Ep:()=>x,HE:()=>C,Jd:()=>l,M2:()=>a,Mu:()=>E,NN:()=>h,NT:()=>w,Nb:()=>c,OE:()=>A,PV:()=>n,Q9:()=>D,TN:()=>N,Xk:()=>_,Z1:()=>u,Zn:()=>s,_4:()=>o,_B:()=>Z,b5:()=>I,cd:()=>y,cx:()=>v,cz:()=>T,dU:()=>U,es:()=>g,fw:()=>b,gR:()=>f,kS:()=>L,pQ:()=>O,u_:()=>S,vD:()=>m});const n="GRID_ID",a="HEADER_ID",o="ROOT_ID",s="DASHBOARD_VERSION_KEY",i="NEW_COMPONENTS_SOURCE_ID",l="NEW_CHART_ID",c="NEW_COLUMN_ID",d="NEW_DIVIDER_ID",u="NEW_HEADER_ID",p="NEW_MARKDOWN_ID",m="NEW_ROW_ID",_="NEW_TAB_ID",h="NEW_TABS_ID",f="NEW_DYNAMIC_COMPONENT",E=0,y=8,g=2*y,T=12,v=1,R=5,b=4,S="SMALL_HEADER",A="MEDIUM_HEADER",O="LARGE_HEADER",I="BACKGROUND_WHITE",C="BACKGROUND_TRANSPARENT",D=50,N="overwrite",w="overwriteConfirmed",L="newDashboard",q=65535,x=["LABEL"],U="ALL_FILTERS_ROOT";var Z;!function(e){e[e.None=0]="None",e[e.HideNav=1]="HideNav",e[e.HideNavAndTitle=2]="HideNavAndTitle",e[e.Report=3]="Report"}(Z||(Z={}))},52838:(e,t,r)=>{"use strict";r.d(t,{U:()=>p,g:()=>m});var n=r(50361),a=r.n(n),o=r(93185),s=r(37731),i=r(11064),l=r(16355),c=r(32873),d=r(52004),u=r(9531);const p=e=>(0,o.cr)(o.TT.DashboardCrossFilters)&&(void 0===e||e),m=(e,t,r)=>{var n;if(!(0,o.cr)(o.TT.DashboardCrossFilters))return;const p=null!=(n=t.global_chart_configuration)&&n.scope?{scope:t.global_chart_configuration.scope,chartsInScope:(0,c.Q)(t.global_chart_configuration.scope,Object.values(r).map((e=>e.id)),e)}:{scope:u.eV,chartsInScope:Object.values(r).map((e=>e.id))},m={};return Object.values(e).forEach((n=>{var o,u,_,h,f,E;const y=null==(o=n.meta)?void 0:o.chartId;var g;(0,s.Z)(y)&&((null!=(u=null==(_=null!=(h=(0,i.Z)().get(null==(f=r[y])||null==(E=f.form_data)?void 0:E.viz_type))?h:{})?void 0:_.behaviors)?u:[]).includes(l.cg.InteractiveChart)&&(null!=(g=t.chart_configuration)&&g[y]&&(m[y]=a()(t.chart_configuration[y])),m[y]||(m[y]={id:y,crossFilters:{scope:d.$}}),m[y].crossFilters.chartsInScope=(0,d._6)(m[y].crossFilters.scope)?p.chartsInScope.filter((e=>e!==Number(y))):(0,c.Q)(m[y].crossFilters.scope,Object.values(r).map((e=>e.id)),e)))})),{chartConfiguration:m,globalChartConfiguration:p}}},70400:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(17563);const a=new Set(["standalone","edit"]);function o(e){const t=n.parse(window.location.search);return Object.entries(t).reduce(((t,[r,n])=>"regular"===e&&a.has(r)||"reserved"===e&&!a.has(r)?t:Array.isArray(n)?{...t,[r]:n[0]}:{...t,[r]:n}),{})}},95173:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});const n={};function a(e){let t=null;if(e){const{childId:a,layout:o={}}=e;if(n[a]){var r;const e=(null==o?void 0:o[n[a]])||{};if(null!=e&&e.children&&null!=e&&null!=(r=e.children)&&null!=r.includes&&r.includes(a))return e.id}t=function(e){let t=null;if(e){const{childId:n,layout:a={}}=e;if(a){const e=Object.keys(a);for(let o=0;o<=e.length-1;o+=1){var r;const s=e[o],i=a[s]||{};if(s!==n&&null!=i&&null!=(r=i.children)&&null!=r.includes&&r.includes(n)){t=s;break}}}}return t}({childId:a,layout:o}),n[a]=t}return t}},32873:(e,t,r)=>{"use strict";r.d(t,{Q:()=>a});var n=r(81255);function a(e,t,r){const a=Object.values(r);return t.filter((t=>{var r,o;return!e.excluded.includes(t)&&(null==(r=a.find((e=>{var r;return(null==e?void 0:e.type)===n.dW&&(null==(r=e.meta)?void 0:r.chartId)===t})))||null==(o=r.parents)?void 0:o.some((t=>e.rootPath.includes(t))))}))}},20194:(e,t,r)=>{"use strict";function n({chartId:e,column:t}){return`${e}_${t}`}r.d(t,{_:()=>o,w:()=>n});const a=/^([0-9]+)_(.*)$/;function o(e){const t=a.exec(e);if(!t)throw new Error("Cannot parse invalid filter key");return{chartId:parseInt(t[1],10),column:t[2]}}},56967:(e,t,r)=>{"use strict";function n(){return(window.location.hash||"#").substring(1)}r.d(t,{Z:()=>n})},22318:(e,t,r)=>{"use strict";r.d(t,{Ms:()=>d,Xg:()=>p,i5:()=>l,N$:()=>u});var n=r(93185),a=r(68630),o=r.n(a);function s(e){return function(e){return o()(e)&&"username"in e}(e)&&"permissions"in e&&"roles"in e}var i=r(12617);const l=e=>s(e)&&Object.keys(e.roles||{}).some((e=>"admin"===e.toLowerCase())),c=(e,t)=>s(t)&&e.owners.some((e=>e.id===t.userId)),d=(e,t)=>s(t)&&(l(t)||c(e,t))&&(0,i.R)("can_write","Dashboard",null==t?void 0:t.roles);function u(e,t,r){return l(e)||s(e)&&Object.values(e.roles||{}).flat().some((e=>e[0]===r&&e[1]===t))}const p=(e,t)=>s(t)&&(0,i.R)("can_write","Dashboard",null==t?void 0:t.roles)&&(!(0,n.cr)(n.TT.DashboardRbac)||l(t)||c(e,t))},74599:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,Ch:()=>a,Ft:()=>l,eG:()=>c,mO:()=>s,sh:()=>u,u3:()=>i,ze:()=>d});var n=r(8868);const a="CLEAR_DATA_MASK_STATE",o="UPDATE_DATA_MASK",s="SET_DATA_MASK_FOR_FILTER_CONFIG_COMPLETE",i="SET_DATA_MASK_FOR_FILTER_CONFIG_FAIL";function l(e,t){return{type:s,filterConfig:e,filters:t}}function c(e,t){return{type:o,filterId:e,dataMask:t}}function d(e){return c(e,(0,n.H)(e))}function u(){return{type:a}}},8868:(e,t,r)=>{"use strict";r.d(t,{H:()=>c,Z:()=>u});var n=r(12902),a=r(93185),o=r(92242),s=r(4305),i=r(74599),l=r(99543);function c(e,t={}){let r={};return e&&(r={id:e}),{...r,extraFormData:{},filterState:{},ownState:{},...t}}function d(e,t,r,n,a){e.forEach((e=>{var r;const o=n||{};t[e.id]={...c(e.id),...e.defaultDataMask,...o[e.id]},a&&!(0,l.JB)(e.defaultDataMask,null==(r=a[e.id])?void 0:r.defaultDataMask,{ignoreUndefined:!0})&&(t[e.id]={...t[e.id],...e.defaultDataMask})})),Object.values(r).forEach((e=>{String(null==e?void 0:e.id).startsWith(o.rW)||(t[null==e?void 0:e.id]=e)}))}const u=(0,n.ZP)(((e,t)=>{var r,n,o,l;const u={};switch(t.type){case i.Ch:return u;case i.A:return e[t.filterId]={...c(t.filterId),...e[t.filterId],...t.dataMask},e;case s.$:var p,m;return(0,a.cr)(a.TT.DashboardCrossFilters)&&Object.keys(null==(p=t.data.dashboardInfo)||null==(m=p.metadata)?void 0:m.chart_configuration).forEach((e=>{u[e]={...c(e)}})),d(null!=(r=null==(n=t.data.dashboardInfo)||null==(o=n.metadata)?void 0:o.native_filter_configuration)?r:[],u,e,t.data.dataMask),u;case i.mO:return d(null!=(l=t.filterConfig)?l:[],u,e,t.filters),u;default:return e}}),{})},99068:(e,t,r)=>{"use strict";r.d(t,{AG:()=>i,yn:()=>d});var n=r(31069),a=r(72570),o=r(98286),s=r(651);const i="SET_DATASOURCE";function l(e){return{type:i,datasource:e}}function c(e){return function(t,r){const{explore:{datasource:n}}=r();t(l(e)),t((0,s.updateFormDataByDatasource)(n,e))}}const d={setDatasource:l,changeDatasource:c,saveDataset:function({schema:e,sql:t,database:r,templateParams:s,datasourceName:i,columns:l}){return async function(d){try{const{json:{data:a}}=await n.Z.post({endpoint:"/api/v1/dataset/",headers:{"Content-Type":"application/json"},body:JSON.stringify({database:null==r?void 0:r.id,table_name:i,schema:e,sql:t,template_params:s,columns:l})});return d(c(a)),a}catch(e){throw(0,o.O$)(e).then((e=>{d((0,a.Gb)(e.error))})),e}}}}},651:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CREATE_NEW_SLICE:()=>q,FETCH_DATASOURCES_STARTED:()=>m,FETCH_DATASOURCES_SUCCEEDED:()=>h,FETCH_DATASOURCE_SUCCEEDED:()=>u,FETCH_FAVE_STAR:()=>g,POST_DATASOURCE_STARTED:()=>d,SAVE_FAVE_STAR:()=>v,SET_EXPLORE_CONTROLS:()=>A,SET_FIELD_VALUE:()=>b,SET_FORCE_QUERY:()=>P,SET_FORM_DATA:()=>I,SET_SAVE_ACTION:()=>w,SET_STASH_FORM_DATA:()=>F,SLICE_UPDATED:()=>U,TOGGLE_FAVE_STAR:()=>E,UPDATE_CHART_TITLE:()=>D,UPDATE_FORM_DATA_BY_DATASOURCE:()=>l,createNewSlice:()=>x,exploreActions:()=>Q,fetchDatasourceSucceeded:()=>p,fetchDatasourcesStarted:()=>_,fetchDatasourcesSucceeded:()=>f,fetchFaveStar:()=>T,saveFaveStar:()=>R,setControlValue:()=>S,setExploreControls:()=>O,setForceQuery:()=>M,setFormData:()=>C,setSaveAction:()=>L,setStashFormData:()=>k,sliceUpdated:()=>Z,toggleFaveStar:()=>y,updateChartTitle:()=>N,updateFormDataByDatasource:()=>c});var n=r(15926),a=r.n(n),o=r(31069),s=r(61988),i=r(72570);const l="UPDATE_FORM_DATA_BY_DATASOURCE";function c(e,t){return{type:l,prevDatasource:e,newDatasource:t}}const d="POST_DATASOURCE_STARTED",u="FETCH_DATASOURCE_SUCCEEDED";function p(){return{type:u}}const m="FETCH_DATASOURCES_STARTED";function _(){return{type:m}}const h="FETCH_DATASOURCES_SUCCEEDED";function f(){return{type:h}}const E="TOGGLE_FAVE_STAR";function y(e){return{type:E,isStarred:e}}const g="FETCH_FAVE_STAR";function T(e){return function(t){o.Z.get({endpoint:`/api/v1/chart/favorite_status/?q=${a().encode([e])}`}).then((({json:e})=>{var r,n;t(y(!(null==e||null==(r=e.result)||null==(n=r[0])||!n.value)))}))}}const v="SAVE_FAVE_STAR";function R(e,t){return function(r){const n=`/api/v1/chart/${e}/favorites/`;(t?o.Z.delete({endpoint:n}):o.Z.post({endpoint:n})).then((()=>r(y(!t)))).catch((()=>{r((0,i.Gb)((0,s.t)("An error occurred while starring this chart")))}))}}const b="SET_FIELD_VALUE";function S(e,t,r){return{type:b,controlName:e,value:t,validationErrors:r}}const A="UPDATE_EXPLORE_CONTROLS";function O(e){return{type:A,formData:e}}const I="UPDATE_FORM_DATA";function C(e){return{type:I,formData:e}}const D="UPDATE_CHART_TITLE";function N(e){return{type:D,sliceName:e}}const w="SET_SAVE_ACTION";function L(e){return{type:w,saveAction:e}}const q="CREATE_NEW_SLICE";function x(e,t,r,n,a){return{type:q,can_add:e,can_download:t,can_overwrite:r,slice:n,form_data:a}}const U="SLICE_UPDATED";function Z(e){return{type:U,slice:e}}const P="SET_FORCE_QUERY";function M(e){return{type:P,force:e}}const F="SET_STASH_FORM_DATA";function k(e,t){return{type:F,isHidden:e,fieldNames:t}}const Q={...i.s2,fetchDatasourcesStarted:_,fetchDatasourcesSucceeded:f,toggleFaveStar:y,fetchFaveStar:T,saveFaveStar:R,setControlValue:S,setExploreControls:O,setStashFormData:k,updateChartTitle:N,createNewSlice:x,sliceUpdated:Z,setForceQuery:M}},76445:(e,t,r)=>{"use strict";r.d(t,{_:()=>f,u:()=>E});var n,a=r(12515),o=r(35854),s=r(5364),i=r(10581),l=r(55786),c=r(81545),d=r(45511),u=r(10331),p=r(42313),m=r(23525),_=r(27600),h=r(12617);!function(e){e.CATEGORICAL="CATEGORICAL",e.SEQUENTIAL="SEQUENTIAL"}(n||(n={}));const f="HYDRATE_EXPLORE",E=({form_data:e,slice:t,dataset:r,metadata:E,saveAction:y=null})=>(g,T)=>{var v,R;const{user:b,datasources:S,charts:A,sliceEntities:O,common:I,explore:C}=T(),D=(0,m.eY)(_.KD.sliceId),N=(0,m.eY)(_.KD.dashboardId),w=D?null==O||null==(v=O.slices)?void 0:v[D]:null,L=null!=t?t:w,q=null!=e?e:null==L?void 0:L.form_data;if(!q.viz_type){const e=(null==I?void 0:I.conf.DEFAULT_VIZ_TYPE)||"table";q.viz_type=(0,m.eY)(_.KD.vizType)||e}var x;q.time_range||(q.time_range=(null==I||null==(x=I.conf)?void 0:x.DEFAULT_TIME_FILTER)||s.vM),!q.include_time||!q.granularity_sqla||null!=(R=q.groupby)&&R.some((e=>(0,i.Z)(e)===(0,i.Z)(q.granularity_sqla)))||(q.groupby=[q.granularity_sqla,...(0,l.Z)(q.groupby)],q.granularity_sqla=void 0),N&&(q.dashboardId=N);const U=r,Z={form_data:q,slice:L,datasource:U},P=(0,o.R3)(Z,q),M=P.color_scheme&&"color_scheme",F=P.linear_color_scheme&&"linear_color_scheme",k=e=>{const t="CATEGORICAL"===e?(0,c.Z)():(0,d.Z)(),r="CATEGORICAL"===e?M:F,n=t.defaultKey,a="CATEGORICAL"===e?"supersetColors":"superset_seq_1",o=q[r],s=!!t.get(o,!0);o&&!s&&(P[r].value=n||a)};M&&k(n.CATEGORICAL),F&&k(n.SEQUENTIAL);const Q={can_add:(0,h.R)("can_write","Chart",null==b?void 0:b.roles),can_download:(0,h.R)("can_csv","Superset",null==b?void 0:b.roles),can_overwrite:(0,l.Z)(null==t?void 0:t.owners).includes(null==b?void 0:b.userId),isDatasourceMetaLoading:!1,isStarred:!1,triggerRender:!1,datasource:U,controls:P,form_data:q,slice:L,controlsTransferred:C.controlsTransferred,standalone:(0,m.eY)(_.KD.standalone),force:(0,m.eY)(_.KD.force),metadata:E,saveAction:y,common:I};Object.entries(Q.controls).forEach((([e,t])=>{Q.controls[e]=(0,u.RO)(t,Q)}));const $=L?(0,u.Hu)(P):null,Y=(0,a.Jp)(Z),B={id:Y,chartAlert:null,chartStatus:null,chartStackTrace:null,chartUpdateEndTime:null,chartUpdateStartTime:0,latestQueryFormData:(0,u.Hu)(Q.controls),sliceFormData:$,queryController:null,queriesResponse:null,triggerQuery:!1,lastRendered:0};return g({type:f,data:{charts:{...A,[Y]:B},datasources:{...S,[(0,p.T)(U)]:U},saveModal:{dashboards:[],saveModalAlert:null,isVisible:!1},explore:Q}})}},99963:(e,t,r)=>{"use strict";r.d(t,{B:()=>l,l:()=>c}),r(67294);var n=r(51995),a=r(51384),o=r(65634),s=r(11965);const i=n.iK.div`
  width: 100%;
  > span {
    display: flex;
    align-items: center;
  }

  .option-label {
    display: inline-block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    & ~ i {
      margin-left: ${({theme:e})=>e.gridUnit}px;
    }
  }
  .type-label {
    margin-right: ${({theme:e})=>3*e.gridUnit}px;
    width: ${({theme:e})=>7*e.gridUnit}px;
    display: inline-block;
    text-align: center;
    font-weight: ${({theme:e})=>e.typography.weights.bold};
  }
`,l=e=>(0,s.tZ)(i,null,(0,s.tZ)(a.m,e)),c=e=>(0,s.tZ)(i,null,(0,s.tZ)(o.E,e))},69856:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>c,GS:()=>l,H7:()=>f,LT:()=>i,Ps:()=>o,Q_:()=>m,YY:()=>a,Yl:()=>g,d:()=>s,i2:()=>h,kc:()=>E,m_:()=>_,qB:()=>u,qK:()=>d,xA:()=>y,yi:()=>p});var n=r(61988);const a={AVG:"AVG",COUNT:"COUNT",COUNT_DISTINCT:"COUNT_DISTINCT",MAX:"MAX",MIN:"MIN",SUM:"SUM"},o=Object.values(a);var s;!function(e){e.Equals="EQUALS",e.NotEquals="NOT_EQUALS",e.LessThan="LESS_THAN",e.LessThanOrEqual="LESS_THAN_OR_EQUAL",e.GreaterThan="GREATER_THAN",e.GreaterThanOrEqual="GREATER_THAN_OR_EQUAL",e.In="IN",e.NotIn="NOT_IN",e.Like="LIKE",e.CaseInsensitiveLike="ILIKE",e.IsNotNull="IS_NOT_NULL",e.IsNull="IS_NULL",e.LatestPartition="LATEST_PARTITION",e.IsTrue="IS_TRUE",e.IsFalse="IS_FALSE",e.TemporalRange="TEMPORAL_RANGE"}(s||(s={}));const i={[s.Equals]:{display:(0,n.t)("Equal to (=)"),operation:"=="},[s.NotEquals]:{display:(0,n.t)("Not equal to (≠)"),operation:"!="},[s.LessThan]:{display:(0,n.t)("Less than (<)"),operation:"<"},[s.LessThanOrEqual]:{display:(0,n.t)("Less or equal (<=)"),operation:"<="},[s.GreaterThan]:{display:(0,n.t)("Greater than (>)"),operation:">"},[s.GreaterThanOrEqual]:{display:(0,n.t)("Greater or equal (>=)"),operation:">="},[s.In]:{display:(0,n.t)("In"),operation:"IN"},[s.NotIn]:{display:(0,n.t)("Not in"),operation:"NOT IN"},[s.Like]:{display:(0,n.t)("Like"),operation:"LIKE"},[s.CaseInsensitiveLike]:{display:(0,n.t)("Like (case insensitive)"),operation:"ILIKE"},[s.IsNotNull]:{display:(0,n.t)("Is not null"),operation:"IS NOT NULL"},[s.IsNull]:{display:(0,n.t)("Is null"),operation:"IS NULL"},[s.LatestPartition]:{display:(0,n.t)("use latest_partition template"),operation:"LATEST PARTITION"},[s.IsTrue]:{display:(0,n.t)("Is true"),operation:"=="},[s.IsFalse]:{display:(0,n.t)("Is false"),operation:"=="},[s.TemporalRange]:{display:(0,n.t)("TEMPORAL_RANGE"),operation:"TEMPORAL_RANGE"}},l=Object.values(s),c=(s.Like,s.CaseInsensitiveLike,[s.Equals,s.NotEquals,s.LessThan,s.LessThanOrEqual,s.GreaterThan,s.GreaterThanOrEqual]),d=new Set([s.In,s.NotIn]),u=new Set([s.LatestPartition,s.TemporalRange]),p=[s.IsNotNull,s.IsNull,s.LatestPartition,s.IsTrue,s.IsFalse],m=/^(LONG|DOUBLE|FLOAT)?(SUM|AVG|MAX|MIN|COUNT)\([A-Z0-9_."]*\)$/i,_={time_range:(0,n.t)("Time range"),granularity_sqla:(0,n.t)("Time column"),time_grain_sqla:(0,n.t)("Time grain"),granularity:(0,n.t)("Time granularity")},h={time_range:"__time_range",granularity_sqla:"__time_col",time_grain_sqla:"__time_grain",granularity:"__granularity"},f=240,E=320,y=0,g=new Set(["all_columns","groupby","metrics","percent_metrics","order_by_cols"])},10331:(e,t,r)=>{"use strict";r.d(t,{os:()=>P,RO:()=>R,mi:()=>S,Bx:()=>T,vP:()=>b,YY:()=>D,Hu:()=>A,Bq:()=>y});var n={};r.r(n),r.d(n,{NVD3TimeSeries:()=>f,annotations:()=>h,colorScheme:()=>m,datasourceAndVizType:()=>p,sqlaTimeSeries:()=>_});var a=r(30845),o=r(46078),s=r(37687),i=r(38575),l=r(89368),c=(r(67294),r(61988)),d=r(46666),u=r(11965);const p={controlSetRows:[["datasource"],["viz_type"],[{name:"slice_id",config:{type:"HiddenControl",label:(0,c.t)("Chart ID"),hidden:!0,description:(0,c.t)("The id of the active chart")}},{name:"cache_timeout",config:{type:"HiddenControl",label:(0,c.t)("Cache Timeout (seconds)"),hidden:!0,description:(0,c.t)("The number of seconds before expiring the cache")}},{name:"url_params",config:{type:"HiddenControl",label:(0,c.t)("URL parameters"),hidden:!0,description:(0,c.t)("Extra parameters for use in jinja templated queries")}}]]},m={label:(0,c.t)("Color scheme"),controlSetRows:[["color_scheme"]]},_={label:(0,c.t)("Time"),description:(0,c.t)("Time related form attributes"),expanded:!0,controlSetRows:[["granularity_sqla"],["time_range"]]},h={label:(0,c.t)("Annotations and layers"),tabOverride:"data",expanded:!0,controlSetRows:[[{name:"annotation_layers",config:{type:"AnnotationLayerControl",label:"",default:[],description:(0,c.t)("Annotation layers"),renderTrigger:!0,tabOverride:"data"}}]]},f=[{label:(0,c.t)("Query"),expanded:!0,controlSetRows:[["metrics"],["adhoc_filters"],["groupby"],["limit","timeseries_limit_metric"],["order_desc"],[{name:"contribution",config:{type:"CheckboxControl",label:(0,c.t)("Contribution"),default:!1,description:(0,c.t)("Compute the contribution to the total")}}],["row_limit",null]]},{label:(0,c.t)("Advanced analytics"),tabOverride:"data",description:(0,c.t)("This section contains options that allow for advanced analytical post processing of query results"),controlSetRows:[[(0,u.tZ)(d.U,null,(0,c.t)("Rolling window"))],[{name:"rolling_type",config:{type:"SelectControl",label:(0,c.t)("Rolling function"),default:"None",choices:[["None",(0,c.t)("None")],["mean",(0,c.t)("mean")],["sum",(0,c.t)("sum")],["std",(0,c.t)("std")],["cumsum",(0,c.t)("cumsum")]],description:(0,c.t)("Defines a rolling window function to apply, works along with the [Periods] text box")}},{name:"rolling_periods",config:{type:"TextControl",label:(0,c.t)("Periods"),isInt:!0,description:(0,c.t)("Defines the size of the rolling window function, relative to the time granularity selected")}},{name:"min_periods",config:{type:"TextControl",label:(0,c.t)("Min periods"),isInt:!0,description:(0,c.t)('The minimum number of rolling periods required to show a value. For instance if you do a cumulative sum on 7 days you may want your "Min Period" to be 7, so that all data points shown are the total of 7 periods. This will hide the "ramp up" taking place over the first 7 periods')}}],[(0,u.tZ)(d.U,null,(0,c.t)("Time comparison"))],[{name:"time_compare",config:{type:"SelectControl",multi:!0,freeForm:!0,label:(0,c.t)("Time shift"),choices:[["1 day",(0,c.t)("1 day")],["1 week",(0,c.t)("1 week")],["28 days",(0,c.t)("28 days")],["30 days",(0,c.t)("30 days")],["52 weeks",(0,c.t)("52 weeks")],["1 year",(0,c.t)("1 year")],["104 weeks",(0,c.t)("104 weeks")],["2 years",(0,c.t)("2 years")],["156 weeks",(0,c.t)("156 weeks")],["3 years",(0,c.t)("3 years")]],description:(0,c.t)("Overlay one or more timeseries from a relative time period. Expects relative time deltas in natural language (example: 24 hours, 7 days, 52 weeks, 365 days). Free text is supported.")}},{name:"comparison_type",config:{type:"SelectControl",label:(0,c.t)("Calculation type"),default:"values",choices:[["values",(0,c.t)("Actual values")],["absolute",(0,c.t)("Difference")],["percentage",(0,c.t)("Percentage change")],["ratio",(0,c.t)("Ratio")]],description:(0,c.t)("How to display time shifts: as individual lines; as the difference between the main time series and each time shift; as the percentage change; or as the ratio between series and time shifts.")}}],[(0,u.tZ)(d.U,null,(0,c.t)("Resample"))],[{name:"resample_rule",config:{type:"SelectControl",freeForm:!0,label:(0,c.t)("Rule"),default:null,choices:[["1T",(0,c.t)("1T")],["1H",(0,c.t)("1H")],["1D",(0,c.t)("1D")],["7D",(0,c.t)("7D")],["1M",(0,c.t)("1M")],["1AS",(0,c.t)("1AS")]],description:(0,c.t)("Pandas resample rule")}},{name:"resample_method",config:{type:"SelectControl",freeForm:!0,label:(0,c.t)("Method"),default:null,choices:[["asfreq",(0,c.t)("asfreq")],["bfill",(0,c.t)("bfill")],["ffill",(0,c.t)("ffill")],["median",(0,c.t)("median")],["mean",(0,c.t)("mean")],["sum",(0,c.t)("sum")]],description:(0,c.t)("Pandas resample method")}}]]}],E=(0,a.Z)(((e,t)=>{const{sectionOverrides:r={},controlOverrides:a,controlPanelSections:s=[]}=t,c={...n};Object.entries(r).forEach((([e,t])=>{"object"==typeof t&&t.constructor===Object?c[e]={...c[e],...t}:c[e]=t}));const{datasourceAndVizType:d}=c,u=[o.i9.Query,o.i9.Table].includes(e)?["granularity"]:["granularity_sqla","time_grain_sqla"];return[d].concat(s.filter(i.D_)).map((e=>{const{controlSetRows:t}=e;return{...e,controlSetRows:(null==t?void 0:t.map((e=>e.filter((e=>"string"!=typeof e||!u.includes(e))).map((e=>(0,l.q)(e,a))))))||[]}}))}));function y(e,t){const r=(0,s.Z)().get(e)||{};return E(t,r)}const g=(0,a.Z)(((e,t)=>{const{controlOverrides:r={},controlPanelSections:n=[]}=t,a=(0,l.q)(function(e,t){var r;return null!=(r=e.filter(i.D_).map((e=>e.controlSetRows)).flat(2).find((e=>t===e||null!==e&&"object"==typeof e&&"name"in e&&e.name===t)))?r:null}(n,e),r);return a&&"config"in a?a.config:a})),T=function(e,t){const r=(0,s.Z)().get(t)||{};return g(e,r)};var v=r(55786);function R(e,t){const{mapStateToProps:r}=e;let n={...e},{value:a}=n;return r&&t&&(n={...e,...r.call(e,t,e)},a=a||n.value),"function"==typeof n.initialValue&&(n.initialValue=n.initialValue(n,t),"function"==typeof n.initialValue&&delete n.initialValue),n.initialValue&&(a=n.initialValue,delete n.initialValue),"function"==typeof n.default&&(n.default=n.default(n,t),"function"==typeof n.default&&delete n.default),n.default&&void 0===a&&(a=n.default),a&&n.multi&&!Array.isArray(a)&&(a=[a]),n.value=a,function(e,t){const r=e.validators,{externalValidationErrors:n=[]}=e,a=[];r&&r.length>0&&r.forEach((r=>{const n=r.call(e,e.value,t);n&&a.push(n)}));const o=[...a,...n];return{...e,validationErrors:o}}(function(e){if("SelectControl"===e.type&&!e.freeForm&&e.choices&&e.value){const t={...e},r=e.choices,n=(0,v.Z)(e.value),a=r.map((e=>e[0]));if(e.multi&&n.length>0)return t.value=n.filter((e=>a.includes(e))),t;if(!e.multi&&!a.includes(n[0]))return t.value=null,t}return e}(n),n)}function b(e,t,r){if(!e)return null;const n={...e,value:r};return null!=t&&t.controls||null===t?R(n,t):n}function S(e,t,r,n){const a={};return y(e,t).forEach((e=>e.controlSetRows.forEach((e=>e.forEach((e=>{if(null!=e&&e.config&&e.name){const{config:t,name:o}=e;a[o]=b(t,r,n[o])}})))))),a}function A(e){const t={};return Object.keys(e).forEach((r=>{const n=e[r];t[r]=n.value})),t}var O=r(62446),I=r(46306);const C=(e,t,r)=>t.options&&"string"==typeof r&&t.options.some((e=>Array.isArray(e)?e[0]===r:e.column_name===r))?e.columns.some((e=>e.column_name===r)):t.savedMetrics&&(0,O.AG)(r)&&t.savedMetrics.some((e=>e.metric_name===r))?e.metrics.some((e=>e.metric_name===r)):t.columns&&((0,O.nX)(r)||(0,I.Ki)(r))&&t.columns.some((e=>{var t;return e.column_name===(null==(t=r.column)?void 0:t.column_name)||e.column_name===r.subject}))?e.columns.some((e=>{var t;return e.column_name===(null==(t=r.column)?void 0:t.column_name)||e.column_name===r.subject})):!!(0,O.q5)(r)&&(Object.assign(r,{datasourceWarning:!0}),!0),D=(e,t,r)=>{if(null!=r){if(Array.isArray(r)){const n=r.filter((r=>C(e,t,r)));return n.length>0?n:t.default}return C(e,t,r)?r:t.default}};var N=r(57557),w=r.n(N),L=r(20002),q=r(35854);const x=["metric","metrics","metric_2","size","x","y","secondary_metric"],U=["groupby","columns","groupbyColumns","groupbyRows","entity","series","series_columns"],Z=["granularity_sqla","time_grain_sqla","time_range","adhoc_filters","limit","timeseries_limit_metric","series_limit_metric","order_desc","row_limit","x_axis","rolling_type","rolling_periods","min_periods","time_compare","comparison_type","resample_rule","resample_method"];class P{constructor(e){var t,r;this.sfd=void 0;const n=Object.freeze(e),a=null==n||null==(t=n.standardizedFormData)?void 0:t.memorizedFormData,o=n.viz_type;let s,i=new Map;if(Array.isArray(a)&&a.length>0&&n.datasource===(null==(r=a.slice(-1)[0][1])?void 0:r.datasource))i=new Map(n.standardizedFormData.memorizedFormData),i.has(o)&&i.delete(o),i.set(o,n),s=P.getStandardizedControls(n);else{const e=w()(n,"standardizedFormData");i.set(o,e),s=P.getStandardizedControls(e)}this.sfd={controls:s,memorizedFormData:i}}static getStandardizedControls(e){const t={metrics:[],columns:[]};if(Object.entries(e).forEach((([e,r])=>{x.includes(e)&&t.metrics.push(...(0,v.Z)(r)),U.includes(e)&&t.columns.push(...(0,v.Z)(r))})),(0,i.pp)(e)){const{metrics:r,columns:n}=e.standardizedFormData.controls;t.metrics.push(...r),t.columns.push(...n)}return t}getLatestFormData(e){return this.has(e)?this.get(e):this.memorizedFormData.slice(-1)[0][1]}get standardizedControls(){return this.sfd.controls}get memorizedFormData(){return Array.from(this.sfd.memorizedFormData.entries())}serialize(){return{controls:this.standardizedControls,memorizedFormData:this.memorizedFormData}}has(e){return this.sfd.memorizedFormData.has(e)}get(e){return this.sfd.memorizedFormData.get(e)}transform(e,t){const r=this.getLatestFormData(e),n={};Z.forEach((e=>{e in t.form_data&&(n[e]=t.form_data[e])}));const a=(0,q.R3)(t,{...r,...n,viz_type:e}),o={...A(a),standardizedFormData:this.serialize()};let i={formData:o,controlsState:a};const l=(0,s.Z)().get(e);if(null!=l&&l.formDataOverrides){(0,L.u)().setStandardizedControls(o);const e={...l.formDataOverrides(o),standardizedFormData:{controls:{...(0,L.u)().controls},memorizedFormData:this.memorizedFormData}};(0,L.u)().clear(),i={formData:e,controlsState:(0,q.R3)(t,e)}}return i.controlsState=(0,q.R3)({...t,controls:i.controlsState},i.formData),i}}},42190:(e,t,r)=>{"use strict";r.d(t,{l6:()=>i,ni:()=>n,s_:()=>c});var n,a=r(22102),o=r(67294);!function(e){e.Loading="loading",e.Complete="complete",e.Error="error"}(n||(n={}));const s={status:n.Loading,result:null,error:null};function i(e,t){return(0,o.useMemo)((()=>{if(e.status!==n.Complete)return e;try{return{...e,result:t(e.result)}}catch(e){return{status:n.Error,result:null,error:e}}}),[e,t])}const l=e=>e.result;function c(e){return i(function(e){const[t,r]=(0,o.useState)(s),i=(0,o.useRef)((()=>{}));return(0,o.useEffect)((()=>{r(s),i.current();let t=!1;return i.current=()=>{t=!0},(0,a.Z)({method:"GET",endpoint:e})({}).then((e=>{t||r({status:n.Complete,result:e,error:null})})).catch((e=>{t||r({status:n.Error,result:null,error:e})})),()=>{t=!0}}),[e]),t}(e),l)}},10362:(e,t,r)=>{"use strict";r.d(t,{h:()=>l});var n=r(15926),a=r.n(n),o=r(98286),s=r(30848),i=r(31069);const l=(0,s.LC)({reducerPath:"queryApi",tagTypes:["Schemas","Tables","DatabaseFunctions","QueryValidations","TableMetadatas","SqlLabInitialState","EditorQueries"],endpoints:()=>({}),baseQuery:({endpoint:e,urlParams:t,transformResponse:r,method:n="GET",parseMethod:s="json",...l},c)=>i.Z.request({...l,endpoint:`${e}${t?`?q=${a().encode(t)}`:""}`,method:n,parseMethod:s,signal:c.signal}).then((e=>{var t;return{data:null!=(t=null==r?void 0:r(e))?t:e}})).catch((e=>(0,o.O$)(e).then((t=>({error:{error:(null==t?void 0:t.message)||(null==t?void 0:t.error)||e.statusText,status:e.status}})))))})},69279:(e,t,r)=>{"use strict";r.d(t,{Kt:()=>l,Xx:()=>u});var n=r(67294),a=r(38325);const o=r(10362).h.injectEndpoints({endpoints:e=>({schemas:e.query({providesTags:[{type:"Schemas",id:"LIST"}],query:({dbId:e,forceRefresh:t})=>({endpoint:`/api/v1/database/${e}/schemas/`,urlParams:{force:t},transformResponse:({json:e})=>e.result.map((e=>({value:e,label:e,title:e})))}),serializeQueryArgs:({queryArgs:{dbId:e}})=>({dbId:e})})})}),{useLazySchemasQuery:s,useSchemasQuery:i,endpoints:l,util:c}=o,d=[];function u(e){const t=(0,n.useRef)(!1),{dbId:r,onSuccess:o,onError:l}=e||{},[c]=s(),u=i({dbId:r,forceRefresh:!1},{skip:!r}),p=(0,a.Z)(((e,t)=>{null==o||o(e,t)})),m=(0,a.Z)((()=>{null==l||l()})),_=(0,n.useCallback)((()=>{r&&c({dbId:r,forceRefresh:!0}).then((({isSuccess:e,isError:t,data:r})=>{e&&p(r||d,!0),t&&m()}))}),[r,m,p,c]);return(0,n.useEffect)((()=>{if(t.current){const{requestId:e,isSuccess:t,isError:r,isFetching:n,data:a,originalArgs:o}=u;null!=o&&o.forceRefresh||!e||n||(t&&p(a||d,!1),r&&m())}else t.current=!0}),[u,p,m]),{...u,refetch:_}}},23936:(e,t,r)=>{"use strict";r.d(t,{$K:()=>m,QD:()=>p,SJ:()=>u,uY:()=>d,zA:()=>_});var n=r(67294),a=r(38325),o=r(10362),s=r(69279);const i=o.h.injectEndpoints({endpoints:e=>({tables:e.query({providesTags:["Tables"],query:({dbId:e,schema:t,forceRefresh:r})=>({endpoint:`/api/v1/database/${null!=e?e:"undefined"}/tables/`,urlParams:{force:r,schema_name:t?encodeURIComponent(t):""},transformResponse:({json:e})=>({options:e.result,hasMore:e.count>e.result.length})}),serializeQueryArgs:({queryArgs:{dbId:e,schema:t}})=>({dbId:e,schema:t})}),tableMetadata:e.query({query:({dbId:e,schema:t,table:r})=>({endpoint:`/api/v1/database/${e}/table/${encodeURIComponent(r)}/${encodeURIComponent(t)}/`,transformResponse:({json:e})=>e})}),tableExtendedMetadata:e.query({query:({dbId:e,schema:t,table:r})=>({endpoint:`/api/v1/database/${e}/table_extra/${encodeURIComponent(r)}/${encodeURIComponent(t)}/`,transformResponse:({json:e})=>e})})})}),{useLazyTablesQuery:l,useTablesQuery:c,useTableMetadataQuery:d,useTableExtendedMetadataQuery:u,endpoints:p,util:m}=i;function _(e){const t=(0,n.useRef)(!1),{data:r,isFetching:o}=(0,s.Xx)({dbId:e.dbId}),i=(0,n.useMemo)((()=>new Set(null==r?void 0:r.map((({value:e})=>e)))),[r]),{dbId:d,schema:u,onSuccess:p,onError:m}=e||{},_=Boolean(d&&u&&!o&&i.has(u)),h=c({dbId:d,schema:u,forceRefresh:!1},{skip:!_}),[f]=l(),E=(0,a.Z)(((e,t)=>{null==p||p(e,t)})),y=(0,a.Z)((e=>{null==m||m(e)})),g=(0,n.useCallback)((()=>{_&&f({dbId:d,schema:u,forceRefresh:!0}).then((({isSuccess:e,isError:t,data:r,error:n})=>{e&&r&&E(r,!0),t&&y(n)}))}),[d,u,_,E,y,f]);return(0,n.useEffect)((()=>{if(t.current){const{requestId:e,isSuccess:t,isError:r,isFetching:n,data:a,error:o,originalArgs:s}=h;null!=s&&s.forceRefresh||!e||n||(t&&a&&E(a,!1),r&&y(o))}else t.current=!0}),[h,E,y]),{...h,refetch:g}}},74004:(e,t,r)=>{"use strict";r.d(t,{n:()=>o});var n=r(67294),a=r(27600);function o(e,t=a.oP){const[r,o]=(0,n.useState)(e);return(0,n.useEffect)((()=>{const r=setTimeout((()=>{o(e)}),t);return()=>{clearTimeout(r)}}),[e,t]),r}},38325:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(97654);function a(e){return(0,n.Z)(e)}},3741:(e,t,r)=>{"use strict";r.d(t,{$K:()=>$,$b:()=>i,BL:()=>N,Bu:()=>H,Eh:()=>T,Ep:()=>d,Ev:()=>o,F8:()=>C,FY:()=>g,H3:()=>p,Im:()=>q,Iq:()=>l,JC:()=>B,Kr:()=>O,P$:()=>R,P2:()=>Y,PC:()=>h,Ph:()=>y,QB:()=>k,Qg:()=>E,S:()=>m,Sl:()=>G,TA:()=>v,TD:()=>c,TG:()=>P,TY:()=>K,Tl:()=>w,W9:()=>n,Wl:()=>s,Yd:()=>J,ZX:()=>L,aD:()=>a,aN:()=>j,br:()=>f,bv:()=>Q,du:()=>W,g3:()=>U,iA:()=>V,kK:()=>F,kV:()=>b,n2:()=>A,oK:()=>_,qL:()=>Z,t4:()=>D,vH:()=>u,xD:()=>M,xE:()=>I,yG:()=>z,yw:()=>S,zf:()=>x});const n="load_chart",a="render_chart",o="hide_browser_tab",s="mount_dashboard",i="mount_explorer",l="select_dashboard_tab",c="force_refresh_chart",d="change_explore_controls",u="toggle_edit_dashboard",p="force_refresh_dashboard",m="periodic_render_dashboard",_="explore_dashboard_chart",h="export_csv_dashboard_chart",f="export_xlsx_dashboard_chart",E="change_dashboard_filter",y="dataset_creation_empty_cancellation",g="dataset_creation_database_cancellation",T="dataset_creation_schema_cancellation",v="dataset_creation_table_cancellation",R="dataset_creation_success",b="spa_navigation",S="confirm_overwrite_dashboard_metadata",A="dashboard_download_as_image",O="dashboard_download_as_pdf",I="chart_download_as_image",C="chart_download_as_csv",D="chart_download_as_csv_pivoted",N="chart_download_as_xls",w="chart_download_as_json",L="sqllab_warn_local_storage_usage",q="sqllab_fetch_failed_query",x="drill_by_modal_opened",U="further_drill_by",Z="drill_by_edit_chart",P="drill_by_breadcrumb_clicked",M="sqllab_monitor_local_storage_usage",F="sqllab_create_table_as",k="sqllab_create_view_as",Q="sqllab_run_query",$="sqllab_stop_query",Y="sqllab_estimate_query_cost",B="sqllab_save_query",H="sqllab_copy_link",j="sqllab_format_sql",V="sqllab_download_csv",G="sqllab_copy_result_to_clipboard",z="sqllab_create_chart",W="sqllab_load_tab_state",K=new Set([n,a,o,q,W]),J=(new Set([s,l,_,c,h,E,d,u,p,m,i,S,A,O,I]),{timeOriginOffset:0,markTimeOrigin(){this.timeOriginOffset=window.performance.now()},getTimestamp(){return Math.round(window.performance.now()-this.timeOriginOffset)}})},97381:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LOG_EVENT:()=>n,logEvent:()=>a});const n="LOG_EVENT";function a(e,t){return r=>r({type:n,payload:{eventName:e,eventData:t}})}},77997:(e,t,r)=>{"use strict";r.d(t,{YJ:()=>g});var n=r(31069),a=r(55786),o=r(68492),s=r(22102),i=r(93185),l=r(20292),c=r(98286);const d="polling",u="last_async_event_id";let p,m,_,h,f,E,y;const g=async e=>new Promise(((t,r)=>{const s=e.job_id;var i;i=async e=>{switch(e.status){case"done":{let{data:o,status:s}=await(async e=>{let t,r="success";try{const{json:r}=await n.Z.get({endpoint:String(e.result_url)});t="result"in r?r.result:r}catch(e){r="error",t=await(0,c.O$)(e)}return{status:r,data:t}})(e);o=(0,a.Z)(o),"success"===s?t(o):r(o);break}case"error":{const t=(0,c.MV)(e);r(t);break}default:o.Z.warn("received event with status",e.status)}var i;f[i=s]&&delete f[i]},f[s]=i})),T=(0,s.Z)({method:"GET",endpoint:"/api/v1/async_event/"}),v=async e=>{e.forEach((e=>{const t=e.job_id,r=f[t];r?(r(e),delete E[t]):(E[t]||(E[t]=0),E[t]+=1,E[t]<=6?setTimeout((()=>{v([e])}),100*E[t]):(delete E[t],o.Z.warn("listener not found for job_id",e.job_id))),(e=>{y=e.id;try{localStorage.setItem(u,y)}catch(e){o.Z.warn("Error saving event Id to localStorage",e)}})(e)}))},R=async()=>{const e=y?{last_id:y}:{};if(Object.keys(f).length)try{const{result:t}=await T(e);null!=t&&t.length&&await v(t)}catch(e){o.Z.warn(e)}m===d&&(h=window.setTimeout(R,_))};let b,S,A=0;const O=()=>{let e=p.GLOBAL_ASYNC_QUERIES_WEBSOCKET_URL;y&&(e+=`?last_id=${y}`),S=new WebSocket(e),S.addEventListener("open",(()=>{o.Z.log("WebSocket connected"),clearTimeout(b),A=0})),S.addEventListener("close",(()=>{b=setTimeout((()=>{A+=1,A<=6?O():(o.Z.warn("WebSocket not available, falling back to async polling"),R())}),2500)})),S.addEventListener("error",(()=>{S.readyState<2&&S.close()})),S.addEventListener("message",(async e=>{let t=[];try{t=[JSON.parse(e.data)],await v(t)}catch(e){o.Z.warn(e)}}))};(e=>{if((0,i.cr)(i.TT.GlobalAsyncQueries)){h&&clearTimeout(h),f={},E={},y=null,p=(0,l.Z)().common.conf,m=p.GLOBAL_ASYNC_QUERIES_TRANSPORT||d,_=p.GLOBAL_ASYNC_QUERIES_POLLING_DELAY||500;try{y=localStorage.getItem(u)}catch(e){o.Z.warn("Failed to fetch last event Id from localStorage")}m===d&&R(),"ws"===m&&O()}})()},99543:(e,t,r)=>{"use strict";r.d(t,{JB:()=>A,SJ:()=>y,_0:()=>b,gP:()=>v,gf:()=>T,p1:()=>R,wK:()=>g,zd:()=>S});var n=r(28368),a=r.n(n),o=r(45220),s=r.n(o),i=r(52353),l=r.n(i),c=r(57557),d=r.n(c),u=r(14176),p=r.n(u),m=r(18446),_=r.n(m),h=r(14670),f=r.n(h),E=(r(64417),r(55786));function y(e,t,r){const n={...e[t]},a={...r};return a.id||(a.id=f().generate()),n[a.id]=a,{...e,[t]:n}}function g(e,t,r,n){const a={...e[t]};return a[r.id]={...a[r.id],...n},{...e,[t]:a}}function T(e,t,r,n,a="id"){const o=[];return e[t].forEach((e=>{r[a]===e[a]?o.push({...e,...n}):o.push(e)})),{...e,[t]:o}}function v(e,t,r,n="id"){const a=[];return e[t].forEach((e=>{r[n]!==e[n]&&a.push(e)})),{...e,[t]:a}}function R(e,t){let r;return e.forEach((e=>{e.id===t&&(r=e)})),r}function b(e,t,r,n=!1){const a={...r};a.id||(a.id=f().generate());const o={};return o[t]=n?[a,...e[t]]:[...e[t],a],{...e,...o}}function S(e,t,r,n=!1){const a=[...r];a.forEach((e=>{e.id||(e.id=f().generate())}));const o={};return o[t]=n?[...a,...e[t]]:[...e[t],...a],{...e,...o}}function A(e,t,r={ignoreUndefined:!1,ignoreNull:!1,ignoreFields:[]}){var n;let o=e,i=t;if(r.ignoreUndefined&&(o=p()(o,l()),i=p()(i,l())),r.ignoreNull&&(o=p()(o,s()),i=p()(i,s())),null!=(n=r.ignoreFields)&&n.length){const e=(0,E.Z)(r.ignoreFields);return a()(o,i,((t,r)=>_()((0,E.Z)(t).map((t=>d()(t,e))),(0,E.Z)(r).map((t=>d()(t,e))))))}return _()(o,i)}},10222:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(54076);const a=e=>(async e=>{if((0,n.G6)())try{const t=new ClipboardItem({"text/plain":e()});await navigator.clipboard.write([t])}catch{const t=await e();await navigator.clipboard.writeText(t)}else{const t=await e();await navigator.clipboard.writeText(t)}})(e).catch((()=>e().then((e=>new Promise(((t,r)=>{const n=document.getSelection();if(n){n.removeAllRanges();const t=document.createRange(),a=document.createElement("span");a.textContent=e,a.style.position="fixed",a.style.top="0",a.style.clip="rect(0, 0, 0, 0)",a.style.whiteSpace="pre",document.body.appendChild(a),t.selectNode(a),n.addRange(t);try{document.execCommand("copy")||r()}catch(e){r()}document.body.removeChild(a),n.removeRange?n.removeRange(t):n.removeAllRanges()}t()}))))))},66785:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={SESSION_TIMED_OUT:"Your session timed out, please refresh your page and try again."}},12617:(e,t,r)=>{"use strict";r.d(t,{R:()=>n});const n=(0,r(30845).Z)(((e,t,r)=>!!r&&Object.values(r).some((r=>r.some((([r,n])=>r===e&&n===t))))))},98286:(e,t,r)=>{"use strict";r.d(t,{HR:()=>i,MV:()=>s,O$:()=>l,d7:()=>c});var n=r(61988),a=r(67663),o=r(66785);function s(e){let t={...e};var r,a,s;(t.errors&&t.errors.length>0&&(t.error=t.description=t.errors[0].message,t.link=null==(r=t.errors[0])||null==(a=r.extra)?void 0:a.link),!t.error&&t.message)&&("object"==typeof t.message&&(t.error=(null==(s=Object.values(t.message)[0])?void 0:s[0])||(0,n.t)("Invalid input")),"string"==typeof t.message&&(t.error=t.message));return t.stack?t={...t,error:(0,n.t)("Unexpected error: ")+(t.description||(0,n.t)("(no description, click to see stack trace)")),stacktrace:t.stack}:t.responseText&&t.responseText.indexOf("CSRF")>=0&&(t={...t,error:(0,n.t)(o.Z.SESSION_TIMED_OUT)}),{...t,error:t.error}}async function i(e,t){const{error:r,message:a}=await l(e);let o=(0,n.t)("Sorry, an unknown error occurred.");return r&&(o=(0,n.t)("Sorry, there was an error saving this %s: %s",t,r)),"string"==typeof a&&"Forbidden"===a&&(o=(0,n.t)("You do not have permission to edit this %s",t)),o}function l(e){return new Promise((t=>{if("string"==typeof e)return void t({error:e});if(e instanceof TypeError&&"Failed to fetch"===e.message)return void t({error:(0,n.t)("Network error")});if("timeout"in e&&"statusText"in e&&"timeout"===e.statusText)return void t({...e,error:(0,n.t)("Request timed out"),errors:[{error_type:a.C.FRONTEND_TIMEOUT_ERROR,extra:{timeout:e.timeout/1e3,issue_codes:[{code:1e3,message:(0,n.t)("Issue 1000 - The dataset is too large to query.")},{code:1001,message:(0,n.t)("Issue 1001 - The database is under an unusual load.")}]},level:"error",message:"Request timed out"}]});const r=e instanceof Response?e:e.response;if(r&&!r.bodyUsed)return void r.clone().json().then((e=>{const n={...r,...e};t(s(n))})).catch((()=>{r.text().then((e=>{t({...r,error:e})}))}));let o=e.statusText||e.message;o||(console.error("non-standard error:",e),o=(0,n.t)("An error occurred")),t({...r,error:o})}))}function c(e,t){let r=e;const n=(null==t?void 0:t.message)||(null==t?void 0:t.error);return n&&(r=`${r}:\n${n}`),r}},42313:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n=e=>{var t,r;return null!=(t=e.uid)?t:`${null!=(r=e.id)?r:"None"}__${e.type}`}},71894:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});const n=()=>{var e,t;return null==(e=window)||null==(t=e.navigator)?void 0:t.webdriver}},9679:(e,t,r)=>{"use strict";function n(e){const t=new Set;return JSON.stringify(e,((e,r)=>{if("object"==typeof r&&null!==r){if(t.has(r))try{return JSON.parse(JSON.stringify(r))}catch(e){return}t.add(r)}return r}))}r.d(t,{o:()=>n})},23525:(e,t,r)=>{"use strict";r.d(t,{Nm:()=>g,TO:()=>v,YE:()=>y,eY:()=>p,en:()=>R});var n=r(41609),a=r.n(n),o=r(31069),s=r(37731),i=r(15926),l=r.n(i),c=r(27600),d=r(43399),u=r(11370);function p({name:e,type:t}){const r=new URLSearchParams(window.location.search).get(e);switch(t){case"number":return r?"true"===r.toLowerCase()?1:"false"===r.toLowerCase()?0:Number.isNaN(Number(r))?null:Number(r):null;case"object":return r?JSON.parse(r):null;case"boolean":return r?"false"!==r.toLowerCase()&&"0"!==r:null;case"rison":if(!r)return null;try{return l().decode(r)}catch{return r}default:return r}}function m(e){const t=new URLSearchParams;return new URLSearchParams(window.location.search).forEach(((r,n)=>{e.includes(n)||t.append(n,r)})),t}function _(e){const t=[];return e.forEach(((e,r)=>t.push([r,e]))),t}function h(e){const t=e||c.$O,r=m(t),n=(0,d.De)();return a()(n)||t.includes(c.KD.preselectFilters.name)||r.append(c.KD.preselectFilters.name,JSON.stringify((0,u.Z)((0,d.De)()))),_(r)}function f(){const e=m(c.Rv),t=(0,d.De)();return a()(t)||e.append(c.KD.preselectFilters.name,JSON.stringify((0,u.Z)((0,d.De)()))),_(e)}function E(e,t){return o.Z.post({endpoint:e,jsonPayload:t}).then((e=>e.json.url))}function y(e,t){return E("/api/v1/explore/permalink",{formData:e,urlParams:h(t)})}function g({dashboardId:e,dataMask:t,activeTabs:r,anchor:n}){return E(`/api/v1/dashboard/${e}/permalink`,{urlParams:f(),dataMask:t,activeTabs:r,anchor:n})}const T=/^([^:/?#]+:)?(?:(\/\/)?([^/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/;function v(e){const t=e.match(T)||[];return"string"==typeof t[1]&&t[1].length>0||"//"===t[2]||"string"==typeof t[3]&&t[3].length>0}function R(e){const t=e.match(T)||[];return!v(e)||(0,s.Z)(t[1])||e.startsWith("//")?e:`//${e}`}},60835:(e,t,r)=>{"use strict";r.d(t,{Cy:()=>Ae,zn:()=>Ce,h:()=>De});var n=r(29829),a=r(53894),o=r(10362),s=r(72570),i=r(37863),l=r(8868),c=r(57557),d=r.n(c),u=r(39666),p=r(41295),m=r(4305),_=r(9467),h=r(39023),f=r(39759),E=r(24350),y=r.n(E),g=r(50810),T=r(37927),v=r(21090),R=r(80621),b=r(12885),S=r(81255);function A(e){return[S.BA,S.dW,S.xh,S.t].indexOf(e.type)>-1}var O=r(95173),I=r(47456),C=r(37418),D=r(28428);const N={[S.BG]:{[S.dW]:!0,[S.BA]:!0,[S.xh]:!0},[S.gn]:{[S.dW]:!0,[S.BA]:!0,[S.xh]:!0}};function w({parentType:e,childType:t}){if(!e||!t)return!1;const r=N[e];return!!r&&Boolean(r[t])}function L({dropResult:e,layout:t}){const{dragging:r,destination:n}=e,a=r.type,o=t[n.id],s=o.type;let i=(0,D.Z)(a,r.meta);i.parents=(o.parents||[]).concat(o.id),A(r)&&(i.meta.width=(0,I.Z)({dropResult:e,layout:t})||void 0);const l=w({parentType:s,childType:a}),c={[i.id]:i};if(l){const e=(0,D.Z)(S.Os);e.children=[i.id],e.parents=(o.parents||[]).concat(o.id),c[e.id]=e,i.parents=e.parents.concat(e.id),i=e}else if(a===S.yR){const e=(0,D.Z)(S.gn);e.parents=(o.parents||[]).concat(o.id),i.children=[e.id],c[e.id]=e}const d=[...o.children];return d.splice(n.index,0,i.id),c[n.id]={...o,children:d},c}function q(e,t,r){const n=null==r?void 0:r[e];if(n){delete r[e];const{children:a=[]}=n;null==a||null==a.forEach||a.forEach((t=>{q(t,e,r)}));const o=null==r?void 0:r[t];if(Array.isArray(null==o?void 0:o.children)){const n=o.children.indexOf(e);if(n>-1){const e=[...o.children];e.splice(n,1),r[t]={...o,children:e}}}}}const x={[m.$]:(e,t)=>({...t.data.dashboardLayout.present}),[b.nj](e,t){const{payload:{nextComponents:r}}=t;return{...e,...r}},[b.CB](e,t){var r;const{payload:{id:n,parentId:a}}=t;if(!(a&&n&&e[n]&&e[a]))return e;const o={...e};q(n,a,o);const s=o[a];return(null==s?void 0:s.type)===S.Os&&0===(null==s||null==(r=s.children)?void 0:r.length)&&q(a,(0,O.Z)({childId:a,layout:o}),o),o},[b.J0](e,t){const{payload:{dropResult:r}}=t,n=L({dropResult:r,layout:e});return{...e,...n}},[b.aZ](e,t){const{payload:{dropResult:r}}=t,{source:n,destination:a,dragging:o}=r;if(!n||!a||!o)return e;const s=function({entitiesMap:e,source:t,destination:r}){const n=[...e[t.id].children],a=[...e[r.id].children],o=n[t.index];if(t.id===r.id){const a=function(e,t,r){const n=[...e],[a]=n.splice(t,1);return n.splice(r,0,a),n}(n,t.index,r.index);return{...e,[t.id]:{...e[t.id],children:a}}}return n.splice(t.index,1),a.splice(r.index,0,o),{...e,[t.id]:{...e[t.id],children:n},[r.id]:{...e[r.id],children:a}}}({entitiesMap:e,source:n,destination:a});if(A(s[o.id])){const t=(0,I.Z)({dropResult:r,layout:e})||void 0;(s[o.id].meta||{}).width!==t&&(s[o.id]={...s[o.id],meta:{...s[o.id].meta,width:t}})}if(w({parentType:a.type,childType:o.type})){const e=s[a.id],t=e.children,r=(0,D.Z)(S.Os);r.children=[t[a.index]],r.parents=(e.parents||[]).concat(a.id),t[a.index]=r.id,s[r.id]=r}return{...e,...s}},[b.YA](e,t){const{payload:{dropResult:r}}=t,{source:n,dragging:a}=r,o=e[R._4],s=o.children[0],i=e[s];if(n.id!==R.D0){const t=e[a.id].children[0],r=e[t],n=[...i.children].filter((e=>e!==a.id));return{...e,[R._4]:{...o,children:[a.id]},[s]:{...i,children:[]},[t]:{...r,children:[...r.children,...n]}}}const l=L({dropResult:r,layout:e}),c=Object.values(l),d=c.find((e=>e.type===S.gn)),u=c.find((e=>e.type===S.yR));return d.children=[...i.children],l[s]={...i,children:[]},l[R._4]={...o,children:[u.id]},{...e,...l}},[b.Mu](e){const t=e[R._4],r=t.children[0],n=e[r];if(n.type!==S.yR)return e;let a=[];const o={...e};return n.children.forEach((t=>{const r=e[t];a=[...a,...r.children],delete o[t]})),delete o[r],o[R._4]={...t,children:[R.PV]},o[R.PV]={...e[R.PV],children:a},o},[b.x_](e){const t={...e};return(0,C.Z)({currentComponent:t[R._4],layout:t}),{...t}},[b.bK]:(e,t)=>({...e,[R.M2]:{...e[R.M2],meta:{...e[R.M2].meta,text:t.text}}})},U=(0,v.ZP)((function(e={},t){return t.type in x?(0,x[t.type])(e,t):e}),{limit:R.Q9+2,ignoreInitialState:!0,filter:(0,v.an)([m.$,b.nj,b.CB,b.J0,b.YA,b.Mu,b.qL,b.aZ,b.L1])});var Z=r(14670),P=r.n(Z),M=r(31069),F=r(9679),k=r(97381),Q=r(3741),$=r(23279),Y=r.n($);const B=new class{constructor({callback:e=(()=>{}),sizeThreshold:t=1e3,delayThreshold:r=1e3}){this.queue=[],this.sizeThreshold=t,this.delayThreshold=r,this.trigger=Y()(this.trigger.bind(this),this.delayThreshold),this.callback=e}append(e){this.queue.push(e),this.trigger()}trigger(){if(this.queue.length>0){const e=this.queue.splice(0,this.sizeThreshold);this.callback.call(null,e),this.queue.length>0&&this.trigger()}}}({callback:e=>{if(e.length<=0)return;let t="/superset/log/?explode=events";const{source:r,source_id:n}=e[0];if("dashboard"===r?t+=`&dashboard_id=${n}`:"slice"===r&&(t+=`&slice_id=${n}`),navigator.sendBeacon){const r=new FormData;r.append("events",(0,F.o)(e)),M.Z.getGuestToken()&&r.append("guest_token",M.Z.getGuestToken()),navigator.sendBeacon(t,r)}else M.Z.post({endpoint:t,postPayload:{events:e},parseMethod:null})},sizeThreshold:1024,delayThreshold:1e3});let H=0;const j=e=>t=>r=>{var n;if(r.type!==k.LOG_EVENT)return t(r);const{dashboardInfo:a,explore:o,impressionId:s,dashboardLayout:i,sqlLab:l}=e.getState();let c={impression_id:s,version:"v2"};if(null!=a&&a.id)c={source:"dashboard",source_id:a.id,...c};else if(null!=o&&o.slice)c={source:"explore",source_id:o.slice?o.slice.slice_id:0,...c};else if(l){const e=l.queryEditors.find((({id:e})=>e===l.tabHistory.slice(-1)[0]));c={source:"sqlLab",source_id:null==e?void 0:e.id,db_id:null==e?void 0:e.dbId,schema:null==e?void 0:e.schema}}const{eventName:d}=r.payload;let{eventData:u={}}=r.payload;if(u={...c,ts:(new Date).getTime(),event_name:d,...u},Q.TY.has(d)?u={...u,event_type:"timing",trigger_event:H}:(H=P().generate(),u={...u,event_type:"user",event_id:H,visibility:document.visibilityState}),u.target_id&&null!=i&&null!=(n=i.present)&&n[u.target_id]){const{meta:e}=i.present[u.target_id];u.target_name=e.chartId?e.sliceName:e.text}return B.append(u),u};var V=r(19485),G=r(76445),z=r(78718),W=r.n(z),K=r(55786),J=r(52256),X=r(35854),ee=r(10331),te=r(651),re=r(42313),ne=r(99068),ae=r(35937),oe=r.n(ae),se=r(64417),ie=r.n(se),le=r(93185),ce=r(43693),de=r(82591),ue=r(44904);const pe={tables:de.uQ,queries:de.NU,queryEditors:de.St,unsavedQueryEditor:e=>(0,de.St)([e])[0]},me={paths:["sqlLab"],config:{slicer:e=>t=>{const r={};e.forEach((e=>{if((0,le.cr)(le.TT.SqllabBackendPersistence)){const{queryEditors:e,editorTabLastUpdatedAt:n,unsavedQueryEditor:a,tables:o,queries:s,tabHistory:i}=t.sqlLab,l=(0,ce.V)(e,a,n);if(l.length>0){const e=l.every((({inLocalStorage:e})=>!e));r.sqlLab={queryEditors:l,...!e&&{tabHistory:i,tables:o.filter((e=>e.inLocalStorage)),queries:oe()(s,(e=>e.inLocalStorage&&!e.isDataPreview))}}}}else delete t[e].common,"sqlLab"===e&&(r[e]=Object.fromEntries(Object.entries(t[e]).map((([e,t])=>{var r,n;return[e,null!=(r=null==(n=pe[e])?void 0:n.call(pe,t))?r:t]}))))}));const n=JSON.stringify(r),a=Math.round(n.length*ue.TU/ue.Yo*100)/100;return t.localStorageUsageInKilobytes!==a&&(t.localStorageUsageInKilobytes=a),r},merge:(e,t={})=>({...e,...t,sqlLab:{...(null==t?void 0:t.sqlLab)||{},...e.sqlLab}})}},_e=ie()(me.paths,me.config);var he=r(61988),fe=r(43716),Ee=r(88484),ye=r(11409),ge=r(44814),Te=r(99543);function ve(e,t,r,n=!1){if(e.tabHistory[e.tabHistory.length-1]!==r){const{queryEditors:n}=(0,Te.gf)(e,"queryEditors",{id:r},t);return{queryEditors:n}}return{unsavedQueryEditor:{...e.unsavedQueryEditor.id===r&&e.unsavedQueryEditor,...r?{id:r,...t}:e.unsavedQueryEditor,...!n&&{updatedAt:(new Date).getTime()}}}}var Re=r(36627);const be=e=>(t=e)=>t,Se=(0,r(20292).Z)(),Ae="USER_LOADED",Oe=e=>[a.Z,j,o.h.middleware],Ie={sqlLab:function e(t={},r){const n={[ye.ADD_QUERY_EDITOR](){const e={...(0,Te.gf)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor}),tabHistory:[...t.tabHistory,r.queryEditor.id]};return(0,Te._0)(e,"queryEditors",{...r.queryEditor,updatedAt:(new Date).getTime()})},[ye.QUERY_EDITOR_SAVED](){const{query:e,result:n,clientId:a}=r,o=t.queryEditors.find((e=>e.id===a));return(0,Te.gf)(t,"queryEditors",o,{remoteId:n.remoteId,name:e.name},"id")},[ye.UPDATE_QUERY_EDITOR](){const e=r.alterations.remoteId,n=t.queryEditors.find((t=>t.remoteId===e));return null==n?t:(0,Te.gf)(t,"queryEditors",n,r.alterations,"remoteId")},[ye.CLONE_QUERY_TO_NEW_TAB](){const n=t.queryEditors.find((e=>e.id===t.tabHistory[t.tabHistory.length-1])),a={...n,...t.unsavedQueryEditor.id===n.id&&t.unsavedQueryEditor},o={remoteId:a.remoteId,name:(0,he.t)("Copy of %s",a.name),dbId:r.query.dbId?r.query.dbId:null,schema:r.query.schema?r.query.schema:null,autorun:!0,sql:r.query.sql,queryLimit:r.query.queryLimit,maxRow:r.query.maxRow};return e({...t,unsavedQueryEditor:{}},ye.addQueryEditor(o))},[ye.REMOVE_QUERY_EDITOR](){const e={...r.queryEditor,...r.queryEditor.id===t.unsavedQueryEditor.id&&t.unsavedQueryEditor};let n=(0,Te.gP)(t,"queryEditors",e);const a=n.queryEditors.map((e=>e.id)),o={};Object.keys(t.queries).forEach((e=>{const r=t.queries[e];a.indexOf(r.sqlEditorId)>-1&&(o[e]=r)}));let s=t.tabHistory.slice();s=s.filter((e=>a.indexOf(e)>-1));const i=t.tables.filter((t=>t.queryEditorId!==e.id));return n={...n,tabHistory:0===s.length&&n.queryEditors.length>0?n.queryEditors.slice(-1).map((e=>e.id)):s,tables:i,queries:o,unsavedQueryEditor:{...r.queryEditor.id!==t.unsavedQueryEditor.id&&t.unsavedQueryEditor}},n},[ye.REMOVE_QUERY](){const e={...t.queries};return delete e[r.query.id],{...t,queries:e}},[ye.RESET_STATE]:()=>({...r.sqlLabInitialState}),[ye.MERGE_TABLE](){const e={...r.table};let n;if(t.tables.forEach((t=>{t.dbId===e.dbId&&t.queryEditorId===e.queryEditorId&&t.schema===e.schema&&t.name===e.name&&(n=t)})),n)return r.query&&(e.dataPreviewQueryId=r.query.id),n.initialized&&(e.id=n.id),(0,Te.gf)(t,"tables",n,e);e.dataPreviewQueryId=null;let a=(0,Te._0)(t,"tables",e,Boolean(r.prepend));return r.query&&(a=(0,Te.gf)(a,"tables",e,{dataPreviewQueryId:r.query.id})),a},[ye.EXPAND_TABLE]:()=>(0,Te.gf)(t,"tables",r.table,{expanded:!0}),[ye.REMOVE_DATA_PREVIEW](){const e={...t.queries};return delete e[r.table.dataPreviewQueryId],{...(0,Te.gf)(t,"tables",r.table,{dataPreviewQueryId:null}),queries:e}},[ye.CHANGE_DATA_PREVIEW_ID](){const e={...t.queries};delete e[r.oldQueryId];const n=[];return t.tables.forEach((e=>{e.dataPreviewQueryId===r.oldQueryId?n.push({...e,dataPreviewQueryId:r.newQuery.id}):n.push(e)})),{...t,queries:e,tables:n,activeSouthPaneTab:r.newQuery.id}},[ye.COLLAPSE_TABLE]:()=>(0,Te.gf)(t,"tables",r.table,{expanded:!1}),[ye.REMOVE_TABLES](){const e=r.tables.map((e=>e.id));return{...t,tables:t.tables.filter((t=>!e.includes(t.id)))}},[ye.COST_ESTIMATE_STARTED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!1,cost:null,error:null}}}),[ye.COST_ESTIMATE_RETURNED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!0,cost:r.json.result,error:null}}}),[ye.COST_ESTIMATE_FAILED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!1,cost:null,error:r.error}}}),[ye.START_QUERY](){let e={...t};if(r.query.sqlEditorId){const n={...(0,Te.p1)(t.queryEditors,r.query.sqlEditorId),...r.query.sqlEditorId===t.unsavedQueryEditor.id&&t.unsavedQueryEditor};if(n.latestQueryId&&t.queries[n.latestQueryId]){const r={...t.queries[n.latestQueryId].results,data:[],query:null},a={...t.queries[n.latestQueryId],results:r},o={...t.queries,[a.id]:a};e={...t,queries:o}}}else e.activeSouthPaneTab=r.query.id;return e=(0,Te.SJ)(e,"queries",r.query),{...e,...ve(t,{latestQueryId:r.query.id},r.query.sqlEditorId,r.query.isDataPreview)}},[ye.STOP_QUERY]:()=>(0,Te.wK)(t,"queries",r.query,{state:fe.Tb.Stopped,results:[]}),[ye.CLEAR_QUERY_RESULTS](){const e={...r.query.results};return e.data=[],(0,Te.wK)(t,"queries",r.query,{results:e,cached:!0})},[ye.REQUEST_QUERY_RESULTS]:()=>(0,Te.wK)(t,"queries",r.query,{state:fe.Tb.Fetching}),[ye.QUERY_SUCCESS](){var e,n,a,o,s,i,l,c,d,u;if(r.query.state===fe.Tb.STOPPED||r.results.status!==fe.Tb.Success)return t;const p={endDttm:(0,ge.zO)(),progress:100,results:r.results,rows:(null==r||null==(e=r.results)||null==(n=e.query)?void 0:n.rows)||0,state:fe.Tb.Success,limitingFactor:null==r||null==(a=r.results)||null==(o=a.query)?void 0:o.limitingFactor,tempSchema:null==r||null==(s=r.results)||null==(i=s.query)?void 0:i.tempSchema,tempTable:null==r||null==(l=r.results)||null==(c=l.query)?void 0:c.tempTable,errorMessage:null,cached:!1},m=null==r||null==(d=r.results)||null==(u=d.query)?void 0:u.resultsKey;return m&&(p.resultsKey=m),(0,Te.wK)(t,"queries",r.query,p)},[ye.QUERY_FAILED](){if(r.query.state===fe.Tb.Stopped)return t;const e={state:fe.Tb.Failed,errors:r.errors,errorMessage:r.msg,endDttm:(0,ge.zO)(),link:r.link};return(0,Te.wK)(t,"queries",r.query,e)},[ye.SET_ACTIVE_QUERY_EDITOR](){var e;if(t.queryEditors.map((e=>e.id)).indexOf(null==(e=r.queryEditor)?void 0:e.id)>-1&&t.tabHistory[t.tabHistory.length-1]!==r.queryEditor.id){const e={...(0,Te.gf)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor}),unsavedQueryEditor:{}};return{...r.queryEditor.id===t.unsavedQueryEditor.id?(0,Te.gf)(e,"queryEditors",r.queryEditor,{...r.queryEditor,...t.unsavedQueryEditor}):e,tabHistory:[...t.tabHistory,r.queryEditor.id]}}return t},[ye.LOAD_QUERY_EDITOR](){const e=(0,Te.gf)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor});return(0,Te.gf)(e,"queryEditors",r.queryEditor,{...r.queryEditor})},[ye.SET_TABLES]:()=>(0,Te.zd)(t,"tables",r.tables),[ye.SET_ACTIVE_SOUTHPANE_TAB]:()=>({...t,activeSouthPaneTab:r.tabId}),[ye.MIGRATE_QUERY_EDITOR](){try{const{sqlLab:e}=JSON.parse(localStorage.getItem("redux"));e.queryEditors=e.queryEditors.filter((e=>e.id!==r.oldQueryEditor.id)),localStorage.setItem("redux",JSON.stringify({sqlLab:e}))}catch(e){}return(0,Te._0)((0,Te.gP)(t,"queryEditors",r.oldQueryEditor),"queryEditors",r.newQueryEditor)},[ye.MIGRATE_TABLE](){try{const{sqlLab:e}=JSON.parse(localStorage.getItem("redux"));e.tables=e.tables.filter((e=>e.id!==r.oldTable.id)),localStorage.setItem("redux",JSON.stringify({sqlLab:e}))}catch(e){}return(0,Te._0)((0,Te.gP)(t,"tables",r.oldTable),"tables",r.newTable)},[ye.MIGRATE_TAB_HISTORY](){try{const{sqlLab:e}=JSON.parse(localStorage.getItem("redux"));e.tabHistory=e.tabHistory.filter((e=>e!==r.oldId)),localStorage.setItem("redux",JSON.stringify({sqlLab:e}))}catch(e){}const e=t.tabHistory.filter((e=>e!==r.oldId));return e.push(r.newId),{...t,tabHistory:e}},[ye.MIGRATE_QUERY](){const e={...t.queries[r.queryId],sqlEditorId:r.queryEditorId},n={...t.queries,[e.id]:e};return{...t,queries:n}},[ye.QUERY_EDITOR_SETDB]:()=>({...t,...ve(t,{dbId:r.dbId},r.queryEditor.id)}),[ye.QUERY_EDITOR_SET_SCHEMA]:()=>({...t,...ve(t,{schema:r.schema},r.queryEditor.id)}),[ye.QUERY_EDITOR_SET_TITLE]:()=>({...t,...ve(t,{name:r.name},r.queryEditor.id)}),[ye.QUERY_EDITOR_SET_SQL](){const{unsavedQueryEditor:e}=t;return(null==e?void 0:e.id)===r.queryEditor.id&&e.sql===r.sql?t:{...t,...ve(t,{sql:r.sql,...r.queryId&&{latestQueryId:r.queryId}},r.queryEditor.id)}},[ye.QUERY_EDITOR_SET_CURSOR_POSITION]:()=>({...t,...ve(t,{cursorPosition:r.position},r.queryEditor.id)}),[ye.QUERY_EDITOR_SET_QUERY_LIMIT]:()=>({...t,...ve(t,{queryLimit:r.queryLimit},r.queryEditor.id)}),[ye.QUERY_EDITOR_SET_TEMPLATE_PARAMS]:()=>({...t,...ve(t,{templateParams:r.templateParams},r.queryEditor.id)}),[ye.QUERY_EDITOR_SET_SELECTED_TEXT]:()=>({...t,...ve(t,{selectedText:r.sql},r.queryEditor.id,!0)}),[ye.QUERY_EDITOR_SET_AUTORUN]:()=>({...t,...ve(t,{autorun:r.autorun},r.queryEditor.id)}),[ye.QUERY_EDITOR_PERSIST_HEIGHT]:()=>({...t,...ve(t,{northPercent:r.northPercent,southPercent:r.southPercent},r.queryEditor.id)}),[ye.QUERY_EDITOR_TOGGLE_LEFT_BAR]:()=>({...t,...ve(t,{hideLeftBar:r.hideLeftBar},r.queryEditor.id)}),[ye.SET_DATABASES](){const e={};return r.databases.forEach((t=>{e[t.id]={...t,extra_json:JSON.parse(t.extra||"")}})),{...t,databases:e}},[ye.REFRESH_QUERIES](){let e={...t.queries},n=!1,{queriesLastUpdate:a}=t;return Object.entries(r.alteredQueries).forEach((([r,o])=>{if(!t.queries.hasOwnProperty(r)||t.queries[r].state!==fe.Tb.Stopped&&t.queries[r].state!==fe.Tb.Failed){var s;const i=(0,Ee.Z)(o.changed_on),l=Date.parse(i);l>a&&(a=l);const c=null==(s=t.queries[r])?void 0:s.state,d=o.state;e[r]={...t.queries[r],...o,...o.startDttm&&{startDttm:Number(o.startDttm)},...o.endDttm&&{endDttm:Number(o.endDttm)},state:d===fe.Tb.Success&&[fe.Tb.Fetching,fe.Tb.Success,fe.Tb.Running].includes(c)?c:d},n=!0}})),n||(e=t.queries),{...t,queries:e,queriesLastUpdate:a}},[ye.CLEAR_INACTIVE_QUERIES](){const{queries:e}=t,n=Object.fromEntries(Object.entries(e).filter((([,e])=>!(["running","pending"].includes(e.state)&&Date.now()-e.startDttm>r.interval&&0===e.progress))).map((([e,t])=>{var r;return[e,{...t,state:t.resultsKey&&null!=(r=t.results)&&r.status?t.results.status:t.state}]})));return{...t,queries:n}},[ye.SET_USER_OFFLINE]:()=>({...t,offline:r.offline}),[ye.CREATE_DATASOURCE_STARTED]:()=>({...t,isDatasourceLoading:!0,errorMessage:null}),[ye.CREATE_DATASOURCE_SUCCESS]:()=>({...t,isDatasourceLoading:!1,errorMessage:null,datasource:r.datasource}),[ye.CREATE_DATASOURCE_FAILED]:()=>({...t,isDatasourceLoading:!1,errorMessage:r.err}),[ye.SET_EDITOR_TAB_LAST_UPDATE]:()=>({...t,editorTabLastUpdatedAt:r.timestamp})};return r.type in n?n[r.type]():t},localStorageUsageInKilobytes:be(0),messageToasts:function(e=[],t){switch(t.type){case s.h:{const{payload:r}=t,n=e.slice();return r.noDuplicate&&n.find((e=>e.text===r.text))?e:[r,...e]}case s.K7:{const{payload:{id:r}}=t;return[...e].filter((e=>e.id!==r))}default:return e}},common:be(Se.common),user:(e=Se.user||{},t)=>t.type===Ae?t.user:e,impressionId:be(P().generate()),charts:i.Z,datasources:(e,t)=>t.type===g.Rn.SetDatasources?function(e,t){return t.type===g.Rn.SetDatasources?{...e,...y()(t.datasources,"uid")}:t.type===g.Rn.SetDatasource?{...e,[t.key]:t.datasource}:e||{}}(e,t):function(e,t){return t.type===ne.AG?{...e,[(0,re.T)(t.datasource)]:t.datasource}:t.type===G._?{...t.data.datasources}:e||{}}(e,t),dashboardInfo:function(e={},t){switch(t.type){case p.$A:return{...e,...t.newInfo,last_modified_time:Math.round((new Date).getTime()/1e3)};case m.$:return{...e,...t.data.dashboardInfo};case p.nH:return{...e,filterBarOrientation:t.filterBarOrientation};case p.Fl:return{...e,crossFiltersEnabled:t.crossFiltersEnabled};default:return e}},dashboardFilters:h.ZP,dataMask:l.Z,nativeFilters:f.Z,dashboardState:function(e={},t){const r={[m.$]:()=>({...e,...t.data.dashboardState}),[_.Be]:()=>({...e,css:t.css}),[_.BD](){const r=new Set(e.sliceIds);return r.add(t.slice.slice_id),{...e,sliceIds:Array.from(r)}},[_.Vd](){const{sliceId:r}=t,n=new Set(e.sliceIds);return n.delete(r),{...e,sliceIds:Array.from(n)}},[_.Z9]:()=>({...e,isStarred:t.isStarred}),[_.H9]:()=>({...e,isPublished:t.isPublished}),[_.$f]:()=>({...e,editMode:t.editMode}),[_.n1](){const{maxUndoHistoryExceeded:r=!0}=t.payload;return{...e,maxUndoHistoryExceeded:r}},[_.oJ]:()=>({...e}),[_.J$]:()=>({...e,colorScheme:t.colorScheme,updatedColorScheme:!0}),[_.ek](){const r={...e.expandedSlices},{sliceId:n}=t;return r[n]?delete r[n]:r[n]=!0,{...e,expandedSlices:r}},[_.P0]:()=>({...e,hasUnsavedChanges:!0}),[_.hD]:()=>({...e,dashboardIsSaving:!0}),[_.qJ]:()=>({...e,dashboardIsSaving:!1}),[_.Ii]:()=>({...e,hasUnsavedChanges:!1,maxUndoHistoryExceeded:!1,editMode:!1,updatedColorScheme:!1,lastModifiedTime:t.lastModifiedTime}),[_.ee](){const{hasUnsavedChanges:r}=t.payload;return{...e,hasUnsavedChanges:r}},[_.yV]:()=>({...e,refreshFrequency:t.refreshFrequency,shouldPersistRefreshFrequency:t.isPersistent,hasUnsavedChanges:t.isPersistent}),[_.ec]:()=>({...e,isRefreshing:!0}),[_.bs]:()=>({...e,isFiltersRefreshing:!0}),[_.sm]:()=>({...e,isFiltersRefreshing:!1}),[_.k5]:()=>({...e,isRefreshing:!1}),[_.RU]:()=>({...e,directPathToChild:t.path,directPathLastUpdated:Date.now()}),[_.om](){const r=new Set(e.activeTabs);return r.delete(t.prevTabId),r.add(t.tabId),{...e,activeTabs:Array.from(r)}},[_.w9]:()=>({...e,overwriteConfirmMetadata:t.overwriteConfirmMetadata}),[_.mq]:()=>({...e,focusedFilterField:{chartId:t.chartId,column:t.column}}),[_.Iw]:()=>e.focusedFilterField&&t.chartId===e.focusedFilterField.chartId&&t.column===e.focusedFilterField.column?{...e,focusedFilterField:null}:e,[_.r$]:()=>({...e,fullSizeChartId:t.chartId}),[_.FF]:()=>({...e,datasetsStatus:t.status})};return t.type in r?r[t.type]():e},dashboardLayout:U,sliceEntities:T.Z,reports:function(e={},t){const r={[u.jt](){var r,n;const{report:a,resourceId:o,creationMethod:s,filterField:i}=t,l=null==(r=a.result)?void 0:r.find((e=>e[i]===o));if(l)return{...e,[s]:{...e[s],[o]:l}};if(null!=e&&null!=(n=e[s])&&n[o]){const t={...e};return delete t[s][o],t}return{...e}},[u.J8](){const{result:r,id:n}=t.json,a={...r,id:n},o=a.dashboard||a.chart;return{...e,[a.creation_method]:{...e[a.creation_method],[o]:a}}},[u.Dr](){const r={...t.json.result,id:t.json.id},n=r.dashboard||r.chart;return{...e,[r.creation_method]:{...e[r.creation_method],[n]:r}}},[u._M](){const{report:r}=t,n=r.dashboard||r.chart;return{...e,[r.creation_method]:{...d()(e[r.creation_method],n)}}}};return t.type in r?r[t.type]():e},saveModal:function(e={},t){const r={[V.SET_SAVE_CHART_MODAL_VISIBILITY]:()=>({...e,isVisible:t.isVisible}),[V.FETCH_DASHBOARDS_SUCCEEDED]:()=>({...e,dashboards:t.choices}),[V.FETCH_DASHBOARDS_FAILED]:()=>({...e,saveModalAlert:`fetching dashboards failed for ${t.userId}`}),[V.SAVE_SLICE_FAILED]:()=>({...e,saveModalAlert:"Failed to save slice"}),[V.SAVE_SLICE_SUCCESS]:t=>({...e,data:t}),[G._]:()=>({...t.data.saveModal})};return t.type in r?r[t.type]():e},explore:function(e={},t){const r={[J.DYNAMIC_PLUGIN_CONTROLS_READY]:()=>({...e,controls:t.controlsState}),[te.TOGGLE_FAVE_STAR]:()=>({...e,isStarred:t.isStarred}),[te.POST_DATASOURCE_STARTED]:()=>({...e,isDatasourceMetaLoading:!0}),[te.UPDATE_FORM_DATA_BY_DATASOURCE](){const r={...e.form_data},{prevDatasource:n,newDatasource:a}=t,o={...e.controls},s=[];n.id===a.id&&n.type===a.type||(r.datasource=a.uid),Object.entries(o).forEach((([e,t])=>{("column_name"===t.valueKey||"savedMetrics"in t||"columns"in t||"options"in t&&!Array.isArray(t.options))&&(r[e]=(0,ee.YY)(a,t,t.value),(0,K.Z)(r[e]).length>0&&r[e]!==o[e].default&&s.push(e))}));const i={...e,controls:o,datasource:t.newDatasource};return{...i,form_data:r,controls:(0,X.R3)(i,r),controlsTransferred:s}},[te.FETCH_DATASOURCES_STARTED]:()=>({...e,isDatasourcesLoading:!0}),[te.SET_FIELD_VALUE](){const{controlName:r,value:n,validationErrors:a}=t;let o={...e.form_data,[r]:n};const s=e.form_data.metrics,i=e.form_data.column_config,l=o.viz_type;"metrics"===r&&s&&i&&(n.forEach(((e,t)=>{var r,n;!s.some((t=>(null==t?void 0:t.label)===(null==e?void 0:e.label)))&&(null==e?void 0:e.label)!==(null==(r=s[t])?void 0:r.label)&&i[null==(n=s[t])?void 0:n.label]&&(i[e.label]=i[s[t].label],delete i[s[t].label])})),o.column_config=i);const c=e.controls[t.controlName]||(0,ee.Bx)(t.controlName,l)||null,d={...(0,ee.vP)(c,e,t.value)},u={...e.controls.column_config,...i&&{value:i}},p={...e,controls:{...e.controls,...c&&{[r]:d},..."metrics"===r&&{column_config:u}}},m={};Array.isArray(d.rerender)&&d.rerender.forEach((e=>{m[e]={...(0,ee.vP)(p.controls[e],p,p.controls[e].value)}}));const _=d.validationErrors||[];(a||[]).forEach((e=>{_.includes(e)||_.push(e)}));const h=_&&_.length>0,f="viz_type"===t.controlName&&t.value!==e.controls.viz_type.value;let E=e.controls;if(f){const r=new ee.os(e.form_data).transform(t.value,e);o=r.formData,E=r.controlsState}return{...e,form_data:o,triggerRender:d.renderTrigger&&!h,controls:{...E,...c&&{[t.controlName]:{...d,validationErrors:_}},...m}}},[te.SET_EXPLORE_CONTROLS]:()=>({...e,controls:(0,X.R3)(e,t.formData)}),[te.SET_FORM_DATA]:()=>({...e,form_data:t.formData}),[te.UPDATE_CHART_TITLE]:()=>({...e,sliceName:t.sliceName}),[te.SET_SAVE_ACTION]:()=>({...e,saveAction:t.saveAction}),[te.CREATE_NEW_SLICE]:()=>({...e,slice:t.slice,controls:(0,X.R3)(e,t.form_data),can_add:t.can_add,can_download:t.can_download,can_overwrite:t.can_overwrite}),[te.SET_STASH_FORM_DATA](){const{form_data:r,hiddenFormData:n}=e,{fieldNames:a,isHidden:o}=t;if(o)return{...e,hiddenFormData:{...n,...W()(r,a)},form_data:d()(r,a)};const s=W()(n,a);return 0===Object.keys(s).length?e:{...e,form_data:{...r,...s},hiddenFormData:d()(n,a)}},[te.SLICE_UPDATED](){var r;return{...e,slice:{...e.slice,...t.slice,owners:t.slice.owners?t.slice.owners.map((e=>e.value)):null},sliceName:null!=(r=t.slice.slice_name)?r:e.sliceName,metadata:{...e.metadata,owners:t.slice.owners?t.slice.owners.map((e=>e.label)):null}}},[te.SET_FORCE_QUERY]:()=>({...e,force:t.force}),[G._]:()=>({...t.data.explore})};return t.type in r?r[t.type]():e}};function Ce({disableDebugger:e=!1,initialState:t=(0,Re.Z)(Se),rootReducers:r=Ie,...a}={}){return(0,n.xC)({preloadedState:t,reducer:{[o.h.reducerPath]:o.h.reducer,...r},middleware:Oe,devTools:!1,enhancers:[_e],...a})}const De=Ce()},69233:(e,t,r)=>{var n={"./alert.svg":[26230,6230],"./alert_solid.svg":[2886,2886],"./alert_solid_small.svg":[14002,4002],"./area-chart-tile.svg":[65573,5573],"./ballot.svg":[70287,287],"./bar-chart-tile.svg":[91084,1084],"./big-number-chart-tile.svg":[58310,8310],"./binoculars.svg":[81684,1684],"./bolt.svg":[6450,6450],"./bolt_small.svg":[40894,894],"./bolt_small_run.svg":[5094,5094],"./calendar.svg":[48829,8829],"./cancel-x.svg":[65394,5394],"./cancel.svg":[19332,9364],"./cancel_solid.svg":[30869,869],"./card_view.svg":[91277,1277],"./cards.svg":[76145,6145],"./cards_locked.svg":[49490,9490],"./caret_down.svg":[40149,149],"./caret_left.svg":[91363,1363],"./caret_right.svg":[56746,6746],"./caret_up.svg":[38754,8754],"./category.svg":[75362,5362],"./certified.svg":[7914,7914],"./check.svg":[69814,9814],"./checkbox-half.svg":[72109,2109],"./checkbox-off.svg":[51923,9131],"./checkbox-on.svg":[72426,2426],"./circle.svg":[31603,1603],"./circle_check.svg":[91503,1503],"./circle_check_solid.svg":[82078,2078],"./clock.svg":[33211,3211],"./close.svg":[48082,8082],"./code.svg":[28295,8295],"./cog.svg":[93533,3533],"./collapse.svg":[29414,9414],"./color_palette.svg":[81997,1997],"./components.svg":[27618,7618],"./copy.svg":[7335,7335],"./cross-filter-badge.svg":[60642,642],"./current-rendered-tile.svg":[11626,1626],"./cursor_target.svg":[42679,2679],"./database.svg":[57056,7056],"./dataset_physical.svg":[14255,4255],"./dataset_virtual.svg":[5336,1016],"./dataset_virtual_greyscale.svg":[80389,389],"./default_db_image.svg":[59286,9286],"./download.svg":[77239,7239],"./drag.svg":[33709,3709],"./edit.svg":[673,673],"./edit_alt.svg":[84749,4749],"./email.svg":[3702,3702],"./error.svg":[16525,6525],"./error_solid.svg":[48277,8277],"./error_solid_small.svg":[68162,8162],"./error_solid_small_red.svg":[83702,8700],"./exclamation.svg":[24602,4602],"./expand.svg":[65481,5481],"./eye.svg":[13456,3456],"./eye_slash.svg":[95305,5305],"./favorite-selected.svg":[62913,2913],"./favorite-unselected.svg":[97914,9452],"./favorite_small_selected.svg":[66146,6146],"./field_abc.svg":[78942,8942],"./field_boolean.svg":[14804,4804],"./field_date.svg":[22417,2417],"./field_derived.svg":[23045,3045],"./field_num.svg":[27461,7461],"./field_struct.svg":[28325,8325],"./file.svg":[84376,4376],"./filter.svg":[85205,5205],"./filter_small.svg":[48225,8225],"./folder.svg":[83431,3431],"./full.svg":[9542,9542],"./function_x.svg":[83339,3339],"./gear.svg":[15634,5634],"./grid.svg":[89480,9480],"./image.svg":[8417,8417],"./import.svg":[47508,7508],"./info-solid.svg":[89558,9558],"./info.svg":[73489,3489],"./info_solid_small.svg":[7822,7822],"./join.svg":[72405,2405],"./keyboard.svg":[45310,5310],"./layers.svg":[51705,1705],"./lightbulb.svg":[46712,6712],"./line-chart-tile.svg":[83423,3423],"./link.svg":[54641,4641],"./list.svg":[91019,1019],"./list_view.svg":[48074,8074],"./location.svg":[55840,5840],"./lock_locked.svg":[9174,9174],"./lock_unlocked.svg":[25280,5280],"./map.svg":[48058,8058],"./message.svg":[25922,5922],"./minus.svg":[35117,5117],"./minus_solid.svg":[67539,7539],"./more_horiz.svg":[82968,3246],"./more_vert.svg":[51441,1441],"./move.svg":[34801,4801],"./nav_charts.svg":[98430,8430],"./nav_dashboard.svg":[36239,6239],"./nav_data.svg":[66730,6730],"./nav_explore.svg":[59360,9360],"./nav_home.svg":[58960,8960],"./nav_lab.svg":[43613,3613],"./note.svg":[60971,971],"./offline.svg":[70650,650],"./paperclip.svg":[44837,4837],"./pie-chart-tile.svg":[19804,9804],"./placeholder.svg":[27850,7850],"./plus.svg":[34616,4616],"./plus_large.svg":[67820,7820],"./plus_small.svg":[74585,4585],"./plus_solid.svg":[83070,3070],"./queued.svg":[62905,2905],"./redo.svg":[13043,3043],"./refresh.svg":[84,84],"./running.svg":[15350,5350],"./save.svg":[90511,511],"./search.svg":[52652,2652],"./server.svg":[26878,6878],"./share.svg":[25869,5869],"./slack.svg":[51044,1044],"./sort.svg":[16945,6945],"./sort_asc.svg":[88012,8012],"./sort_desc.svg":[88426,8426],"./sql.svg":[17248,7248],"./table-chart-tile.svg":[85499,5499],"./table.svg":[99684,9684],"./tag.svg":[92237,2237],"./tags.svg":[51378,1378],"./transparent.svg":[54858,4858],"./trash.svg":[15694,2663],"./triangle_change.svg":[47635,7635],"./triangle_down.svg":[97589,6384],"./triangle_up.svg":[33478,3478],"./undo.svg":[62202,2202],"./up-level.svg":[15029,5029],"./user.svg":[72837,2837],"./warning.svg":[92707,2707],"./warning_solid.svg":[85725,5725],"./x-large.svg":[55521,5521],"./x-small.svg":[20057,57]};function a(e){if(!r.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],a=t[0];return r.e(t[1]).then((()=>r(a)))}a.keys=()=>Object.keys(n),a.id=69233,e.exports=a},89419:(e,t,r)=>{"use strict";e.exports=r.p+"loading.cff8a5da.gif"}}]);
//# sourceMappingURL=7130.24cf033576d5c1ebbdd2.entry.js.map